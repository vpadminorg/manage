import{aa as T,d as ie,Y as K,r as _,Z as ae,b as Ee,J as Ue,$ as he,o as u,c as C,j as t,k as a,w as b,m as F,e as n,x as ne,F as $,q as L,p as f,y as c,W as oe,a0 as De,X as qe,Q as Ke,R as Fe,G as $e,C as Le,D as Re,I as Ie,ab as Ne,a1 as Pe,af as Be,U as Qe,v as ze}from"./index-D4nD6lq3.js";/* empty css                       *//* empty css                 *//* empty css                */import{_ as Ae}from"./index-BH-aX6uU.js";import{E as je,a as Ge}from"./el-table-column-Nw9CsZCh.js";import"./el-checkbox-DpS0yAA0.js";import{_ as Oe}from"./index-Cu5tDpmP.js";/* empty css               */import{_ as Je}from"./index-CeC1FWzw.js";/* empty css               */import{E as Me,a as We}from"./el-form-item-oceQVxPu.js";import{E as Xe}from"./index-I5OlcPyW.js";import{E as Ye}from"./index-fvT2sidt.js";import{E as Ze}from"./index-DWSlLEJi.js";import{E as He,a as xe}from"./index-BaDxqmMz.js";import"./_initCloneObject-Cyh6om-O.js";/* empty css                */import"./index-CsUbaV0a.js";import"./_baseClone-zQQn4kcl.js";const et=r=>T({url:"/system/client/list",method:"get",params:r}),tt=r=>T({url:"/system/client/"+r,method:"get"}),lt=r=>T({url:"/system/client",method:"post",data:r}),at=r=>T({url:"/system/client",method:"put",data:r}),nt=r=>T({url:"/system/client/"+r,method:"delete"});function ot(r,o){return T({url:"/system/client/changeStatus",method:"put",data:{clientId:r,status:o}})}const it={class:"p-2"},st={class:"search"},ut={class:"dialog-footer"},dt=ie({name:"Client"}),qt=ie({...dt,setup(r){const{proxy:o}=Fe(),{sys_normal_disable:R}=K(o==null?void 0:o.useDict("sys_normal_disable")),{sys_grant_type:A}=K(o==null?void 0:o.useDict("sys_grant_type")),{sys_device_type:j}=K(o==null?void 0:o.useDict("sys_device_type")),G=_([]),w=_(!1),S=_(!0),E=_(!0),I=_([]),O=_(!0),J=_(!0),N=_(0),M=_(),P=_(),g=ae({visible:!1,title:""}),W={id:void 0,clientId:void 0,clientKey:void 0,clientSecret:void 0,grantTypeList:void 0,deviceType:void 0,activeTimeout:void 0,timeout:void 0,status:void 0},se=ae({form:{...W},queryParams:{pageNum:1,pageSize:10,clientId:void 0,clientKey:void 0,clientSecret:void 0,grantType:void 0,deviceType:void 0,activeTimeout:void 0,timeout:void 0,status:void 0},rules:{id:[{required:!0,message:"id不能为空",trigger:"blur"}],clientId:[{required:!0,message:"客户端id不能为空",trigger:"blur"}],clientKey:[{required:!0,message:"客户端key不能为空",trigger:"blur"}],clientSecret:[{required:!0,message:"客户端秘钥不能为空",trigger:"blur"}],grantTypeList:[{required:!0,message:"授权类型不能为空",trigger:"change"}],deviceType:[{required:!0,message:"设备类型不能为空",trigger:"change"}]}}),{queryParams:d,form:s,rules:ue}=K(se),V=async()=>{S.value=!0;const i=await et(d.value);G.value=i.rows,N.value=i.total,S.value=!1},de=()=>{B(),g.visible=!1},B=()=>{var i;s.value={...W},(i=P.value)==null||i.resetFields()},U=()=>{d.value.pageNum=1,V()},re=()=>{var i;(i=M.value)==null||i.resetFields(),U()},me=i=>{I.value=i.map(e=>e.id),O.value=i.length!=1,J.value=!i.length},pe=()=>{B(),g.visible=!0,g.title="添加客户端管理"},X=async i=>{B();const e=(i==null?void 0:i.id)||I.value[0],y=await tt(e);Object.assign(s.value,y.data),g.visible=!0,g.title="修改客户端管理"},ce=()=>{var i;(i=P.value)==null||i.validate(async e=>{e&&(w.value=!0,s.value.id?await at(s.value).finally(()=>w.value=!1):await lt(s.value).finally(()=>w.value=!1),o==null||o.$modal.msgSuccess("修改成功"),g.visible=!1,await V())})},Y=async i=>{const e=(i==null?void 0:i.id)||I.value;await(o==null?void 0:o.$modal.confirm('是否确认删除客户端管理编号为"'+e+'"的数据项？').finally(()=>S.value=!1)),await nt(e),o==null||o.$modal.msgSuccess("删除成功"),await V()},ve=()=>{o==null||o.download("system/client/export",{...d.value},`client_${new Date().getTime()}.xlsx`)},_e=async i=>{let e=i.status==="0"?"启用":"停用";try{await(o==null?void 0:o.$modal.confirm('确认要"'+e+'"吗?')),await ot(i.clientId,i.status),o==null||o.$modal.msgSuccess(e+"成功")}catch{i.status=i.status==="0"?"1":"0"}};return Ee(()=>{V()}),(i,e)=>{var te,le;const y=$e,m=Me,Q=Le,z=Re,v=Ie,Z=We,h=Xe,fe=Je,ge=Ye,p=je,H=Oe,ye=Ne,D=Pe,be=Ge,Ve=Ae,ke=Ze,x=Ue("question-filled"),ee=Be,Te=He,Ce=xe,we=Qe,k=he("hasPermi"),Se=ze;return u(),C("div",it,[t(De,{"enter-active-class":(te=n(o))==null?void 0:te.animate.searchAnimate.enter,"leave-active-class":(le=n(o))==null?void 0:le.animate.searchAnimate.leave},{default:a(()=>[b(F("div",st,[t(Z,{ref_key:"queryFormRef",ref:M,model:n(d),inline:!0},{default:a(()=>[t(m,{label:"客户端key",prop:"clientKey"},{default:a(()=>[t(y,{modelValue:n(d).clientKey,"onUpdate:modelValue":e[0]||(e[0]=l=>n(d).clientKey=l),placeholder:"请输入客户端key",clearable:"",onKeyup:ne(U,["enter"])},null,8,["modelValue"])]),_:1}),t(m,{label:"客户端秘钥",prop:"clientSecret"},{default:a(()=>[t(y,{modelValue:n(d).clientSecret,"onUpdate:modelValue":e[1]||(e[1]=l=>n(d).clientSecret=l),placeholder:"请输入客户端秘钥",clearable:"",onKeyup:ne(U,["enter"])},null,8,["modelValue"])]),_:1}),t(m,{label:"状态",prop:"status"},{default:a(()=>[t(z,{modelValue:n(d).status,"onUpdate:modelValue":e[2]||(e[2]=l=>n(d).status=l),placeholder:"状态",clearable:""},{default:a(()=>[(u(!0),C($,null,L(n(R),l=>(u(),f(Q,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,null,{default:a(()=>[t(v,{type:"primary",icon:"Search",onClick:U},{default:a(()=>e[16]||(e[16]=[c("搜索")])),_:1}),t(v,{icon:"Refresh",onClick:re},{default:a(()=>e[17]||(e[17]=[c("重置")])),_:1})]),_:1})]),_:1},8,["model"])],512),[[oe,n(E)]])]),_:1},8,["enter-active-class","leave-active-class"]),t(ke,{shadow:"never"},{header:a(()=>[t(ge,{gutter:10,class:"mb8"},{default:a(()=>[t(h,{span:1.5},{default:a(()=>[b((u(),f(v,{type:"primary",plain:"",icon:"Plus",onClick:pe},{default:a(()=>e[18]||(e[18]=[c("新增")])),_:1})),[[k,["system:client:add"]]])]),_:1}),t(h,{span:1.5},{default:a(()=>[b((u(),f(v,{type:"success",plain:"",icon:"Edit",disabled:n(O),onClick:e[3]||(e[3]=l=>X())},{default:a(()=>e[19]||(e[19]=[c(" 修改 ")])),_:1},8,["disabled"])),[[k,["system:client:edit"]]])]),_:1}),t(h,{span:1.5},{default:a(()=>[b((u(),f(v,{type:"danger",plain:"",icon:"Delete",disabled:n(J),onClick:e[4]||(e[4]=l=>Y())},{default:a(()=>e[20]||(e[20]=[c(" 删除 ")])),_:1},8,["disabled"])),[[k,["system:client:remove"]]])]),_:1}),t(h,{span:1.5},{default:a(()=>[b((u(),f(v,{type:"warning",plain:"",icon:"Download",onClick:ve},{default:a(()=>e[21]||(e[21]=[c("导出")])),_:1})),[[k,["system:client:export"]]])]),_:1}),t(fe,{showSearch:n(E),"onUpdate:showSearch":e[5]||(e[5]=l=>qe(E)?E.value=l:null),onQueryTable:V},null,8,["showSearch"])]),_:1})]),default:a(()=>[b((u(),f(be,{data:n(G),onSelectionChange:me},{default:a(()=>[t(p,{type:"selection",width:"55",align:"center"}),(u(),f(p,{key:0,label:"id",align:"center",prop:"id"})),t(p,{label:"客户端id",align:"center",prop:"clientId"}),t(p,{label:"客户端key",align:"center",prop:"clientKey"}),t(p,{label:"客户端秘钥",align:"center",prop:"clientSecret"}),t(p,{label:"授权类型",align:"center"},{default:a(l=>[t(H,{options:n(A),value:l.row.grantTypeList},null,8,["options","value"])]),_:1}),t(p,{label:"设备类型",align:"center"},{default:a(l=>[t(H,{options:n(j),value:l.row.deviceType},null,8,["options","value"])]),_:1}),t(p,{label:"Token活跃超时时间",align:"center",prop:"activeTimeout"}),t(p,{label:"Token固定超时时间",align:"center",prop:"timeout"}),t(p,{key:"status",label:"状态",align:"center"},{default:a(l=>[t(ye,{modelValue:l.row.status,"onUpdate:modelValue":q=>l.row.status=q,"active-value":"0","inactive-value":"1",onChange:q=>_e(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(p,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[t(D,{content:"修改",placement:"top"},{default:a(()=>[b(t(v,{link:"",type:"primary",icon:"Edit",onClick:q=>X(l.row)},null,8,["onClick"]),[[k,["system:client:edit"]]])]),_:2},1024),t(D,{content:"删除",placement:"top"},{default:a(()=>[b(t(v,{link:"",type:"primary",icon:"Delete",onClick:q=>Y(l.row)},null,8,["onClick"]),[[k,["system:client:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Se,n(S)]]),b(t(Ve,{page:n(d).pageNum,"onUpdate:page":e[6]||(e[6]=l=>n(d).pageNum=l),limit:n(d).pageSize,"onUpdate:limit":e[7]||(e[7]=l=>n(d).pageSize=l),total:n(N),onPagination:V},null,8,["page","limit","total"]),[[oe,n(N)>0]])]),_:1}),t(we,{modelValue:n(g).visible,"onUpdate:modelValue":e[15]||(e[15]=l=>n(g).visible=l),title:n(g).title,width:"500px","append-to-body":""},{footer:a(()=>[F("div",ut,[t(v,{loading:n(w),type:"primary",onClick:ce},{default:a(()=>e[24]||(e[24]=[c("确 定")])),_:1},8,["loading"]),t(v,{onClick:de},{default:a(()=>e[25]||(e[25]=[c("取 消")])),_:1})])]),default:a(()=>[t(Z,{ref_key:"clientFormRef",ref:P,model:n(s),rules:n(ue),"label-width":"100px"},{default:a(()=>[t(m,{label:"客户端key",prop:"clientKey"},{default:a(()=>[t(y,{modelValue:n(s).clientKey,"onUpdate:modelValue":e[8]||(e[8]=l=>n(s).clientKey=l),disabled:n(s).id!=null,placeholder:"请输入客户端key"},null,8,["modelValue","disabled"])]),_:1}),t(m,{label:"客户端秘钥",prop:"clientSecret"},{default:a(()=>[t(y,{modelValue:n(s).clientSecret,"onUpdate:modelValue":e[9]||(e[9]=l=>n(s).clientSecret=l),disabled:n(s).id!=null,placeholder:"请输入客户端秘钥"},null,8,["modelValue","disabled"])]),_:1}),t(m,{label:"授权类型",prop:"grantTypeList"},{default:a(()=>[t(z,{modelValue:n(s).grantTypeList,"onUpdate:modelValue":e[10]||(e[10]=l=>n(s).grantTypeList=l),multiple:"",placeholder:"请输入授权类型"},{default:a(()=>[(u(!0),C($,null,L(n(A),l=>(u(),f(Q,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"设备类型",prop:"deviceType"},{default:a(()=>[t(z,{modelValue:n(s).deviceType,"onUpdate:modelValue":e[11]||(e[11]=l=>n(s).deviceType=l),placeholder:"请输入设备类型"},{default:a(()=>[(u(!0),C($,null,L(n(j),l=>(u(),f(Q,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{prop:"activeTimeout","label-width":"auto"},{label:a(()=>[F("span",null,[t(D,{content:"指定时间无操作则过期（单位：秒），默认30分钟（1800秒）",placement:"top"},{default:a(()=>[t(ee,null,{default:a(()=>[t(x)]),_:1})]),_:1}),e[22]||(e[22]=c(" Token活跃超时时间 "))])]),default:a(()=>[t(y,{modelValue:n(s).activeTimeout,"onUpdate:modelValue":e[12]||(e[12]=l=>n(s).activeTimeout=l),placeholder:"请输入Token活跃超时时间"},null,8,["modelValue"])]),_:1}),t(m,{prop:"timeout","label-width":"auto"},{label:a(()=>[F("span",null,[t(D,{content:"指定时间必定过期（单位：秒），默认七天（604800秒）",placement:"top"},{default:a(()=>[t(ee,null,{default:a(()=>[t(x)]),_:1})]),_:1}),e[23]||(e[23]=c(" Token固定超时时间 "))])]),default:a(()=>[t(y,{modelValue:n(s).timeout,"onUpdate:modelValue":e[13]||(e[13]=l=>n(s).timeout=l),placeholder:"请输入Token固定超时时间"},null,8,["modelValue"])]),_:1}),t(m,{label:"状态"},{default:a(()=>[t(Ce,{modelValue:n(s).status,"onUpdate:modelValue":e[14]||(e[14]=l=>n(s).status=l)},{default:a(()=>[(u(!0),C($,null,L(n(R),l=>(u(),f(Te,{key:l.value,value:l.value},{default:a(()=>[c(Ke(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{qt as default};
