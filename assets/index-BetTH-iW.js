var Nv=Object.defineProperty;var Ov=(e,t,n)=>t in e?Nv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var et=(e,t,n)=>(Ov(e,typeof t!="symbol"?t+"":t,n),n);import{aw as pa,ax as Hi,ay as Lv,br as Zd,cv as Qd,az as xr,a$ as Jd,b5 as Ui,r as $,b7 as vu,i as hl,ba as $v,aE as Vr,O as Ge,d as Le,o as ae,c as Ce,aP as Rr,a2 as hi,e as E,aR as ef,bd as Bv,dJ as jv,m as z,y as F,Q as nn,j as g,k as w,aJ as Vv,af as sn,x as kr,z as Fv,w as kt,W as Qt,cs as Hv,aV as tf,bo as zv,ar as Uv,b3 as nf,cC as rf,b4 as Gv,dK as In,dL as gu,dM as Wv,aa as Gn,dN as Yv,a as qv,Y as of,b as _i,J as we,a0 as ml,F as Wt,q as gn,p as ze,t as Ke,X as Ue,R as bi,n as Jt,G as Yt,I as Wn,a9 as Kv,U as Ei,a1 as Qi,at as gt,Z as Ar,C as da,D as fa,L as ha,cl as vl,ab as Xv,dO as Zv,v as gl,aM as Qv,aq as Jv,cH as eg,cI as tg,cJ as ng,_ as ig}from"./index-D4nD6lq3.js";/* empty css                */import"./el-checkbox-DpS0yAA0.js";import{E as rg}from"./el-tree-select-DpW7sF-R.js";import{_ as af}from"./index-BH-aX6uU.js";import{E as og,a as ag}from"./el-table-column-Nw9CsZCh.js";/* empty css               */import{_ as sg}from"./index-CeC1FWzw.js";import{E as Ot,a as Lt}from"./el-form-item-oceQVxPu.js";/* empty css               *//* empty css                */import{E as lg}from"./el-link-BLiuvJwr.js";import{B as yl,g as te,I as cg,i as Pe,a as Yn,e as ce,h as rn,m as _l,j as N,c as xt,t as Hn,b as yi,k as ug,V as Fr,l as I,n as Ee,o as pe,p as Te,q as ma,s as on,r as ye,u as Tt,v as Ji,w as bt,x as rt,y as ot,z as Dr,A as Ut,C as bl,D as De,F as Pt,O as sf,G as Wi,H as bn,J as W,K as va,L as Oe,M as dt,N as qn,P as se,Q as de,R as ga,S as ve,T as y,U as Qo,W as El,X as ya,Y as mn,Z as xl,_ as an,$ as xe,a0 as gs,a1 as lf,a2 as En,a3 as cf,a4 as pg,a5 as Ne,a6 as js,a7 as hn,a8 as mt,a9 as dg,aa as pt,ab as wl,ac as yu,ad as fg,ae as uf,af as Vs,ag as yn,ah as Sl,ai as Fs,aj as hg,ak as pf,al as Gi,am as _a,an as Z,ao as df,ap as vt,aq as tt,ar as Qe,as as Ie,at as _e,au as _n,av as ba,aw as Ir,ax as Yi,ay as zn,az as Et,aA as Se,aB as Hr,aC as Mr,aD as ff,aE as ji,aF as Ho,aG as ci,aH as _u,aI as mg,aJ as vg,aK as gg,aL as yg,aM as _g,aN as hf,aO as mf,aP as jn,aQ as vf,aR as bg,aS as Cl,aT as Eg,aU as Tl,aV as xg,aW as wg,aX as Sg,aY as Cg,aZ as Hs,a_ as gf,a$ as Tg,b0 as Pg,b1 as bu,b2 as yf,b3 as Rg,b4 as kg,b5 as Ea,b6 as Ag,b7 as _f,b8 as bf,b9 as Dg,ba as Ig,bb as Eu,E as Mg,f as Ng}from"./Viewer-DMA2S4ab.js";import{E as Ef}from"./el-input-number-C1HbC4Gz.js";import{E as Pl,a as Rl}from"./el-tab-pane-xdTQeNFk.js";import{u as xi,_ as xu}from"./index.vue_vue_type_script_setup_true_lang-D7mrRZGd.js";import{_ as Og}from"./index-Cu5tDpmP.js";import{m as wu}from"./index-CyG2HWXF.js";import{E as xf}from"./index-DWSlLEJi.js";/* empty css                       *//* empty css                        */import{b as Lg,a as $g}from"./index-BaDxqmMz.js";import{s as Bg}from"./index-86cChj1c.js";import{l as jg}from"./index-DkTz8tRe.js";import{E as Vg}from"./index-CsUbaV0a.js";import{E as Fg}from"./index-I5OlcPyW.js";import{E as Hg}from"./index-fvT2sidt.js";import"./_initCloneObject-Cyh6om-O.js";import"./_baseClone-zQQn4kcl.js";import"./index-DfYNOEwA.js";import"./index-BOrFPrtb.js";const Su=e=>xr(e)||Jd(e)||Ui(e),zg=pa({accordion:Boolean,modelValue:{type:Hi([Array,String,Number]),default:()=>Lv([])}}),Ug={[Zd]:Su,[Qd]:Su},wf=Symbol("collapseContextKey"),Gg=(e,t)=>{const n=$(vu(e.modelValue)),i=o=>{n.value=o;const a=e.accordion?n.value[0]:n.value;t(Zd,a),t(Qd,a)},r=o=>{if(e.accordion)i([n.value[0]===o?"":o]);else{const a=[...n.value],s=a.indexOf(o);s>-1?a.splice(s,1):a.push(o),i(a)}};return hl(()=>e.modelValue,()=>n.value=vu(e.modelValue),{deep:!0}),$v(wf,{activeNames:n,handleItemClick:r}),{activeNames:n,setActiveNames:i}},Wg=()=>{const e=Vr("collapse");return{rootKls:Ge(()=>e.b())}},Yg=Le({name:"ElCollapse"}),qg=Le({...Yg,props:zg,emits:Ug,setup(e,{expose:t,emit:n}){const i=e,{activeNames:r,setActiveNames:o}=Gg(i,n),{rootKls:a}=Wg();return t({activeNames:r,setActiveNames:o}),(s,l)=>(ae(),Ce("div",{class:hi(E(a))},[Rr(s.$slots,"default")],2))}});var Kg=ef(qg,[["__file","collapse.vue"]]);const Xg=pa({title:{type:String,default:""},name:{type:Hi([String,Number]),default:void 0},disabled:Boolean}),Zg=e=>{const t=Bv(wf),{namespace:n}=Vr("collapse"),i=$(!1),r=$(!1),o=jv(),a=Ge(()=>o.current++),s=Ge(()=>{var d;return(d=e.name)!=null?d:`${n.value}-id-${o.prefix}-${E(a)}`}),l=Ge(()=>t==null?void 0:t.activeNames.value.includes(E(s)));return{focusing:i,id:a,isActive:l,handleFocus:()=>{setTimeout(()=>{r.value?r.value=!1:i.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(E(s)),i.value=!1,r.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(E(s))}}},Qg=(e,{focusing:t,isActive:n,id:i})=>{const r=Vr("collapse"),o=Ge(()=>[r.b("item"),r.is("active",E(n)),r.is("disabled",e.disabled)]),a=Ge(()=>[r.be("item","header"),r.is("active",E(n)),{focusing:E(t)&&!e.disabled}]),s=Ge(()=>[r.be("item","arrow"),r.is("active",E(n))]),l=Ge(()=>r.be("item","wrap")),c=Ge(()=>r.be("item","content")),p=Ge(()=>r.b(`content-${E(i)}`)),u=Ge(()=>r.b(`head-${E(i)}`));return{arrowKls:s,headKls:a,rootKls:o,itemWrapperKls:l,itemContentKls:c,scopedContentId:p,scopedHeadId:u}},Jg=["id","aria-expanded","aria-controls","aria-describedby","tabindex"],ey=["id","aria-hidden","aria-labelledby"],ty=Le({name:"ElCollapseItem"}),ny=Le({...ty,props:Xg,setup(e,{expose:t}){const n=e,{focusing:i,id:r,isActive:o,handleFocus:a,handleHeaderClick:s,handleEnterClick:l}=Zg(n),{arrowKls:c,headKls:p,rootKls:u,itemWrapperKls:d,itemContentKls:f,scopedContentId:h,scopedHeadId:v}=Qg(n,{focusing:i,isActive:o,id:r});return t({isActive:o}),(m,S)=>(ae(),Ce("div",{class:hi(E(u))},[z("button",{id:E(v),class:hi(E(p)),"aria-expanded":E(o),"aria-controls":E(h),"aria-describedby":E(h),tabindex:m.disabled?-1:0,type:"button",onClick:S[0]||(S[0]=(...b)=>E(s)&&E(s)(...b)),onKeydown:S[1]||(S[1]=kr(Fv((...b)=>E(l)&&E(l)(...b),["stop","prevent"]),["space","enter"])),onFocus:S[2]||(S[2]=(...b)=>E(a)&&E(a)(...b)),onBlur:S[3]||(S[3]=b=>i.value=!1)},[Rr(m.$slots,"title",{},()=>[F(nn(m.title),1)]),g(E(sn),{class:hi(E(c))},{default:w(()=>[g(E(Vv))]),_:1},8,["class"])],42,Jg),g(E(Hv),null,{default:w(()=>[kt(z("div",{id:E(h),role:"region",class:hi(E(d)),"aria-hidden":!E(o),"aria-labelledby":E(v)},[z("div",{class:hi(E(f))},[Rr(m.$slots,"default")],2)],10,ey),[[Qt,E(o)]])]),_:3})],2))}});var Sf=ef(ny,[["__file","collapse-item.vue"]]);const wi=tf(Kg,{CollapseItem:Sf}),Si=zv(Sf),iy=pa({prefixCls:{type:String}}),Cu=Le({name:"ElSpaceItem",props:iy,setup(e,{slots:t}){const n=Vr("space"),i=Ge(()=>`${e.prefixCls||n.b()}__item`);return()=>Uv("div",{class:i.value},Rr(t,"default"))}}),Tu={small:8,default:12,large:16};function ry(e){const t=Vr("space"),n=Ge(()=>[t.b(),t.m(e.direction),e.class]),i=$(0),r=$(0),o=Ge(()=>{const s=e.wrap||e.fill?{flexWrap:"wrap"}:{},l={alignItems:e.alignment},c={rowGap:`${r.value}px`,columnGap:`${i.value}px`};return[s,l,c,e.style]}),a=Ge(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return nf(()=>{const{size:s="small",wrap:l,direction:c,fill:p}=e;if(Ui(s)){const[u=0,d=0]=s;i.value=u,r.value=d}else{let u;xr(s)?u=s:u=Tu[s||"small"]||Tu.small,(l||p)&&c==="horizontal"?i.value=r.value=u:c==="horizontal"?(i.value=u,r.value=0):(r.value=u,i.value=0)}}),{classes:n,containerStyle:o,itemStyle:a}}const oy=pa({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:Hi([String,Object,Array]),default:""},style:{type:Hi([String,Array,Object]),default:""},alignment:{type:Hi(String),default:"center"},prefixCls:{type:String},spacer:{type:Hi([Object,String,Number,Array]),default:null,validator:e=>rf(e)||xr(e)||Jd(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:Gv,validator:e=>xr(e)||Ui(e)&&e.length===2&&e.every(xr)}}),ay=Le({name:"ElSpace",props:oy,setup(e,{slots:t}){const{classes:n,containerStyle:i,itemStyle:r}=ry(e);function o(a,s="",l=[]){const{prefixCls:c}=e;return a.forEach((p,u)=>{gu(p)?Ui(p.children)&&p.children.forEach((d,f)=>{gu(d)&&Ui(d.children)?o(d.children,`${s+f}-`,l):l.push(g(Cu,{style:r.value,prefixCls:c,key:`nested-${s+f}`},{default:()=>[d]},In.PROPS|In.STYLE,["style","prefixCls"]))}):Wv(p)&&l.push(g(Cu,{style:r.value,prefixCls:c,key:`LoopKey${s+u}`},{default:()=>[p]},In.PROPS|In.STYLE,["style","prefixCls"]))}),l}return()=>{var a;const{spacer:s,direction:l}=e,c=Rr(t,"default",{key:0},()=>[]);if(((a=c.children)!=null?a:[]).length===0)return null;if(Ui(c.children)){let p=o(c.children);if(s){const u=p.length-1;p=p.reduce((d,f,h)=>{const v=[...d,f];return h!==u&&v.push(g("span",{style:[r.value,l==="vertical"?"width: 100%":null],key:h},[rf(s)?s:F(s,In.TEXT)],In.STYLE)),v},[])}return g("div",{class:n.value,style:i.value},p,In.STYLE|In.CLASS)}return c.children}}}),sy=tf(ay),ly=e=>Gn({url:"/workflow/model/list",method:"get",params:e}),Cf=e=>Gn({url:"/workflow/model/getInfo/"+e,method:"get"}),cy=e=>Gn({url:"/workflow/model/save",method:"post",data:e});function uy(e){return Gn({url:"/workflow/model/update",method:"put",data:e})}function py(e){return Gn({url:"/workflow/model/editModelXml",method:"put",data:e})}function dy(e){return Gn({url:"/workflow/model/"+e,method:"delete"})}const fy=e=>Gn({url:`/workflow/model/modelDeploy/${e}`,method:"post"}),hy=e=>Gn({url:"/workflow/model/copyModel",method:"post",data:e}),my={"bpmn:Process":"流程","bpmn:StartEvent":"开始事件","bpmn:IntermediateThrowEvent":"中间事件","bpmn:Task":"任务","bpmn:SendTask":"发送任务","bpmn:ReceiveTask":"接收任务","bpmn:UserTask":"用户任务","bpmn:ManualTask":"手工任务","bpmn:BusinessRuleTask":"业务规则任务","bpmn:ServiceTask":"服务任务","bpmn:ScriptTask":"脚本任务","bpmn:EndEvent":"结束事件","bpmn:SequenceFlow":"流程线","bpmn:ExclusiveGateway":"互斥网关","bpmn:ParallelGateway":"并行网关","bpmn:InclusiveGateway":"相容网关","bpmn:ComplexGateway":"复杂网关","bpmn:EventBasedGateway":"事件网关","bpmn:Participant":"池/参与者","bpmn:SubProcess":"子流程","bpmn:DataObjectReference":"数据对象引用","bpmn:DataStoreReference":"数据存储引用","bpmn:Group":"组"},vy={"Activate hand tool":"启动手动工具","Activate lasso tool":"启动 Lasso 工具","Activate create/remove space tool":"启动创建/删除空间工具","Activate global connect tool":"启动全局连接工具","Ad-hoc":"Ad-hoc","Add lane above":"在上方添加泳道","Add lane below":"在下方添加泳道","Business rule task":"规则任务","Call activity":"引用流程","Compensation end event":"结束补偿事件","Compensation intermediate throw event":"中间补偿抛出事件","Complex gateway":"复杂网关","Conditional intermediate catch event":"中间条件捕获事件","Conditional start event (non-interrupting)":"条件启动事件 (非中断)","Conditional start event":"条件启动事件","Connect using association":"文本关联","Connect using sequence/message flow or association":"消息关联","Change element":"更改元素","Change type":"更改类型","Create data object reference":"创建数据对象引用","Create data store reference":"创建数据存储引用","Create expanded sub-process":"创建可折叠子流程","Create pool/participant":"创建池/参与者",Collection:"集合","Connect using data input association":"数据输入关联","Data store reference":"数据存储引用","Data object reference":"数据对象引用","Divide into two lanes":"分成两个泳道","Divide into three lanes":"分成三个泳道","End event":"结束事件","Error end event":"结束错误事件","Escalation end event":"结束升级事件","Escalation intermediate throw event":"中间升级抛出事件","Event sub-process":"事件子流程","Event-based gateway":"事件网关","Exclusive gateway":"互斥网关","Empty pool/participant (removes content)":"清空池/参与者 (删除内容)","Empty pool/participant":"清空池/参与者","Expanded pool/participant":"展开池/参与者","Inclusive gateway":"相容网关","Intermediate throw event":"中间抛出事件",Loop:"循环","Link intermediate catch event":"中间链接捕获事件","Link intermediate throw event":"中间链接抛出事件","Manual task":"手动任务","Message end event":"结束消息事件","Message intermediate catch event":"中间消息捕获事件","Message intermediate throw event":"中间消息抛出事件","Message start event":"消息启动事件","Parallel gateway":"并行网关","Parallel multi-instance":"并行多实例","Participant multiplicity":"参与者多重性","Receive task":"接受任务",Remove:"移除","Script task":"脚本任务","Send task":"发送任务","Sequential multi-instance":"串行多实例","Service task":"服务任务","Signal end event":"结束信号事件","Signal intermediate catch event":"中间信号捕获事件","Signal intermediate throw event":"中间信号抛出事件","Signal start event (non-interrupting)":"信号启动事件 (非中断)","Signal start event":"信号启动事件","Start event":"开始事件","Sub-process (collapsed)":"可折叠子流程","Sub-process (expanded)":"可展开子流程","Sub rocess":"子流程",Task:"任务",Transaction:"事务","Terminate end event":"终止边界事件","Timer intermediate catch event":"中间定时捕获事件","Timer start event (non-interrupting)":"定时启动事件 (非中断)","Timer start event":"定时启动事件","User task":"用户任务","Create start event":"创建开始事件","Create gateway":"创建网关","Create intermediate/boundary event":"创建中间/边界事件","Create end event":"创建结束事件","Create group":"创建组","Create startEvent":"开始节点","Create endEvent":"结束节点","Create exclusiveGateway":"互斥网关","Create parallelGateway":"并行网关","Create task":"任务节点","Create userTask":"用户任务节点","Condition type":"条件类型","Append end event":"追加结束事件节点","Append gateway":"追加网关节点","Append task":"追加任务","Append user task":"追加用户任务节点","Append text annotation":"追加文本注释","Append intermediate/boundary event":"追加中间或边界事件","Append receive task":"追加接收任务节点","Append message intermediate catch event":"追加中间消息捕获事件","Append timer intermediate catch event":"追加中间定时捕获事件","Append conditional intermediate catch event":"追加中间条件捕获事件","Append signal intermediate catch event":"追加中间信号捕获事件","flow elements must be children of pools/participants":"流程元素必须是池/参与者的子元素"},Ci=e=>{const{element:t}=e;return{parseData:()=>{const i={...t.businessObject,...t.businessObject.$attrs};for(const r in i)if(r.indexOf("flowable:")===0){const o=r.replace("flowable:","");i[o]=i[r],delete i[r]}return{...i}}}},gy={"bpmn:EndEvent":{},"bpmn:StartEvent":{initiator:!0,formKey:!0},"bpmn:UserTask":{allocationType:!0,specifyDesc:!0,multipleUserAuditType:!0,async:!0,priority:!0,skipExpression:!0,dueDate:!0,taskListener:!0,executionListener:!0},"bpmn:ServiceTask":{async:!0,skipExpression:!0,isForCompensation:!0,triggerable:!0,class:!0},"bpmn:ScriptTask":{async:!0,isForCompensation:!0,autoStoreVariables:!0},"bpmn:ManualTask":{async:!0,isForCompensation:!0},"bpmn:ReceiveTask":{async:!0,isForCompensation:!0},"bpmn:SendTask":{async:!0,isForCompensation:!0},"bpmn:BusinessRuleTask":{async:!0,isForCompensation:!0,ruleVariablesInput:!0,rules:!0,resultVariable:!0,exclude:!0}},Mn={modeler:void 0,moddle:void 0,modeling:void 0,canvas:void 0,elementRegistry:void 0,bpmnFactory:void 0,procDefId:void 0,procDefName:void 0},Un=Yv("modeler",()=>{let e=Mn.modeler,t=Mn.moddle,n=Mn.modeling,i=Mn.canvas,r=Mn.elementRegistry,o=Mn.bpmnFactory;const a=$(Mn.procDefId),s=$(Mn.procDefName);return{getModeler:()=>e,getModdle:()=>t,getModeling:()=>n,getCanvas:()=>i,getElRegistry:()=>r,getBpmnFactory:()=>o,getProcDefId:()=>a.value,getProcDefName:()=>s.value,setModeler:b=>{b?(e=b,n=b.get("modeling"),t=b.get("moddle"),i=b.get("canvas"),o=b.get("bpmnFactory"),r=b.get("elementRegistry")):n=t=i=r=o=void 0},setProcDef:b=>{a.value=b.get("canvas").getRootElement().businessObject.get("id"),s.value=b.get("canvas").getRootElement().businessObject.get("name")}}});var Vi=(e=>(e.USER="user",e.CANDIDATE="candidate",e.YOURSELF="yourself",e.SPECIFY="specify",e))(Vi||{}),Tf=(e=>(e.SPECIFY_MULTIPLE="specifyMultiple",e.SPECIFY_SINGLE="specifySingle",e))(Tf||{}),_t=(e=>(e.SERIAL="serial",e.PARALLEL="parallel",e.NONE="none",e))(_t||{});const xn=e=>{const{element:t}=e,{getModeling:n,getModdle:i}=Un(),r=n(),o=i(),a=Ge(()=>{const b=t.businessObject;return b.eventDefinitions?b.eventDefinitions[0].$type:b.$type}),s=Ge(()=>gy[a.value]||{}),l=(b,T,C)=>{const k=o.create(b,T);return C&&(k.$parent=C),k},c=(b=!0)=>{let T=t.businessObject.get("extensionElements");return!T&&b&&(T=l("bpmn:ExtensionElements",{values:[]},t.businessObject),r.updateModdleProperties(t,t.businessObject,{extensionElements:T})),T},p=b=>{b||(b=c());let T=b.values.find(C=>C.$type==="flowable:properties");return T||(T=l("flowable:properties",{values:[]},b),r.updateModdleProperties(t,b,{values:[...b.get("values"),T]})),T},u=b=>{r.updateProperties(t,b)},d=(b,T)=>{r.updateModdleProperties(t,b,T)},f=(b,T)=>{const C=p();let k=C.values.find(A=>A.name===b);return k?(k.name=b,k.value=T):(k=l("flowable:property",{name:b,value:T},C),r.updateModdleProperties(t,C,{values:[...C.get("values"),k]})),k},h=b=>{b&&u({id:b})},v=b=>{b&&u({name:b})},m=b=>{u({formKey:b})},S={MultiInstanceType:[{id:"373d4b81-a0d1-4eb8-8685-0d2fb1b468e2",label:"无",value:_t.NONE},{id:"b5acea7c-b7e5-46b0-8778-390db091bdab",label:"串行",value:_t.SERIAL},{id:"b4f0c683-1ccc-43c4-8380-e1b998986caf",label:"并行",value:_t.PARALLEL}]};return{elementType:a,constant:S,showConfig:s,updateProperties:u,updateProperty:f,updateModdleProperties:d,createModdleElement:l,idChange:h,nameChange:v,formKeyChange:m,getExtensionElements:c,getPropertiesElements:p}},yy={class:"mb-[10px]"},_y=Le({__name:"index",props:{modelValue:{default:void 0},multiple:{type:Boolean,default:!0},data:{default:void 0}},emits:["update:modelValue","confirmCallBack"],setup(e,{expose:t,emit:n}){const i=e,r=n;qv();const{proxy:o}=bi(),{sys_normal_disable:a}=of(o==null?void 0:o.useDict("sys_normal_disable")),s=$(),l=$(!0),c=$(!0),p=$(0),u=$(["",""]),d=$([]),f=xi({title:"角色选择"}),h=$(),v=$(),m=$({pageNum:1,pageSize:10,roleName:"",roleKey:"",status:""}),S=Ge(()=>T(i.data)),b=()=>{r("update:modelValue",d.value),r("confirmCallBack",d.value),f.closeDialog()},T=G=>G instanceof Array?[...G]:typeof G=="string"?G.split(","):typeof G=="number"?[G]:(console.warn("<RoleSelect> The data type of data should be array or string or number, but I received other"),[]),C=()=>{l.value=!0,wu.listRole(o==null?void 0:o.addDateRange(m.value,u.value)).then(G=>{s.value=G.rows,p.value=G.total,l.value=!1})},k=async()=>{await C();const G=s.value.filter(D=>d.value.some(O=>O.roleId===D.roleId));await v.value.setCheckboxRow(G,!0)},A=()=>{m.value.pageNum=1,C()},j=()=>{var G;u.value=["",""],(G=h.value)==null||G.resetFields(),A()},V=G=>{!i.multiple&&G.checked&&(v.value.setCheckboxRow(d.value,!1),d.value=[]);const D=G.row;G.checked?d.value.push(D):d.value=d.value.filter(O=>O.roleId!==D.roleId)},H=G=>{const D=s.value;G.checked?D.forEach(O=>{d.value.some(q=>q.roleId===O.roleId)||d.value.push(O)}):d.value=d.value.filter(O=>!D.some(q=>q.roleId===O.roleId))},Y=G=>{var re;const D=G.roleId,O=d.value.findIndex(ne=>ne.roleId===D),q=d.value[O];(re=v.value)==null||re.setCheckboxRow(q,!1),d.value.splice(O,1)},U=async()=>{if(S.value.length>0){const{data:G}=await wu.optionSelect(S.value);d.value=G;const D=s.value.filter(O=>S.value.includes(String(O.roleId)));await Jt(()=>{v.value.setCheckboxRow(D,!0)})}},ie=()=>{f.closeDialog()};return hl(()=>f.visible.value,G=>{G?U():(v.value.clearCheckboxReserve(),v.value.clearCheckboxRow(),j(),d.value=[])}),_i(()=>{C()}),t({open:f.openDialog,close:f.closeDialog}),(G,D)=>{const O=Yt,q=Ot,re=Wn,ne=Lt,ge=xf,$e=Kv,X=we("vxe-column"),J=Og,oe=we("vxe-table"),ke=af,lt=Ei;return ae(),Ce("div",null,[g(lt,{modelValue:E(f).visible.value,"onUpdate:modelValue":D[5]||(D[5]=L=>E(f).visible.value=L),title:E(f).title.value,width:"80%","append-to-body":""},{footer:w(()=>[g(re,{onClick:ie},{default:w(()=>D[8]||(D[8]=[F("取消")])),_:1}),g(re,{type:"primary",onClick:b},{default:w(()=>D[9]||(D[9]=[F("确定")])),_:1})]),default:w(()=>{var L,R;return[g(ml,{"enter-active-class":(L=E(o))==null?void 0:L.animate.searchAnimate.enter,"leave-active-class":(R=E(o))==null?void 0:R.animate.searchAnimate.leave},{default:w(()=>[kt(z("div",yy,[g(ge,{shadow:"hover"},{default:w(()=>[g(ne,{ref_key:"queryFormRef",ref:h,model:E(m),inline:!0},{default:w(()=>[g(q,{label:"角色名称",prop:"roleName"},{default:w(()=>[g(O,{modelValue:E(m).roleName,"onUpdate:modelValue":D[0]||(D[0]=ee=>E(m).roleName=ee),placeholder:"请输入角色名称",clearable:"",onKeyup:kr(A,["enter"])},null,8,["modelValue"])]),_:1}),g(q,{label:"权限字符",prop:"roleKey"},{default:w(()=>[g(O,{modelValue:E(m).roleKey,"onUpdate:modelValue":D[1]||(D[1]=ee=>E(m).roleKey=ee),placeholder:"请输入权限字符",clearable:"",onKeyup:kr(A,["enter"])},null,8,["modelValue"])]),_:1}),g(q,null,{default:w(()=>[g(re,{type:"primary",icon:"Search",onClick:A},{default:w(()=>D[6]||(D[6]=[F("搜索")])),_:1}),g(re,{icon:"Refresh",onClick:j},{default:w(()=>D[7]||(D[7]=[F("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[Qt,E(c)]])]),_:1},8,["enter-active-class","leave-active-class"]),g(ge,{shadow:"hover"},{header:w(()=>[(ae(!0),Ce(Wt,null,gn(E(d),ee=>(ae(),ze($e,{key:ee.roleId,closable:"",style:{margin:"2px"},onClose:fe=>Y(ee)},{default:w(()=>[F(nn(ee.roleName),1)]),_:2},1032,["onClose"]))),128))]),default:w(()=>[g(oe,{ref_key:"tableRef",ref:v,height:"400px",border:"","show-overflow":"",data:E(s),loading:E(l),"row-config":{keyField:"roleId"},"checkbox-config":{reserve:!0,checkRowKeys:E(S)},"highlight-current-row":"",onCheckboxAll:H,onCheckboxChange:V},{default:w(()=>[g(X,{type:"checkbox",width:"50",align:"center"}),Ke("",!0),g(X,{field:"roleName",title:"角色名称"}),g(X,{field:"roleKey",title:"权限字符"}),g(X,{field:"roleSort",title:"显示顺序",width:"100"}),g(X,{title:"状态",align:"center",width:"100"},{default:w(ee=>[g(J,{options:E(a),value:ee.row.status},null,8,["options","value"])]),_:1}),g(X,{field:"createTime",title:"创建时间",align:"center"},{default:w(ee=>[z("span",null,nn(G.parseTime(ee.row.createTime)),1)]),_:1})]),_:1},8,["data","loading","checkbox-config"]),E(p)>0?(ae(),ze(ke,{key:0,total:E(p),"onUpdate:total":D[2]||(D[2]=ee=>Ue(p)?p.value=ee:null),page:E(m).pageNum,"onUpdate:page":D[3]||(D[3]=ee=>E(m).pageNum=ee),limit:E(m).pageSize,"onUpdate:limit":D[4]||(D[4]=ee=>E(m).pageSize=ee),onPagination:k},null,8,["total","page","limit"])):Ke("",!0)]),_:1})]}),_:1},8,["modelValue","title"])])}}}),Pf=Le({__name:"ListenerParam",props:{height:{default:"200px"},tableData:{default:()=>[]}},setup(e,{expose:t}){const{proxy:n}=bi(),i=$({type:[{required:!0,message:"请选择",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}],value:[{required:!0,message:"请输入",trigger:"blur"}]}),{title:r,visible:o,openDialog:a,closeDialog:s}=xi({title:"监听器参数"}),l=[{id:"742fdeb7-23b4-416b-ac66-cd4ec8b901b7",label:"字符串",value:"stringValue"},{id:"660c9c46-8fae-4bae-91a0-0335420019dc",label:"表达式",value:"expression"}],c=$(),p=()=>{const h=c.value;return h?h.getTableData().fullData:[]},u=async()=>{const h=c.value;if(h){const{row:v}=await h.insertAt({},-1);await h.validate(v)}},d=async h=>{await(n==null?void 0:n.$modal.confirm("您确定要删除该数据?"));const v=c.value;v&&await v.remove(h)};return t({closeDialog:s,openDialog:a,validate:async()=>{const h=c.value;if(h)return await h.validate(!0)},getTableData:p}),(h,v)=>{const m=Wn,S=we("vxe-toolbar"),b=we("vxe-column"),T=we("vxe-option"),C=we("vxe-select"),k=we("vxe-input"),A=Qi,j=we("vxe-table");return ae(),Ce(Wt,null,[g(S,null,{buttons:w(()=>[g(m,{icon:"Plus",onClick:u},{default:w(()=>v[0]||(v[0]=[F("新增")])),_:1})]),_:1}),g(j,{ref_key:"tableRef",ref:c,height:h.height,border:"","show-overflow":"","keep-source":"",data:h.tableData,"edit-rules":E(i),"edit-config":{trigger:"click",mode:"row",showStatus:!0}},{default:w(()=>[g(b,{type:"seq",width:"40"}),g(b,{field:"type",title:"类型","edit-render":{}},{default:w(V=>{var H;return[z("span",null,nn((H=l.find(Y=>Y.value===V.row.type))==null?void 0:H.label),1)]}),edit:w(V=>[g(C,{modelValue:V.row.type,"onUpdate:modelValue":H=>V.row.type=H},{default:w(()=>[(ae(),Ce(Wt,null,gn(l,H=>g(T,{key:H.id,value:H.value,label:H.label},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),g(b,{field:"name",title:"名称","edit-render":{}},{edit:w(V=>[g(k,{modelValue:V.row.name,"onUpdate:modelValue":H=>V.row.name=H,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),g(b,{field:"value",title:"值","edit-render":{}},{edit:w(V=>[g(k,{modelValue:V.row.value,"onUpdate:modelValue":H=>V.row.value=H,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),g(b,{title:"操作",width:"100","show-overflow":"",align:"center"},{default:w(V=>[g(A,{content:"删除",placement:"top"},{default:w(()=>[g(m,{link:"",type:"danger",icon:"Delete",onClick:H=>d(V.row)},null,8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["height","data","edit-rules"])],64)}}}),by={class:"dialog-footer"},Ey=Le({__name:"ExecutionListener",props:{element:{}},emits:["close"],setup(e,{emit:t}){const n=e,{proxy:i}=bi(),r=$(),o=xi({title:r.value?"编辑&保存":"新增&保存"}),{showConfig:a,elementType:s,updateProperties:l}=xn({element:gt(n.element)}),{getModdle:c}=Un(),p=c(),u=$(),d=$(),f=$(),h={event:"",type:"",className:"",params:[]},v=$({...h}),m=$([]),S=$({event:[{required:!0,message:"请选择",trigger:"blur"}],type:[{required:!0,message:"请选择",trigger:"blur"}],className:[{required:!0,message:"请输入",trigger:"blur"}]}),b=async()=>{const D=await u.value.validate();await f.value.validate(O=>{if(O&&!D){const q=d.value;q&&(v.value.params=u.value.getTableData(),r.value?Object.assign(r.value,v.value):q.insertAt({...v.value},-1),j(),o.closeDialog())}})},T=async()=>{const D=d.value;D&&(D.getCheckboxRecords().length===0?i==null||i.$modal.msgWarning("请选择行"):(await D.removeCheckboxRow(),j()))},C=async()=>{Object.assign(v.value,h),r.value=null,o.openDialog()},k=D=>{Object.assign(v.value,D),r.value=D,o.openDialog()},A=async D=>{await(i==null?void 0:i.$modal.confirm("您确定要删除该数据?"));const O=d.value;O&&(await O.remove(D),j())},j=()=>{var q,re;const O=d.value.getTableData().fullData;if(O.length){let ne=n.element.businessObject.get("extensionElements");ne||(ne=p.create("bpmn:ExtensionElements")),ne.values=((q=ne.values)==null?void 0:q.filter(ge=>ge.$type!=="flowable:ExecutionListener"))??[],O.forEach(ge=>{const $e=p.create("flowable:ExecutionListener");$e.event=ge.event,$e[ge.type]=ge.className,ge.params&&ge.params.length&&ge.params.forEach(X=>{const J=p.create("flowable:Field");J.name=X.name,J[X.type]=X.value,$e.get("fields").push(J)}),ne.get("values").push($e)}),l({extensionElements:ne})}else{const ne=n.element.businessObject.extensionElements;ne&&(ne.values=((re=ne.values)==null?void 0:re.filter(ge=>ge.$type!=="flowable:ExecutionListener"))??[])}},V=({row:D})=>{k(D)},H=Ar({body:{options:[[{code:"edit",name:"编辑",prefixIcon:"vxe-icon-edit",disabled:!1},{code:"remove",name:"删除",prefixIcon:"vxe-icon-delete",disabled:!1}]]},visibleMethod({options:D,column:O}){const q=!O;return D.forEach(re=>{re.forEach(ne=>{ne.disabled=q})}),!0}}),Y=({menu:D,row:O,column:q})=>{if(d.value)switch(D.code){case"edit":k(O);break;case"remove":A(O);break}},U=()=>{var D;m.value=((D=n.element.businessObject.extensionElements)==null?void 0:D.values.filter(O=>O.$type==="flowable:ExecutionListener").map(O=>{var re;let q;return"class"in O&&(q="class"),"expression"in O&&(q="expression"),"delegateExpression"in O&&(q="delegateExpression"),{event:O.event,type:q,className:O[q],params:((re=O.fields)==null?void 0:re.map(ne=>{let ge;return"stringValue"in ne&&(ge="stringValue"),"expression"in ne&&(ge="expression"),{name:ne.name,type:ge,value:ne[ge]}}))??[]}}))??[]};_i(()=>{U()});const ie=[{id:"742fdeb7-23b4-416b-ac66-cd4ec8b901b7",label:"类",value:"class"},{id:"660c9c46-8fae-4bae-91a0-0335420019dc",label:"表达式",value:"expression"},{id:"4b8135ab-6bc3-4a0f-80be-22f58bc6c5fd",label:"委托表达式",value:"delegateExpression"}],G=[{id:"e6e0a51a-2d5d-4dc4-b847-b5c14f43a6ab",label:"开始",value:"start"},{id:"6da97c1e-15fc-4445-8943-75d09f49778e",label:"结束",value:"end"},{id:"6a2cbcec-e026-4f11-bef7-fff0b5c871e2",label:"启用",value:"take"}];return(D,O)=>{const q=Wn,re=we("vxe-toolbar"),ne=we("vxe-column"),ge=we("vxe-table"),$e=da,X=fa,J=Ot,oe=we("QuestionFilled"),ke=sn,lt=Qi,L=Yt,R=Lt,ee=Pl,fe=Rl,me=Ei;return ae(),Ce("div",null,[g(re,null,{buttons:w(()=>[g(q,{type:"primary",link:"",size:"small",onClick:C},{default:w(()=>O[4]||(O[4]=[F("新增")])),_:1}),g(q,{type:"primary",link:"",size:"small",onClick:T},{default:w(()=>O[5]||(O[5]=[F("删除")])),_:1})]),_:1}),g(ge,{ref_key:"tableRef",ref:d,size:"mini",height:"100px",border:"","show-overflow":"","keep-source":"",data:E(m),"menu-config":E(H),onCellDblclick:V,onMenuClick:Y},{default:w(()=>[g(ne,{type:"checkbox",width:"40"}),g(ne,{type:"seq",width:"40"}),g(ne,{field:"event",title:"事件","min-width":"100px"},{default:w(K=>{var he;return[z("span",null,nn((he=G.find(Me=>Me.value===K.row.event))==null?void 0:he.label),1)]}),_:1}),g(ne,{field:"type",title:"类型","min-width":"100px"},{default:w(K=>{var he;return[z("span",null,nn((he=ie.find(Me=>Me.value===K.row.type))==null?void 0:he.label),1)]}),_:1}),g(ne,{field:"className",title:"Java 类名","min-width":"100px"})]),_:1},8,["data","menu-config"]),g(me,{modelValue:E(o).visible.value,"onUpdate:modelValue":O[3]||(O[3]=K=>E(o).visible.value=K),title:E(o).title.value,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},{footer:w(()=>[z("div",by,[g(q,{onClick:E(o).closeDialog},{default:w(()=>O[8]||(O[8]=[F("取 消")])),_:1},8,["onClick"]),g(q,{type:"primary",onClick:b},{default:w(()=>O[9]||(O[9]=[F("确 定")])),_:1})])]),default:w(()=>[g(R,{ref_key:"formRef",ref:f,model:E(v),rules:E(S),"label-width":"100px"},{default:w(()=>{var K;return[g(J,{label:"事件",prop:"event"},{default:w(()=>[g(X,{modelValue:E(v).event,"onUpdate:modelValue":O[0]||(O[0]=he=>E(v).event=he)},{default:w(()=>[(ae(),Ce(Wt,null,gn(G,he=>g($e,{key:he.id,value:he.value,label:he.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(J,{label:"类型",prop:"type"},{label:w(()=>[z("span",null,[O[7]||(O[7]=F(" 类型 ")),g(lt,{placement:"top"},{content:w(()=>O[6]||(O[6]=[F(" 类：示例 com.company.MyCustomListener，自定义类必须实现 org.flowable.engine.delegate.TaskListener 接口"),z("br",null,null,-1),F(" 表达式：示例 ${myObject.callMethod(task, task.eventName)}"),z("br",null,null,-1),F(" 委托表达式：示例 ${myListenerSpringBean} ，该 springBean 需要实现 org.flowable.engine.delegate.TaskListener 接口 ")])),default:w(()=>[g(ke,null,{default:w(()=>[g(oe)]),_:1})]),_:1})])]),default:w(()=>[g(X,{modelValue:E(v).type,"onUpdate:modelValue":O[1]||(O[1]=he=>E(v).type=he)},{default:w(()=>[(ae(),Ce(Wt,null,gn(ie,he=>g($e,{key:he.id,value:he.value,label:he.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(J,{label:ie.filter(he=>he.value===E(v).type)[0]?(K=ie.filter(he=>he.value===E(v).type)[0])==null?void 0:K.label:"表达式",prop:"className"},{default:w(()=>[g(L,{modelValue:E(v).className,"onUpdate:modelValue":O[2]||(O[2]=he=>E(v).className=he),type:"text"},null,8,["modelValue"])]),_:1},8,["label"])]}),_:1},8,["model","rules"]),g(fe,{type:"border-card"},{default:w(()=>[g(ee,{label:"参数"},{default:w(()=>[g(Pf,{ref_key:"listenerParamRef",ref:u,"table-data":E(v).params},null,8,["table-data"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),Ti=ha(Ey,[["__scopeId","data-v-691c519b"]]),xy={class:"dialog-footer"},wy=Le({__name:"TaskListener",props:{element:{}},setup(e){const{proxy:t}=bi(),n=e,i=$(),r=xi({title:i.value?"编辑&保存":"新增&保存"}),{showConfig:o,elementType:a,updateProperties:s}=xn({element:gt(n.element)}),{getModdle:l}=Un(),c=l(),p=$(),u=$(),d=$(),f={event:"",type:"",className:"",name:"",params:[]},h=$({...f});$(0);const v=$([]),m=$({event:[{required:!0,message:"请选择",trigger:"blur"}],type:[{required:!0,message:"请选择",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}],className:[{required:!0,message:"请输入",trigger:"blur"}]}),S=async()=>{const G=await p.value.validate();await d.value.validate(D=>{if(D&&!G){const O=u.value;O&&(h.value.params=p.value.getTableData(),i.value?Object.assign(i.value,h.value):O.insertAt({...h.value},-1),A(),r.closeDialog())}})},b=async()=>{Object.assign(h.value,f),i.value=null,r.openDialog()},T=G=>{Object.assign(h.value,G),i.value=G,r.openDialog()},C=async G=>{await(t==null?void 0:t.$modal.confirm("您确定要删除该数据?"));const D=u.value;D&&(await D.remove(G),A())},k=async()=>{const G=u.value;G&&(G.getCheckboxRecords().length===0?t==null||t.$modal.msgWarning("请选择行"):(await G.removeCheckboxRow(),A()))},A=()=>{var O,q;const D=u.value.getTableData().fullData;if(D.length){let re=n.element.businessObject.get("extensionElements");re||(re=c.create("bpmn:ExtensionElements")),re.values=((O=re.values)==null?void 0:O.filter(ne=>ne.$type!=="flowable:TaskListener"))??[],D.forEach(ne=>{const ge=c.create("flowable:TaskListener");ge.event=ne.event,ge[ne.type]=ne.className,ne.params&&ne.params.length&&ne.params.forEach($e=>{const X=c.create("flowable:Field");X.name=$e.name,X[$e.type]=$e.value,ge.get("fields").push(X)}),re.get("values").push(ge)}),s({extensionElements:re})}else{const re=n.element.businessObject.extensionElements;re&&(re.values=((q=re.values)==null?void 0:q.filter(ne=>ne.$type!=="flowable:TaskListener"))??[])}},j=({row:G})=>{T(G)},V=Ar({body:{options:[[{code:"edit",name:"编辑",prefixIcon:"vxe-icon-edit",disabled:!1},{code:"remove",name:"删除",prefixIcon:"vxe-icon-delete",disabled:!1}]]},visibleMethod({options:G,column:D}){const O=!D;return G.forEach(q=>{q.forEach(re=>{re.disabled=O})}),!0}}),H=({menu:G,row:D,column:O})=>{if(u.value)switch(G.code){case"edit":T(D);break;case"remove":C(D);break}},Y=()=>{var G;v.value=((G=n.element.businessObject.extensionElements)==null?void 0:G.values.filter(D=>D.$type==="flowable:TaskListener").map(D=>{var q;let O;return"class"in D&&(O="class"),"expression"in D&&(O="expression"),"delegateExpression"in D&&(O="delegateExpression"),{event:D.event,type:O,className:D[O],params:((q=D.fields)==null?void 0:q.map(re=>{let ne;return"stringValue"in re&&(ne="stringValue"),"expression"in re&&(ne="expression"),{name:re.name,type:ne,value:re[ne]}}))??[]}}))??[]};_i(()=>{Y()});const U=[{id:"742fdeb7-23b4-416b-ac66-cd4ec8b901b7",label:"类",value:"class"},{id:"660c9c46-8fae-4bae-91a0-0335420019dc",label:"表达式",value:"expression"},{id:"4b8135ab-6bc3-4a0f-80be-22f58bc6c5fd",label:"委托表达式",value:"delegateExpression"}],ie=[{id:"e6e0a51a-2d5d-4dc4-b847-b5c14f43a6ab",label:"创建",value:"create"},{id:"6da97c1e-15fc-4445-8943-75d09f49778e",label:"指派",value:"assignment"},{id:"6a2cbcec-e026-4f11-bef7-fff0b5c871e2",label:"完成",value:"complete"},{id:"68801972-85f1-482f-bd86-1fad015c26ed",label:"删除",value:"delete"}];return(G,D)=>{const O=Wn,q=we("vxe-toolbar"),re=we("vxe-column"),ne=we("vxe-table"),ge=we("QuestionFilled"),$e=sn,X=Qi,J=da,oe=fa,ke=Ot,lt=Yt,L=Lt,R=Pl,ee=Rl,fe=Ei;return ae(),Ce("div",null,[g(q,null,{buttons:w(()=>[g(O,{type:"primary",link:"",size:"small",onClick:b},{default:w(()=>D[4]||(D[4]=[F("新增")])),_:1}),g(O,{type:"primary",link:"",size:"small",onClick:k},{default:w(()=>D[5]||(D[5]=[F("删除")])),_:1})]),_:1}),g(ne,{ref_key:"tableRef",ref:u,size:"mini",height:"100px",border:"","show-overflow":"","keep-source":"",data:E(v),"menu-config":E(V),onCellDblclick:j,onMenuClick:H},{default:w(()=>[g(re,{type:"checkbox",width:"40"}),g(re,{type:"seq",width:"40"}),g(re,{field:"event",title:"事件","min-width":"100px"},{default:w(me=>{var K;return[z("span",null,nn((K=ie.find(he=>he.value===me.row.event))==null?void 0:K.label),1)]}),_:1}),g(re,{field:"type",title:"类型","min-width":"100px"},{default:w(me=>{var K;return[z("span",null,nn((K=U.find(he=>he.value===me.row.type))==null?void 0:K.label),1)]}),_:1}),g(re,{field:"className",title:"Java 类名","min-width":"100px"})]),_:1},8,["data","menu-config"]),g(fe,{modelValue:E(r).visible.value,"onUpdate:modelValue":D[3]||(D[3]=me=>E(r).visible.value=me),title:E(r).title.value,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},{footer:w(()=>[z("div",xy,[g(O,{onClick:E(r).closeDialog},{default:w(()=>D[8]||(D[8]=[F("取 消")])),_:1},8,["onClick"]),g(O,{type:"primary",onClick:S},{default:w(()=>D[9]||(D[9]=[F("确 定")])),_:1})])]),default:w(()=>[g(L,{ref_key:"formRef",ref:d,model:E(h),rules:E(m),"label-width":"100px"},{default:w(()=>{var me;return[g(ke,{label:"事件",prop:"event"},{label:w(()=>[z("span",null,[D[7]||(D[7]=F(" 事件 ")),g(X,{placement:"top"},{content:w(()=>D[6]||(D[6]=[F(" create（创建）：当任务已经创建，并且所有任务参数都已经设置时触发。"),z("br",null,null,-1),F(" assignment（指派）：当任务已经指派给某人时触发。请注意：当流程执行到达用户任务时，在触发create事件之前，会首先触发assignment事件。"),z("br",null,null,-1),F(" complete（完成）：当任务已经完成，从运行时数据中删除前触发。"),z("br",null,null,-1),F(" delete（删除）：在任务即将被删除前触发。请注意任务由completeTask正常完成时也会触发。 ")])),default:w(()=>[g($e,null,{default:w(()=>[g(ge)]),_:1})]),_:1})])]),default:w(()=>[g(oe,{modelValue:E(h).event,"onUpdate:modelValue":D[0]||(D[0]=K=>E(h).event=K)},{default:w(()=>[(ae(),Ce(Wt,null,gn(ie,K=>g(J,{key:K.id,value:K.value,label:K.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(ke,{label:"类型",prop:"type"},{default:w(()=>[g(oe,{modelValue:E(h).type,"onUpdate:modelValue":D[1]||(D[1]=K=>E(h).type=K)},{default:w(()=>[(ae(),Ce(Wt,null,gn(U,K=>g(J,{key:K.id,value:K.value,label:K.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(ke,{label:U.filter(K=>K.value===E(h).type)[0]?(me=U.filter(K=>K.value===E(h).type)[0])==null?void 0:me.label:"表达式",prop:"className"},{default:w(()=>[g(lt,{modelValue:E(h).className,"onUpdate:modelValue":D[2]||(D[2]=K=>E(h).className=K),type:"text"},null,8,["modelValue"])]),_:1},8,["label"])]}),_:1},8,["model","rules"]),g(ee,{type:"border-card"},{default:w(()=>[g(R,{label:"参数"},{default:w(()=>[g(Pf,{ref_key:"listenerParamRef",ref:p,"table-data":E(h).params},null,8,["table-data"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),Sy=ha(wy,[["__scopeId","data-v-c40f762f"]]),Cy=Le({__name:"DueDate",props:{modelValue:{default:""},data:{default:""}},emits:["update:modelValue","confirmCallBack"],setup(e,{expose:t,emit:n}){const i=e,r=n,{title:o,visible:a,openDialog:s,closeDialog:l}=xi({title:"设置任务到期时间"}),c=$();$();const p=$(""),u=$(""),d=$(""),f=$(""),h=$(1),v=$(1),m=$(1),S=$(1),b=["4","8","12","24"],T=["1","2","3","4"],C=()=>{if(c.value=i.data,i.data){const D=i.data.substring(i.data.length-1);if(D==="H"){const q=i.data.substring(2,i.data.length-1);b.includes(q)?p.value=q:(p.value="自定义",h.value=Number(q))}const O=i.data.substring(1,i.data.length-1);D==="D"&&(T.includes(O)?u.value=O:(u.value="自定义",v.value=Number(O))),D==="W"&&(T.includes(O)?d.value=O:(d.value="自定义",m.value=Number(O))),D==="M"&&(T.includes(O)?f.value=O:(f.value="自定义",S.value=Number(O)))}},k=()=>{r("update:modelValue",c.value),r("confirmCallBack",c.value),l()},A=D=>{c.value=`PT${D}H`,u.value="",d.value="",f.value="",v.value=1,m.value=1,S.value=1},j=D=>{c.value=`P${D}D`,p.value="",d.value="",f.value="",h.value=1,m.value=1,S.value=1},V=D=>{c.value=`P${D}W`,p.value="",u.value="",f.value="",h.value=1,v.value=1,S.value=1},H=D=>{c.value=`P${D}M`,p.value="",u.value="",d.value="",h.value=1,v.value=1,m.value=1},Y=D=>{D==="自定义"?c.value=`PT${h.value}H`:c.value=`PT${D}H`,u.value="",d.value="",f.value="",v.value=1,m.value=1,S.value=1},U=D=>{D==="自定义"?c.value=`P${v.value}D`:c.value=`P${D}D`,p.value="",d.value="",f.value="",h.value=1,m.value=1,S.value=1},ie=D=>{D==="自定义"?c.value=`P${m.value}W`:c.value=`P${D}W`,p.value="",u.value="",f.value="",h.value=1,v.value=1,S.value=1},G=D=>{D==="自定义"?c.value=`P${S.value}M`:c.value=`P${D}M`,p.value="",u.value="",d.value="",h.value=1,v.value=1,m.value=1};return hl(()=>a.value,()=>{a.value&&C()}),t({openDialog:s,closeDialog:l}),(D,O)=>{const q=Lg,re=Ef,ne=$g,ge=Ot,$e=Lt,X=Wn,J=Ei;return ae(),Ce("div",null,[g(J,{modelValue:E(a),"onUpdate:modelValue":O[8]||(O[8]=oe=>Ue(a)?a.value=oe:null),title:E(o),width:"600px","append-to-body":""},{footer:w(()=>[z("div",null,[g(X,{onClick:E(l)},{default:w(()=>O[9]||(O[9]=[F("取消")])),_:1},8,["onClick"]),g(X,{type:"primary",onClick:k},{default:w(()=>O[10]||(O[10]=[F("确定")])),_:1})])]),default:w(()=>[g($e,{"label-width":"100px"},{default:w(()=>[g(ge,{label:"小时"},{default:w(()=>[g(ne,{modelValue:E(p),"onUpdate:modelValue":O[1]||(O[1]=oe=>Ue(p)?p.value=oe:null),onChange:Y},{default:w(()=>[g(q,{label:"4",value:"4"}),g(q,{label:"8",value:"8"}),g(q,{label:"12",value:"12"}),g(q,{label:"24",value:"24"}),g(q,{label:"自定义",value:"自定义"}),kt(g(re,{modelValue:E(h),"onUpdate:modelValue":O[0]||(O[0]=oe=>Ue(h)?h.value=oe:null),min:1,onChange:A},null,8,["modelValue"]),[[Qt,E(p)==="自定义"]])]),_:1},8,["modelValue"])]),_:1}),g(ge,{label:"天"},{default:w(()=>[g(ne,{modelValue:E(u),"onUpdate:modelValue":O[3]||(O[3]=oe=>Ue(u)?u.value=oe:null),onChange:U},{default:w(()=>[g(q,{label:"1",value:"1"}),g(q,{label:"2",value:"2"}),g(q,{label:"3",value:"3"}),g(q,{label:"4",value:"4"}),g(q,{label:"自定义",value:"自定义"}),kt(g(re,{modelValue:E(v),"onUpdate:modelValue":O[2]||(O[2]=oe=>Ue(v)?v.value=oe:null),min:1,onChange:j},null,8,["modelValue"]),[[Qt,E(u)==="自定义"]])]),_:1},8,["modelValue"])]),_:1}),g(ge,{label:"周"},{default:w(()=>[g(ne,{modelValue:E(d),"onUpdate:modelValue":O[5]||(O[5]=oe=>Ue(d)?d.value=oe:null),onChange:ie},{default:w(()=>[g(q,{label:"1",value:"1"}),g(q,{label:"2",value:"2"}),g(q,{label:"3",value:"3"}),g(q,{label:"4",value:"4"}),g(q,{label:"自定义",value:"自定义"}),kt(g(re,{modelValue:E(m),"onUpdate:modelValue":O[4]||(O[4]=oe=>Ue(m)?m.value=oe:null),min:1,onChange:V},null,8,["modelValue"]),[[Qt,E(d)==="自定义"]])]),_:1},8,["modelValue"])]),_:1}),g(ge,{label:"月"},{default:w(()=>[g(ne,{modelValue:E(f),"onUpdate:modelValue":O[7]||(O[7]=oe=>Ue(f)?f.value=oe:null),onChange:G},{default:w(()=>[g(q,{label:"1",value:"1"}),g(q,{label:"2",value:"2"}),g(q,{label:"3",value:"3"}),g(q,{label:"4",value:"4"}),g(q,{label:"自定义",value:"自定义"}),kt(g(re,{modelValue:E(S),"onUpdate:modelValue":O[6]||(O[6]=oe=>Ue(S)?S.value=oe:null),min:1,onChange:H},null,8,["modelValue"]),[[Qt,E(f)==="自定义"]])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),Ty={class:"collapse__title"},Py={class:"collapse__title"},Ry={class:"collapse__title"},ky={key:0},Ay={class:"collapse__title"},Dy={class:"collapse__title"},Iy=Le({__name:"TaskPanel",props:{element:{}},setup(e){const t=$([]),n=$(!1),i=e,{showConfig:r,nameChange:o,formKeyChange:a,idChange:s,updateProperties:l,getExtensionElements:c,createModdleElement:p,constant:u}=xn({element:gt(i.element)}),{parseData:d}=Ci({element:gt(i.element)}),f={id:"",name:"",dueDate:"",multiInstanceType:_t.NONE,allocationType:Vi.USER,specifyDesc:Tf.SPECIFY_SINGLE},h=$({...f,...d()}),v=$({userName:""}),m=$(["1","2"]),S=$(),b=$(),T=$(),C=$(),k=()=>{S.value.open()},A=()=>{var L;(L=h.value.assignee)!=null&&L.includes("$")&&(h.value.assignee=""),b.value.open()},j=()=>{T.value.open()},V=L=>{C.value.openDialog()},H=L=>{l({"flowable:assignee":L||void 0})},Y=L=>{const R=L.length!==0?L[0]:void 0;l({"flowable:assignee":R==null?void 0:R.userId}),v.value=R||{userName:""},h.value.assignee=String(R==null?void 0:R.userId);let ee=c();if(ee.values=ee.get("values").filter(fe=>fe.$type!=="flowable:extAssignee"),R){const fe=p("flowable:extAssignee",{body:""},ee);ee.get("values").push(fe),fe.body=JSON.stringify({userName:R.userName,userId:R.userId})}ee.values.length===0&&(ee=void 0),l({extensionElements:ee})},U=L=>{let R=c();if(R.values=R.values.filter(ee=>ee.$type!=="flowable:extCandidateUsers"),L.length===0)h.value.candidateUsers=void 0,l({"flowable:candidateUsers":void 0});else{const ee=L.map(K=>K.userId).join(",");h.value.candidateUsers=ee,l({"flowable:candidateUsers":ee});const fe=p("flowable:extCandidateUsers",{body:""},R);R.values.push(fe);const me=L.map(K=>({userId:K.userId,userName:K.userName}));fe.body=JSON.stringify(me)}R.values.length===0&&(R=void 0),l({extensionElements:R})},ie=L=>{if(L.length===0)h.value.candidateGroups="",l({"flowable:candidateGroups":void 0});else{const R=L.map(ee=>ee.roleId).join(",");h.value.candidateGroups=R,l({"flowable:candidateGroups":R})}},G=L=>{l({"flowable:dueDate":L})},D=L=>{l({"flowable:async":L})},O=L=>{l({"flowable:skipExpression":L&&L.length>0?L:void 0})},q=L=>{l({"flowable:priority":L})},re=L=>{if(L!==_t.NONE){let R=i.element.businessObject.get("loopCharacteristics");R||(R=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),R.isSequential=L===_t.SERIAL,l({loopCharacteristics:R})}else l({loopCharacteristics:void 0})},ne=L=>{let R=i.element.businessObject.get("loopCharacteristics");R||(R=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),R.collection=L&&L.length>0?L:void 0,l({loopCharacteristics:R})},ge=L=>{let R=i.element.businessObject.get("loopCharacteristics");R||(R=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),R.elementVariable=L&&L.length>0?L:void 0,l({loopCharacteristics:R})},$e=L=>{let R=i.element.businessObject.get("loopCharacteristics");R||(R=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),L&&L.length>0?R.completionCondition?R.completionCondition.body=L:R.completionCondition=p("bpmn:Expression",{body:L},R):R.completionCondition=void 0,l({loopCharacteristics:R})},X=L=>{l({"flowable:dueDate":L&&L.length>0?L:void 0})},J=Ge(()=>h.value.candidateUsers?h.value.candidateUsers.split(",").length:0),oe=Ge(()=>h.value.candidateGroups?h.value.candidateGroups.split(",").length:0);vl(()=>{var R;const L=c(!1);if(L&&L.get("values")){let ee=L.get("values").find(fe=>fe.$type==="flowable:extAssignee");ee&&(v.value=JSON.parse(ee.body))}if(h.value.loopCharacteristics){const ee=h.value.loopCharacteristics;h.value.collection=ee.collection||"",h.value.elementVariable=ee.elementVariable||"",h.value.completionCondition=((R=ee.completionCondition)==null?void 0:R.body)||"",h.value.multiInstanceType=ee.isSequential?_t.SERIAL:_t.PARALLEL}h.value.assignee&&(h.value.fixedAssignee=h.value.assignee)});const ke=$({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});Vi.USER,Vi.CANDIDATE,Vi.YOURSELF,Vi.SPECIFY;const lt=async()=>{n.value=!0;const L=await Bg();t.value=L.data,n.value=!1};return _i(()=>{Jt(()=>{lt()})}),(L,R)=>{const ee=we("InfoFilled"),fe=sn,me=Yt,K=Ot,he=da,Me=fa,ct=Si,Ht=we("Checked"),Ae=Xv,He=Wn,ai=Zv,Di=Pl,Rn=Rl,ht=Ef,ur=we("HelpFilled"),Je=we("QuestionFilled"),kn=Qi,Be=we("BellFilled"),si=wi,po=Lt,fo=gl;return ae(),Ce("div",null,[g(po,{ref:"formRef",size:"default",model:E(h),rules:E(ke),"label-width":"100px"},{default:w(()=>[g(si,{modelValue:E(m),"onUpdate:modelValue":R[19]||(R[19]=le=>Ue(m)?m.value=le:null)},{default:w(()=>[g(ct,{name:"1"},{title:w(()=>[z("div",Ty,[g(fe,null,{default:w(()=>[g(ee)]),_:1}),R[21]||(R[21]=F(" 常规 "))])]),default:w(()=>[z("div",null,[g(K,{prop:"id",label:"节点 ID"},{default:w(()=>[g(me,{modelValue:E(h).id,"onUpdate:modelValue":R[0]||(R[0]=le=>E(h).id=le),onChange:E(s)},null,8,["modelValue","onChange"])]),_:1}),g(K,{prop:"name",label:"节点名称"},{default:w(()=>[g(me,{modelValue:E(h).name,"onUpdate:modelValue":R[1]||(R[1]=le=>E(h).name=le),onChange:E(o)},null,8,["modelValue","onChange"])]),_:1}),E(r).skipExpression?(ae(),ze(K,{key:0,prop:"skipExpression",label:"跳过表达式"},{default:w(()=>[g(me,{modelValue:E(h).skipExpression,"onUpdate:modelValue":R[2]||(R[2]=le=>E(h).skipExpression=le),onChange:O},null,8,["modelValue"])]),_:1})):Ke("",!0),kt((ae(),ze(K,{prop:"formKey",label:"表单地址"},{default:w(()=>[g(Me,{modelValue:E(h).formKey,"onUpdate:modelValue":R[3]||(R[3]=le=>E(h).formKey=le),clearable:"",filterable:"",placeholder:"请选择表单",style:{width:"260px"},onChange:E(a)},{default:w(()=>[(ae(!0),Ce(Wt,null,gn(E(t),le=>(ae(),ze(he,{key:le.id,label:le.formTypeName+":"+le.formName,value:le.formType+":"+le.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})),[[fo,E(n)]])])]),_:1}),g(ct,{name:"2"},{title:w(()=>[z("div",Py,[g(fe,null,{default:w(()=>[g(Ht)]),_:1}),R[22]||(R[22]=F(" 任务 "))])]),default:w(()=>[z("div",null,[E(r).async?(ae(),ze(K,{key:0,prop:"sync",label:"是否异步"},{default:w(()=>[g(Ae,{modelValue:E(h).async,"onUpdate:modelValue":R[4]||(R[4]=le=>E(h).async=le),"inline-prompt":"","active-text":"是","inactive-text":"否",onChange:D},null,8,["modelValue"])]),_:1})):Ke("",!0),g(Rn,{"tab-position":"left",class:"demo-tabs"},{default:w(()=>[g(Di,{label:"身份存储"},{default:w(()=>[g(K,{label:"分配人员"},{default:w(()=>[g(me,{modelValue:E(h).assignee,"onUpdate:modelValue":R[5]||(R[5]=le=>E(h).assignee=le),onBlur:R[6]||(R[6]=le=>H(E(h).assignee))},{append:w(()=>[g(He,{icon:"Search",type:"primary",onClick:A})]),_:1},8,["modelValue"])]),_:1}),g(K,{label:"候选人员"},{default:w(()=>[g(ai,{value:E(J),max:99},{default:w(()=>[g(He,{size:"small",type:"primary",onClick:k},{default:w(()=>R[23]||(R[23]=[F("选择人员")])),_:1})]),_:1},8,["value"])]),_:1}),g(K,{label:"候选组"},{default:w(()=>[g(ai,{value:E(oe),max:99},{default:w(()=>[g(He,{size:"small",type:"primary",onClick:j},{default:w(()=>R[24]||(R[24]=[F("选择组")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),E(r).dueDate?(ae(),ze(K,{key:1,prop:"dueDate",label:"到期时间"},{default:w(()=>[g(me,{modelValue:E(h).dueDate,"onUpdate:modelValue":R[7]||(R[7]=le=>E(h).dueDate=le),clearable:"",onChange:X,onClick:V},{append:w(()=>[g(He,{icon:"Search",type:"primary",onClick:V})]),_:1},8,["modelValue"])]),_:1})):Ke("",!0),E(r).priority?(ae(),ze(K,{key:2,prop:"priority",label:"优先级"},{default:w(()=>[g(ht,{modelValue:E(h).priority,"onUpdate:modelValue":R[8]||(R[8]=le=>E(h).priority=le),min:0,onChange:q},null,8,["modelValue"])]),_:1})):Ke("",!0)])]),_:1}),g(ct,{name:"3"},{title:w(()=>[z("div",Ry,[g(fe,null,{default:w(()=>[g(ur)]),_:1}),R[25]||(R[25]=F(" 多实例 "))])]),default:w(()=>[z("div",null,[g(K,{label:"多实例类型"},{default:w(()=>[g(Me,{modelValue:E(h).multiInstanceType,"onUpdate:modelValue":R[9]||(R[9]=le=>E(h).multiInstanceType=le),onChange:re},{default:w(()=>[(ae(!0),Ce(Wt,null,gn(E(u).MultiInstanceType,le=>(ae(),ze(he,{key:le.id,value:le.value,label:le.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),E(h).multiInstanceType!==E(_t).NONE?(ae(),Ce("div",ky,[g(K,{label:"集合"},{label:w(()=>[z("span",null,[R[27]||(R[27]=F(" 集合 ")),g(kn,{placement:"top"},{content:w(()=>R[26]||(R[26]=[F(" 属性会作为表达式进行解析。如果表达式解析为字符串而不是一个集合，"),z("br",null,null,-1),F(" 不论是因为本身配置的就是静态字符串值，还是表达式计算结果为字符串，"),z("br",null,null,-1),F(" 这个字符串都会被当做变量名，并从流程变量中用于获取实际的集合。 ")])),default:w(()=>[g(fe,null,{default:w(()=>[g(Je)]),_:1})]),_:1})])]),default:w(()=>[g(me,{modelValue:E(h).collection,"onUpdate:modelValue":R[10]||(R[10]=le=>E(h).collection=le),onChange:ne},null,8,["modelValue"])]),_:1}),g(K,{label:"元素变量"},{label:w(()=>[z("span",null,[R[29]||(R[29]=F(" 元素变量 ")),g(kn,{placement:"top"},{content:w(()=>R[28]||(R[28]=[F(" 每创建一个用户任务前，先以该元素变量为label，集合中的一项为value，"),z("br",null,null,-1),F(" 创建（局部）流程变量，该局部流程变量被用于指派用户任务。"),z("br",null,null,-1),F(" 一般来说，该字符串应与指定人员变量相同。 ")])),default:w(()=>[g(fe,null,{default:w(()=>[g(Je)]),_:1})]),_:1})])]),default:w(()=>[g(me,{modelValue:E(h).elementVariable,"onUpdate:modelValue":R[11]||(R[11]=le=>E(h).elementVariable=le),onChange:ge},null,8,["modelValue"])]),_:1}),g(K,{label:"完成条件"},{label:w(()=>[z("span",null,[R[31]||(R[31]=F(" 完成条件 ")),g(kn,{placement:"top"},{content:w(()=>R[30]||(R[30]=[F(" 多实例活动在所有实例都完成时结束，然而也可以指定一个表达式，在每个实例"),z("br",null,null,-1),F(" 结束时进行计算。当表达式计算为true时，将销毁所有剩余的实例，并结束多实例"),z("br",null,null,-1),F(" 活动，继续执行流程。例如 ${nrOfCompletedInstances/nrOfInstances >= 0.6 }，"),z("br",null,null,-1),F(" 表示当任务完成60%时，该节点就算完成 ")])),default:w(()=>[g(fe,null,{default:w(()=>[g(Je)]),_:1})]),_:1})])]),default:w(()=>[g(me,{modelValue:E(h).completionCondition,"onUpdate:modelValue":R[12]||(R[12]=le=>E(h).completionCondition=le),onChange:$e},null,8,["modelValue"])]),_:1})])):Ke("",!0)])]),_:1}),E(r).taskListener?(ae(),ze(ct,{key:0,name:"4"},{title:w(()=>[z("div",Ay,[g(fe,null,{default:w(()=>[g(Be)]),_:1}),R[32]||(R[32]=F(" 任务监听器 "))])]),default:w(()=>[z("div",null,[E(r).taskListener?(ae(),ze(Sy,{key:0,element:L.element},null,8,["element"])):Ke("",!0)])]),_:1})):Ke("",!0),E(r).executionListener?(ae(),ze(ct,{key:1,name:"5"},{title:w(()=>[z("div",Dy,[g(fe,null,{default:w(()=>[g(Be)]),_:1}),R[33]||(R[33]=F(" 执行监听器 "))])]),default:w(()=>[z("div",null,[E(r).executionListener?(ae(),ze(Ti,{key:0,element:L.element},null,8,["element"])):Ke("",!0)])]),_:1})):Ke("",!0),E(r).isForCompensation?(ae(),ze(K,{key:2,prop:"isForCompensation",label:"是否为补偿"},{default:w(()=>[g(Ae,{modelValue:E(h).isForCompensation,"onUpdate:modelValue":R[13]||(R[13]=le=>E(h).isForCompensation=le),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ke("",!0),E(r).triggerServiceTask?(ae(),ze(K,{key:3,prop:"triggerServiceTask",label:"服务任务可触发"},{default:w(()=>[g(Ae,{modelValue:E(h).triggerServiceTask,"onUpdate:modelValue":R[14]||(R[14]=le=>E(h).triggerServiceTask=le),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ke("",!0),E(r).autoStoreVariables?(ae(),ze(K,{key:4,prop:"autoStoreVariables",label:"自动存储变量"},{default:w(()=>[g(Ae,{modelValue:E(h).autoStoreVariables,"onUpdate:modelValue":R[15]||(R[15]=le=>E(h).autoStoreVariables=le),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ke("",!0),E(r).ruleVariablesInput?(ae(),ze(K,{key:5,prop:"skipExpression",label:"输入变量"},{default:w(()=>[g(me,{modelValue:E(h).ruleVariablesInput,"onUpdate:modelValue":R[16]||(R[16]=le=>E(h).ruleVariablesInput=le)},null,8,["modelValue"])]),_:1})):Ke("",!0),E(r).exclude?(ae(),ze(K,{key:6,prop:"exclude",label:"排除"},{default:w(()=>[g(Ae,{modelValue:E(h).exclude,"onUpdate:modelValue":R[17]||(R[17]=le=>E(h).exclude=le),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ke("",!0),E(r).class?(ae(),ze(K,{key:7,prop:"class",label:"类"},{default:w(()=>[g(me,{modelValue:E(h).class,"onUpdate:modelValue":R[18]||(R[18]=le=>E(h).class=le)},null,8,["modelValue"])]),_:1})):Ke("",!0)]),_:1},8,["modelValue"])]),_:1},8,["model","rules"]),g(E(xu),{ref_key:"userSelectRef",ref:S,data:E(h).candidateUsers,onConfirmCallBack:U},null,8,["data"]),g(E(xu),{ref_key:"singleUserSelectRef",ref:b,data:E(h).assignee,multiple:!1,onConfirmCallBack:Y},null,8,["data"]),g(E(_y),{ref_key:"roleSelectRef",ref:T,data:E(h).candidateGroups,onConfirmCallBack:ie},null,8,["data"]),g(Cy,{ref_key:"dueDateRef",ref:C,modelValue:E(h).dueDate,"onUpdate:modelValue":R[20]||(R[20]=le=>E(h).dueDate=le),data:E(h).dueDate,onConfirmCallBack:G},null,8,["modelValue","data"])])}}}),My={class:"collapse__title"},Ny={class:"collapse__title"},Oy=Le({__name:"ProcessPanel",props:{element:{}},setup(e){const t=e,{parseData:n}=Ci({element:gt(t.element)}),{idChange:i,nameChange:r}=xn({element:gt(t.element)}),o=$(["1","2"]),a=$(n()),s=$({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(l,c)=>{const p=we("InfoFilled"),u=sn,d=Yt,f=Ot,h=Lt,v=Si,m=we("BellFilled"),S=wi;return ae(),Ce("div",null,[g(S,{modelValue:E(o),"onUpdate:modelValue":c[2]||(c[2]=b=>Ue(o)?o.value=b:null)},{default:w(()=>[g(v,{name:"1"},{title:w(()=>[z("div",My,[g(u,null,{default:w(()=>[g(p)]),_:1}),c[3]||(c[3]=F(" 常规 "))])]),default:w(()=>[z("div",null,[g(h,{ref:"formRef",model:E(a),rules:E(s),"label-width":"80px"},{default:w(()=>[g(f,{label:"流程标识",prop:"id"},{default:w(()=>[g(d,{modelValue:E(a).id,"onUpdate:modelValue":c[0]||(c[0]=b=>E(a).id=b),onChange:E(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{label:"流程名称",prop:"name"},{default:w(()=>[g(d,{modelValue:E(a).name,"onUpdate:modelValue":c[1]||(c[1]=b=>E(a).name=b),onChange:E(r)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(v,{name:"2"},{title:w(()=>[z("div",Ny,[g(u,null,{default:w(()=>[g(m)]),_:1}),c[4]||(c[4]=F(" 执行监听器 "))])]),default:w(()=>[z("div",null,[g(Ti,{element:l.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),Ly={class:"collapse__title"},$y={class:"collapse__title"},By=Le({__name:"StartEndPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i}=xn({element:gt(t.element)}),{parseData:r}=Ci({element:gt(t.element)}),o=$(r()),a=$(["1","2"]),s=$({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(l,c)=>{const p=we("InfoFilled"),u=sn,d=Yt,f=Ot,h=Lt,v=Si,m=we("BellFilled"),S=wi;return ae(),Ce("div",null,[g(S,{modelValue:E(a),"onUpdate:modelValue":c[2]||(c[2]=b=>Ue(a)?a.value=b:null)},{default:w(()=>[g(v,{name:"1"},{title:w(()=>[z("div",Ly,[g(u,null,{default:w(()=>[g(p)]),_:1}),c[3]||(c[3]=F(" 常规 "))])]),default:w(()=>[z("div",null,[g(h,{ref:"formRef",model:E(o),rules:E(s),"label-width":"90px"},{default:w(()=>[g(f,{prop:"id",label:"节点 ID"},{default:w(()=>[g(d,{modelValue:E(o).id,"onUpdate:modelValue":c[0]||(c[0]=b=>E(o).id=b),onChange:E(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{prop:"name",label:"节点名称"},{default:w(()=>[g(d,{modelValue:E(o).name,"onUpdate:modelValue":c[1]||(c[1]=b=>E(o).name=b),onChange:E(n)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(v,{name:"2"},{title:w(()=>[z("div",$y,[g(u,null,{default:w(()=>[g(m)]),_:1}),c[4]||(c[4]=F(" 执行监听器 "))])]),default:w(()=>[z("div",null,[g(Ti,{element:l.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),jy={class:"collapse__title"},Vy={class:"collapse__title"},Fy=Le({__name:"GatewayPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i}=xn({element:gt(t.element)}),{parseData:r}=Ci({element:gt(t.element)}),o=$(["1","2"]),a=$(r()),s=$({processCategory:[{required:!0,message:"请选择",trigger:"blur"}],id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(l,c)=>{const p=we("InfoFilled"),u=sn,d=Yt,f=Ot,h=Lt,v=Si,m=we("BellFilled"),S=wi;return ae(),Ce("div",null,[g(S,{modelValue:E(o),"onUpdate:modelValue":c[2]||(c[2]=b=>Ue(o)?o.value=b:null)},{default:w(()=>[g(v,{name:"1"},{title:w(()=>[z("div",jy,[g(u,null,{default:w(()=>[g(p)]),_:1}),c[3]||(c[3]=F(" 常规 "))])]),default:w(()=>[z("div",null,[g(h,{ref:"formRef",model:E(a),rules:E(s),"label-width":"80px"},{default:w(()=>[g(f,{prop:"id",label:"节点 ID"},{default:w(()=>[g(d,{modelValue:E(a).id,"onUpdate:modelValue":c[0]||(c[0]=b=>E(a).id=b),onChange:E(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{prop:"name",label:"节点名称"},{default:w(()=>[g(d,{modelValue:E(a).name,"onUpdate:modelValue":c[1]||(c[1]=b=>E(a).name=b),onChange:E(n)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(v,{name:"2"},{title:w(()=>[z("div",Vy,[g(u,null,{default:w(()=>[g(m)]),_:1}),c[4]||(c[4]=F(" 执行监听器 "))])]),default:w(()=>[z("div",null,[g(Ti,{element:l.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),Hy={class:"collapse__title"},zy={class:"collapse__title"},Uy=Le({__name:"SequenceFlowPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i,updateProperties:r}=xn({element:gt(t.element)}),{parseData:o}=Ci({element:gt(t.element)}),a=Un().getModdle(),s=$(["1","2"]),l=$(o()),c=$({processCategory:[{required:!0,message:"请选择",trigger:"blur"}],id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]}),p=d=>{if(d){const f=a.create("bpmn:FormalExpression",{body:d});r({conditionExpression:f})}else r({conditionExpression:null})},u=d=>{r({"flowable:skipExpression":d})};return vl(()=>{l.value.conditionExpression&&(l.value.conditionExpressionValue=l.value.conditionExpression.body)}),(d,f)=>{const h=we("InfoFilled"),v=sn,m=Yt,S=Ot,b=Lt,T=Si,C=we("BellFilled"),k=wi;return ae(),Ce("div",null,[g(k,{modelValue:E(s),"onUpdate:modelValue":f[4]||(f[4]=A=>Ue(s)?s.value=A:null)},{default:w(()=>[g(T,{name:"1"},{title:w(()=>[z("div",Hy,[g(v,null,{default:w(()=>[g(h)]),_:1}),f[5]||(f[5]=F(" 常规 "))])]),default:w(()=>[z("div",null,[g(b,{ref:"formRef",model:E(l),rules:E(c),"label-width":"90px"},{default:w(()=>[g(S,{prop:"id",label:"节点 ID"},{default:w(()=>[g(m,{modelValue:E(l).id,"onUpdate:modelValue":f[0]||(f[0]=A=>E(l).id=A),onChange:E(i)},null,8,["modelValue","onChange"])]),_:1}),g(S,{prop:"name",label:"节点名称"},{default:w(()=>[g(m,{modelValue:E(l).name,"onUpdate:modelValue":f[1]||(f[1]=A=>E(l).name=A),onChange:E(n)},null,8,["modelValue","onChange"])]),_:1}),g(S,{prop:"conditionExpression",label:"跳转条件"},{default:w(()=>[g(m,{modelValue:E(l).conditionExpressionValue,"onUpdate:modelValue":f[2]||(f[2]=A=>E(l).conditionExpressionValue=A),onChange:p},null,8,["modelValue"])]),_:1}),g(S,{prop:"skipExpression",label:"跳过表达式"},{default:w(()=>[g(m,{modelValue:E(l).skipExpression,"onUpdate:modelValue":f[3]||(f[3]=A=>E(l).skipExpression=A),onChange:u},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(T,{name:"2"},{title:w(()=>[z("div",zy,[g(v,null,{default:w(()=>[g(C)]),_:1}),f[6]||(f[6]=F(" 执行监听器 "))])]),default:w(()=>[z("div",null,[g(Ti,{element:d.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),Gy={class:"collapse__title"},Wy={class:"collapse__title"},Yy=Le({__name:"ParticipantPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i}=xn({element:gt(t.element)}),{parseData:r}=Ci({element:gt(t.element)}),o=$(r()),a=$(["1","2"]),s=$({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(l,c)=>{const p=we("InfoFilled"),u=sn,d=Yt,f=Ot,h=Lt,v=Si,m=we("BellFilled"),S=wi;return ae(),Ce("div",null,[g(S,{modelValue:E(a),"onUpdate:modelValue":c[2]||(c[2]=b=>Ue(a)?a.value=b:null)},{default:w(()=>[g(v,{name:"1"},{title:w(()=>[z("div",Gy,[g(u,null,{default:w(()=>[g(p)]),_:1}),c[3]||(c[3]=F(" 常规 "))])]),default:w(()=>[z("div",null,[g(h,{ref:"formRef",model:E(o),rules:E(s),"label-width":"90px"},{default:w(()=>[g(f,{prop:"id",label:"节点 ID"},{default:w(()=>[g(d,{modelValue:E(o).id,"onUpdate:modelValue":c[0]||(c[0]=b=>E(o).id=b),onChange:E(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{prop:"name",label:"节点名称"},{default:w(()=>[g(d,{modelValue:E(o).name,"onUpdate:modelValue":c[1]||(c[1]=b=>E(o).name=b),onChange:E(n)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(v,{name:"2"},{title:w(()=>[z("div",Wy,[g(u,null,{default:w(()=>[g(m)]),_:1}),c[4]||(c[4]=F(" 执行监听器 "))])]),default:w(()=>[z("div",null,[g(Ti,{element:l.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),qy={class:"collapse__title"},Ky={class:"collapse__title"},Xy={class:"collapse__title"},Zy={key:0},Qy=Le({__name:"SubProcessPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i,updateProperties:r,createModdleElement:o,constant:a}=xn({element:gt(t.element)}),{parseData:s}=Ci({element:gt(t.element)}),l=$(s()),c=$(["1","2","3"]),p=v=>{if(v!==_t.NONE){let m=t.element.businessObject.get("loopCharacteristics");m||(m=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),m.isSequential=v===_t.SERIAL,r({loopCharacteristics:m})}else r({loopCharacteristics:void 0})},u=v=>{let m=t.element.businessObject.get("loopCharacteristics");m||(m=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),m.collection=v&&v.length>0?v:void 0,r({loopCharacteristics:m})},d=v=>{let m=t.element.businessObject.get("loopCharacteristics");m||(m=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),m.elementVariable=v&&v.length>0?v:void 0,r({loopCharacteristics:m})},f=v=>{let m=t.element.businessObject.get("loopCharacteristics");m||(m=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),v&&v.length>0?m.completionCondition?m.completionCondition.body=v:m.completionCondition=o("bpmn:Expression",{body:v},m):m.completionCondition=void 0,r({loopCharacteristics:m})};vl(()=>{var v;if(l.value.loopCharacteristics){const m=l.value.loopCharacteristics;l.value.collection=m.collection||"",l.value.elementVariable=m.elementVariable||"",l.value.completionCondition=((v=m.completionCondition)==null?void 0:v.body)||"",l.value.multiInstanceType=m.isSequential?_t.SERIAL:_t.PARALLEL}});const h=$({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(v,m)=>{const S=we("InfoFilled"),b=sn,T=Yt,C=Ot,k=Si,A=we("BellFilled"),j=we("HelpFilled"),V=da,H=fa,Y=we("QuestionFilled"),U=Qi,ie=wi,G=Lt;return ae(),Ce("div",null,[g(G,{ref:"formRef",model:E(l),rules:E(h),"label-width":"90px"},{default:w(()=>[g(ie,{modelValue:E(c),"onUpdate:modelValue":m[6]||(m[6]=D=>Ue(c)?c.value=D:null)},{default:w(()=>[g(k,{name:"1"},{title:w(()=>[z("div",qy,[g(b,null,{default:w(()=>[g(S)]),_:1}),m[7]||(m[7]=F(" 常规 "))])]),default:w(()=>[z("div",null,[g(C,{prop:"id",label:"节点 ID"},{default:w(()=>[g(T,{modelValue:E(l).id,"onUpdate:modelValue":m[0]||(m[0]=D=>E(l).id=D),onChange:E(i)},null,8,["modelValue","onChange"])]),_:1}),g(C,{prop:"name",label:"节点名称"},{default:w(()=>[g(T,{modelValue:E(l).name,"onUpdate:modelValue":m[1]||(m[1]=D=>E(l).name=D),onChange:E(n)},null,8,["modelValue","onChange"])]),_:1})])]),_:1}),g(k,{name:"2"},{title:w(()=>[z("div",Ky,[g(b,null,{default:w(()=>[g(A)]),_:1}),m[8]||(m[8]=F(" 执行监听器 "))])]),default:w(()=>[z("div",null,[g(Ti,{element:v.element},null,8,["element"])])]),_:1}),g(k,{name:"3"},{title:w(()=>[z("div",Xy,[g(b,null,{default:w(()=>[g(j)]),_:1}),m[9]||(m[9]=F(" 多实例 "))])]),default:w(()=>[z("div",null,[g(C,{label:"多实例类型"},{default:w(()=>[g(H,{modelValue:E(l).multiInstanceType,"onUpdate:modelValue":m[2]||(m[2]=D=>E(l).multiInstanceType=D),onChange:p},{default:w(()=>[(ae(!0),Ce(Wt,null,gn(E(a).MultiInstanceType,D=>(ae(),ze(V,{key:D.id,value:D.value,label:D.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),E(l).multiInstanceType!==E(_t).NONE?(ae(),Ce("div",Zy,[g(C,{label:"集合"},{label:w(()=>[z("span",null,[m[11]||(m[11]=F(" 集合 ")),g(U,{placement:"top"},{content:w(()=>m[10]||(m[10]=[F(" 属性会作为表达式进行解析。如果表达式解析为字符串而不是一个集合，"),z("br",null,null,-1),F(" 不论是因为本身配置的就是静态字符串值，还是表达式计算结果为字符串，"),z("br",null,null,-1),F(" 这个字符串都会被当做变量名，并从流程变量中用于获取实际的集合。 ")])),default:w(()=>[g(b,null,{default:w(()=>[g(Y)]),_:1})]),_:1})])]),default:w(()=>[g(T,{modelValue:E(l).collection,"onUpdate:modelValue":m[3]||(m[3]=D=>E(l).collection=D),onChange:u},null,8,["modelValue"])]),_:1}),g(C,{label:"元素变量"},{label:w(()=>[z("span",null,[m[13]||(m[13]=F(" 元素变量 ")),g(U,{placement:"top"},{content:w(()=>m[12]||(m[12]=[F(" 每创建一个用户任务前，先以该元素变量为label，集合中的一项为value，"),z("br",null,null,-1),F(" 创建（局部）流程变量，该局部流程变量被用于指派用户任务。"),z("br",null,null,-1),F(" 一般来说，该字符串应与指定人员变量相同。 ")])),default:w(()=>[g(b,null,{default:w(()=>[g(Y)]),_:1})]),_:1})])]),default:w(()=>[g(T,{modelValue:E(l).elementVariable,"onUpdate:modelValue":m[4]||(m[4]=D=>E(l).elementVariable=D),onChange:d},null,8,["modelValue"])]),_:1}),g(C,{label:"完成条件"},{label:w(()=>[z("span",null,[m[15]||(m[15]=F(" 完成条件 ")),g(U,{placement:"top"},{content:w(()=>m[14]||(m[14]=[F(" 多实例活动在所有实例都完成时结束，然而也可以指定一个表达式，在每个实例"),z("br",null,null,-1),F(" 结束时进行计算。当表达式计算为true时，将销毁所有剩余的实例，并结束多实例"),z("br",null,null,-1),F(" 活动，继续执行流程。例如 ${nrOfCompletedInstances/nrOfInstances >= 0.6 }，"),z("br",null,null,-1),F(" 表示当任务完成60%时，该节点就算完成 ")])),default:w(()=>[g(b,null,{default:w(()=>[g(Y)]),_:1})]),_:1})])]),default:w(()=>[g(T,{modelValue:E(l).completionCondition,"onUpdate:modelValue":m[5]||(m[5]=D=>E(l).completionCondition=D),onChange:f},null,8,["modelValue"])]),_:1})])):Ke("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])])}}}),Jy={ref:"propertyPanel"},e_={key:0,class:"node-name"},t_=Le({name:"PropertyPanel"}),n_=Le({...t_,props:{modeler:{}},setup(e){const t=e,n=$(),i=$(),r=["bpmn:IntermediateThrowEvent","bpmn:StartEvent","bpmn:EndEvent"],o=["bpmn:UserTask","bpmn:Task","bpmn:SendTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:BusinessRuleTask","bpmn:ServiceTask","bpmn:ScriptTask"],a=["bpmn:SequenceFlow"],s=["bpmn:InclusiveGateway","bpmn:ExclusiveGateway","bpmn:ParallelGateway","bpmn:EventBasedGateway","bpmn:ComplexGateway"],l=["bpmn:Process"],c=Ge(()=>{if(!n.value)return null;const d=n.value.type;if(r.includes(d))return By;if(o.includes(d))return Iy;if(a.includes(d))return Uy;if(s.includes(d))return Fy;if(l.includes(d))return Oy;if(d==="bpmn:Participant")return Yy;if(d==="bpmn:SubProcess")return Qy}),p=Ge(()=>{if(n.value){const d=n.value.businessObject,f=d!=null&&d.eventDefinitions&&(d==null?void 0:d.eventDefinitions.length)>0?d.eventDefinitions[0].$type:d.$type;return my[f]||f}return""}),u=()=>{t.modeler.on("root.added",d=>{n.value=null,d.element.type==="bpmn:Process"&&Jt(()=>{n.value=d.element,i.value=d.element})}),t.modeler.on("element.click",d=>{d.element.type==="bpmn:Process"&&Jt(()=>{n.value=d.element,i.value=d.element})}),t.modeler.on("selection.changed",d=>{n.value=null;const f=d.newSelection[0];f?Jt(()=>{n.value=f}):Jt(()=>{n.value=i.value})})};return _i(()=>{u()}),(d,f)=>(ae(),Ce("div",Jy,[E(p)?(ae(),Ce("div",e_,nn(E(p)),1)):Ke("",!0),E(n)?(ae(),ze(Qv(E(c)),{key:1,element:E(n)},null,8,["element"])):Ke("",!0)],512))}}),i_=ha(n_,[["__scopeId","data-v-596954c9"]]);function zr(e){yl.call(this,e),this.on("import.parse.complete",function(t){t.error||this._collectIds(t.definitions,t.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}te(zr,yl);zr.prototype._createModdle=function(e){var t=yl.prototype._createModdle.call(this,e);return t.ids=new cg([32,36,1]),t};zr.prototype._collectIds=function(e,t){var n=e.$model,i=n.ids,r;i.clear();for(r in t)i.claim(r,t[r])};var r_=["c","C"],o_=["v","V"],a_=["y","Y"],Rf=["z","Z"];function s_(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function At(e){return e.altKey?!1:e.ctrlKey||e.metaKey}function nt(e,t){return e=Pe(e)?e:[e],e.indexOf(t.key)!==-1||e.indexOf(t.code)!==-1}function kl(e){return e.shiftKey}function l_(e){return At(e)&&nt(r_,e)}function c_(e){return At(e)&&nt(o_,e)}function u_(e){return At(e)&&!kl(e)&&nt(Rf,e)}function p_(e){return At(e)&&(nt(a_,e)||nt(Rf,e)&&kl(e))}var xa="keyboard.keydown",d_="keyboard.keyup",Pu="input-handle-modified-keys",f_=1e3;function at(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}at.$inject=["config.keyboard","eventBus"];at.prototype._keydownHandler=function(e){this._keyHandler(e,xa)};at.prototype._keyupHandler=function(e){this._keyHandler(e,d_)};at.prototype._keyHandler=function(e,t){var n;if(!this._isEventIgnored(e)){var i={keyEvent:e};n=this._eventBus.fire(t||xa,i),n&&e.preventDefault()}};at.prototype._isEventIgnored=function(e){return e.defaultPrevented?!0:h_(e.target)&&this._isModifiedKeyIgnored(e)};at.prototype._isModifiedKeyIgnored=function(e){if(!At(e))return!0;var t=this._getAllowedModifiers(e.target);return t.indexOf(e.key)===-1};at.prototype._getAllowedModifiers=function(e){var t=Yn(e,"["+Pu+"]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute(Pu).split(",")};at.prototype.bind=function(e){this.unbind(),this._node=e,ce.bind(e,"keydown",this._keydownHandler),ce.bind(e,"keyup",this._keyupHandler),this._fire("bind")};at.prototype.getBinding=function(){return this._node};at.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),ce.unbind(e,"keydown",this._keydownHandler),ce.unbind(e,"keyup",this._keyupHandler)),this._node=null};at.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})};at.prototype.addListener=function(e,t,n){rn(e)&&(n=t,t=e,e=f_),this._eventBus.on(n||xa,e,t)};at.prototype.removeListener=function(e,t){this._eventBus.off(t||xa,e)};at.prototype.hasModifier=s_;at.prototype.isCmd=At;at.prototype.isShift=kl;at.prototype.isKey=nt;function h_(e){return e&&(_l(e,"input, textarea")||e.contentEditable==="true")}var m_=500;function er(e,t){var n=this;e.on("editorActions.init",m_,function(i){var r=i.editorActions;n.registerBindings(t,r)})}er.$inject=["eventBus","keyboard"];er.prototype.registerBindings=function(e,t){function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("undo",function(i){var r=i.keyEvent;if(u_(r))return t.trigger("undo"),!0}),n("redo",function(i){var r=i.keyEvent;if(p_(r))return t.trigger("redo"),!0}),n("copy",function(i){var r=i.keyEvent;if(l_(r))return t.trigger("copy"),!0}),n("paste",function(i){var r=i.keyEvent;if(c_(r))return t.trigger("paste"),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(nt(["+","Add","="],r)&&At(r))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(nt(["-","Subtract"],r)&&At(r))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(i){var r=i.keyEvent;if(nt("0",r)&&At(r))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(i){var r=i.keyEvent;if(nt(["Backspace","Delete","Del"],r))return t.trigger("removeSelection"),!0})};const Al={__init__:["keyboard","keyboardBindings"],keyboard:["type",at],keyboardBindings:["type",er]};var v_={moveSpeed:50,moveSpeedAccelerated:200};function kf(e,t,n){var i=this;this._config=N({},v_,e||{}),t.addListener(r);function r(o){var a=o.keyEvent,s=i._config;if(t.isCmd(a)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],a)){var l=t.isShift(a)?s.moveSpeedAccelerated:s.moveSpeed,c;switch(a.key){case"ArrowLeft":case"Left":c="left";break;case"ArrowUp":case"Up":c="up";break;case"ArrowRight":case"Right":c="right";break;case"ArrowDown":case"Down":c="down";break}return i.moveCanvas({speed:l,direction:c}),!0}}this.moveCanvas=function(o){var a=0,s=0,l=o.speed,c=l/Math.min(Math.sqrt(n.viewbox().scale),1);switch(o.direction){case"left":a=c;break;case"up":s=c;break;case"right":a=-c;break;case"down":s=-c;break}n.scroll({dx:a,dy:s})}}kf.$inject=["config.keyboardMove","keyboard","canvas"];const Af={__depends__:[Al],__init__:["keyboardMove"],keyboardMove:["type",kf]};var g_=/^djs-cursor-.*$/;function wa(e){var t=xt(document.body);t.removeMatching(g_),e&&t.add("djs-cursor-"+e)}function Df(){wa(null)}var y_=5e3;function If(e,t){t=t||"element.click";function n(){return!1}return e.once(t,y_,n),function(){e.off(t,n)}}function wr(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function Gt(e,t){return{x:e.x-t.x,y:e.y-t.y}}var __=15;function Mf(e,t){var n;e.on("element.mousedown",500,function(a){return o(a.originalEvent)});function i(a){var s=n.start,l=n.button,c=Hn(a),p=Gt(c,s);if(!n.dragging&&b_(p)>__&&(n.dragging=!0,l===0&&If(e),wa("grab")),n.dragging){var u=n.last||n.start;p=Gt(c,u),t.scroll({dx:p.x,dy:p.y}),n.last=c}a.preventDefault()}function r(a){ce.unbind(document,"mousemove",i),ce.unbind(document,"mouseup",r),n=null,Df()}function o(a){if(!Yn(a.target,".djs-draggable")){var s=a.button;if(!(s>=2||a.ctrlKey||a.shiftKey||a.altKey))return n={button:s,start:Hn(a)},ce.bind(document,"mousemove",i),ce.bind(document,"mouseup",r),!0}}this.isActive=function(){return!!n}}Mf.$inject=["eventBus","canvas"];function b_(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}const Nf={__init__:["moveCanvas"],moveCanvas:["type",Mf]};function zs(e){return Math.log(e)/Math.log(10)}function Of(e,t){var n=zs(e.min),i=zs(e.max),r=Math.abs(n)+Math.abs(i);return r/t}function E_(e,t){return Math.max(e.min,Math.min(e.max,t))}var x_=Math.sign||function(e){return e>=0?1:-1},Dl={min:.2,max:4},Lf=10,w_=.1,S_=.75;function ln(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=yi(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||S_;var i=this;t.on("canvas.init",function(r){i._init(e.enabled!==!1)})}ln.$inject=["config.zoomScroll","eventBus","canvas"];ln.prototype.scroll=function(t){this._canvas.scroll(t)};ln.prototype.reset=function(){this._canvas.zoom("fit-viewport")};ln.prototype.zoom=function(t,n){var i=Of(Dl,Lf*2);this._totalDelta+=t,Math.abs(this._totalDelta)>w_&&(this._zoom(t,n,i),this._totalDelta=0)};ln.prototype._handleWheel=function(t){if(!Yn(t.target,".djs-scrollable",!0)){var n=this._container;t.preventDefault();var i=t.ctrlKey||ug()&&t.metaKey,r=t.shiftKey,o=-1*this._scale,a;if(i?o*=t.deltaMode===0?.02:.32:o*=t.deltaMode===0?1:16,i){var s=n.getBoundingClientRect(),l={x:t.clientX-s.left,y:t.clientY-s.top};a=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*x_(t.deltaY)*o,this.zoom(a,l)}else r?a={dx:o*t.deltaY,dy:0}:a={dx:o*t.deltaX,dy:o*t.deltaY},this.scroll(a)}};ln.prototype.stepZoom=function(t,n){var i=Of(Dl,Lf);this._zoom(t,n,i)};ln.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,o=zs(i.zoom()),a=Math.round(o/n)*n;a+=n*r;var s=Math.pow(10,a);i.zoom(E_(Dl,s),t)};ln.prototype.toggle=function(t){var n=this._container,i=this._handleWheel,r=this._enabled;return typeof t>"u"&&(t=!r),r!==t&&ce[t?"bind":"unbind"](n,"wheel",i,!1),this._enabled=t,t};ln.prototype._init=function(e){this.toggle(e)};const $f={__init__:["zoomScroll"],zoomScroll:["type",ln]};function Nr(e){Fr.call(this,e)}te(Nr,Fr);Nr.prototype._navigationModules=[Af,Nf,$f];Nr.prototype._modules=[].concat(Fr.prototype._modules,Nr.prototype._navigationModules);var Bf={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,n,i,r){var o=["","webkit","Moz","MS","ms","o"],a=n.createElement("div"),s="function",l=Math.round,c=Math.abs,p=Date.now;function u(_,x,P){return setTimeout(T(_,P),x)}function d(_,x,P){return Array.isArray(_)?(f(_,P[x],P),!0):!1}function f(_,x,P){var M;if(_)if(_.forEach)_.forEach(x,P);else if(_.length!==r)for(M=0;M<_.length;)x.call(P,_[M],M,_),M++;else for(M in _)_.hasOwnProperty(M)&&x.call(P,_[M],M,_)}function h(_,x,P){var M="DEPRECATED METHOD: "+x+`
`+P+` AT 
`;return function(){var B=new Error("get-stack-trace"),Q=B&&B.stack?B.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",be=t.console&&(t.console.warn||t.console.log);return be&&be.call(t.console,M,Q),_.apply(this,arguments)}}var v;typeof Object.assign!="function"?v=function(x){if(x===r||x===null)throw new TypeError("Cannot convert undefined or null to object");for(var P=Object(x),M=1;M<arguments.length;M++){var B=arguments[M];if(B!==r&&B!==null)for(var Q in B)B.hasOwnProperty(Q)&&(P[Q]=B[Q])}return P}:v=Object.assign;var m=h(function(x,P,M){for(var B=Object.keys(P),Q=0;Q<B.length;)(!M||M&&x[B[Q]]===r)&&(x[B[Q]]=P[B[Q]]),Q++;return x},"extend","Use `assign`."),S=h(function(x,P){return m(x,P,!0)},"merge","Use `assign`.");function b(_,x,P){var M=x.prototype,B;B=_.prototype=Object.create(M),B.constructor=_,B._super=M,P&&v(B,P)}function T(_,x){return function(){return _.apply(x,arguments)}}function C(_,x){return typeof _==s?_.apply(x&&x[0]||r,x):_}function k(_,x){return _===r?x:_}function A(_,x,P){f(Y(x),function(M){_.addEventListener(M,P,!1)})}function j(_,x,P){f(Y(x),function(M){_.removeEventListener(M,P,!1)})}function V(_,x){for(;_;){if(_==x)return!0;_=_.parentNode}return!1}function H(_,x){return _.indexOf(x)>-1}function Y(_){return _.trim().split(/\s+/g)}function U(_,x,P){if(_.indexOf&&!P)return _.indexOf(x);for(var M=0;M<_.length;){if(P&&_[M][P]==x||!P&&_[M]===x)return M;M++}return-1}function ie(_){return Array.prototype.slice.call(_,0)}function G(_,x,P){for(var M=[],B=[],Q=0;Q<_.length;){var be=_[Q][x];U(B,be)<0&&M.push(_[Q]),B[Q]=be,Q++}return M=M.sort(function(ut,yt){return ut[x]>yt[x]}),M}function D(_,x){for(var P,M,B=x[0].toUpperCase()+x.slice(1),Q=0;Q<o.length;){if(P=o[Q],M=P?P+B:x,M in _)return M;Q++}return r}var O=1;function q(){return O++}function re(_){var x=_.ownerDocument||_;return x.defaultView||x.parentWindow||t}var ne=/mobile|tablet|ip(ad|hone|od)|android/i,ge="ontouchstart"in t,$e=D(t,"PointerEvent")!==r,X=ge&&ne.test(navigator.userAgent),J="touch",oe="pen",ke="mouse",lt="kinect",L=25,R=1,ee=2,fe=4,me=8,K=1,he=2,Me=4,ct=8,Ht=16,Ae=he|Me,He=ct|Ht,ai=Ae|He,Di=["x","y"],Rn=["clientX","clientY"];function ht(_,x){var P=this;this.manager=_,this.callback=x,this.element=_.element,this.target=_.options.inputTarget,this.domHandler=function(M){C(_.options.enable,[_])&&P.handler(M)},this.init()}ht.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(re(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&j(this.element,this.evEl,this.domHandler),this.evTarget&&j(this.target,this.evTarget,this.domHandler),this.evWin&&j(re(this.element),this.evWin,this.domHandler)}};function ur(_){var x,P=_.options.inputClass;return P?x=P:$e?x=ls:X?x=vo:ge?x=cs:x=mo,new x(_,Je)}function Je(_,x,P){var M=P.pointers.length,B=P.changedPointers.length,Q=x&R&&M-B===0,be=x&(fe|me)&&M-B===0;P.isFirst=!!Q,P.isFinal=!!be,Q&&(_.session={}),P.eventType=x,kn(_,P),_.emit("hammer.input",P),_.recognize(P),_.session.prevInput=P}function kn(_,x){var P=_.session,M=x.pointers,B=M.length;P.firstInput||(P.firstInput=po(x)),B>1&&!P.firstMultiple?P.firstMultiple=po(x):B===1&&(P.firstMultiple=!1);var Q=P.firstInput,be=P.firstMultiple,it=be?be.center:Q.center,ut=x.center=fo(M);x.timeStamp=p(),x.deltaTime=x.timeStamp-Q.timeStamp,x.angle=ss(it,ut),x.distance=ho(it,ut),Be(P,x),x.offsetDirection=nu(x.deltaX,x.deltaY);var yt=le(x.deltaTime,x.deltaX,x.deltaY);x.overallVelocityX=yt.x,x.overallVelocityY=yt.y,x.overallVelocity=c(yt.x)>c(yt.y)?yt.x:yt.y,x.scale=be?fv(be.pointers,M):1,x.rotation=be?dv(be.pointers,M):0,x.maxPointers=P.prevInput?x.pointers.length>P.prevInput.maxPointers?x.pointers.length:P.prevInput.maxPointers:x.pointers.length,si(P,x);var Zt=_.element;V(x.srcEvent.target,Zt)&&(Zt=x.srcEvent.target),x.target=Zt}function Be(_,x){var P=x.center,M=_.offsetDelta||{},B=_.prevDelta||{},Q=_.prevInput||{};(x.eventType===R||Q.eventType===fe)&&(B=_.prevDelta={x:Q.deltaX||0,y:Q.deltaY||0},M=_.offsetDelta={x:P.x,y:P.y}),x.deltaX=B.x+(P.x-M.x),x.deltaY=B.y+(P.y-M.y)}function si(_,x){var P=_.lastInterval||x,M=x.timeStamp-P.timeStamp,B,Q,be,it;if(x.eventType!=me&&(M>L||P.velocity===r)){var ut=x.deltaX-P.deltaX,yt=x.deltaY-P.deltaY,Zt=le(M,ut,yt);Q=Zt.x,be=Zt.y,B=c(Zt.x)>c(Zt.y)?Zt.x:Zt.y,it=nu(ut,yt),_.lastInterval=x}else B=P.velocity,Q=P.velocityX,be=P.velocityY,it=P.direction;x.velocity=B,x.velocityX=Q,x.velocityY=be,x.direction=it}function po(_){for(var x=[],P=0;P<_.pointers.length;)x[P]={clientX:l(_.pointers[P].clientX),clientY:l(_.pointers[P].clientY)},P++;return{timeStamp:p(),pointers:x,center:fo(x),deltaX:_.deltaX,deltaY:_.deltaY}}function fo(_){var x=_.length;if(x===1)return{x:l(_[0].clientX),y:l(_[0].clientY)};for(var P=0,M=0,B=0;B<x;)P+=_[B].clientX,M+=_[B].clientY,B++;return{x:l(P/x),y:l(M/x)}}function le(_,x,P){return{x:x/_||0,y:P/_||0}}function nu(_,x){return _===x?K:c(_)>=c(x)?_<0?he:Me:x<0?ct:Ht}function ho(_,x,P){P||(P=Di);var M=x[P[0]]-_[P[0]],B=x[P[1]]-_[P[1]];return Math.sqrt(M*M+B*B)}function ss(_,x,P){P||(P=Di);var M=x[P[0]]-_[P[0]],B=x[P[1]]-_[P[1]];return Math.atan2(B,M)*180/Math.PI}function dv(_,x){return ss(x[1],x[0],Rn)+ss(_[1],_[0],Rn)}function fv(_,x){return ho(x[0],x[1],Rn)/ho(_[0],_[1],Rn)}var hv={mousedown:R,mousemove:ee,mouseup:fe},mv="mousedown",vv="mousemove mouseup";function mo(){this.evEl=mv,this.evWin=vv,this.pressed=!1,ht.apply(this,arguments)}b(mo,ht,{handler:function(x){var P=hv[x.type];P&R&&x.button===0&&(this.pressed=!0),P&ee&&x.which!==1&&(P=fe),this.pressed&&(P&fe&&(this.pressed=!1),this.callback(this.manager,P,{pointers:[x],changedPointers:[x],pointerType:ke,srcEvent:x}))}});var gv={pointerdown:R,pointermove:ee,pointerup:fe,pointercancel:me,pointerout:me},yv={2:J,3:oe,4:ke,5:lt},iu="pointerdown",ru="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(iu="MSPointerDown",ru="MSPointerMove MSPointerUp MSPointerCancel");function ls(){this.evEl=iu,this.evWin=ru,ht.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}b(ls,ht,{handler:function(x){var P=this.store,M=!1,B=x.type.toLowerCase().replace("ms",""),Q=gv[B],be=yv[x.pointerType]||x.pointerType,it=be==J,ut=U(P,x.pointerId,"pointerId");Q&R&&(x.button===0||it)?ut<0&&(P.push(x),ut=P.length-1):Q&(fe|me)&&(M=!0),!(ut<0)&&(P[ut]=x,this.callback(this.manager,Q,{pointers:P,changedPointers:[x],pointerType:be,srcEvent:x}),M&&P.splice(ut,1))}});var _v={touchstart:R,touchmove:ee,touchend:fe,touchcancel:me},bv="touchstart",Ev="touchstart touchmove touchend touchcancel";function ou(){this.evTarget=bv,this.evWin=Ev,this.started=!1,ht.apply(this,arguments)}b(ou,ht,{handler:function(x){var P=_v[x.type];if(P===R&&(this.started=!0),!!this.started){var M=xv.call(this,x,P);P&(fe|me)&&M[0].length-M[1].length===0&&(this.started=!1),this.callback(this.manager,P,{pointers:M[0],changedPointers:M[1],pointerType:J,srcEvent:x})}}});function xv(_,x){var P=ie(_.touches),M=ie(_.changedTouches);return x&(fe|me)&&(P=G(P.concat(M),"identifier")),[P,M]}var wv={touchstart:R,touchmove:ee,touchend:fe,touchcancel:me},Sv="touchstart touchmove touchend touchcancel";function vo(){this.evTarget=Sv,this.targetIds={},ht.apply(this,arguments)}b(vo,ht,{handler:function(x){var P=wv[x.type],M=Cv.call(this,x,P);M&&this.callback(this.manager,P,{pointers:M[0],changedPointers:M[1],pointerType:J,srcEvent:x})}});function Cv(_,x){var P=ie(_.touches),M=this.targetIds;if(x&(R|ee)&&P.length===1)return M[P[0].identifier]=!0,[P,P];var B,Q,be=ie(_.changedTouches),it=[],ut=this.target;if(Q=P.filter(function(yt){return V(yt.target,ut)}),x===R)for(B=0;B<Q.length;)M[Q[B].identifier]=!0,B++;for(B=0;B<be.length;)M[be[B].identifier]&&it.push(be[B]),x&(fe|me)&&delete M[be[B].identifier],B++;if(it.length)return[G(Q.concat(it),"identifier"),it]}var Tv=2500,au=25;function cs(){ht.apply(this,arguments);var _=T(this.handler,this);this.touch=new vo(this.manager,_),this.mouse=new mo(this.manager,_),this.primaryTouch=null,this.lastTouches=[]}b(cs,ht,{handler:function(x,P,M){var B=M.pointerType==J,Q=M.pointerType==ke;if(!(Q&&M.sourceCapabilities&&M.sourceCapabilities.firesTouchEvents)){if(B)Pv.call(this,P,M);else if(Q&&Rv.call(this,M))return;this.callback(x,P,M)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Pv(_,x){_&R?(this.primaryTouch=x.changedPointers[0].identifier,su.call(this,x)):_&(fe|me)&&su.call(this,x)}function su(_){var x=_.changedPointers[0];if(x.identifier===this.primaryTouch){var P={x:x.clientX,y:x.clientY};this.lastTouches.push(P);var M=this.lastTouches,B=function(){var Q=M.indexOf(P);Q>-1&&M.splice(Q,1)};setTimeout(B,Tv)}}function Rv(_){for(var x=_.srcEvent.clientX,P=_.srcEvent.clientY,M=0;M<this.lastTouches.length;M++){var B=this.lastTouches[M],Q=Math.abs(x-B.x),be=Math.abs(P-B.y);if(Q<=au&&be<=au)return!0}return!1}var lu=D(a.style,"touchAction"),cu=lu!==r,uu="compute",pu="auto",us="manipulation",li="none",pr="pan-x",dr="pan-y",go=Av();function ps(_,x){this.manager=_,this.set(x)}ps.prototype={set:function(_){_==uu&&(_=this.compute()),cu&&this.manager.element.style&&go[_]&&(this.manager.element.style[lu]=_),this.actions=_.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var _=[];return f(this.manager.recognizers,function(x){C(x.options.enable,[x])&&(_=_.concat(x.getTouchAction()))}),kv(_.join(" "))},preventDefaults:function(_){var x=_.srcEvent,P=_.offsetDirection;if(this.manager.session.prevented){x.preventDefault();return}var M=this.actions,B=H(M,li)&&!go[li],Q=H(M,dr)&&!go[dr],be=H(M,pr)&&!go[pr];if(B){var it=_.pointers.length===1,ut=_.distance<2,yt=_.deltaTime<250;if(it&&ut&&yt)return}if(!(be&&Q)&&(B||Q&&P&Ae||be&&P&He))return this.preventSrc(x)},preventSrc:function(_){this.manager.session.prevented=!0,_.preventDefault()}};function kv(_){if(H(_,li))return li;var x=H(_,pr),P=H(_,dr);return x&&P?li:x||P?x?pr:dr:H(_,us)?us:pu}function Av(){if(!cu)return!1;var _={},x=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(P){_[P]=x?t.CSS.supports("touch-action",P):!0}),_}var yo=1,It=2,Ii=4,An=8,pn=An,fr=16,Xt=32;function dn(_){this.options=v({},this.defaults,_||{}),this.id=q(),this.manager=null,this.options.enable=k(this.options.enable,!0),this.state=yo,this.simultaneous={},this.requireFail=[]}dn.prototype={defaults:{},set:function(_){return v(this.options,_),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(_){if(d(_,"recognizeWith",this))return this;var x=this.simultaneous;return _=_o(_,this),x[_.id]||(x[_.id]=_,_.recognizeWith(this)),this},dropRecognizeWith:function(_){return d(_,"dropRecognizeWith",this)?this:(_=_o(_,this),delete this.simultaneous[_.id],this)},requireFailure:function(_){if(d(_,"requireFailure",this))return this;var x=this.requireFail;return _=_o(_,this),U(x,_)===-1&&(x.push(_),_.requireFailure(this)),this},dropRequireFailure:function(_){if(d(_,"dropRequireFailure",this))return this;_=_o(_,this);var x=U(this.requireFail,_);return x>-1&&this.requireFail.splice(x,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(_){return!!this.simultaneous[_.id]},emit:function(_){var x=this,P=this.state;function M(B){x.manager.emit(B,_)}P<An&&M(x.options.event+du(P)),M(x.options.event),_.additionalEvent&&M(_.additionalEvent),P>=An&&M(x.options.event+du(P))},tryEmit:function(_){if(this.canEmit())return this.emit(_);this.state=Xt},canEmit:function(){for(var _=0;_<this.requireFail.length;){if(!(this.requireFail[_].state&(Xt|yo)))return!1;_++}return!0},recognize:function(_){var x=v({},_);if(!C(this.options.enable,[this,x])){this.reset(),this.state=Xt;return}this.state&(pn|fr|Xt)&&(this.state=yo),this.state=this.process(x),this.state&(It|Ii|An|fr)&&this.tryEmit(x)},process:function(_){},getTouchAction:function(){},reset:function(){}};function du(_){return _&fr?"cancel":_&An?"end":_&Ii?"move":_&It?"start":""}function fu(_){return _==Ht?"down":_==ct?"up":_==he?"left":_==Me?"right":""}function _o(_,x){var P=x.manager;return P?P.get(_):_}function zt(){dn.apply(this,arguments)}b(zt,dn,{defaults:{pointers:1},attrTest:function(_){var x=this.options.pointers;return x===0||_.pointers.length===x},process:function(_){var x=this.state,P=_.eventType,M=x&(It|Ii),B=this.attrTest(_);return M&&(P&me||!B)?x|fr:M||B?P&fe?x|An:x&It?x|Ii:It:Xt}});function bo(){zt.apply(this,arguments),this.pX=null,this.pY=null}b(bo,zt,{defaults:{event:"pan",threshold:10,pointers:1,direction:ai},getTouchAction:function(){var _=this.options.direction,x=[];return _&Ae&&x.push(dr),_&He&&x.push(pr),x},directionTest:function(_){var x=this.options,P=!0,M=_.distance,B=_.direction,Q=_.deltaX,be=_.deltaY;return B&x.direction||(x.direction&Ae?(B=Q===0?K:Q<0?he:Me,P=Q!=this.pX,M=Math.abs(_.deltaX)):(B=be===0?K:be<0?ct:Ht,P=be!=this.pY,M=Math.abs(_.deltaY))),_.direction=B,P&&M>x.threshold&&B&x.direction},attrTest:function(_){return zt.prototype.attrTest.call(this,_)&&(this.state&It||!(this.state&It)&&this.directionTest(_))},emit:function(_){this.pX=_.deltaX,this.pY=_.deltaY;var x=fu(_.direction);x&&(_.additionalEvent=this.options.event+x),this._super.emit.call(this,_)}});function ds(){zt.apply(this,arguments)}b(ds,zt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[li]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.scale-1)>this.options.threshold||this.state&It)},emit:function(_){if(_.scale!==1){var x=_.scale<1?"in":"out";_.additionalEvent=this.options.event+x}this._super.emit.call(this,_)}});function fs(){dn.apply(this,arguments),this._timer=null,this._input=null}b(fs,dn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[pu]},process:function(_){var x=this.options,P=_.pointers.length===x.pointers,M=_.distance<x.threshold,B=_.deltaTime>x.time;if(this._input=_,!M||!P||_.eventType&(fe|me)&&!B)this.reset();else if(_.eventType&R)this.reset(),this._timer=u(function(){this.state=pn,this.tryEmit()},x.time,this);else if(_.eventType&fe)return pn;return Xt},reset:function(){clearTimeout(this._timer)},emit:function(_){this.state===pn&&(_&&_.eventType&fe?this.manager.emit(this.options.event+"up",_):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function hs(){zt.apply(this,arguments)}b(hs,zt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[li]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.rotation)>this.options.threshold||this.state&It)}});function ms(){zt.apply(this,arguments)}b(ms,zt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ae|He,pointers:1},getTouchAction:function(){return bo.prototype.getTouchAction.call(this)},attrTest:function(_){var x=this.options.direction,P;return x&(Ae|He)?P=_.overallVelocity:x&Ae?P=_.overallVelocityX:x&He&&(P=_.overallVelocityY),this._super.attrTest.call(this,_)&&x&_.offsetDirection&&_.distance>this.options.threshold&&_.maxPointers==this.options.pointers&&c(P)>this.options.velocity&&_.eventType&fe},emit:function(_){var x=fu(_.offsetDirection);x&&this.manager.emit(this.options.event+x,_),this.manager.emit(this.options.event,_)}});function Eo(){dn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}b(Eo,dn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[us]},process:function(_){var x=this.options,P=_.pointers.length===x.pointers,M=_.distance<x.threshold,B=_.deltaTime<x.time;if(this.reset(),_.eventType&R&&this.count===0)return this.failTimeout();if(M&&B&&P){if(_.eventType!=fe)return this.failTimeout();var Q=this.pTime?_.timeStamp-this.pTime<x.interval:!0,be=!this.pCenter||ho(this.pCenter,_.center)<x.posThreshold;this.pTime=_.timeStamp,this.pCenter=_.center,!be||!Q?this.count=1:this.count+=1,this._input=_;var it=this.count%x.taps;if(it===0)return this.hasRequireFailures()?(this._timer=u(function(){this.state=pn,this.tryEmit()},x.interval,this),It):pn}return Xt},failTimeout:function(){return this._timer=u(function(){this.state=Xt},this.options.interval,this),Xt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==pn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Dn(_,x){return x=x||{},x.recognizers=k(x.recognizers,Dn.defaults.preset),new vs(_,x)}Dn.VERSION="2.0.7",Dn.defaults={domEvents:!1,touchAction:uu,enable:!0,inputTarget:null,inputClass:null,preset:[[hs,{enable:!1}],[ds,{enable:!1},["rotate"]],[ms,{direction:Ae}],[bo,{direction:Ae},["swipe"]],[Eo],[Eo,{event:"doubletap",taps:2},["tap"]],[fs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Dv=1,hu=2;function vs(_,x){this.options=v({},Dn.defaults,x||{}),this.options.inputTarget=this.options.inputTarget||_,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=_,this.input=ur(this),this.touchAction=new ps(this,this.options.touchAction),mu(this,!0),f(this.options.recognizers,function(P){var M=this.add(new P[0](P[1]));P[2]&&M.recognizeWith(P[2]),P[3]&&M.requireFailure(P[3])},this)}vs.prototype={set:function(_){return v(this.options,_),_.touchAction&&this.touchAction.update(),_.inputTarget&&(this.input.destroy(),this.input.target=_.inputTarget,this.input.init()),this},stop:function(_){this.session.stopped=_?hu:Dv},recognize:function(_){var x=this.session;if(!x.stopped){this.touchAction.preventDefaults(_);var P,M=this.recognizers,B=x.curRecognizer;(!B||B&&B.state&pn)&&(B=x.curRecognizer=null);for(var Q=0;Q<M.length;)P=M[Q],x.stopped!==hu&&(!B||P==B||P.canRecognizeWith(B))?P.recognize(_):P.reset(),!B&&P.state&(It|Ii|An)&&(B=x.curRecognizer=P),Q++}},get:function(_){if(_ instanceof dn)return _;for(var x=this.recognizers,P=0;P<x.length;P++)if(x[P].options.event==_)return x[P];return null},add:function(_){if(d(_,"add",this))return this;var x=this.get(_.options.event);return x&&this.remove(x),this.recognizers.push(_),_.manager=this,this.touchAction.update(),_},remove:function(_){if(d(_,"remove",this))return this;if(_=this.get(_),_){var x=this.recognizers,P=U(x,_);P!==-1&&(x.splice(P,1),this.touchAction.update())}return this},on:function(_,x){if(_!==r&&x!==r){var P=this.handlers;return f(Y(_),function(M){P[M]=P[M]||[],P[M].push(x)}),this}},off:function(_,x){if(_!==r){var P=this.handlers;return f(Y(_),function(M){x?P[M]&&P[M].splice(U(P[M],x),1):delete P[M]}),this}},emit:function(_,x){this.options.domEvents&&Iv(_,x);var P=this.handlers[_]&&this.handlers[_].slice();if(!(!P||!P.length)){x.type=_,x.preventDefault=function(){x.srcEvent.preventDefault()};for(var M=0;M<P.length;)P[M](x),M++}},destroy:function(){this.element&&mu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function mu(_,x){var P=_.element;if(P.style){var M;f(_.options.cssProps,function(B,Q){M=D(P.style,Q),x?(_.oldCssProps[M]=P.style[M],P.style[M]=B):P.style[M]=_.oldCssProps[M]||""}),x||(_.oldCssProps={})}}function Iv(_,x){var P=n.createEvent("Event");P.initEvent(_,!0,!0),P.gesture=x,x.target.dispatchEvent(P)}v(Dn,{INPUT_START:R,INPUT_MOVE:ee,INPUT_END:fe,INPUT_CANCEL:me,STATE_POSSIBLE:yo,STATE_BEGAN:It,STATE_CHANGED:Ii,STATE_ENDED:An,STATE_RECOGNIZED:pn,STATE_CANCELLED:fr,STATE_FAILED:Xt,DIRECTION_NONE:K,DIRECTION_LEFT:he,DIRECTION_RIGHT:Me,DIRECTION_UP:ct,DIRECTION_DOWN:Ht,DIRECTION_HORIZONTAL:Ae,DIRECTION_VERTICAL:He,DIRECTION_ALL:ai,Manager:vs,Input:ht,TouchAction:ps,TouchInput:vo,MouseInput:mo,PointerEventInput:ls,TouchMouseInput:cs,SingleTouchInput:ou,Recognizer:dn,AttrRecognizer:zt,Tap:Eo,Pan:bo,Swipe:ms,Pinch:ds,Rotate:hs,Press:fs,on:A,off:j,each:f,merge:S,extend:m,assign:v,inherit:b,bindFn:T,prefixed:D});var Mv=typeof t<"u"?t:typeof self<"u"?self:{};Mv.Hammer=Dn,e.exports?e.exports=Dn:t[i]=Dn})(window,document,"Hammer")})(Bf);var C_=Bf.exports;const ui=Jv(C_);var T_=.2,P_=4,Ru=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function xo(e,t){return t.get(e,!1)}function Us(e){e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.srcEvent&&typeof e.srcEvent.stopPropagation=="function"&&e.srcEvent.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation()}function ys(e){function t(c){I(Ru,function(p){ce.bind(e,p,Us,!0)})}function n(c){setTimeout(function(){I(Ru,function(p){ce.unbind(e,p,Us,!0)})},500)}ce.bind(e,"touchstart",t,!0),ce.bind(e,"touchend",n,!0),ce.bind(e,"touchcancel",n,!0);var i=new ui.Manager(e,{inputClass:ui.TouchInput,recognizers:[],domEvents:!0}),r=new ui.Tap,o=new ui.Pan({threshold:10}),a=new ui.Press,s=new ui.Pinch,l=new ui.Tap({event:"doubletap",taps:2});return s.requireFailure(o),s.requireFailure(a),i.add([o,a,s,l,r]),i.reset=function(c){var p=this.recognizers,u=this.session;u.stopped||(i.stop(c),setTimeout(function(){var d,f;for(d=0;f=p[d];d++)f.reset(),f.state=8;u.curRecognizer=null},0))},i.on("hammer.input",function(c){c.srcEvent.defaultPrevented&&i.reset(!0)}),i}function jf(e,t,n,i,r){var o=xo("dragging",e),a=xo("move",e),s=xo("contextPad",e),l=xo("palette",e),c;function p(f,h){return function(v){var m=u(v.target),S=m&&i.get(m);return h&&(v.srcEvent.button=h),r.fire(f,v,S)}}function u(f){var h=Yn(f,"svg, .djs-element",!0);return h}function d(f){c=ys(f);function h(S){var b=0,T=0;function C(A){var j=A.deltaX-b,V=A.deltaY-T;t.scroll({dx:j,dy:V}),b=A.deltaX,T=A.deltaY}function k(A){c.off("panmove",C),c.off("panend",k),c.off("pancancel",k)}c.on("panmove",C),c.on("panend",k),c.on("pancancel",k)}function v(S){var b=u(S.target),T=b&&i.get(b);if(a&&t.getRootElement()!==T)return a.start(S,T,!0);h()}function m(S){var b=t.zoom(),T=S.center;function C(A){var j=1-(1-A.scale)/1.5,V=Math.max(T_,Math.min(P_,j*b));t.zoom(V,T),Us(A)}function k(A){c.off("pinchmove",C),c.off("pinchend",k),c.off("pinchcancel",k),c.reset(!0)}c.on("pinchmove",C),c.on("pinchend",k),c.on("pinchcancel",k)}c.on("tap",p("element.click")),c.on("doubletap",p("element.dblclick",1)),c.on("panstart",v),c.on("press",v),c.on("pinchstart",m)}o&&n.on("drag.move",function(f){var h=f.originalEvent;if(!(!h||h instanceof MouseEvent)){var v=Hn(h),m=document.elementFromPoint(v.x,v.y),S=u(m),b=S&&i.get(S);b!==f.hover&&(f.hover&&o.out(f),b&&(o.hover({element:b,gfx:S}),f.hover=b,f.hoverGfx=S))}}),s&&n.on("contextPad.create",function(f){var h=f.pad.html,v=ys(h);v.on("panstart",function(m){s.trigger("dragstart",m,!0)}),v.on("press",function(m){s.trigger("dragstart",m,!0)}),v.on("tap",function(m){s.trigger("click",m)})}),l&&n.on("palette.create",function(f){var h=f.container,v=ys(h);v.on("panstart",function(m){l.trigger("dragstart",m,!0)}),v.on("press",function(m){l.trigger("dragstart",m,!0)}),v.on("tap",function(m){l.trigger("click",m)})}),n.on("canvas.init",function(f){d(f.svg)})}jf.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"];function Il(e){var t=this;e.on("canvas.init",function(n){t.addBBoxMarker(n.svg)})}Il.$inject=["eventBus"];Il.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=Ee("rect");pe(n,{x:-1e4,y:1e4,width:10,height:10}),pe(n,t),Te(e,n);var i=Ee("rect");pe(i,{x:1e4,y:1e4,width:10,height:10}),pe(i,t),Te(e,i)};const R_={__depends__:[ma],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",jf],touchFix:["type",Il]},k_={__depends__:[R_]};function _s(e){return e&&e[e.length-1]}function ku(e){return e.y}function Au(e){return e.x}var A_={left:Au,center:Au,right:function(e){return e.x+e.width},top:ku,middle:ku,bottom:function(e){return e.y+e.height}};function tr(e,t){this._modeling=e,this._rules=t}tr.$inject=["modeling","rules"];tr.prototype._getOrientationDetails=function(e){var t=["top","bottom","middle"],n="x",i="width";return t.indexOf(e)!==-1&&(n="y",i="height"),{axis:n,dimension:i}};tr.prototype._isType=function(e,t){return t.indexOf(e)!==-1};tr.prototype._alignmentPosition=function(e,t){var n=this._getOrientationDetails(e),i=n.axis,r=n.dimension,o={},a={},s=!1,l,c,p;function u(d,f){return Math.round((d[i]+f[i]+f[r])/2)}if(this._isType(e,["left","top"]))o[e]=t[0][i];else if(this._isType(e,["right","bottom"]))p=_s(t),o[e]=p[i]+p[r];else if(this._isType(e,["center","middle"])){if(I(t,function(d){var f=d[i]+Math.round(d[r]/2);a[f]?a[f].elements.push(d):a[f]={elements:[d],center:f}}),l=on(a,function(d){return d.elements.length>1&&(s=!0),d.elements.length}),s)return o[e]=_s(l).center,o;c=t[0],t=on(t,function(d){return d[i]+d[r]}),p=_s(t),o[e]=u(c,p)}return o};tr.prototype.trigger=function(e,t){var n=this._modeling,i,r=ye(e,function(l){return!(l.waypoints||l.host||l.labelTarget)});if(i=this._rules.allowed("elements.align",{elements:r}),Pe(i)&&(r=i),!(r.length<2||!i)){var o=A_[t],a=on(r,o),s=this._alignmentPosition(t,a);n.alignElements(a,s)}};const D_={__init__:["alignElements"],alignElements:["type",tr]};var wo=".entry",I_=1e3,Du=12,M_=300;function wt(e,t,n,i){this._canvas=e,this._eventBus=n,this._overlays=i;var r=Tt(t&&t.scale)?t.scale:{min:1,max:1.5};this._overlaysConfig={scale:r},this._current=null,this._init()}wt.$inject=["canvas","config.contextPad","eventBus","overlays"];wt.prototype._init=function(){var e=this;this._eventBus.on("selection.changed",function(t){var n=t.newSelection,i=n.length?n.length===1?n[0]:n:null;i?e.open(i,!0):e.close()}),this._eventBus.on("elements.changed",function(t){var n=t.elements,i=e._current;if(i){var r=i.target,o=Ji(Pe(r)?r:[r],function(a){return Vf(n,a)});o&&e.open(r,!0)}})};wt.prototype.registerProvider=function(e,t){t||(t=e,e=I_),this._eventBus.on("contextPad.getProviders",e,function(n){n.providers.push(t)})};wt.prototype.getEntries=function(e){var t=this._getProviders(),n=Pe(e)?"getMultiElementContextPadEntries":"getContextPadEntries",i={};return I(t,function(r){if(rn(r[n])){var o=r[n](e);rn(o)?i=o(i):I(o,function(a,s){i[s]=a})}}),i};wt.prototype.trigger=function(e,t,n){var i,r,o=t.delegateTarget||t.target;return o?(i=bt(o,"data-action"),r=t.originalEvent||t,e==="mouseover"?this._timeout=setTimeout(()=>{this._mouseout=this.triggerEntry(i,"hover",r,n)},M_):e==="mouseout"&&(clearTimeout(this._timeout),this._mouseout&&(this._mouseout(),this._mouseout=null)),this.triggerEntry(i,e,r,n)):t.preventDefault()};wt.prototype.triggerEntry=function(e,t,n,i){if(this.isShown()){var r=this._current.target,o=this._current.entries,a=o[e];if(a){var s=a.action;if(this._eventBus.fire("contextPad.trigger",{entry:a,event:n})!==!1){if(rn(s)){if(t==="click")return s(n,r,i)}else if(s[t])return s[t](n,r,i);n.preventDefault()}}}};wt.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))};wt.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};wt.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html,r;I(t,function(o,a){var s=o.group||"default",l=rt(o.html||'<div class="entry" draggable="true"></div>'),c;bt(l,"data-action",a),c=ot("[data-group="+Dr(s)+"]",i),c||(c=rt('<div class="group"></div>'),bt(c,"data-group",s),i.appendChild(c)),c.appendChild(l),o.className&&N_(l,o.className),o.title&&bt(l,"title",o.title),o.imageUrl&&(r=rt("<img>"),bt(r,"src",o.imageUrl),r.style.width="100%",r.style.height="100%",l.appendChild(r))}),xt(i).add("open"),this._current={target:e,entries:t,pad:n},this._eventBus.fire("contextPad.open",{current:this._current})};wt.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=rt('<div class="djs-context-pad"></div>'),r=this._getPosition(e),o=N({html:i},this._overlaysConfig,r);Ut.bind(i,wo,"click",function(l){t.trigger("click",l)}),Ut.bind(i,wo,"dragstart",function(l){t.trigger("dragstart",l)}),Ut.bind(i,wo,"mouseover",function(l){t.trigger("mouseover",l)}),Ut.bind(i,wo,"mouseout",function(l){t.trigger("mouseout",l)}),ce.bind(i,"mousedown",function(l){l.stopPropagation()});var a=this._canvas.getRootElement();this._overlayId=n.add(a,"context-pad",o);var s=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{target:e,pad:s}),s};wt.prototype.close=function(){this.isOpen()&&(clearTimeout(this._timeout),this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};wt.prototype.isOpen=function(e){var t=this._current;if(!t)return!1;if(!e)return!0;var n=t.target;return Pe(e)!==Pe(n)?!1:Pe(e)?e.length===n.length&&bl(e,function(i){return Vf(n,i)}):n===e};wt.prototype.isShown=function(){return this.isOpen()&&this._overlays.isShown()};wt.prototype._getPosition=function(e){e=De(e)?O_(e):e;var t=Pe(e)?e:[e],n=Pt(t);return{position:{left:n.x+n.width+Du,top:n.y-Du/2}}};function N_(e,t){var n=xt(e);t=Pe(t)?t:t.split(/\s+/g),t.forEach(function(i){n.add(i)})}function Vf(e,t){return e.indexOf(t)!==-1}function O_(e){return e.waypoints[e.waypoints.length-1]}const Ff={__depends__:[ma,sf],contextPad:["type",wt]};var Sa,je,Hf,mi,Iu,zf,Gs,Ml,Ws,Ys,Or={},Uf=[],L_=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Nl=Array.isArray;function Vn(e,t){for(var n in t)e[n]=t[n];return e}function Gf(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Wf(e,t,n){var i,r,o,a={};for(o in t)o=="key"?i=t[o]:o=="ref"?r=t[o]:a[o]=t[o];if(arguments.length>2&&(a.children=arguments.length>3?Sa.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)a[o]===void 0&&(a[o]=e.defaultProps[o]);return zo(e,a,i,r,null)}function zo(e,t,n,i,r){var o={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r??++Hf,__i:-1,__u:0};return r==null&&je.vnode!=null&&je.vnode(o),o}function Ca(e){return e.children}function Uo(e,t){this.props=e,this.context=t}function qi(e,t){if(t==null)return e.__?qi(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?qi(e):null}function Yf(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Yf(e)}}function Mu(e){(!e.__d&&(e.__d=!0)&&mi.push(e)&&!Jo.__r++||Iu!==je.debounceRendering)&&((Iu=je.debounceRendering)||zf)(Jo)}function Jo(){var e,t,n,i,r,o,a,s;for(mi.sort(Gs);e=mi.shift();)e.__d&&(t=mi.length,i=void 0,o=(r=(n=e).__v).__e,a=[],s=[],n.__P&&((i=Vn({},r)).__v=r.__v+1,je.vnode&&je.vnode(i),Ol(n.__P,i,r,n.__n,n.__P.namespaceURI,32&r.__u?[o]:null,a,o??qi(r),!!(32&r.__u),s),i.__v=r.__v,i.__.__k[i.__i]=i,Xf(a,i,s),i.__e!=o&&Yf(i)),mi.length>t&&mi.sort(Gs));Jo.__r=0}function qf(e,t,n,i,r,o,a,s,l,c,p){var u,d,f,h,v,m=i&&i.__k||Uf,S=t.length;for(n.__d=l,$_(n,t,m),l=n.__d,u=0;u<S;u++)(f=n.__k[u])!=null&&(d=f.__i===-1?Or:m[f.__i]||Or,f.__i=u,Ol(e,f,d,r,o,a,s,l,c,p),h=f.__e,f.ref&&d.ref!=f.ref&&(d.ref&&Ll(d.ref,null,f),p.push(f.ref,f.__c||h,f)),v==null&&h!=null&&(v=h),65536&f.__u||d.__k===f.__k?l=Kf(f,l,e):typeof f.type=="function"&&f.__d!==void 0?l=f.__d:h&&(l=h.nextSibling),f.__d=void 0,f.__u&=-196609);n.__d=l,n.__e=v}function $_(e,t,n){var i,r,o,a,s,l=t.length,c=n.length,p=c,u=0;for(e.__k=[],i=0;i<l;i++)(r=t[i])!=null&&typeof r!="boolean"&&typeof r!="function"?(a=i+u,(r=e.__k[i]=typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?zo(null,r,null,null,null):Nl(r)?zo(Ca,{children:r},null,null,null):r.constructor===void 0&&r.__b>0?zo(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r).__=e,r.__b=e.__b+1,o=null,(s=r.__i=B_(r,n,a,p))!==-1&&(p--,(o=n[s])&&(o.__u|=131072)),o==null||o.__v===null?(s==-1&&u--,typeof r.type!="function"&&(r.__u|=65536)):s!==a&&(s==a-1?u--:s==a+1?u++:(s>a?u--:u++,r.__u|=65536))):r=e.__k[i]=null;if(p)for(i=0;i<c;i++)(o=n[i])!=null&&!(131072&o.__u)&&(o.__e==e.__d&&(e.__d=qi(o)),Zf(o,o))}function Kf(e,t,n){var i,r;if(typeof e.type=="function"){for(i=e.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=e,t=Kf(i[r],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=qi(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function B_(e,t,n,i){var r=e.key,o=e.type,a=n-1,s=n+1,l=t[n];if(l===null||l&&r==l.key&&o===l.type&&!(131072&l.__u))return n;if(i>(l!=null&&!(131072&l.__u)?1:0))for(;a>=0||s<t.length;){if(a>=0){if((l=t[a])&&!(131072&l.__u)&&r==l.key&&o===l.type)return a;a--}if(s<t.length){if((l=t[s])&&!(131072&l.__u)&&r==l.key&&o===l.type)return s;s++}}return-1}function Nu(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||L_.test(t)?n:n+"px"}function So(e,t,n,i,r){var o;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||Nu(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||Nu(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?i?n.u=i.u:(n.u=Ml,e.addEventListener(t,o?Ys:Ws,o)):e.removeEventListener(t,o?Ys:Ws,o);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Ou(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Ml++;else if(t.t<n.u)return;return n(je.event?je.event(t):t)}}}function Ol(e,t,n,i,r,o,a,s,l,c){var p,u,d,f,h,v,m,S,b,T,C,k,A,j,V,H,Y=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(l=!!(32&n.__u),o=[s=t.__e=n.__e]),(p=je.__b)&&p(t);e:if(typeof Y=="function")try{if(S=t.props,b="prototype"in Y&&Y.prototype.render,T=(p=Y.contextType)&&i[p.__c],C=p?T?T.props.value:p.__:i,n.__c?m=(u=t.__c=n.__c).__=u.__E:(b?t.__c=u=new Y(S,C):(t.__c=u=new Uo(S,C),u.constructor=Y,u.render=V_),T&&T.sub(u),u.props=S,u.state||(u.state={}),u.context=C,u.__n=i,d=u.__d=!0,u.__h=[],u._sb=[]),b&&u.__s==null&&(u.__s=u.state),b&&Y.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Vn({},u.__s)),Vn(u.__s,Y.getDerivedStateFromProps(S,u.__s))),f=u.props,h=u.state,u.__v=t,d)b&&Y.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),b&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(b&&Y.getDerivedStateFromProps==null&&S!==f&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(S,C),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(S,u.__s,C)===!1||t.__v===n.__v)){for(t.__v!==n.__v&&(u.props=S,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(U){U&&(U.__=t)}),k=0;k<u._sb.length;k++)u.__h.push(u._sb[k]);u._sb=[],u.__h.length&&a.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(S,u.__s,C),b&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(f,h,v)})}if(u.context=C,u.props=S,u.__P=e,u.__e=!1,A=je.__r,j=0,b){for(u.state=u.__s,u.__d=!1,A&&A(t),p=u.render(u.props,u.state,u.context),V=0;V<u._sb.length;V++)u.__h.push(u._sb[V]);u._sb=[]}else do u.__d=!1,A&&A(t),p=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++j<25);u.state=u.__s,u.getChildContext!=null&&(i=Vn(Vn({},i),u.getChildContext())),b&&!d&&u.getSnapshotBeforeUpdate!=null&&(v=u.getSnapshotBeforeUpdate(f,h)),qf(e,Nl(H=p!=null&&p.type===Ca&&p.key==null?p.props.children:p)?H:[H],t,n,i,r,o,a,s,l,c),u.base=t.__e,t.__u&=-161,u.__h.length&&a.push(u),m&&(u.__E=u.__=null)}catch(U){if(t.__v=null,l||o!=null){for(t.__u|=l?160:32;s&&s.nodeType===8&&s.nextSibling;)s=s.nextSibling;o[o.indexOf(s)]=null,t.__e=s}else t.__e=n.__e,t.__k=n.__k;je.__e(U,t,n)}else o==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=j_(n.__e,t,n,i,r,o,a,l,c);(p=je.diffed)&&p(t)}function Xf(e,t,n){t.__d=void 0;for(var i=0;i<n.length;i++)Ll(n[i],n[++i],n[++i]);je.__c&&je.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(o){o.call(r)})}catch(o){je.__e(o,r.__v)}})}function j_(e,t,n,i,r,o,a,s,l){var c,p,u,d,f,h,v,m=n.props,S=t.props,b=t.type;if(b==="svg"?r="http://www.w3.org/2000/svg":b==="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),o!=null){for(c=0;c<o.length;c++)if((f=o[c])&&"setAttribute"in f==!!b&&(b?f.localName===b:f.nodeType===3)){e=f,o[c]=null;break}}if(e==null){if(b===null)return document.createTextNode(S);e=document.createElementNS(r,b,S.is&&S),s&&(je.__m&&je.__m(t,o),s=!1),o=null}if(b===null)m===S||s&&e.data===S||(e.data=S);else{if(o=o&&Sa.call(e.childNodes),m=n.props||Or,!s&&o!=null)for(m={},c=0;c<e.attributes.length;c++)m[(f=e.attributes[c]).name]=f.value;for(c in m)if(f=m[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=f;else if(!(c in S)){if(c=="value"&&"defaultValue"in S||c=="checked"&&"defaultChecked"in S)continue;So(e,c,null,f,r)}}for(c in S)f=S[c],c=="children"?d=f:c=="dangerouslySetInnerHTML"?p=f:c=="value"?h=f:c=="checked"?v=f:s&&typeof f!="function"||m[c]===f||So(e,c,f,m[c],r);if(p)s||u&&(p.__html===u.__html||p.__html===e.innerHTML)||(e.innerHTML=p.__html),t.__k=[];else if(u&&(e.innerHTML=""),qf(e,Nl(d)?d:[d],t,n,i,b==="foreignObject"?"http://www.w3.org/1999/xhtml":r,o,a,o?o[0]:n.__k&&qi(n,0),s,l),o!=null)for(c=o.length;c--;)Gf(o[c]);s||(c="value",b==="progress"&&h==null?e.removeAttribute("value"):h!==void 0&&(h!==e[c]||b==="progress"&&!h||b==="option"&&h!==m[c])&&So(e,c,h,m[c],r),c="checked",v!==void 0&&v!==e[c]&&So(e,c,v,m[c],r))}return e}function Ll(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(r){je.__e(r,n)}}function Zf(e,t,n){var i,r;if(je.unmount&&je.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||Ll(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){je.__e(o,t)}i.base=i.__P=null}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&Zf(i[r],t,n||typeof e.type!="function");n||Gf(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function V_(e,t,n){return this.constructor(e,n)}function Qf(e,t,n){var i,r,o,a;je.__&&je.__(e,t),r=(i=typeof n=="function")?null:t.__k,o=[],a=[],Ol(t,e=(!i&&n||t).__k=Wf(Ca,null,[e]),r||Or,Or,t.namespaceURI,!i&&n?[n]:r?null:t.firstChild?Sa.call(t.childNodes):null,o,!i&&n?n:r?r.__e:t.firstChild,i,a),Xf(o,e,a)}Sa=Uf.slice,je={__e:function(e,t,n,i){for(var r,o,a;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(e)),a=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,i||{}),a=r.__d),a)return r.__E=r}catch(s){e=s}throw e}},Hf=0,Uo.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Vn({},this.state),typeof e=="function"&&(e=e(Vn({},n),this.props)),e&&Vn(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Mu(this))},Uo.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Mu(this))},Uo.prototype.render=Ca,mi=[],zf=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Gs=function(e,t){return e.__v.__b-t.__v.__b},Jo.__r=0,Ml=0,Ws=Ou(!1),Ys=Ou(!0);var Jf=function(e,t,n,i){var r;t[0]=0;for(var o=1;o<t.length;o++){var a=t[o++],s=t[o]?(t[0]|=a?1:2,n[t[o++]]):t[++o];a===3?i[0]=s:a===4?i[1]=Object.assign(i[1]||{},s):a===5?(i[1]=i[1]||{})[t[++o]]=s:a===6?i[1][t[++o]]+=s+"":a?(r=e.apply(s,Jf(e,s,n,["",null])),i.push(r),s[0]?t[0]|=2:(t[o-2]=0,t[o]=r)):i.push(s)}return i},Lu=new Map;function F_(e){var t=Lu.get(this);return t||(t=new Map,Lu.set(this,t)),(t=Jf(this,t.get(e)||(t.set(e,t=function(n){for(var i,r,o=1,a="",s="",l=[0],c=function(d){o===1&&(d||(a=a.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?l.push(0,d,a):o===3&&(d||a)?(l.push(3,d,a),o=2):o===2&&a==="..."&&d?l.push(4,d,0):o===2&&a&&!d?l.push(5,0,!0,a):o>=5&&((a||!d&&o===5)&&(l.push(o,0,a,r),o=6),d&&(l.push(o,d,0,r),o=6)),a=""},p=0;p<n.length;p++){p&&(o===1&&c(),c(p));for(var u=0;u<n[p].length;u++)i=n[p][u],o===1?i==="<"?(c(),l=[l],o=3):a+=i:o===4?a==="--"&&i===">"?(o=1,a=""):a=i+a[0]:s?i===s?s="":a+=i:i==='"'||i==="'"?s=i:i===">"?(c(),o=1):o&&(i==="="?(o=5,r=a,a=""):i==="/"&&(o<5||n[p][u+1]===">")?(c(),o===3&&(l=l[0]),o=l,(l=l[0]).push(2,0,o),o=0):i===" "||i==="	"||i===`
`||i==="\r"?(c(),o=2):a+=i),o===3&&a==="!--"&&(o=4,l=l[0])}return c(),l}(e)),t),arguments,[])).length>1?t:t[0]}var Ze=F_.bind(Wf),Ki,We,bs,$u,Lr=0,eh=[],Xe=je,Bu=Xe.__b,ju=Xe.__r,Vu=Xe.diffed,Fu=Xe.__c,Hu=Xe.unmount,zu=Xe.__;function Ta(e,t){Xe.__h&&Xe.__h(We,e,Lr||t),Lr=0;var n=We.__H||(We.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function Es(e){return Lr=1,H_(th,e)}function H_(e,t,n){var i=Ta(Ki++,2);if(i.t=e,!i.__c&&(i.__=[th(void 0,t),function(s){var l=i.__N?i.__N[0]:i.__[0],c=i.t(l,s);l!==c&&(i.__N=[c,i.__[1]],i.__c.setState({}))}],i.__c=We,!We.u)){var r=function(s,l,c){if(!i.__c.__H)return!0;var p=i.__c.__H.__.filter(function(d){return!!d.__c});if(p.every(function(d){return!d.__N}))return!o||o.call(this,s,l,c);var u=!1;return p.forEach(function(d){if(d.__N){var f=d.__[0];d.__=d.__N,d.__N=void 0,f!==d.__[0]&&(u=!0)}}),!(!u&&i.__c.props===s)&&(!o||o.call(this,s,l,c))};We.u=!0;var o=We.shouldComponentUpdate,a=We.componentWillUpdate;We.componentWillUpdate=function(s,l,c){if(this.__e){var p=o;o=void 0,r(s,l,c),o=p}a&&a.call(this,s,l,c)},We.shouldComponentUpdate=r}return i.__N||i.__}function xs(e,t){var n=Ta(Ki++,3);!Xe.__s&&Bl(n.__H,t)&&(n.__=e,n.i=t,We.__H.__h.push(n))}function ea(e,t){var n=Ta(Ki++,4);!Xe.__s&&Bl(n.__H,t)&&(n.__=e,n.i=t,We.__h.push(n))}function $l(e){return Lr=5,$r(function(){return{current:e}},[])}function $r(e,t){var n=Ta(Ki++,7);return Bl(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Fi(e,t){return Lr=8,$r(function(){return e},t)}function z_(){for(var e;e=eh.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Go),e.__H.__h.forEach(qs),e.__H.__h=[]}catch(t){e.__H.__h=[],Xe.__e(t,e.__v)}}Xe.__b=function(e){We=null,Bu&&Bu(e)},Xe.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),zu&&zu(e,t)},Xe.__r=function(e){ju&&ju(e),Ki=0;var t=(We=e.__c).__H;t&&(bs===We?(t.__h=[],We.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(t.__h.forEach(Go),t.__h.forEach(qs),t.__h=[],Ki=0)),bs=We},Xe.diffed=function(e){Vu&&Vu(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(eh.push(t)!==1&&$u===Xe.requestAnimationFrame||(($u=Xe.requestAnimationFrame)||U_)(z_)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),bs=We=null},Xe.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Go),n.__h=n.__h.filter(function(i){return!i.__||qs(i)})}catch(i){t.some(function(r){r.__h&&(r.__h=[])}),t=[],Xe.__e(i,n.__v)}}),Fu&&Fu(e,t)},Xe.unmount=function(e){Hu&&Hu(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Go(i)}catch(r){t=r}}),n.__H=void 0,t&&Xe.__e(t,n.__v))};var Uu=typeof requestAnimationFrame=="function";function U_(e){var t,n=function(){clearTimeout(i),Uu&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);Uu&&(t=requestAnimationFrame(n))}function Go(e){var t=We,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),We=t}function qs(e){var t=We;e.__c=e.__(),We=t}function Bl(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function th(e,t){return typeof t=="function"?t(e):t}function nh(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=nh(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function ta(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=nh(e))&&(i&&(i+=" "),i+=t);return i}function G_(e){const{entry:t,selected:n,onMouseEnter:i,onMouseLeave:r,onAction:o}=e;return Ze`
    <li
      class=${ta("entry",{selected:n})}
      data-id=${t.id}
      title=${t.title||t.label}
      onClick=${o}
      onMouseEnter=${i}
      onMouseLeave=${r}
      onDragStart=${a=>o(a,t,"dragstart")}
      draggable=${!0}
    >
      <div class="djs-popup-entry-content">
        <span
          class=${ta("djs-popup-entry-name",t.className)}
        >
          ${t.imageUrl&&Ze`<img class="djs-popup-entry-icon" src=${t.imageUrl} alt="" />`||t.imageHtml&&Ze`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:t.imageHtml}} />`}

          ${t.label?Ze`
            <span class="djs-popup-label">
              ${t.label}
            </span>
          `:null}
        </span>
        ${t.description&&Ze`
          <span
            class="djs-popup-entry-description"
            title=${t.description}
          >
            ${t.description}
          </span>
        `}
      </div>
      ${t.documentationRef&&Ze`
        <div class="djs-popup-entry-docs">
          <a
            href="${t.documentationRef}"
            onClick=${a=>a.stopPropagation()}
            title="Open element documentation"
            target="_blank"
            rel="noopener"
          >
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z" fill="#818798"/>
            </svg>
          </a>
        </div>
      `}
    </li>
  `}function W_(e){const{selectedEntry:t,setSelectedEntry:n,entries:i,...r}=e,o=$l(),a=$r(()=>Y_(i),[i]);return ea(()=>{const s=o.current;if(!s)return;const l=s.querySelector(".selected");l&&q_(l)},[t]),Ze`
    <div class="djs-popup-results" ref=${o}>
      ${a.map(s=>Ze`
        ${s.name&&Ze`
          <div key=${s.id} class="entry-header" title=${s.name}>
            ${s.name}
          </div>
        `}
        <ul class="djs-popup-group" data-group=${s.id}>
          ${s.entries.map(l=>Ze`
            <${G_}
              key=${l.id}
              entry=${l}
              selected=${l===t}
              onMouseEnter=${()=>n(l)}
              onMouseLeave=${()=>n(null)}
              ...${r}
            />
          `)}
        </ul>
      `)}
    </div>
  `}function Y_(e){const t=[],n=o=>t.find(a=>o.id===a.id),i=o=>!!n(o),r=o=>typeof o=="string"?{id:o}:o;return e.forEach(o=>{const a=o.group?r(o.group):{id:"default"};i(a)?n(a).entries.push(o):t.push({...a,entries:[o]})}),t}function q_(e){typeof e.scrollIntoViewIfNeeded=="function"?e.scrollIntoViewIfNeeded():e.scrollIntoView({scrollMode:"if-needed",block:"nearest"})}function K_(e){const{onClose:t,onSelect:n,className:i,headerEntries:r,position:o,title:a,width:s,scale:l,search:c,entries:p,onOpened:u,onClosed:d}=e,f=$r(()=>Tt(c)?p.length>5:!1,[c,p]),h=$l(),[v,m]=Es(""),S=Fi((U,ie)=>{if(!f)return U;const G=D=>{if(!ie)return(D.rank||0)>=0;if(D.searchable===!1)return!1;const O=[D.description||"",D.label||"",D.search||""].join("---").toLowerCase();return ie.toLowerCase().split(/\s/g).every(q=>O.includes(q))};return U.filter(G)},[f]),[b,T]=Es(S(p,v)),[C,k]=Es(b[0]),A=Fi(U=>{(!C||!U.includes(C))&&k(U[0]),T(U)},[C,T,k]);xs(()=>{A(S(p,v))},[v,p]),xs(()=>{const U=ie=>{if(ie.key==="Escape")return ie.preventDefault(),t()};return document.documentElement.addEventListener("keydown",U),()=>{document.documentElement.removeEventListener("keydown",U)}},[]),ea(()=>{h.current&&h.current.focus()},[]);const j=Fi(U=>{let G=b.indexOf(C)+U;G<0&&(G=b.length-1),G>=b.length&&(G=0),k(b[G])},[b,C,k]),V=Fi(U=>{if(U.key==="Enter"&&C)return n(U,C);if(U.key==="ArrowUp"||U.key==="Tab"&&U.shiftKey)return j(-1),U.preventDefault();if(U.key==="ArrowDown"||U.key==="Tab")return j(1),U.preventDefault()},[n,t,C,j]),H=Fi(U=>{_l(U.target,"input")&&m(()=>U.target.value)},[m]);xs(()=>(u(),()=>{d()}),[]);const Y=$r(()=>a||r.length>0,[a,r]);return Ze`
    <${Gu}
      onClose=${t}
      onKeyup=${H}
      onKeydown=${V}
      className=${i}
      position=${o}
      width=${s}
      scale=${l}
    >
      ${Y&&Ze`
        <div class="djs-popup-header">
          <h3 class="djs-popup-title" title=${a}>${a}</h3>
          ${r.map(U=>Ze`
            <span
              class=${Z_(U,U===C)}
              onClick=${ie=>n(ie,U)}
              title=${U.title||U.label}
              data-id=${U.id}
              onMouseEnter=${()=>k(U)}
              onMouseLeave=${()=>k(null)}
            >
            ${U.imageUrl&&Ze`<img class="djs-popup-entry-icon" src=${U.imageUrl} alt="" />`||U.imageHtml&&Ze`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:U.imageHtml}} />`}

              ${U.label?Ze`
                <span class="djs-popup-label">${U.label}</span>
              `:null}
            </span>
          `)}
        </div>
      `}
      ${p.length>0&&Ze`
        <div class="djs-popup-body">

          ${f&&Ze`
          <div class="djs-popup-search">
            <svg class="djs-popup-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>
            </svg>
            <input
                ref=${h}
                type="text"
              />
          </div>
          `}

          <${W_}
            entries=${b}
            selectedEntry=${C}
            setSelectedEntry=${k}
            onAction=${n}
          />
        </div>
        ${b.length===0&&Ze`
          <div class="djs-popup-no-results">No matching entries found.</div>
        `}
      `}
    </${Gu}>
  `}function Gu(e){const{onClose:t,onKeydown:n,onKeyup:i,className:r,children:o,position:a}=e,s=$l(),l=Fi(c=>{Yn(c.target,".djs-popup",!0)||t()},[t]);return ea(()=>{if(typeof a!="function")return;const c=s.current,p=a(c);c.style.left=`${p.x}px`,c.style.top=`${p.y}px`},[s.current,a]),ea(()=>{s.current&&s.current.focus()},[]),Ze`
    <div
      class="djs-popup-backdrop"
      onClick=${l}
    >
      <div
        class=${ta("djs-popup",r)}
        style=${X_(e)}
        onKeydown=${n}
        onKeyup=${i}
        ref=${s}
        tabIndex="-1"
      >
        ${o}
      </div>
    </div>
  `}function X_(e){return{transform:`scale(${e.scale})`,width:`${e.width}px`}}function Z_(e,t){return ta("entry",e.className,e.active?"active":"",e.disabled?"disabled":"",t?"selected":"")}var Q_="data-id",ih=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],J_=1e3;function Fe(e,t,n){this._eventBus=t,this._canvas=n,this._current=null;var i=Tt(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},t.on("diagram.destroy",()=>{this.close()}),t.on("element.changed",r=>{const o=this.isOpen()&&this._current.target;r.element===o&&this._render()})}Fe.$inject=["config.popupMenu","eventBus","canvas"];Fe.prototype._render=function(){const{position:e,className:t,entries:n,headerEntries:i,options:r}=this._current,o=Object.entries(n).map(([u,d])=>({id:u,...d})),a=Object.entries(i).map(([u,d])=>({id:u,...d})),s=e&&(u=>this._ensureVisible(u,e)),l=this._updateScale(this._current.container);Qf(Ze`
      <${K_}
        onClose=${u=>this.close(u)}
        onSelect=${(u,d,f)=>this.trigger(u,d,f)}
        position=${s}
        className=${t}
        entries=${o}
        headerEntries=${a}
        scale=${l}
        onOpened=${this._onOpened.bind(this)}
        onClosed=${this._onClosed.bind(this)}
        ...${{...r}}
      />
    `,this._current.container)};Fe.prototype.open=function(e,t,n,i){if(!e)throw new Error("target is missing");if(!t)throw new Error("providers for <"+t+"> not found");if(!n)throw new Error("position is missing");this.isOpen()&&this.close();const{entries:r,headerEntries:o}=this._getContext(e,t);this._current={position:n,className:t,target:e,entries:r,headerEntries:o,container:this._createContainer({provider:t}),options:i},this._emit("open"),this._bindAutoClose(),this._render()};Fe.prototype._getContext=function(e,t){const n=this._getProviders(t);if(!n||!n.length)throw new Error("provider for <"+t+"> not found");const i=this._getEntries(e,n),r=this._getHeaderEntries(e,n);return{entries:i,headerEntries:r,empty:!(Object.keys(i).length||Object.keys(r).length)}};Fe.prototype.close=function(){this.isOpen()&&(this._emit("close"),this.reset(),this._current=null)};Fe.prototype.reset=function(){const e=this._current.container;Qf(null,e),Wi(e)};Fe.prototype._emit=function(e,t){this._eventBus.fire(`popupMenu.${e}`,t)};Fe.prototype._onOpened=function(){this._emit("opened")};Fe.prototype._onClosed=function(){this._emit("closed")};Fe.prototype._createContainer=function(e){var t=this._canvas,n=t.getContainer();const i=rt(`<div class="djs-popup-parent djs-scrollable" data-popup=${e.provider}></div>`);return n.appendChild(i),i};Fe.prototype._bindAutoClose=function(){this._eventBus.once(ih,this.close,this)};Fe.prototype._unbindAutoClose=function(){this._eventBus.off(ih,this.close,this)};Fe.prototype._updateScale=function(){var e=this._canvas.zoom(),t=this._config.scale,n,i,r=e;return t!==!0&&(t===!1?(n=1,i=1):(n=t.min,i=t.max),Tt(n)&&e<n&&(r=n),Tt(i)&&e>i&&(r=i)),r};Fe.prototype._ensureVisible=function(e,t){var n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect(),r={},o=t.x,a=t.y;return t.x+i.width>n.width&&(r.x=!0),t.y+i.height>n.height&&(r.y=!0),r.x&&r.y?(o=t.x-i.width,a=t.y-i.height):r.x?(o=t.x-i.width,a=t.y):r.y&&t.y<i.height?(o=t.x,a=10):r.y&&(o=t.x,a=t.y-i.height),t.y<n.top&&(a=t.y+i.height),{x:o,y:a}};Fe.prototype.isEmpty=function(e,t){if(!e)throw new Error("target is missing");if(!t)throw new Error("provider ID is missing");const n=this._getProviders(t);return!n||!n.length?!0:this._getContext(e,t).empty};Fe.prototype.registerProvider=function(e,t,n){n||(n=t,t=J_),this._eventBus.on("popupMenu.getProviders."+e,t,function(i){i.providers.push(n)})};Fe.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers};Fe.prototype._getEntries=function(e,t){var n={};return I(t,function(i){if(!i.getPopupMenuEntries){I(i.getEntries(e),function(o){var a=o.id;if(!a)throw new Error("entry ID is missing");n[a]=bn(o,["id"])});return}var r=i.getPopupMenuEntries(e);rn(r)?n=r(n):I(r,function(o,a){n[a]=o})}),n};Fe.prototype._getHeaderEntries=function(e,t){var n={};return I(t,function(i){if(!i.getPopupMenuHeaderEntries){if(!i.getHeaderEntries)return;I(i.getHeaderEntries(e),function(o){var a=o.id;if(!a)throw new Error("entry ID is missing");n[a]=bn(o,["id"])});return}var r=i.getPopupMenuHeaderEntries(e);rn(r)?n=r(n):I(r,function(o,a){n[a]=o})}),n};Fe.prototype.isOpen=function(){return!!this._current};Fe.prototype.trigger=function(e,t,n="click"){if(e.preventDefault(),!t){let r=Yn(e.delegateTarget||e.target,".entry",!0),o=bt(r,Q_);t={id:o,...this._getEntry(o)}}const i=t.action;if(this._emit("trigger",{entry:t,event:e})!==!1){if(rn(i)){if(n==="click")return i(e,t)}else if(i[n])return i[n](e,t)}};Fe.prototype._getEntry=function(e){var t=this._current.entries[e]||this._current.headerEntries[e];if(!t)throw new Error("entry not found");return t};const jl={__init__:["popupMenu"],popupMenu:["type",Fe]};var rh={align:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 2000">
              <line x1="200" y1="150" x2="200" y2="1850" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
              <rect x="500" y="150" width="1300" height="700" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="500" y="1150" width="700" height="700" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,bottom:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="1650" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="350" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="850" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,center:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="900" y1="150" x2="900" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="250" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="500" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,left:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="100" y1="150" x2="100" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="100" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="100" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,right:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="1650" y1="150" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="350" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="850" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,top:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="150" x2="1650" y2="150" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="150" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="150" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,middle:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="900" x2="1650" y2="900" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="250" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="500" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`},eb=900;function nr(e,t,n,i){e.registerProvider(eb,this),this._contextPad=e,this._popupMenu=t,this._translate=n,this._canvas=i}nr.$inject=["contextPad","popupMenu","translate","canvas"];nr.prototype.getMultiElementContextPadEntries=function(e){var t={};return this._isAllowed(e)&&N(t,this._getEntries(e)),t};nr.prototype._isAllowed=function(e){return!this._popupMenu.isEmpty(e,"align-elements")};nr.prototype._getEntries=function(){var e=this;return{"align-elements":{group:"align-elements",title:e._translate("Align elements"),html:`<div class="entry">${rh.align}</div>`,action:{click:function(t,n){var i=e._getMenuPosition(n);N(i,{cursor:{x:t.x,y:t.y}}),e._popupMenu.open(n,"align-elements",i)}}}}};nr.prototype._getMenuPosition=function(e){var t=5,n=this._contextPad.getPad(e).html,i=n.getBoundingClientRect(),r={x:i.left,y:i.bottom+t};return r};var tb=["left","center","right","top","middle","bottom"];function Ur(e,t,n,i){this._alignElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",this)}Ur.$inject=["popupMenu","alignElements","translate","rules"];Ur.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&N(t,this._getEntries(e)),t};Ur.prototype._isAllowed=function(e){return this._rules.allowed("elements.align",{elements:e})};Ur.prototype._getEntries=function(e){var t=this._alignElements,n=this._translate,i=this._popupMenu,r={};return I(tb,function(o){r["align-elements-"+o]={group:"align",title:n("Align elements "+o),className:"bjs-align-elements-menu-entry",imageHtml:rh[o],action:function(){t.trigger(e,o),i.close()}}}),r};function $t(e){W.call(this,e),this.init()}$t.$inject=["eventBus"];te($t,W);$t.prototype.addRule=function(e,t,n){var i=this;typeof e=="string"&&(e=[e]),e.forEach(function(r){i.canExecute(r,t,function(o,a,s){return n(o)},!0)})};$t.prototype.init=function(){};function Pa(e){$t.call(this,e)}Pa.$inject=["eventBus"];te(Pa,$t);Pa.prototype.init=function(){this.addRule("elements.align",function(e){var t=e.elements,n=ye(t,function(i){return!(i.waypoints||i.host||i.labelTarget)});return n=va(n),n.length<2?!1:n})};const nb={__depends__:[D_,Ff,jl],__init__:["alignElementsContextPadProvider","alignElementsMenuProvider","bpmnAlignElements"],alignElementsContextPadProvider:["type",nr],alignElementsMenuProvider:["type",Ur],bpmnAlignElements:["type",Pa]};var ib=10,oh=50,rb=250;function Vl(e,t,n,i){for(var r;r=ob(e,n,t);)n=i(t,n,r);return n}function Fl(e){return function(t,n,i){var r={x:n.x,y:n.y};return["x","y"].forEach(function(o){var a=e[o];if(a){var s=o==="x"?"width":"height",l=a.margin,c=a.minDistance;l<0?r[o]=Math.min(i[o]+l-t[s]/2,n[o]-c+l):r[o]=Math.max(i[o]+i[s]+l+t[s]/2,n[o]+c+l)}}),r}}function ob(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},r=sb(e);return Oe(r,function(o){if(o===n)return!1;var a=dt(o,i,ib);return a==="intersect"})}function ab(e,t){t||(t={});function n(h){return h.source===e?1:-1}var i=t.defaultDistance||oh,r=t.direction||"e",o=t.filter,a=t.getWeight||n,s=t.maxDistance||rb,l=t.reference||"start";o||(o=ub);function c(h,v){return r==="n"?l==="start"?se(h).top-se(v).bottom:l==="center"?se(h).top-de(v).y:se(h).top-se(v).top:r==="w"?l==="start"?se(h).left-se(v).right:l==="center"?se(h).left-de(v).x:se(h).left-se(v).left:r==="s"?l==="start"?se(v).top-se(h).bottom:l==="center"?de(v).y-se(h).bottom:se(v).bottom-se(h).bottom:l==="start"?se(v).left-se(h).right:l==="center"?de(v).x-se(h).right:se(v).right-se(h).right}var p=e.incoming.filter(o).map(function(h){var v=a(h),m=v<0?c(h.source,e):c(e,h.source);return{id:h.source.id,distance:m,weight:v}}),u=e.outgoing.filter(o).map(function(h){var v=a(h),m=v>0?c(e,h.target):c(h.target,e);return{id:h.target.id,distance:m,weight:v}}),d=p.concat(u).reduce(function(h,v){return h[v.id+"__weight_"+v.weight]=v,h},{}),f=qn(d,function(h,v){var m=v.distance,S=v.weight;return m<0||m>s||(h[String(m)]||(h[String(m)]=0),h[String(m)]+=1*S,(!h.distance||h[h.distance]<h[String(m)])&&(h.distance=m)),h},{});return f.distance||i}function sb(e){var t=ws(e);return e.host&&(t=t.concat(ws(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce(function(n,i){return n.concat(ws(i))},[]))),t}function ws(e){return cb(e).concat(lb(e))}function lb(e){return e.incoming.map(function(t){return t.source})}function cb(e){return e.outgoing.map(function(t){return t.target})}function ub(){return!0}var pb=100;function ah(e,t,n){e.on("autoPlace",pb,function(i){var r=i.shape,o=i.source;return db(o,r)}),e.on("autoPlace.end",function(i){n.scrollToElement(i.shape)}),this.append=function(i,r,o){e.fire("autoPlace.start",{source:i,shape:r});var a=e.fire("autoPlace",{source:i,shape:r}),s=t.appendShape(i,r,a,i.parent,o);return e.fire("autoPlace.end",{source:i,shape:s}),s}}ah.$inject=["eventBus","modeling","canvas"];function db(e,t,n){n||(n={});var i=n.defaultDistance||oh,r=de(e),o=se(e);return{x:o.right+i+t.width/2,y:r.y}}function sh(e,t){e.on("autoPlace.end",500,function(n){t.select(n.shape)})}sh.$inject=["eventBus","selection"];const fb={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",ah],autoPlaceSelectionBehavior:["type",sh]};function na(e,t){for(ga(t)&&(t=[t]);e=e.parent;)if(ve(e,t))return e;return null}function lh(e,t){if(y(t,"bpmn:TextAnnotation"))return vb(e,t);if(ve(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return gb(e,t);if(y(t,"bpmn:FlowNode"))return hb(e,t)}function hb(e,t){var n=se(e),i=de(e),r=ab(e,{filter:function(p){return y(p,"bpmn:SequenceFlow")}}),o=30,a=80,s="left";y(e,"bpmn:BoundaryEvent")&&(s=dt(e,e.host,-25),s.indexOf("top")!==-1&&(o*=-1));var l={x:n.right+r+t.width/2,y:i.y+mb(s,a)},c={y:{margin:o,minDistance:a}};return Vl(e,t,l,Fl(c))}function mb(e,t){return e.includes("top")?-1*t:e.includes("bottom")?t:0}function vb(e,t){var n=se(e),i={x:n.right+t.width/2,y:n.top-50-t.height/2};De(e)&&(i=de(e),i.x+=100,i.y-=50);var r={y:{margin:-30,minDistance:20}};return Vl(e,t,i,Fl(r))}function gb(e,t){var n=se(e),i={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2},r={x:{margin:30,minDistance:30}};return Vl(e,t,i,Fl(r))}function ch(e){e.on("autoPlace",function(t){var n=t.shape,i=t.source;return lh(i,n)})}ch.$inject=["eventBus"];const Hl={__depends__:[fb],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",ch]};function wn(e,t,n,i){W.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(o){var a=o.context,s=a.hints||{},l=a.shape,c=a.parent||a.newParent;s.autoResize!==!1&&r._expand([l],c)}),this.postExecuted(["elements.move"],function(o){var a=o.context,s=Qo(El(a.closure.topLevel)),l=a.hints,c=l?l.autoResize:!0;if(c!==!1){var p=ya(s,function(u){return u.parent.id});I(p,function(u,d){Pe(c)&&(u=u.filter(function(f){return Oe(c,mn({id:f.id}))})),r._expand(u,d)})}}),this.postExecuted(["shape.toggleCollapse"],function(o){var a=o.context,s=a.hints,l=a.shape;s&&s.autoResize===!1||l.collapsed||r._expand(l.children||[],l)}),this.postExecuted(["shape.resize"],function(o){var a=o.context,s=a.hints,l=a.shape,c=l.parent;s&&s.autoResize===!1||c&&r._expand([l],c)})}wn.$inject=["eventBus","elementRegistry","modeling","rules"];te(wn,W);wn.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=se(Pt(e)),o=se(t),a={};return r.top-o.top<i.top&&(a.top=r.top-n.top),r.left-o.left<i.left&&(a.left=r.left-n.left),o.right-r.right<i.right&&(a.right=r.right+n.right),o.bottom-r.bottom<i.bottom&&(a.bottom=r.bottom+n.bottom),xl(N({},o,a))};wn.prototype._expand=function(e,t){typeof t=="string"&&(t=this._elementRegistry.get(t));var n=this._rules.allowed("element.autoResize",{elements:e,target:t});if(n){var i=this._getOptimalBounds(e,t);if(yb(i,t)){var r=_b(an(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:r});var o=t.parent;o&&this._expand([t],o)}}};wn.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}};wn.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}};wn.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};function yb(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function _b(e,t){var n="";return e=se(e),t=se(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}function Ra(e){e.invoke(wn,this)}Ra.$inject=["injector"];te(Ra,wn);Ra.prototype.resize=function(e,t,n){y(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};function Gr(e){$t.call(this,e);var t=this;this.addRule("element.autoResize",function(n){return t.canResize(n.elements,n.target)})}Gr.$inject=["eventBus"];te(Gr,$t);Gr.prototype.canResize=function(e,t){return!1};function ka(e,t){Gr.call(this,e),this._modeling=t}te(ka,Gr);ka.$inject=["eventBus","modeling"];ka.prototype.canResize=function(e,t){if(y(t.di,"bpmndi:BPMNPlane")||!y(t,"bpmn:Participant")&&!y(t,"bpmn:Lane")&&!y(t,"bpmn:SubProcess"))return!1;var n=!0;return I(e,function(i){if(y(i,"bpmn:Lane")||xe(i)){n=!1;return}}),n};const bb={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",Ra],bpmnAutoResizeProvider:["type",ka]};var Wu=1500;function uh(e,t,n){var i=this,r=n.get("dragging",!1);function o(a){if(!a.hover){var s=a.originalEvent,l=i._findTargetGfx(s),c=l&&e.get(l);l&&c&&(a.stopPropagation(),r.hover({element:c,gfx:l}),r.move(s))}}r&&t.on("drag.start",function(a){t.once("drag.move",Wu,function(s){o(s)})}),function(){var a,s;t.on("element.hover",function(l){a=l.gfx,s=l.element}),t.on("element.hover",Wu,function(l){s&&t.fire("element.out",{element:s,gfx:a})}),t.on("element.out",function(){a=null,s=null})}(),this._findTargetGfx=function(a){var s,l;if(a instanceof MouseEvent)return s=Hn(a),l=document.elementFromPoint(s.x,s.y),Eb(l)}}uh.$inject=["elementRegistry","eventBus","injector"];function Eb(e){return Yn(e,"svg, .djs-element",!0)}const xb={__init__:["hoverFix"],hoverFix:["type",uh]};var Mi=Math.round,Yu="djs-drag-active";function pi(e){e.preventDefault()}function wb(e){return typeof TouchEvent<"u"&&e instanceof TouchEvent}function Sb(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function ph(e,t,n,i){var r={threshold:5,trapClick:!0},o;function a(T){var C=t.viewbox(),k=t._container.getBoundingClientRect();return{x:C.x+(T.x-k.left)/C.scale,y:C.y+(T.y-k.top)/C.scale}}function s(T,C){C=C||o;var k=e.createEvent(N({},C.payload,C.data,{isTouch:C.isTouch}));return e.fire("drag."+T,k)===!1?!1:e.fire(C.prefix+"."+T,k)}function l(T){var C=T.filter(function(k){return i.get(k.id)});C.length&&n.select(C)}function c(T,C){var k=o.payload,A=o.displacement,j=o.globalStart,V=Hn(T),H=Gt(V,j),Y=o.localStart,U=a(V),ie=Gt(U,Y);if(!o.active&&(C||Sb(H)>o.threshold)){if(N(k,{x:Mi(Y.x+A.x),y:Mi(Y.y+A.y),dx:0,dy:0},{originalEvent:T}),s("start")===!1)return m();o.active=!0,o.keepSelection||(k.previousSelection=n.get(),n.select(null)),o.cursor&&wa(o.cursor),t.addMarker(t.getRootElement(),Yu)}gs(T),o.active&&(N(k,{x:Mi(U.x+A.x),y:Mi(U.y+A.y),dx:Mi(ie.x),dy:Mi(ie.y)},{originalEvent:T}),s("move"))}function p(T){var C,k=!0;o.active&&(T&&(o.payload.originalEvent=T,gs(T)),k=s("end")),k===!1&&s("rejected"),C=S(k!==!0),s("ended",C)}function u(T){nt("Escape",T)&&(pi(T),m())}function d(T){var C;o.active&&(C=If(e),setTimeout(C,400),pi(T)),p(T)}function f(T){c(T)}function h(T){var C=o.payload;C.hoverGfx=T.gfx,C.hover=T.element,s("hover")}function v(T){s("out");var C=o.payload;C.hoverGfx=null,C.hover=null}function m(T){var C;if(o){var k=o.active;k&&s("cancel"),C=S(T),k&&s("canceled",C)}}function S(T){var C,k;s("cleanup"),Df(),o.trapClick?k=d:k=p,ce.unbind(document,"mousemove",c),ce.unbind(document,"dragstart",pi),ce.unbind(document,"selectstart",pi),ce.unbind(document,"mousedown",k,!0),ce.unbind(document,"mouseup",k,!0),ce.unbind(document,"keyup",u),ce.unbind(document,"touchstart",f,!0),ce.unbind(document,"touchcancel",m,!0),ce.unbind(document,"touchmove",c,!0),ce.unbind(document,"touchend",p,!0),e.off("element.hover",h),e.off("element.out",v),t.removeMarker(t.getRootElement(),Yu);var A=o.payload.previousSelection;return T!==!1&&A&&!n.get().length&&l(A),C=o,o=null,C}function b(T,C,k,A){o&&m(!1),typeof C=="string"&&(A=k,k=C,C=null),A=N({},r,A||{});var j=A.data||{},V,H,Y,U,ie;A.trapClick?U=d:U=p,T?(V=lf(T)||T,H=Hn(T),gs(T),V.type==="dragstart"&&pi(V)):(V=null,H={x:0,y:0}),Y=a(H),C||(C=Y),ie=wb(V),o=N({prefix:k,data:j,payload:{},globalStart:H,displacement:Gt(C,Y),localStart:Y,isTouch:ie},A),A.manual||(ie?(ce.bind(document,"touchstart",f,!0),ce.bind(document,"touchcancel",m,!0),ce.bind(document,"touchmove",c,!0),ce.bind(document,"touchend",p,!0)):(ce.bind(document,"mousemove",c),ce.bind(document,"dragstart",pi),ce.bind(document,"selectstart",pi),ce.bind(document,"mousedown",U,!0),ce.bind(document,"mouseup",U,!0)),ce.bind(document,"keyup",u),e.on("element.hover",h),e.on("element.out",v)),s("init"),A.autoActivate&&c(T,!0)}e.on("diagram.destroy",m),this.init=b,this.move=c,this.hover=h,this.out=v,this.end=p,this.cancel=m,this.context=function(){return o},this.setOptions=function(T){N(r,T)}}ph.$inject=["eventBus","canvas","selection","elementRegistry"];const Sn={__depends__:[xb,En],dragging:["type",ph]};function ir(e,t,n){this._canvas=n,this._opts=N({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(r){var o=i._toBorderPoint(r);i.startScroll(o)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}ir.$inject=["config.autoScroll","eventBus","canvas"];ir.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),o=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var a=0,s=0,l=0;l<4;l++)Cb(o[l],n.scrollThresholdOut[l],n.scrollThresholdIn[l])&&(l===0?a=n.scrollStep:l==1?s=n.scrollStep:l==2?a=-n.scrollStep:l==3&&(s=-n.scrollStep));(a!==0||s!==0)&&(t.scroll({dx:a,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))};function Cb(e,t,n){return t<e&&e<n}ir.prototype.stopScroll=function(){clearTimeout(this._scrolling)};ir.prototype.setOptions=function(e){this._opts=N({},this._opts,e)};ir.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=Hn(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};const Tb={__depends__:[Sn],__init__:["autoScroll"],autoScroll:["type",ir]};function zl(e){this._commandStack=e.get("commandStack",!1)}zl.$inject=["injector"];zl.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),n===void 0?!0:n};const cn={__init__:["rules"],rules:["type",zl]};var Co=Math.round,Pb=Math.max;function Rb(e,t){var n=e.x,i=e.y;return[["M",n,i],["m",0,-t],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}function kb(e){var t=[];return e.forEach(function(n,i){t.push([i===0?"M":"L",n.x,n.y])}),t}var dh=10;function Ab(e,t){var n,i;for(n=0;i=e[n];n++)if(cf(i,t)<=dh)return{point:e[n],bendpoint:!0,index:n};return null}function Db(e,t){var n=pg(Rb(t,dh),kb(e)),i=n[0],r=n[n.length-1],o;return i?i!==r?i.segment2!==r.segment2?(o=Pb(i.segment2,r.segment2)-1,{point:e[o],bendpoint:!0,index:o}):{point:{x:Co(i.x+r.x)/2,y:Co(i.y+r.y)/2},index:i.segment2}:{point:{x:Co(i.x),y:Co(i.y)},index:i.segment2}:null}function Ks(e,t){return Ab(e,t)||Db(e,t)}function fh(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function qu(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function Ib(e,t){return t?{x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y}:e}function Mb(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}],r=i[0].n*t[0]+i[1].n*t[1],o=i[0].lambda*t[0]+i[1].lambda*t[1];return-r/o}function Ul(e,t){var n=t[0],i=t[1],r={x:i.x-n.x,y:i.y-n.y},o=Mb([n.x,n.y],[r.x,r.y],[e.x,e.y]);return{x:n.x+o*r.x,y:n.y+o*r.y}}function hh(e,t){var n=Ul(e,t),i={x:n.x-e.x,y:n.y-e.y};return fh(i)}function ia(e,t){return fh({x:e.x-t.x,y:e.y-t.y})}var mh="djs-bendpoint",vh="djs-segment-dragger";function Nb(e,t){var n=Hn(t),i=e._container.getBoundingClientRect(),r;r={x:i.left,y:i.top};var o=e.viewbox();return{x:o.x+(n.x-r.x)/o.scale,y:o.y+(n.y-r.y)/o.scale}}function Xs(e,t,n){var i=Nb(e,n),r=Ks(t,i);return r}function Zs(e,t){var n=Ee("g");Ne(n).add(mh),Te(e,n);var i=Ee("circle");pe(i,{cx:0,cy:0,r:4}),Ne(i).add("djs-visual"),Te(n,i);var r=Ee("circle");return pe(r,{cx:0,cy:0,r:10}),Ne(r).add("djs-hit"),Te(n,r),t&&Ne(n).add(t),n}function Ob(e,t,n,i){var r=Ee("g");Te(e,r);var o=18,a=6,s=11,l=$b(t,n,i),c=a+s,p=Ee("rect");pe(p,{x:-o/2,y:-a/2,width:o,height:a}),Ne(p).add("djs-visual"),Te(r,p);var u=Ee("rect");return pe(u,{x:-l/2,y:-c/2,width:l,height:c}),Ne(u).add("djs-hit"),Te(r,u),dg(r,i==="v"?90:0),r}function gh(e,t,n){var i=Ee("g"),r=js(t,n),o=hn(t,n);return Te(e,i),Ob(i,t,n,o),Ne(i).add(vh),Ne(i).add(o==="h"?"horizontal":"vertical"),mt(i,r.x,r.y),i}function Qs(e){return Math.abs(Math.round(e*2/3))}function Lb(e,t){var n=Bb(e,t);return Ul(e,n)}function $b(e,t,n){var i=t.x-e.x,r=t.y-e.y;return Qs(n==="h"?i:r)}function Bb(e,t){for(var n=t.waypoints,i=1/0,r,o=0;o<n.length-1;o++){var a=n[o],s=n[o+1],l=hh(e,[a,s]);l<i&&(i=l,r=o)}return[n[r],n[r+1]]}function yh(e,t,n,i,r){function o(T,C,k){var A=T.index,j=T.point,V,H,Y,U,ie,G;return A<=0||T.bendpoint?!1:(V=C[A-1],H=C[A],Y=js(V,H),U=hn(V,H),ie=Math.abs(j.x-Y.x),G=Math.abs(j.y-Y.y),U&&ie<=k&&G<=k)}function a(T,C){var k=T.waypoints,A,j,V,H;return C.index<=0||C.bendpoint||(A={start:k[C.index-1],end:k[C.index]},j=hn(A.start,A.end),!j)?null:(j==="h"?V=A.end.x-A.start.x:V=A.end.y-A.start.y,H=Qs(V)/2,H)}function s(T,C){var k=C.waypoints,A=Xs(t,k,T),j;if(A)return j=a(C,A),o(A,k,j)?r.start(T,C,A.index):i.start(T,C,A.index,!A.bendpoint),!0}function l(T,C,k){ce.bind(T,C,function(A){n.triggerMouseEvent(C,A,k),A.stopPropagation()})}function c(T,C){var k=t.getLayer("overlays"),A=ot('.djs-bendpoints[data-element-id="'+Dr(T.id)+'"]',k);return!A&&C&&(A=Ee("g"),pe(A,{"data-element-id":T.id}),Ne(A).add("djs-bendpoints"),Te(k,A),l(A,"mousedown",T),l(A,"click",T),l(A,"dblclick",T)),A}function p(T,C){return ot('.djs-segment-dragger[data-segment-idx="'+T+'"]',C)}function u(T,C){C.waypoints.forEach(function(k,A){var j=Zs(T);Te(T,j),mt(j,k.x,k.y)}),Zs(T,"floating")}function d(T,C){for(var k=C.waypoints,A,j,V,H=1;H<k.length;H++)A=k[H-1],j=k[H],hn(A,j)&&(V=gh(T,A,j),pe(V,{"data-segment-idx":H}),l(V,"mousemove",C))}function f(T){I(yu("."+mh,T),function(C){pt(C)})}function h(T){I(yu("."+vh,T),function(C){pt(C)})}function v(T){var C=c(T);return C||(C=c(T,!0),u(C,T),d(C,T)),C}function m(T){var C=c(T);C&&(h(C),f(C),d(C,T),u(C,T))}function S(T,C){var k=ot(".floating",T),A=C.point;k&&mt(k,A.x,A.y)}function b(T,C,k){var A=p(C.index,T),j=k[C.index-1],V=k[C.index],H=C.point,Y=js(j,V),U=hn(j,V),ie,G;A&&(ie=jb(A),G={x:H.x-Y.x,y:H.y-Y.y},U==="v"&&(G={x:G.y,y:G.x}),mt(ie,G.x,G.y))}e.on("connection.changed",function(T){m(T.element)}),e.on("connection.remove",function(T){var C=c(T.element);C&&pt(C)}),e.on("element.marker.update",function(T){var C=T.element,k;C.waypoints&&(k=v(C),T.add?Ne(k).add(T.marker):Ne(k).remove(T.marker))}),e.on("element.mousemove",function(T){var C=T.element,k=C.waypoints,A,j;if(k){if(A=c(C,!0),j=Xs(t,k,T.originalEvent),!j)return;S(A,j),j.bendpoint||b(A,j,k)}}),e.on("element.mousedown",function(T){if(wl(T)){var C=T.originalEvent,k=T.element;if(k.waypoints)return s(C,k)}}),e.on("selection.changed",function(T){var C=T.newSelection,k=C[0];k&&k.waypoints&&v(k)}),e.on("element.hover",function(T){var C=T.element;C.waypoints&&(v(C),n.registerEvent(T.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(T){n.unregisterEvent(T.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(T){var C=T.element,k=T.newId;if(C.waypoints){var A=c(C);A&&pe(A,{"data-element-id":k})}}),this.addHandles=v,this.updateHandles=m,this.getBendpointsContainer=c,this.getSegmentDragger=p}yh.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function jb(e){return ot(".djs-visual",e)}var Ku=Math.round,di="reconnectStart",fi="reconnectEnd",hr="updateWaypoints";function Gl(e,t,n,i,r,o){this._injector=e,this.start=function(a,s,l,c){var p=n.getGraphics(s),u=s.source,d=s.target,f=s.waypoints,h;!c&&l===0?h=di:!c&&l===f.length-1?h=fi:h=hr;var v=h===hr?"connection.updateWaypoints":"connection.reconnect",m=r.allowed(v,{connection:s,source:u,target:d});m===!1&&(m=r.allowed(v,{connection:s,source:d,target:u})),m!==!1&&i.init(a,"bendpoint.move",{data:{connection:s,connectionGfx:p,context:{allowed:m,bendpointIndex:l,connection:s,source:u,target:d,insert:c,type:h}}})},t.on("bendpoint.move.hover",function(a){var s=a.context,l=s.connection,c=l.source,p=l.target,u=a.hover,d=s.type;s.hover=u;var f;if(u){var h=d===hr?"connection.updateWaypoints":"connection.reconnect";if(f=s.allowed=r.allowed(h,{connection:l,source:d===di?u:c,target:d===fi?u:p}),f){s.source=d===di?u:c,s.target=d===fi?u:p;return}f===!1&&(f=s.allowed=r.allowed(h,{connection:l,source:d===fi?u:p,target:d===di?u:c})),f&&(s.source=d===fi?u:p,s.target=d===di?u:c)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(a){var s=a.context,l=s.type;s.hover=null,s.source=null,s.target=null,l!==hr&&(s.allowed=!1)}),t.on("bendpoint.move.end",function(a){var s=a.context,l=s.allowed,c=s.bendpointIndex,p=s.connection,u=s.insert,d=p.waypoints.slice(),f=s.source,h=s.target,v=s.type,m=s.hints||{},S={x:Ku(a.x),y:Ku(a.y)};if(!l)return!1;v===hr?(u?d.splice(c,0,S):d[c]=S,m.bendpointMove={insert:u,bendpointIndex:c},d=this.cropWaypoints(p,d),o.updateWaypoints(p,fg(d),m)):(v===di?(m.docking="source",ra(s)&&(m.docking="target",m.newWaypoints=d.reverse())):v===fi&&(m.docking="target",ra(s)&&(m.docking="source",m.newWaypoints=d.reverse())),o.reconnect(p,f,h,S,m))},this)}Gl.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];Gl.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};function ra(e){var t=e.hover,n=e.source,i=e.target,r=e.type;if(r===di)return t&&i&&t===i&&n!==i;if(r===fi)return t&&n&&t===n&&n!==i}var Vb="reconnectStart",Fb="reconnectEnd",Xu="updateWaypoints",mr="connect-ok",To="connect-not-ok",Zu="connect-hover",Qu="djs-updating",Ju="djs-dragging",ep=1100;function _h(e,t,n,i){this._injector=t;var r=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(o){var a=o.context,s=a.bendpointIndex,l=a.connection,c=a.insert,p=l.waypoints,u=p.slice();a.waypoints=p,c&&u.splice(s,0,{x:o.x,y:o.y}),l.waypoints=u;var d=a.draggerGfx=Zs(i.getLayer("overlays"));Ne(d).add("djs-dragging"),i.addMarker(l,Ju),i.addMarker(l,Qu)}),n.on("bendpoint.move.hover",function(o){var a=o.context,s=a.allowed,l=a.hover,c=a.type;if(l){if(i.addMarker(l,Zu),c===Xu)return;s?(i.removeMarker(l,To),i.addMarker(l,mr)):s===!1&&(i.removeMarker(l,mr),i.addMarker(l,To))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],ep,function(o){var a=o.context,s=a.hover,l=a.target;s&&(i.removeMarker(s,Zu),i.removeMarker(s,l?mr:To))}),n.on("bendpoint.move.move",function(o){var a=o.context,s=a.allowed,l=a.bendpointIndex,c=a.draggerGfx,p=a.hover,u=a.type,d=a.connection,f=d.source,h=d.target,v=d.waypoints.slice(),m={x:o.x,y:o.y},S=a.hints||{},b={};r&&(S.connectionStart&&(b.connectionStart=S.connectionStart),S.connectionEnd&&(b.connectionEnd=S.connectionEnd),u===Vb?ra(a)?(b.connectionEnd=b.connectionEnd||m,b.source=h,b.target=p||f,v=v.reverse()):(b.connectionStart=b.connectionStart||m,b.source=p||f,b.target=h):u===Fb?ra(a)?(b.connectionStart=b.connectionStart||m,b.source=p||h,b.target=f,v=v.reverse()):(b.connectionEnd=b.connectionEnd||m,b.source=f,b.target=p||h):(b.noCropping=!0,b.noLayout=!0,v[l]=m),u===Xu&&(v=e.cropWaypoints(d,v)),b.waypoints=v,r.drawPreview(a,s,b)),mt(c,o.x,o.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],ep,function(o){var a=o.context,s=a.connection,l=a.draggerGfx,c=a.hover,p=a.target,u=a.waypoints;s.waypoints=u,pt(l),i.removeMarker(s,Qu),i.removeMarker(s,Ju),c&&(i.removeMarker(c,mr),i.removeMarker(c,p?mr:To)),r&&r.cleanUp(a)})}_h.$inject=["bendpointMove","injector","eventBus","canvas"];var tp="connect-hover",np="djs-updating";function ip(e,t,n){return Wl(e,t,e[t]+n)}function Wl(e,t,n){return{x:t==="x"?n:e.x,y:t==="y"?n:e.y}}function Hb(e,t,n,i){var r=Math.max(t[i],n[i]),o=Math.min(t[i],n[i]),a=20,s=Math.min(Math.max(o+a,e[i]),r-a);return Wl(t,i,s)}function bh(e){return e==="x"?"y":"x"}function rp(e,t,n){var i,r;return e.original?e.original:(i=de(t),r=bh(n),Wl(e,r,i[r]))}function Eh(e,t,n,i,r,o){var a=e.get("connectionDocking",!1);this.start=function(u,d,f){var h,v=n.getGraphics(d),m=f-1,S=f,b=d.waypoints,T=b[m],C=b[S],k=Xs(n,b,u),A,j,V;A=hn(T,C),A&&(j=A==="v"?"x":"y",m===0&&(T=rp(T,d.source,j)),S===b.length-1&&(C=rp(C,d.target,j)),k?V=k.point:V={x:(T.x+C.x)/2,y:(T.y+C.y)/2},h={connection:d,segmentStartIndex:m,segmentEndIndex:S,segmentStart:T,segmentEnd:C,axis:j,dragPosition:V},i.init(u,V,"connectionSegment.move",{cursor:j==="x"?"resize-ew":"resize-ns",data:{connection:d,connectionGfx:v,context:h}}))};function s(u,d){if(!a)return d;var f=u.waypoints,h;return u.waypoints=d,h=a.getCroppedWaypoints(u),u.waypoints=f,h}function l(u){r.update("connection",u.connection,u.connectionGfx)}function c(u,d,f){var h=u.newWaypoints,v=u.segmentStartIndex+d,m=h[v],S=u.segmentEndIndex+d,b=h[S],T=bh(u.axis),C=Hb(f,m,b,T);mt(u.draggerGfx,C.x,C.y)}function p(u,d){var f=0,h=u.filter(function(v,m){return uf(u[m-1],u[m+1],v)?(f=m<=d?f-1:f,!1):!0});return{waypoints:h,segmentOffset:f}}t.on("connectionSegment.move.start",function(u){var d=u.context,f=u.connection,h=n.getLayer("overlays");d.originalWaypoints=f.waypoints.slice(),d.draggerGfx=gh(h,d.segmentStart,d.segmentEnd),Ne(d.draggerGfx).add("djs-dragging"),n.addMarker(f,np)}),t.on("connectionSegment.move.move",function(u){var d=u.context,f=d.connection,h=d.segmentStartIndex,v=d.segmentEndIndex,m=d.segmentStart,S=d.segmentEnd,b=d.axis,T=d.originalWaypoints.slice(),C=ip(m,b,u["d"+b]),k=ip(S,b,u["d"+b]),A=T.length,j=0;T[h]=C,T[v]=k;var V,H;h<2&&(V=dt(f.source,C),h===1?V==="intersect"&&(T.shift(),T[0]=C,j--):V!=="intersect"&&(T.unshift(m),j++)),v>A-3&&(H=dt(f.target,k),v===A-2?H==="intersect"&&(T.pop(),T[T.length-1]=k):H!=="intersect"&&T.push(S)),d.newWaypoints=f.waypoints=s(f,T),c(d,j,u),d.newSegmentStartIndex=h+j,l(u)}),t.on("connectionSegment.move.hover",function(u){u.context.hover=u.hover,n.addMarker(u.hover,tp)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(u){var d=u.context.hover;d&&n.removeMarker(d,tp)}),t.on("connectionSegment.move.cleanup",function(u){var d=u.context,f=d.connection;d.draggerGfx&&pt(d.draggerGfx),n.removeMarker(f,np)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(u){var d=u.context,f=d.connection;f.waypoints=d.originalWaypoints,l(u)}),t.on("connectionSegment.move.end",function(u){var d=u.context,f=d.connection,h=d.newWaypoints,v=d.newSegmentStartIndex;h=h.map(function(k){return{original:k.original,x:Math.round(k.x),y:Math.round(k.y)}});var m=p(h,v),S=m.waypoints,b=s(f,S),T=m.segmentOffset,C={segmentMove:{segmentStartIndex:d.segmentStartIndex,newSegmentStartIndex:v+T}};o.updateWaypoints(f,b,C)})}Eh.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var zb=Math.abs,op=Math.round;function Ub(e,t,n){n=n===void 0?10:n;var i,r;for(i=0;i<t.length;i++)if(r=t[i],zb(r-e)<=n)return r}function xh(e){return{x:e.x,y:e.y}}function wh(e){return{x:e.x+e.width,y:e.y+e.height}}function Nt(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:op(e.x+e.width/2),y:op(e.y+e.height/2)}}function Xi(e,t){var n=e.snapped;return n?typeof t=="string"?n[t]:n.x&&n.y:!1}function Ye(e,t,n){if(typeof t!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var i,r=e[t],o=e.snapped=e.snapped||{};return n===!1?o[t]=!1:(o[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i),r}function Sh(e){return e.children||[]}var Gb=Math.abs,ap=Math.round,Ss=10;function Ch(e){function t(o,a){if(Pe(o)){for(var s=o.length;s--;)if(Gb(o[s]-a)<=Ss)return o[s]}else{o=+o;var l=a%o;if(l<Ss)return a-l;if(l>o-Ss)return a-l+o}return a}function n(o,a){if(o.waypoints)return Lb(a,o);if(o.width)return{x:ap(o.width/2+o.x),y:ap(o.height/2+o.y)}}function i(o){var a=o.context,s=a.snapPoints,l=a.connection,c=l.waypoints,p=a.segmentStart,u=a.segmentStartIndex,d=a.segmentEnd,f=a.segmentEndIndex,h=a.axis;if(s)return s;var v=[c[u-1],p,d,c[f+1]];return u<2&&v.unshift(n(l.source,o)),f>c.length-3&&v.unshift(n(l.target,o)),a.snapPoints=s={horizontal:[],vertical:[]},I(v,function(m){m&&(m=m.original||m,h==="y"&&s.horizontal.push(m.y),h==="x"&&s.vertical.push(m.x))}),s}e.on("connectionSegment.move.move",1500,function(o){var a=i(o),s=o.x,l=o.y,c,p;if(a){c=t(a.vertical,s),p=t(a.horizontal,l);var u=s-c,d=l-p;N(o,{dx:o.dx-u,dy:o.dy-d,x:c,y:p}),(u||a.vertical.indexOf(s)!==-1)&&Ye(o,"x",c),(d||a.horizontal.indexOf(l)!==-1)&&Ye(o,"y",p)}});function r(o){var a=o.snapPoints,s=o.connection.waypoints,l=o.bendpointIndex;if(a)return a;var c=[s[l-1],s[l+1]];return o.snapPoints=a={horizontal:[],vertical:[]},I(c,function(p){p&&(p=p.original||p,a.horizontal.push(p.y),a.vertical.push(p.x))}),a}e.on(["connect.hover","connect.move","connect.end"],1500,function(o){var a=o.context,s=a.hover,l=s&&n(s,o);!De(s)||!l||!l.x||!l.y||(Ye(o,"x",l.x),Ye(o,"y",l.y))}),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(o){var a=o.context,s=r(a),l=a.hover,c=l&&n(l,o),p=o.x,u=o.y,d,f;if(s){d=t(c?s.vertical.concat([c.x]):s.vertical,p),f=t(c?s.horizontal.concat([c.y]):s.horizontal,u);var h=p-d,v=u-f;N(o,{dx:o.dx-h,dy:o.dy-v,x:o.x-h,y:o.y-v}),(h||s.vertical.indexOf(p)!==-1)&&Ye(o,"x",d),(v||s.horizontal.indexOf(u)!==-1)&&Ye(o,"y",f)}})}Ch.$inject=["eventBus"];const Wb={__depends__:[Sn,cn],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",yh],bendpointMove:["type",Gl],bendpointMovePreview:["type",_h],connectionSegmentMove:["type",Eh],bendpointSnapping:["type",Ch]};function Th(e,t,n,i){function r(a,s){return i.allowed("connection.create",{source:a,target:s})}function o(a,s){return r(s,a)}e.on("connect.hover",function(a){var s=a.context,l=s.start,c=a.hover,p;if(s.hover=c,p=s.canExecute=r(l,c),!Vs(p)){if(p!==!1){s.source=l,s.target=c;return}p=s.canExecute=o(l,c),!Vs(p)&&p!==!1&&(s.source=c,s.target=l)}}),e.on(["connect.out","connect.cleanup"],function(a){var s=a.context;s.hover=null,s.source=null,s.target=null,s.canExecute=!1}),e.on("connect.end",function(a){var s=a.context,l=s.canExecute,c=s.connectionStart,p={x:a.x,y:a.y},u=s.source,d=s.target;if(!l)return!1;var f=null,h={connectionStart:Js(s)?p:c,connectionEnd:Js(s)?c:p};yn(l)&&(f=l),s.connection=n.connect(u,d,f,h)}),this.start=function(a,s,l,c){yn(l)||(c=l,l=de(s)),t.init(a,"connect",{autoActivate:c,data:{shape:s,context:{start:s,connectionStart:l}}})}}Th.$inject=["eventBus","dragging","modeling","rules"];function Js(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}var Yb=1100,qb=900,sp="connect-ok",lp="connect-not-ok";function Ph(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(r){var o=r.context,a=o.canExecute,s=o.hover,l=o.source,c=o.start,p=o.startPosition,u=o.target,d=o.connectionStart||p,f=o.connectionEnd||{x:r.x,y:r.y},h=d,v=f;Js(o)&&(h=f,v=d),i.drawPreview(o,a,{source:l||c,target:u||s,connectionStart:h,connectionEnd:v})}),t.on("connect.hover",qb,function(r){var o=r.context,a=r.hover,s=o.canExecute;s!==null&&n.addMarker(a,s?sp:lp)}),t.on(["connect.out","connect.cleanup"],Yb,function(r){var o=r.hover;o&&(n.removeMarker(o,sp),n.removeMarker(o,lp))}),i&&t.on("connect.cleanup",function(r){i.cleanUp(r.context)})}Ph.$inject=["injector","eventBus","canvas"];const Yl={__depends__:[En,cn,Sn],__init__:["connectPreview"],connect:["type",Th],connectPreview:["type",Ph]};var Kb="djs-dragger";function Cn(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}Cn.$inject=["injector","canvas","graphicsFactory","elementFactory"];Cn.prototype.drawPreview=function(e,t,n){n=n||{};var i=e.connectionPreviewGfx,r=e.getConnection,o=n.source,a=n.target,s=n.waypoints,l=n.connectionStart,c=n.connectionEnd,p=n.noLayout,u=n.noCropping,d=n.noNoop,f,h=this;if(i||(i=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),Sl(i),r||(r=e.getConnection=Xb(function(v,m,S){return h.getConnection(v,m,S)})),t&&(f=r(t,o,a)),!f){!d&&this.drawNoopPreview(i,n);return}f.waypoints=s||[],this._layouter&&!p&&(f.waypoints=this._layouter.layoutConnection(f,{source:o,target:a,connectionStart:l,connectionEnd:c,waypoints:n.waypoints||f.waypoints})),(!f.waypoints||!f.waypoints.length)&&(f.waypoints=[o?de(o):l,a?de(a):c]),this._connectionDocking&&(o||a)&&!u&&(f.waypoints=this._connectionDocking.getCroppedWaypoints(f,o,a)),this._graphicsFactory.drawConnection(i,f,{stroke:"var(--element-dragger-color)"})};Cn.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,r=t.connectionStart||de(n),o=t.connectionEnd||de(i),a=this.cropWaypoints(r,o,n,i),s=this.createNoopConnection(a[0],a[1]);Te(e,s)};Cn.prototype.cropWaypoints=function(e,t,n,i){var r=this._graphicsFactory,o=n&&r.getShapePath(n),a=i&&r.getShapePath(i),s=r.getConnectionPath({waypoints:[e,t]});return e=n&&Fs(o,s,!0)||e,t=i&&Fs(a,s,!1)||t,[e,t]};Cn.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&pt(e.connectionPreviewGfx)};Cn.prototype.getConnection=function(e){var t=Zb(e);return this._elementFactory.createConnection(t)};Cn.prototype.createConnectionPreviewGfx=function(){var e=Ee("g");return pe(e,{pointerEvents:"none"}),Ne(e).add(Kb),Te(this._canvas.getActiveLayer(),e),e};Cn.prototype.createNoopConnection=function(e,t){return hg([e,t],{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"})};function Xb(e){var t={};return function(n){var i=JSON.stringify(n),r=t[i];return r||(r=t[i]=e.apply(null,arguments)),r}}function Zb(e){return yn(e)?e:{}}const Qb={__init__:["connectionPreview"],connectionPreview:["type",Cn]};var Jb=["marker-start","marker-mid","marker-end"],eE=["circle","ellipse","line","path","polygon","polyline","path","rect"];function Kn(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;t.on("drag.cleanup",function(){r.cleanUp()})}Kn.$inject=["elementRegistry","eventBus","canvas","styles"];Kn.prototype.cleanUp=function(){var e=this;I(e._clonedMarkers,function(t){pt(t)}),e._clonedMarkers={}};Kn.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)};Kn.prototype.addDragger=function(e,t,n,i="djs-dragger"){n=n||this.getGfx(e);var r=pf(n),o=n.getBoundingClientRect();return this._cloneMarkers(Gi(r),i),pe(r,this._styles.cls(i,[],{x:o.top,y:o.left})),Te(t,r),pe(r,"data-preview-support-element-id",e.id),r};Kn.prototype.addFrame=function(e,t){var n=Ee("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return Te(t,n),pe(n,"data-preview-support-element-id",e.id),n};Kn.prototype._cloneMarkers=function(e,t="djs-dragger"){var n=this;if(e.childNodes)for(var i=0;i<e.childNodes.length;i++)n._cloneMarkers(e.childNodes[i],t);rE(e)&&Jb.forEach(function(r){if(pe(e,r)){var o=tE(e,r,n._canvas.getContainer());n._cloneMarker(e,o,r,t)}})};Kn.prototype._cloneMarker=function(e,t,n,i="djs-dragger"){var r=t.id+"-"+i,o=this._clonedMarkers[r];if(!o){o=pf(t);var a=r+"-clone";o.id=a,Ne(o).add(i),this._clonedMarkers[r]=o;var s=ot("defs",this._canvas._svg);s||(s=Ee("defs"),Te(this._canvas._svg,s)),Te(s,o)}var l=iE(this._clonedMarkers[r].id);pe(e,n,l)};function tE(e,t,n){var i=nE(pe(e,t));return ot("marker#"+i,n||document)}function nE(e){return e.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function iE(e){return"url(#"+e+")"}function rE(e){return eE.indexOf(e.nodeName)!==-1}const rr={__init__:["previewSupport"],previewSupport:["type",Kn]},Po="complex-preview";class Rh{constructor(t,n,i){this._canvas=t,this._graphicsFactory=n,this._previewSupport=i,this._markers=[]}create(t){this.cleanUp();const{created:n=[],moved:i=[],removed:r=[],resized:o=[]}=t,a=this._canvas.getLayer(Po);n.filter(s=>!oE(s)).forEach(s=>{let l;De(s)?(l=this._graphicsFactory._createContainer("connection",Ee("g")),this._graphicsFactory.drawConnection(Gi(l),s)):(l=this._graphicsFactory._createContainer("shape",Ee("g")),this._graphicsFactory.drawShape(Gi(l),s),mt(l,s.x,s.y)),this._previewSupport.addDragger(s,a,l)}),i.forEach(({element:s,delta:l})=>{this._previewSupport.addDragger(s,a,void 0,"djs-dragging"),this._canvas.addMarker(s,"djs-element-hidden"),this._markers.push([s,"djs-element-hidden"]);const c=this._previewSupport.addDragger(s,a);De(s)?mt(c,l.x,l.y):mt(c,s.x+l.x,s.y+l.y)}),r.forEach(s=>{this._previewSupport.addDragger(s,a,void 0,"djs-dragging"),this._canvas.addMarker(s,"djs-element-hidden"),this._markers.push([s,"djs-element-hidden"])}),o.forEach(({shape:s,bounds:l})=>{this._canvas.addMarker(s,"djs-hidden"),this._markers.push([s,"djs-hidden"]),this._previewSupport.addDragger(s,a,void 0,"djs-dragging");const c=this._graphicsFactory._createContainer("shape",Ee("g"));this._graphicsFactory.drawShape(Gi(c),s,{width:l.width,height:l.height}),mt(c,l.x,l.y),this._previewSupport.addDragger(s,a,c)})}cleanUp(){Sl(this._canvas.getLayer(Po)),this._markers.forEach(([t,n])=>this._canvas.removeMarker(t,n)),this._markers=[],this._previewSupport.cleanUp()}show(){this._canvas.showLayer(Po)}hide(){this._canvas.hideLayer(Po)}}Rh.$inject=["canvas","graphicsFactory","previewSupport"];function oE(e){return e.hidden}const aE={__depends__:[rr],__init__:["complexPreview"],complexPreview:["type",Rh]};var ql=["top","bottom","left","right"],Ro=10;function Kl(e,t){W.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(r){var o=r.context,a=o.connection,s=a.source,l=a.target,c=o.hints||{};c.createElementsBehavior!==!1&&(n(s),n(l))}),this.postExecuted(["label.create"],function(r){var o=r.context,a=o.shape,s=o.hints||{};s.createElementsBehavior!==!1&&n(a.labelTarget)}),this.postExecuted(["elements.create"],function(r){var o=r.context,a=o.elements,s=o.hints||{};s.createElementsBehavior!==!1&&a.forEach(function(l){n(l)})});function n(r){if(_a(r)){var o=cE(r);o&&i(r,o)}}function i(r,o){var a=de(r),s=r.label,l=de(s);if(s.parent){var c=se(r),p;switch(o){case"top":p={x:a.x,y:c.top-Ro-s.height/2};break;case"left":p={x:c.left-Ro-s.width/2,y:a.y};break;case"bottom":p={x:a.x,y:c.bottom+Ro+s.height/2};break;case"right":p={x:c.right+Ro+s.width/2,y:a.y};break}var u=Gt(p,l);t.moveShape(s,u)}}}te(Kl,W);Kl.$inject=["eventBus","modeling"];function sE(e){var t=e.host,n=de(e),i=dt(n,t),r;i.indexOf("-")>=0?r=i.split("-"):r=[i];var o=ql.filter(function(a){return r.indexOf(a)===-1});return o}function lE(e){var t=de(e),n=[].concat(e.incoming.map(function(i){return i.waypoints[i.waypoints.length-2]}),e.outgoing.map(function(i){return i.waypoints[1]})).map(function(i){return kh(t,i)});return n}function cE(e){var t=de(e.label),n=de(e),i=kh(n,t);if(uE(i)){var r=lE(e);if(e.host){var o=sE(e);r=r.concat(o)}var a=ql.filter(function(s){return r.indexOf(s)===-1});if(a.indexOf(i)===-1)return a[0]}}function kh(e,t){return dt(t,e,5)}function uE(e){return ql.indexOf(e)!==-1}function Xl(e){W.call(this,e),this.preExecute("shape.append",function(t){var n=t.source,i=t.shape;t.position||(y(i,"bpmn:TextAnnotation")?t.position={x:n.x+n.width/2+75,y:n.y-50-i.height/2}:t.position={x:n.x+n.width+80+i.width/2,y:n.y+n.height/2})},!0)}te(Xl,W);Xl.$inject=["eventBus"];function Zl(e,t){e.invoke(W,this),this.postExecute("shape.move",function(n){var i=n.newParent,r=n.shape,o=ye(r.incoming.concat(r.outgoing),function(a){return y(a,"bpmn:Association")});I(o,function(a){t.moveConnection(a,{x:0,y:0},i)})},!0)}te(Zl,W);Zl.$inject=["injector","modeling"];var cp=500;function Aa(e,t){t.invoke(W,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",cp,function(i){var r=i.elements;r=r.filter(function(o){var a=o.host;return up(o,a)}),r.length===1&&r.map(function(o){return r.indexOf(o)}).forEach(function(o){var a=r[o];i.elements[o]=n._replaceShape(r[o],a)})},!0),this.preExecute("elements.move",cp,function(i){var r=i.shapes,o=i.newHost;if(r.length===1){var a=r[0];up(a,o)&&(i.shapes=[n._replaceShape(a,o)])}},!0)}Aa.$inject=["bpmnReplace","injector"];te(Aa,W);Aa.prototype._replaceShape=function(e,t){var n=pE(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})};function pE(e){var t=Z(e),n=t.eventDefinitions;return n&&n[0]}function up(e,t){return!xe(e)&&ve(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function Ql(e,t){W.call(this,e);function n(i){return ye(i.attachers,function(r){return y(r,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(i){var r=i.context.source,o=i.context.target,a=n(o);y(r,"bpmn:EventBasedGateway")&&y(o,"bpmn:ReceiveTask")&&a.length>0&&t.removeElements(a)}),this.postExecute("connection.reconnect",function(i){var r=i.context.oldSource,o=i.context.newSource;y(r,"bpmn:Gateway")&&y(o,"bpmn:EventBasedGateway")&&I(o.outgoing,function(a){var s=a.target,l=n(s);y(s,"bpmn:ReceiveTask")&&l.length>0&&t.removeElements(l)})})}Ql.$inject=["eventBus","modeling"];te(Ql,W);function Jl(e,t,n){W.call(this,e),this.preExecute("shape.replace",s,!0),this.postExecuted("shape.replace",l,!0),this.preExecute("connection.create",r,!0),this.postExecuted("connection.delete",i,!0),this.postExecuted("connection.reconnect",o,!0),this.postExecuted("element.updateProperties",a,!0);function i(m){const S=m.source,b=m.target;Ni(S)&&vr(b)&&p(b)}function r(m){const S=m.connection,b=m.source,T=m.target;Ni(b)&&ko(T)&&(c(T),d(b,[S]))}function o(m){const S=m.newTarget,b=m.oldSource,T=m.oldTarget;if(T!==S){const C=b;vr(T)&&p(T),Ni(C)&&ko(S)&&c(S)}}function a(m){const{element:S}=m;vr(S)?(u(S),f(S)):ko(S)&&h(S)}function s(m){const{newData:S,oldShape:b}=m;if(Ni(m.oldShape)&&S.eventDefinitionType!=="bpmn:CompensateEventDefinition"||S.type!=="bpmn:BoundaryEvent"){const T=b.outgoing.find(({target:C})=>vr(C));T&&T.target&&(m._connectionTarget=T.target)}else if(!Ni(m.oldShape)&&S.eventDefinitionType==="bpmn:CompensateEventDefinition"&&S.type==="bpmn:BoundaryEvent"){const T=b.outgoing.find(({target:C})=>ko(C));T&&T.target&&(m._connectionTarget=T.target),v(b)}}function l(m){const{_connectionTarget:S,newShape:b}=m;S&&t.connect(b,S)}function c(m){t.updateProperties(m,{isForCompensation:!0})}function p(m){t.updateProperties(m,{isForCompensation:void 0})}function u(m){for(const S of m.incoming)n.canConnect(S.source,m)||t.removeConnection(S);for(const S of m.outgoing)n.canConnect(m,S.target)||t.removeConnection(S)}function d(m,S){m.outgoing.filter(C=>y(C,"bpmn:Association")).filter(C=>vr(C.target)&&!S.includes(C)).forEach(C=>t.removeConnection(C))}function f(m){const S=m.attachers.slice();S.length&&t.removeElements(S)}function h(m){const S=m.incoming.filter(b=>Ni(b.source));t.removeElements(S)}function v(m){const S=m.outgoing.filter(b=>y(b,"bpmn:SequenceFlow"));t.removeElements(S)}}te(Jl,W);Jl.$inject=["eventBus","modeling","bpmnRules"];function vr(e){const t=Z(e);return t&&t.get("isForCompensation")}function Ni(e){return e&&y(e,"bpmn:BoundaryEvent")&&df(e,"bpmn:CompensateEventDefinition")}function ko(e){return e&&y(e,"bpmn:Activity")&&!vt(e)}function ec(e){e.invoke(W,this),this.preExecute("shape.create",1500,function(t){var n=t.context,i=n.parent,r=n.shape;y(i,"bpmn:Lane")&&!y(r,"bpmn:Lane")&&(n.parent=na(i,"bpmn:Participant"))})}ec.$inject=["injector"];te(ec,W);function tc(e,t){W.call(this,e),this.preExecute("shape.create",function(n){var i=n.context,r=i.shape;if(y(r,"bpmn:DataObjectReference")&&r.type!=="label"){var o=t.create("bpmn:DataObject");r.businessObject.dataObjectRef=o}})}tc.$inject=["eventBus","bpmnFactory"];te(tc,W);var el=20,tl=20,Ah=30,Ao=2e3;function nc(e,t,n){W.call(this,t),t.on(["create.start","shape.move.start"],Ao,function(r){var o=r.context,a=o.shape,s=e.getRootElement();if(!(!y(a,"bpmn:Participant")||!y(s,"bpmn:Process")||!s.children.length)){var l=s.children.filter(function(u){return!y(u,"bpmn:Group")&&!xe(u)&&!De(u)});if(l.length){var c=Pt(l),p=dE(a,c);N(a,p),o.createConstraints=fE(a,c)}}}),t.on("create.start",Ao,function(r){var o=r.context,a=o.shape,s=e.getRootElement(),l=e.getGraphics(s);function c(p){p.element=s,p.gfx=l}y(a,"bpmn:Participant")&&y(s,"bpmn:Process")&&(t.on("element.hover",Ao,c),t.once("create.cleanup",function(){t.off("element.hover",c)}))});function i(){var r=e.getRootElement();return y(r,"bpmn:Collaboration")?r:n.makeCollaboration()}this.preExecute("elements.create",Ao,function(r){var o=r.elements,a=r.parent,s=hE(o),l;s&&y(a,"bpmn:Process")&&(r.parent=i(),l=r.hints=r.hints||{},l.participant=s,l.process=a,l.processRef=Z(s).get("processRef"))},!0),this.preExecute("shape.create",function(r){var o=r.parent,a=r.shape;y(a,"bpmn:Participant")&&y(o,"bpmn:Process")&&(r.parent=i(),r.process=o,r.processRef=Z(a).get("processRef"))},!0),this.execute("shape.create",function(r){var o=r.hints||{},a=r.process||o.process,s=r.shape,l=o.participant;a&&(!l||s===l)&&Z(s).set("processRef",Z(a))},!0),this.revert("shape.create",function(r){var o=r.hints||{},a=r.process||o.process,s=r.processRef||o.processRef,l=r.shape,c=o.participant;a&&(!c||l===c)&&Z(l).set("processRef",s)},!0),this.postExecute("shape.create",function(r){var o=r.hints||{},a=r.process||r.hints.process,s=r.shape,l=o.participant;if(a){var c=a.children.slice();l?s===l&&n.moveElements(c,{x:0,y:0},l):n.moveElements(c,{x:0,y:0},s)}},!0)}nc.$inject=["canvas","eventBus","modeling"];te(nc,W);function dE(e,t){t={width:t.width+el*2+Ah,height:t.height+tl*2};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}function fE(e,t){return t=se(t),{bottom:t.top+e.height/2-tl,left:t.right-e.width/2+el,top:t.bottom-e.height/2+tl,right:t.left+e.width/2-el-Ah}}function hE(e){return Oe(e,function(t){return y(t,"bpmn:Participant")})}var pp="__targetRef_placeholder";function ic(e,t){W.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],dp(o)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],dp(o));function n(a,s,l){var c=a.get("dataInputAssociations");return Oe(c,function(p){return p!==l&&p.targetRef===s})}function i(a,s){var l=a.get("properties"),c=Oe(l,function(p){return p.name===pp});return!c&&s&&(c=t.create("bpmn:Property",{name:pp}),tt(l,c)),c}function r(a,s){var l=i(a);l&&(n(a,l,s)||Qe(a.get("properties"),l))}function o(a){var s=a.context,l=s.connection,c=l.businessObject,p=l.target,u=p&&p.businessObject,d=s.newTarget,f=d&&d.businessObject,h=s.oldTarget||s.target,v=h&&h.businessObject,m=l.businessObject,S;v&&v!==u&&r(v,c),f&&f!==u&&r(f,c),u?(S=i(u,!0),m.targetRef=S):m.targetRef=null}}ic.$inject=["eventBus","bpmnFactory"];te(ic,W);function dp(e){return function(t){var n=t.context,i=n.connection;if(y(i,"bpmn:DataInputAssociation"))return e(t)}}function Da(e){this._bpmnUpdater=e}Da.$inject=["bpmnUpdater"];Da.prototype.execute=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.newSemanticParent,r=e.newDiParent;return e.oldSemanticParent=t.$parent,e.oldDiParent=n.$parent,this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,r),[]};Da.prototype.revert=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.oldSemanticParent,r=e.oldDiParent;return this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,r),[]};function rc(e,t,n,i){W.call(this,i),t.registerHandler("dataStore.updateContainment",Da);function r(){return n.filter(function(s){return y(s,"bpmn:Participant")&&Z(s).processRef})[0]}function o(s){return s.children.filter(function(l){return y(l,"bpmn:DataStoreReference")&&!l.labelTarget})}function a(s,l){var c=s.businessObject||s;if(l=l||r(),l){var p=l.businessObject||l;t.execute("dataStore.updateContainment",{dataStoreBo:c,dataStoreDi:Ie(s),newSemanticParent:p.processRef||p,newDiParent:Ie(l)})}}this.preExecute("shape.create",function(s){var l=s.context,c=l.shape;y(c,"bpmn:DataStoreReference")&&c.type!=="label"&&(l.hints||(l.hints={}),l.hints.autoResize=!1)}),this.preExecute("elements.move",function(s){var l=s.context,c=l.shapes,p=c.filter(function(u){return y(u,"bpmn:DataStoreReference")});p.length&&(l.hints||(l.hints={}),l.hints.autoResize=c.filter(function(u){return!y(u,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(s){var l=s.context,c=l.shape,p=c.parent;y(c,"bpmn:DataStoreReference")&&c.type!=="label"&&y(p,"bpmn:Collaboration")&&a(c)}),this.postExecute("shape.move",function(s){var l=s.context,c=l.shape,p=l.oldParent,u=c.parent;if(!y(p,"bpmn:Collaboration")&&y(c,"bpmn:DataStoreReference")&&c.type!=="label"&&y(u,"bpmn:Collaboration")){var d=y(p,"bpmn:Participant")?p:vE(p,"bpmn:Participant");a(c,d)}}),this.postExecute("shape.delete",function(s){var l=s.context,c=l.shape,p=e.getRootElement();ve(c,["bpmn:Participant","bpmn:SubProcess"])&&y(p,"bpmn:Collaboration")&&o(p).filter(function(u){return mE(u,c)}).forEach(function(u){a(u)})}),this.postExecute("canvas.updateRoot",function(s){var l=s.context,c=l.oldRoot,p=l.newRoot,u=o(c);u.forEach(function(d){y(p,"bpmn:Process")&&a(d,p)})})}rc.$inject=["canvas","commandStack","elementRegistry","eventBus"];te(rc,W);function mE(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}function vE(e,t){for(;e.parent;){if(y(e.parent,t))return e.parent;e=e.parent}}var oa=Math.max,aa=Math.min,gE=20;function Dh(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function yE(e,t,n){var i=n.x,r=n.y,o={x:e.x,y:e.y,width:e.width,height:e.height};return t.indexOf("n")!==-1?(o.y=e.y+r,o.height=e.height-r):t.indexOf("s")!==-1&&(o.height=e.height+r),t.indexOf("e")!==-1?o.width=e.width+i:t.indexOf("w")!==-1&&(o.x=e.x+i,o.width=e.width-i),o}function _E(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function Do(e,t,n){var i=t[e],r=n.min&&n.min[e],o=n.max&&n.max[e];return _e(r)&&(i=(/top|left/.test(e)?aa:oa)(i,r)),_e(o)&&(i=(/top|left/.test(e)?oa:aa)(i,o)),i}function bE(e,t){if(!t)return e;var n=se(e);return xl({top:Do("top",n,t),right:Do("right",n,t),bottom:Do("bottom",n,t),left:Do("left",n,t)})}function EE(e,t,n,i){var r=se(t),o={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},a=i?se(i):o,s={top:aa(o.top,a.top),left:aa(o.left,a.left),bottom:oa(o.bottom,a.bottom),right:oa(o.right,a.right)};return xl(s)}function gr(e,t){return typeof e<"u"?e:gE}function xE(e,t){var n,i,r,o;return typeof t=="object"?(n=gr(t.left),i=gr(t.right),r=gr(t.top),o=gr(t.bottom)):n=i=r=o=gr(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+o}}function wE(e){return!(e.waypoints||e.type==="label")}function Ih(e,t){var n;if(e.length===void 0?n=ye(e.children,wE):n=e,n.length)return xE(Pt(n),t)}var Nn=Math.abs;function SE(e,t){return Dh(se(t),se(e))}var CE=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],zi=30;function Ia(e,t){return t=t||[],e.children.filter(function(n){y(n,"bpmn:Lane")&&(Ia(n,t),t.push(n))}),t}function Xn(e){return e.children.filter(function(t){return y(t,"bpmn:Lane")})}function Mt(e){return na(e,CE)||e}function TE(e,t){var n=Mt(e),i=y(n,"bpmn:Process")?[]:[n],r=Ia(n,i),o=se(e),a=se(t),s=SE(e,t),l=[],c=_n(e);return r.forEach(function(p){if(p!==e){var u=c?0:s.top,d=c?s.right:0,f=c?0:s.bottom,h=c?s.left:0,v=se(p);s.top&&(Nn(v.bottom-o.top)<10&&(f=a.top-v.bottom),Nn(v.top-o.top)<5&&(u=a.top-v.top)),s.left&&(Nn(v.right-o.left)<10&&(d=a.left-v.right),Nn(v.left-o.left)<5&&(h=a.left-v.left)),s.bottom&&(Nn(v.top-o.bottom)<10&&(u=a.bottom-v.top),Nn(v.bottom-o.bottom)<5&&(f=a.bottom-v.bottom)),s.right&&(Nn(v.left-o.right)<10&&(h=a.right-v.left),Nn(v.right-o.right)<5&&(d=a.right-v.right)),(u||d||f||h)&&l.push({shape:p,newBounds:_E(p,{top:u,right:d,bottom:f,left:h})})}}),l}var PE=500;function oc(e,t){W.call(this,e);function n(i,r){var o=_n(i),a=Xn(r),s=[],l=[],c=[],p=[];if(ba(a,function(m){return o?m.y>i.y?l.push(m):s.push(m):m.x>i.x?p.push(m):c.push(m),m.children}),!!a.length){var u;o?l.length&&s.length?u=i.height/2:u=i.height:p.length&&c.length?u=i.width/2:u=i.width;var d,f,h,v;s.length&&(d=t.calculateAdjustments(s,"y",u,i.y-10),t.makeSpace(d.movingShapes,d.resizingShapes,{x:0,y:u},"s")),l.length&&(f=t.calculateAdjustments(l,"y",-u,i.y+i.height+10),t.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:-u},"n")),c.length&&(h=t.calculateAdjustments(c,"x",u,i.x-10),t.makeSpace(h.movingShapes,h.resizingShapes,{x:u,y:0},"e")),p.length&&(v=t.calculateAdjustments(p,"x",-u,i.x+i.width+10),t.makeSpace(v.movingShapes,v.resizingShapes,{x:-u,y:0},"w"))}}this.postExecuted("shape.delete",PE,function(i){var r=i.context,o=r.hints,a=r.shape,s=r.oldParent;y(a,"bpmn:Lane")&&(o&&o.nested||n(a,s))})}oc.$inject=["eventBus","spaceTool"];te(oc,W);var fp=500;function Ma(e,t){t.invoke(W,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",fp,function(i){var r=i.elements;r.filter(function(o){var a=o.host;return hp(o,a)}).map(function(o){return r.indexOf(o)}).forEach(function(o){i.elements[o]=n._replaceShape(r[o])})},!0),this.preExecute("elements.move",fp,function(i){var r=i.shapes,o=i.newHost;r.forEach(function(a,s){var l=a.host;hp(a,kE(r,l)?l:o)&&(r[s]=n._replaceShape(a))})},!0)}Ma.$inject=["bpmnReplace","injector"];te(Ma,W);Ma.prototype._replaceShape=function(e){var t=RE(e),n;return t?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:t.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})};function RE(e){var t=Z(e),n=t.eventDefinitions;return n&&n[0]}function hp(e,t){return!xe(e)&&y(e,"bpmn:BoundaryEvent")&&!t}function kE(e,t){return e.indexOf(t)!==-1}function ac(e,t,n){W.call(this,e);function i(r,o,a){var s=o.waypoints,l,c,p,u,d,f,h,v=r.outgoing.slice(),m=r.incoming.slice(),S;_e(a.width)?S=de(a):S=a;var b=Ks(s,S);if(b){if(l=s.slice(0,b.index),c=s.slice(b.index+(b.bendpoint?1:0)),!l.length||!c.length)return;p=b.bendpoint?s[b.index]:S,(l.length===1||!mp(r,l[l.length-1]))&&l.push(vp(p)),(c.length===1||!mp(r,c[0]))&&c.unshift(vp(p))}u=o.source,d=o.target,t.canConnect(u,r,o)&&(n.reconnectEnd(o,r,l||S),f=o),t.canConnect(r,d,o)&&(f?h=n.connect(r,d,{type:o.type,waypoints:c}):(n.reconnectStart(o,r,c||S),h=o));var T=[].concat(f&&ye(m,function(C){return C.source===f.source})||[],h&&ye(v,function(C){return C.target===h.target})||[]);T.length&&n.removeElements(T)}this.preExecute("elements.move",function(r){var o=r.newParent,a=r.shapes,s=r.delta,l=a[0];if(!(!l||!o)){o&&o.waypoints&&(r.newParent=o=o.parent);var c=de(l),p={x:c.x+s.x,y:c.y+s.y},u=Oe(o.children,function(d){var f=t.canInsert(a,d);return f&&Ks(d.waypoints,p)});u&&(r.targetFlow=u,r.position=p)}},!0),this.postExecuted("elements.move",function(r){var o=r.shapes,a=r.targetFlow,s=r.position;a&&i(o[0],a,s)},!0),this.preExecute("shape.create",function(r){var o=r.parent,a=r.shape;t.canInsert(a,o)&&(r.targetFlow=o,r.parent=o.parent)},!0),this.postExecuted("shape.create",function(r){var o=r.shape,a=r.targetFlow,s=r.position;a&&i(o,a,s)},!0)}te(ac,W);ac.$inject=["eventBus","bpmnRules","modeling"];function mp(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function vp(e){return N({},e)}function sc(e,t){W.call(this,e),this.preExecuted("connection.create",function(n){var i=n.context,r=i.connection,o=i.source,a=i.target,s=i.hints;if(!(s&&s.createElementsBehavior===!1)&&Oi(r)){var l=[];y(o,"bpmn:EventBasedGateway")?l=a.incoming.filter(c=>c!==r&&Oi(c)):l=a.incoming.filter(c=>c!==r&&Oi(c)&&y(c.source,"bpmn:EventBasedGateway")),l.forEach(function(c){t.removeConnection(c)})}}),this.preExecuted("shape.replace",function(n){var i=n.context,r=i.newShape;if(y(r,"bpmn:EventBasedGateway")){var o=r.outgoing.filter(Oi).reduce(function(a,s){return a.includes(s.target)?a:a.concat(s.target)},[]);o.forEach(function(a){a.incoming.filter(Oi).forEach(function(s){const l=a.incoming.filter(Oi).filter(function(c){return c.source===r});(s.source!==r||l.length>1)&&t.removeConnection(s)})})}})}sc.$inject=["eventBus","modeling"];te(sc,W);function Oi(e){return y(e,"bpmn:SequenceFlow")}var Io=1500,gp=2e3;function Mh(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],Io,function(i){var r=i.context,o=r.shape||i.shape,a=i.hover;y(a,"bpmn:Lane")&&!ve(o,["bpmn:Lane","bpmn:Participant"])&&(i.hover=Mt(a),i.hoverGfx=e.getGraphics(i.hover));var s=n.getRootElement();a!==s&&(o.labelTarget||ve(o,["bpmn:Group","bpmn:TextAnnotation"]))&&(i.hover=s,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Io,function(i){var r=i.hover;y(r,"bpmn:Lane")&&(i.hover=Mt(r)||r,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["bendpoint.move.hover"],Io,function(i){var r=i.context,o=i.hover,a=r.type;y(o,"bpmn:Lane")&&/reconnect/.test(a)&&(i.hover=Mt(o)||o,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.start"],Io,function(i){var r=i.context,o=r.start;y(o,"bpmn:Lane")&&(r.start=Mt(o)||o)}),t.on("shape.move.start",gp,function(i){var r=i.shape;y(r,"bpmn:Lane")&&(i.shape=Mt(r)||r)}),t.on("spaceTool.move",gp,function(i){var r=i.hover;r&&y(r,"bpmn:Lane")&&(i.hover=Mt(r))})}Mh.$inject=["elementRegistry","eventBus","canvas"];function AE(e){return e.create("bpmn:Category")}function DE(e){return e.create("bpmn:CategoryValue")}function IE(e,t,n){return tt(t.get("categoryValue"),e),e.$parent=t,tt(n.get("rootElements"),t),t.$parent=n,e}function ME(e){var t=e.$parent;return t&&(Qe(t.get("categoryValue"),e),e.$parent=null),e}function NE(e){var t=e.$parent;return t&&(Qe(t.get("rootElements"),e),e.$parent=null),e}var yp=770;function lc(e,t,n,i,r,o){r.invoke(W,this);function a(){return n.filter(function(h){return y(h,"bpmn:Group")})}function s(h,v){return h.some(function(m){var S=Z(m),b=S.categoryValueRef&&S.categoryValueRef.$parent;return b===v})}function l(h,v){return h.some(function(m){var S=Z(m);return S.categoryValueRef===v})}function c(h,v,m){var S=a().filter(function(b){return b.businessObject!==m});v&&!s(S,v)&&NE(v),h&&!l(S,h)&&ME(h)}function p(h,v){return IE(h,v,t.getDefinitions())}function u(h,v){var m=Z(h),S=m.categoryValueRef;S||(S=m.categoryValueRef=v.categoryValue=v.categoryValue||DE(e));var b=S.$parent;b||(b=S.$parent=v.category=v.category||AE(e)),p(S,b,t.getDefinitions())}function d(h,v){var m=v.category,S=v.categoryValue,b=Z(h);S?(b.categoryValueRef=null,c(S,m,b)):c(null,b.categoryValueRef.$parent,b)}this.execute("label.create",function(h){var v=h.context,m=v.labelTarget;y(m,"bpmn:Group")&&u(m,v)}),this.revert("label.create",function(h){var v=h.context,m=v.labelTarget;y(m,"bpmn:Group")&&d(m,v)}),this.execute("shape.delete",function(h){var v=h.context,m=v.shape,S=Z(m);if(!(!y(m,"bpmn:Group")||m.labelTarget)){var b=v.categoryValue=S.categoryValueRef,T;b&&(T=v.category=b.$parent,c(b,T,S),S.categoryValueRef=null)}}),this.reverted("shape.delete",function(h){var v=h.context,m=v.shape;if(!(!y(m,"bpmn:Group")||m.labelTarget)){var S=v.category,b=v.categoryValue,T=Z(m);b&&(T.categoryValueRef=b,p(b,S))}}),this.execute("shape.create",function(h){var v=h.context,m=v.shape;!y(m,"bpmn:Group")||m.labelTarget||Z(m).categoryValueRef&&u(m,v)}),this.reverted("shape.create",function(h){var v=h.context,m=v.shape;!y(m,"bpmn:Group")||m.labelTarget||Z(m).categoryValueRef&&d(m,v)});function f(h,v){var m=e.create(h.$type);return o.copyElement(h,m,null,v)}i.on("copyPaste.copyElement",yp,function(h){var v=h.descriptor,m=h.element;if(!(!y(m,"bpmn:Group")||m.labelTarget)){var S=Z(m);if(S.categoryValueRef){var b=S.categoryValueRef;v.categoryValue=f(b,!0),b.$parent&&(v.category=f(b.$parent,!0))}}}),i.on("copyPaste.pasteElement",yp,function(h){var v=h.descriptor,m=v.businessObject,S=v.categoryValue,b=v.category;S&&(S=m.categoryValueRef=f(S)),b&&(S.$parent=f(b)),delete v.category,delete v.categoryValue})}lc.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"];te(lc,W);function nl(e,t,n,i){var r,o,a,s,l;return r=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y),r==0?null:(o=e.y-n.y,a=e.x-n.x,l=(i.x-n.x)*o-(i.y-n.y)*a,s=l/r,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function Nh(e){function t(i,r,o){var a={x:o.x,y:o.y-50},s={x:o.x-50,y:o.y},l=nl(i,r,o,a),c=nl(i,r,o,s),p;l&&c?_p(l,o)>_p(c,o)?p=c:p=l:p=l||c,i.original=p}function n(i){var r=i.waypoints;t(r[0],r[1],de(i.source)),t(r[r.length-1],r[r.length-2],de(i.target))}e.on("bpmnElement.added",function(i){var r=i.element;r.waypoints&&n(r)})}Nh.$inject=["eventBus"];function _p(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function cc(e){W.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var i=n.context.shape,r=Z(i),o=Ie(i);if(ve(r,t)){var a=o.get("isHorizontal");a===void 0&&(a=!0),o.set("isHorizontal",a)}})}cc.$inject=["eventBus"];te(cc,W);var Oh=Math.sqrt,Lh=Math.min,OE=Math.max,bp=Math.abs;function Ep(e){return Math.pow(e,2)}function yr(e,t){return Oh(Ep(e.x-t.x)+Ep(e.y-t.y))}function LE(e,t){var n=0,i,r,o,a,s,l,c,p,u,d,f;for(n=0;n<t.length-1;n++){if(i=t[n],r=t[n+1],wp(i,r)?c=[i]:(o=yr(e,i),a=yr(e,r),l=Lh(o,a),c=$E(i,r,e,l)),c.length<1)throw new Error("expected between [1, 2] circle -> line intersections");c.length===1&&(p={type:"bendpoint",position:c[0],segmentIndex:n,bendpointIndex:wp(i,c[0])?n:n+1}),c.length===2&&(s=jE(c[0],c[1]),p={type:"segment",position:s,segmentIndex:n,relativeLocation:yr(i,s)/yr(i,r)}),u=yr(p.position,e),(!f||d>u)&&(f=p,d=u)}return f}function $E(e,t,n,i){var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,l=r*r+o*o,c=r*a+o*s,p=a*a+s*s-i*i,u=c/l,d=p/l,f=u*u-d;if(f<0&&f>-1e-6&&(f=0),f<0)return[];var h=Oh(f),v=-u+h,m=-u-h,S={x:e.x-r*v,y:e.y-o*v};if(f===0)return[S];var b={x:e.x-r*m,y:e.y-o*m};return[S,b].filter(function(T){return BE(T,e,t)})}function BE(e,t,n){return xp(e.x,t.x,n.x)&&xp(e.y,t.y,n.y)}function xp(e,t,n){return e>=Lh(t,n)-sa&&e<=OE(t,n)+sa}function jE(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var sa=.1;function wp(e,t){return bp(e.x-t.x)<=sa&&bp(e.y-t.y)<=sa}function VE(e,t,n,i){var r=n.segmentIndex,o=t.length-e.length;if(i.segmentMove){var a=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return r===a?s:r>=s?r+o<s?s:r+o:r}if(i.bendpointMove){var l=i.bendpointMove.insert,c=i.bendpointMove.bendpointIndex,p;if(o===0)return r;if(r>=c&&(p=l?r+1:r-1),r<c&&(p=r,l&&n.type!=="bendpoint"&&c-1===r)){var u=Bh(t,c);u<n.relativeLocation&&p++}return p}return o===0?r:i.connectionStart&&r===0?0:i.connectionEnd&&r===e.length-2?t.length-2:Math.floor((t.length-2)/2)}function $h(e,t,n,i){var r=0,o=0,a={point:e,delta:{x:0,y:0}},s=LE(e,n),l=s.segmentIndex,c=VE(n,t,s,i);if(c<0||c>t.length-2||c===null)return a;var p=Sp(n,l),u=Sp(t,c),d=s.position,f=HE(p,d),h=FE(p,u);if(s.type==="bendpoint"){var v=t.length-n.length,m=s.bendpointIndex,S=n[m];if(t.indexOf(S)!==-1)return a;if(v===0){var b=t[m];return r=b.x-s.position.x,o=b.y-s.position.y,{delta:{x:r,y:o},point:{x:e.x+r,y:e.y+o}}}v<0&&m!==0&&m<n.length-1&&(f=Bh(n,m))}var T={x:(u[1].x-u[0].x)*f+u[0].x,y:(u[1].y-u[0].y)*f+u[0].y},C=Ib({x:e.x-d.x,y:e.y-d.y},h);return r=T.x+C.x-e.x,o=T.y+C.y-e.y,{point:Ir(T),delta:Ir({x:r,y:o})}}function Bh(e,t){var n=ia(e[t-1],e[t]),i=ia(e[t],e[t+1]),r=n/(n+i);return r}function FE(e,t){var n=qu(e),i=qu(t);return i-n}function Sp(e,t){return[e[t],e[t+1]]}function HE(e,t){var n=ia(e[0],e[1]),i=ia(e[0],t);return n===0?0:i/n}function zE(e,t,n,i){var r=de(e);return $h(r,t,n,i).delta}function Wr(e,t,n){var i=wr(t),r=wr(n),o=Gt(e,i),a={x:o.x*(n.width/t.width),y:o.y*(n.height/t.height)};return Ir({x:r.x+a.x,y:r.y+a.y})}function Cp(e,t,n){var i=wr(e),r=wr(t),o=wr(n),a=Gt(e,i),s=Gt(i,r),l=UE(i,t,n);if(l)return l;var c={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},p={x:o.x+c.x,y:o.y+c.y};return Ir({x:p.x+a.x-e.x,y:p.y+a.y-e.y})}function UE(e,t,n){var i=se(t),r=se(n);if(GE(i,r))return null;var o=dt(t,e),a,s,l;if(o==="top")a={x:0,y:r.bottom-i.bottom};else if(o==="bottom")a={x:0,y:r.top-i.top};else if(o==="right")a={x:r.left-i.left,y:0};else if(o==="left")a={x:r.right-i.right,y:0};else return null;return s={x:e.x+a.x,y:e.y+a.y},l=dt(n,s),l!==o?null:a}function GE(e,t){return WE(e,t)||YE(e,t)}function WE(e,t){return e.right!==t.right&&e.left!==t.left}function YE(e,t){return e.top!==t.top&&e.bottom!==t.bottom}var Tp="name",Pp="text";function uc(e,t,n,i){W.call(this,e),this.postExecute("element.updateProperties",r),this.postExecute("element.updateModdleProperties",a=>{Z(a.context.element)===a.context.moddleElement&&r(a)});function r(a){var s=a.context,l=s.element,c=s.properties;if(Tp in c&&t.updateLabel(l,c[Tp]),Pp in c&&y(l,"bpmn:TextAnnotation")){var p=i.getTextAnnotationBounds({x:l.x,y:l.y,width:l.width,height:l.height},c[Pp]||"");t.updateLabel(l,c.text,p)}}this.postExecute(["shape.create","connection.create"],function(a){var s=a.context,l=s.hints||{};if(l.createElementsBehavior!==!1){var c=s.shape||s.connection;xe(c)||!Yi(c)||zn(c)&&t.updateLabel(c,zn(c))}}),this.postExecute("shape.delete",function(a){var s=a.context,l=s.labelTarget,c=s.hints||{};l&&c.unsetLabel!==!1&&t.updateLabel(l,null,null,{removeShape:!1})});function o(a){var s=a.context,l=s.connection,c=l.label,p=N({},s.hints),u=s.newWaypoints||l.waypoints,d=s.oldWaypoints;return typeof p.startChanged>"u"&&(p.startChanged=!!p.connectionStart),typeof p.endChanged>"u"&&(p.endChanged=!!p.connectionEnd),zE(c,u,d,p)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(a){var s=a.context,l=s.hints||{};if(l.labelBehavior!==!1){var c=s.connection,p=c.label,u;!p||!p.parent||(u=o(a),t.moveShape(p,u))}}),this.postExecute(["shape.replace"],function(a){var s=a.context,l=s.newShape,c=s.oldShape,p=Z(l);p&&Yi(p)&&c.label&&l.label&&(l.label.x=c.label.x,l.label.y=c.label.y)}),this.postExecute("shape.resize",function(a){var s=a.context,l=s.shape,c=s.newBounds,p=s.oldBounds;if(_a(l)){var u=l.label,d=de(u),f=XE(p),h=KE(d,f),v=qE(h,p,c);t.moveShape(u,v)}})}te(uc,W);uc.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function qE(e,t,n){var i=Wr(e,t,n);return Ir(Gt(i,e))}function KE(e,t){if(t.length){var n=ZE(e,t);return Ul(e,n)}}function XE(e){return[[{x:e.x,y:e.y},{x:e.x+(e.width||0),y:e.y}],[{x:e.x+(e.width||0),y:e.y},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y+(e.height||0)},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y},{x:e.x,y:e.y+(e.height||0)}]]}function ZE(e,t){var n=t.map(function(r){return{line:r,distance:hh(e,r)}}),i=on(n,"distance");return i[0].line}function QE(e,t,n,i){return $h(e,t,n,i).point}function pc(e,t){W.call(this,e);function n(i,r){var o=i.context,a=o.connection,s=N({},o.hints),l=o.newWaypoints||a.waypoints,c=o.oldWaypoints;return typeof s.startChanged>"u"&&(s.startChanged=!!s.connectionStart),typeof s.endChanged>"u"&&(s.endChanged=!!s.connectionEnd),QE(r,l,c,s)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(i){var r=i.context,o=r.connection,a=o.outgoing,s=o.incoming;s.forEach(function(l){var c=l.waypoints[l.waypoints.length-1],p=n(i,c),u=[].concat(l.waypoints.slice(0,-1),[p]);t.updateWaypoints(l,u)}),a.forEach(function(l){var c=l.waypoints[0],p=n(i,c),u=[].concat([p],l.waypoints.slice(1));t.updateWaypoints(l,u)})}),this.postExecute(["connection.move"],function(i){var r=i.context,o=r.connection,a=o.outgoing,s=o.incoming,l=r.delta;s.forEach(function(c){var p=c.waypoints[c.waypoints.length-1],u={x:p.x+l.x,y:p.y+l.y},d=[].concat(c.waypoints.slice(0,-1),[u]);t.updateWaypoints(c,d)}),a.forEach(function(c){var p=c.waypoints[0],u={x:p.x+l.x,y:p.y+l.y},d=[].concat([u],c.waypoints.slice(1));t.updateWaypoints(c,d)})})}te(pc,W);pc.$inject=["eventBus","modeling"];function Na(e,t,n){var i=La(e),r=Vh(i,t),o=i[0];return r.length?r[r.length-1]:Wr(o.original||o,n,t)}function Oa(e,t,n){var i=La(e),r=Vh(i,t),o=i[i.length-1];return r.length?r[0]:Wr(o.original||o,n,t)}function dc(e,t,n){var i=La(e),r=jh(t,n),o=i[0];return Wr(o.original||o,r,t)}function fc(e,t,n){var i=La(e),r=jh(t,n),o=i[i.length-1];return Wr(o.original||o,r,t)}function jh(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function La(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function Vh(e,t){var n=Et(e,ex);return ye(n,function(i){return JE(i,t)})}function JE(e,t){return dt(t,e,1)==="intersect"}function ex(e){return e.original||e}function hc(e,t){W.call(this,e),this.postExecute("shape.replace",function(n){var i=n.oldShape,r=n.newShape;if(tx(i,r)){var o=nx(i);o.incoming.forEach(function(a){var s=Oa(a,r,i);t.reconnectEnd(a,r,s)}),o.outgoing.forEach(function(a){var s=Na(a,r,i);t.reconnectStart(a,r,s)})}},!0)}hc.$inject=["eventBus","modeling"];te(hc,W);function tx(e,t){return y(e,"bpmn:Participant")&&Se(e)&&y(t,"bpmn:Participant")&&!Se(t)}function nx(e){var t=Hr([e],!1),n=[],i=[];return t.forEach(function(r){r!==e&&(r.incoming.forEach(function(o){y(o,"bpmn:MessageFlow")&&n.push(o)}),r.outgoing.forEach(function(o){y(o,"bpmn:MessageFlow")&&i.push(o)}))},[]),{incoming:n,outgoing:i}}const ix=["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:SignalEventDefinition"];function Fh(e){const t=Z(e);if(!y(t,"bpmn:BoundaryEvent")&&!(y(t,"bpmn:StartEvent")&&vt(t.$parent)))return!1;const n=t.get("eventDefinitions");return!n||!n.length?!1:ix.some(i=>y(n[0],i))}function Hh(e){return y(e,"bpmn:BoundaryEvent")?"cancelActivity":"isInterrupting"}function mc(e,t){e.invoke(W,this),this.postExecuted("shape.replace",function(n){const i=n.context.oldShape,r=n.context.newShape,o=n.context.hints;if(!Fh(r))return;const a=Hh(r);if(o.targetElement&&o.targetElement[a]!==void 0)return;const l=Z(i).get(a),c=Z(r).get(a);l!==c&&t.updateProperties(r,{[a]:l})})}mc.$inject=["injector","modeling"];te(mc,W);function vc(e,t){W.call(this,e),this.preExecute("shape.resize",function(n){var i=n.shape,r=Ie(i),o=r&&r.get("label"),a=o&&o.get("bounds");a&&t.updateModdleProperties(i,o,{bounds:void 0})},!0)}te(vc,W);vc.$inject=["eventBus","modeling"];function gc(e,t,n){W.call(this,e),this.preExecute("shape.delete",function(i){var r=i.context.shape;if(!(r.incoming.length!==1||r.outgoing.length!==1)){var o=r.incoming[0],a=r.outgoing[0];if(!(!y(o,"bpmn:SequenceFlow")||!y(a,"bpmn:SequenceFlow"))&&t.canConnect(o.source,a.target,o)){var s=rx(o.waypoints,a.waypoints);n.reconnectEnd(o,a.target,s)}}})}te(gc,W);gc.$inject=["eventBus","bpmnRules","modeling"];function Li(e){return e.original||e}function rx(e,t){var n=nl(Li(e[e.length-2]),Li(e[e.length-1]),Li(t[1]),Li(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[Li(e[0]),Li(t[t.length-1])]}function yc(e,t){W.call(this,e),this.preExecute("shape.delete",function(n){var i=n.shape,r=i.parent;y(i,"bpmn:Participant")&&(n.collaborationRoot=r)},!0),this.postExecute("shape.delete",function(n){var i=n.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()},!0)}yc.$inject=["eventBus","modeling"];te(yc,W);function _c(e,t,n,i){W.call(this,e);var r=i.get("dragging",!1);function o(l){var c=l.source,p=l.target,u=l.parent;if(u){var d,f;y(l,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(c,p)||(f=!0),n.canConnectMessageFlow(c,p)&&(d="bpmn:MessageFlow")),y(l,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(c,p)||(f=!0),n.canConnectSequenceFlow(c,p)&&(d="bpmn:SequenceFlow")),f&&t.removeConnection(l),d&&t.connect(c,p,{type:d,waypoints:l.waypoints.slice()})}}function a(l){var c=l.context,p=c.connection,u=c.newSource||p.source,d=c.newTarget||p.target,f,h;f=n.canConnect(u,d),!(!f||f.type===p.type)&&(h=t.connect(u,d,{type:f.type,associationDirection:f.associationDirection,waypoints:p.waypoints.slice()}),p.parent&&t.removeConnection(p),c.connection=h,r&&s(p,h))}function s(l,c){var p=r.context(),u=p&&p.payload.previousSelection,d;!u||!u.length||(d=u.indexOf(l),d!==-1&&u.splice(d,1,c))}this.postExecuted("elements.move",function(l){var c=l.closure,p=c.allConnections;I(p,o)},!0),this.preExecute("connection.reconnect",a),this.postExecuted("element.updateProperties",function(l){var c=l.context,p=c.properties,u=c.element,d=u.businessObject,f;p.default&&(f=Oe(u.outgoing,mn({id:u.businessObject.default.id})),f&&t.updateProperties(f,{conditionExpression:void 0})),p.conditionExpression&&d.sourceRef.default===d&&t.updateProperties(u.source,{default:void 0})})}te(_c,W);_c.$inject=["eventBus","modeling","bpmnRules","injector"];function $a(e,t,n,i,r,o){i.invoke(W,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=o,this.postExecuted(["elements.create"],500,function(a){var s=a.context,l=s.parent,c=s.elements,p=qn(c,function(u,d){var f=t.canReplace([d],d.host||d.parent||l);return f?u.concat(f.replacements):u},[]);p.length&&this._replaceElements(c,p)},this),this.postExecuted(["elements.move"],500,function(a){var s=a.context,l=s.newParent,c=s.newHost,p=[];I(s.closure.topLevel,function(d){vt(d)?p=p.concat(d.children):p=p.concat(d)}),p.length===1&&c&&(l=c);var u=t.canReplace(p,l);u&&this._replaceElements(p,u.replacements,c)},this),this.postExecute(["shape.replace"],1500,function(a){var s=a.context,l=s.oldShape,c=s.newShape,p=l.attachers,u;p&&p.length&&(u=t.canReplace(p,c),this._replaceElements(p,u.replacements))},this),this.postExecuted(["shape.replace"],1500,function(a){var s=a.context,l=s.oldShape,c=s.newShape;r.unclaimId(l.businessObject.id,l.businessObject),r.updateProperties(c,{id:l.id})})}te($a,W);$a.prototype._replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,r=this._selection;I(t,function(o){var a={type:o.newElementType},s=n.get(o.oldElementId),l=e.indexOf(s);e[l]=i.replaceElement(s,a,{select:!1})}),t&&r.select(e)};$a.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var ox=1500,ax={width:140,height:120},bc={width:300,height:60},Ec={width:60,height:300},Wo={width:300,height:150},Yo={width:150,height:300},zh={width:140,height:120},Uh={width:50,height:30};function Gh(e){e.on("resize.start",ox,function(t){var n=t.context,i=n.shape,r=n.direction,o=n.balanced;(y(i,"bpmn:Lane")||y(i,"bpmn:Participant"))&&(n.resizeConstraints=px(i,r,o)),y(i,"bpmn:SubProcess")&&Se(i)&&(n.minDimensions=zh),y(i,"bpmn:TextAnnotation")&&(n.minDimensions=Uh)})}Gh.$inject=["eventBus"];var On=Math.abs,sx=Math.min,lx=Math.max;function Wh(e,t,n,i){var r=e[t];e[t]=r===void 0?n:i(n,r)}function $i(e,t,n){return Wh(e,t,n,sx)}function Bi(e,t,n){return Wh(e,t,n,lx)}var cx={top:20,left:50,right:20,bottom:20},ux={top:50,left:20,right:20,bottom:20};function px(e,t,n){var i=Mt(e),r=!0,o=!0,a=Ia(i,[i]),s=se(e),l={},c={},p=_n(e),u=p?bc:Ec;/n/.test(t)?c.top=s.bottom-u.height:/e/.test(t)?c.right=s.left+u.width:/s/.test(t)?c.bottom=s.top+u.height:/w/.test(t)&&(c.left=s.right-u.width),a.forEach(function(h){var v=se(h);/n/.test(t)&&(p&&v.top<s.top-10&&(r=!1),n&&On(s.top-v.bottom)<10&&Bi(l,"top",v.top+u.height),On(s.top-v.top)<5&&$i(c,"top",v.bottom-u.height)),/e/.test(t)&&(!p&&v.right>s.right+10&&(o=!1),n&&On(s.right-v.left)<10&&$i(l,"right",v.right-u.width),On(s.right-v.right)<5&&Bi(c,"right",v.left+u.width)),/s/.test(t)&&(p&&v.bottom>s.bottom+10&&(o=!1),n&&On(s.bottom-v.top)<10&&$i(l,"bottom",v.bottom-u.height),On(s.bottom-v.bottom)<5&&Bi(c,"bottom",v.top+u.height)),/w/.test(t)&&(!p&&v.left<s.left-10&&(r=!1),n&&On(s.left-v.right)<10&&Bi(l,"left",v.left+u.width),On(s.left-v.left)<5&&$i(c,"left",v.right-u.width))});var d=i.children.filter(function(h){return!h.hidden&&!h.waypoints&&(y(h,"bpmn:FlowElement")||y(h,"bpmn:Artifact"))}),f=p?cx:ux;return d.forEach(function(h){var v=se(h);r&&/n/.test(t)&&$i(c,"top",v.top-f.top),o&&/e/.test(t)&&Bi(c,"right",v.right+f.right),o&&/s/.test(t)&&Bi(c,"bottom",v.bottom+f.bottom),r&&/w/.test(t)&&$i(c,"left",v.left-f.left)}),{min:c,max:l}}var Rp=1001;function Yh(e,t){e.on("resize.start",Rp+500,function(n){var i=n.context,r=i.shape;(y(r,"bpmn:Lane")||y(r,"bpmn:Participant"))&&(i.balanced=!Mr(n))}),e.on("resize.end",Rp,function(n){var i=n.context,r=i.shape,o=i.canExecute,a=i.newBounds;if(y(r,"bpmn:Lane")||y(r,"bpmn:Participant"))return o&&(a=ff(a),t.resizeLane(r,a,i.balanced)),!1})}Yh.$inject=["eventBus","modeling"];var dx=500;function xc(e,t,n,i,r){n.invoke(W,this);function o(p){return ve(p,["bpmn:ReceiveTask","bpmn:SendTask"])||fx(p,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function a(p){var u=e.getDefinitions(),d=u.get("rootElements");return!!Oe(d,mn({id:p.id}))}function s(p){if(y(p,"bpmn:ErrorEventDefinition"))return"errorRef";if(y(p,"bpmn:EscalationEventDefinition"))return"escalationRef";if(y(p,"bpmn:MessageEventDefinition"))return"messageRef";if(y(p,"bpmn:SignalEventDefinition"))return"signalRef"}function l(p){if(ve(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.get("messageRef");var u=p.get("eventDefinitions"),d=u[0];return d.get(s(d))}function c(p,u){if(ve(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.set("messageRef",u);var d=p.get("eventDefinitions"),f=d[0];return f.set(s(f),u)}this.executed(["shape.create","element.updateProperties","element.updateModdleProperties"],function(p){var u=p.shape||p.element;if(o(u)){var d=Z(u),f=l(d),h;f&&!a(f)&&(h=e.getDefinitions().get("rootElements"),tt(h,f),p.addedRootElement=f)}},!0),this.reverted(["shape.create","element.updateProperties","element.updateModdleProperties"],function(p){var u=p.addedRootElement;if(u){var d=e.getDefinitions().get("rootElements");Qe(d,u)}},!0),t.on("copyPaste.copyElement",function(p){var u=p.descriptor,d=p.element;if(!(d.labelTarget||!o(d))){var f=Z(d),h=l(f);h&&(u.referencedRootElement=h)}}),t.on("copyPaste.pasteElement",dx,function(p){var u=p.descriptor,d=u.businessObject,f=u.referencedRootElement;f&&(a(f)||(f=i.copyElement(f,r.create(f.$type))),c(d,f),delete u.referencedRootElement)})}xc.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];te(xc,W);function fx(e,t){return Pe(t)||(t=[t]),Ji(t,function(n){return df(e,n)})}var qh=Math.max;function Kh(e){e.on("spaceTool.getMinDimensions",function(t){var n=t.shapes,i=t.axis,r=t.start,o={};return I(n,function(a){var s=a.id;y(a,"bpmn:Participant")&&(o[s]=mx(a,i,r)),y(a,"bpmn:Lane")&&(o[s]=_n(a)?bc:Ec),y(a,"bpmn:SubProcess")&&Se(a)&&(o[s]=zh),y(a,"bpmn:TextAnnotation")&&(o[s]=Uh),y(a,"bpmn:Group")&&(o[s]=ax)}),o})}Kh.$inject=["eventBus"];function hx(e){return e==="x"}function mx(e,t,n){var i=_n(e);if(!yx(e))return i?Wo:Yo;var r=hx(t),o={};return r?i?o=Wo:o={width:gx(e,n,r),height:Yo.height}:i?o={width:Wo.width,height:vx(e,n,r)}:o=Yo,o}function vx(e,t,n){var i;return i=_x(e,t,n),qh(Wo.height,i)}function gx(e,t,n){var i;return i=bx(e,t,n),qh(Yo.width,i)}function yx(e){return!!Xn(e).length}function _x(e,t,n){var i=Xn(e),r;return r=wc(i,t,n),e.height-r.height+bc.height}function bx(e,t,n){var i=Xn(e),r;return r=wc(i,t,n),e.width-r.width+Ec.width}function wc(e,t,n){var i,r,o;for(i=0;i<e.length;i++)if(r=e[i],!n&&t>=r.y&&t<=r.y+r.height||n&&t>=r.x&&t<=r.x+r.width)return o=Xn(r),o.length?wc(o,t,n):r}var kp=400,Ex=600,Ap={x:180,y:160};function Zn(e,t,n,i,r,o,a){W.call(this,t),this._canvas=e,this._eventBus=t,this._modeling=n,this._elementFactory=i,this._bpmnFactory=r,this._bpmnjs=o,this._elementRegistry=a;var s=this;function l(u){return y(u,"bpmn:SubProcess")&&!Se(u)}function c(u){var d=u.shape,f=u.newRootElement,h=Z(d);f=s._addDiagram(f||h),u.newRootElement=e.addRootElement(f)}function p(u){var d=u.shape,f=Z(d);s._removeDiagram(f);var h=u.newRootElement=a.get(ji(f));e.removeRootElement(h)}this.executed("shape.create",function(u){var d=u.shape;l(d)&&c(u)},!0),this.postExecuted("shape.create",function(u){var d=u.shape,f=u.newRootElement;!f||!d.children||(s._showRecursively(d.children),s._moveChildrenToShape(d,f))},!0),this.reverted("shape.create",function(u){var d=u.shape;l(d)&&p(u)},!0),this.preExecuted("shape.delete",function(u){var d=u.shape;if(l(d)){var f=a.get(ji(d));f&&n.removeElements(f.children.slice())}},!0),this.executed("shape.delete",function(u){var d=u.shape;l(d)&&p(u)},!0),this.reverted("shape.delete",function(u){var d=u.shape;l(d)&&c(u)},!0),this.preExecuted("shape.replace",function(u){var d=u.oldShape,f=u.newShape;!l(d)||!l(f)||(u.oldRoot=e.removeRootElement(ji(d)))},!0),this.postExecuted("shape.replace",function(u){var d=u.newShape,f=u.oldRoot,h=e.findRoot(ji(d));if(!(!f||!h)){var v=f.children;n.moveElements(v,{x:0,y:0},h)}},!0),this.executed("element.updateProperties",function(u){var d=u.element;if(y(d,"bpmn:SubProcess")){var f=u.properties,h=u.oldProperties,v=h.id,m=f.id;if(v!==m){if(Ho(d)){a.updateId(d,ci(m)),a.updateId(v,m);return}var S=a.get(ci(v));S&&a.updateId(ci(v),ci(m))}}},!0),this.reverted("element.updateProperties",function(u){var d=u.element;if(y(d,"bpmn:SubProcess")){var f=u.properties,h=u.oldProperties,v=h.id,m=f.id;if(v!==m){if(Ho(d)){a.updateId(d,ci(v)),a.updateId(m,v);return}var S=a.get(ci(m));S&&a.updateId(S,ci(v))}}},!0),t.on("element.changed",function(u){var d=u.element;if(Ho(d)){var f=d,h=a.get(_u(f));!h||h===f||t.fire("element.changed",{element:h})}}),this.executed("shape.toggleCollapse",kp,function(u){var d=u.shape;y(d,"bpmn:SubProcess")&&(Se(d)?p(u):(c(u),s._showRecursively(d.children)))},!0),this.reverted("shape.toggleCollapse",kp,function(u){var d=u.shape;y(d,"bpmn:SubProcess")&&(Se(d)?p(u):(c(u),s._showRecursively(d.children)))},!0),this.postExecuted("shape.toggleCollapse",Ex,function(u){var d=u.shape;if(y(d,"bpmn:SubProcess")){var f=u.newRootElement;f&&(Se(d)?s._moveChildrenToShape(f,d):s._moveChildrenToShape(d,f))}},!0),t.on("copyPaste.createTree",function(u){var d=u.element,f=u.children;if(l(d)){var h=ji(d),v=a.get(h);v&&f.push.apply(f,v.children)}}),t.on("copyPaste.copyElement",function(u){var d=u.descriptor,f=u.element,h=u.elements,v=f.parent,m=y(Ie(v),"bpmndi:BPMNPlane");if(m){var S=_u(v),b=Oe(h,function(T){return T.id===S});b&&(d.parent=b.id)}}),t.on("copyPaste.pasteElement",function(u){var d=u.descriptor;d.parent&&(l(d.parent)||d.parent.hidden)&&(d.hidden=!0)})}te(Zn,W);Zn.prototype._moveChildrenToShape=function(e,t){var n=this._modeling,i=e.children,r;if(i){i=i.concat(i.reduce(function(c,p){return p.label&&p.label.parent!==e?c.concat(p.label):c},[]));var o=i.filter(function(c){return!c.hidden});if(!o.length){n.moveElements(i,{x:0,y:0},t,{autoResize:!1});return}var a=Pt(o);if(!t.x)r={x:Ap.x-a.x,y:Ap.y-a.y};else{var s=de(t),l=de(a);r={x:s.x-l.x,y:s.y-l.y}}n.moveElements(i,r,t,{autoResize:!1})}};Zn.prototype._showRecursively=function(e,t){var n=this,i=[];return e.forEach(function(r){r.hidden=!!t,i=i.concat(r),r.children&&(i=i.concat(n._showRecursively(r.children,r.collapsed||t)))}),i};Zn.prototype._addDiagram=function(e){var t=this._bpmnjs,n=t.getDefinitions().diagrams;return e.businessObject||(e=this._createNewDiagram(e)),n.push(e.di.$parent),e};Zn.prototype._createNewDiagram=function(e){var t=this._bpmnFactory,n=this._elementFactory,i=t.create("bpmndi:BPMNPlane",{bpmnElement:e}),r=t.create("bpmndi:BPMNDiagram",{plane:i});i.$parent=r;var o=n.createRoot({id:ji(e),type:e.$type,di:i,businessObject:e,collapsed:!0});return o};Zn.prototype._removeDiagram=function(e){var t=this._bpmnjs,n=t.getDefinitions().diagrams,i=Oe(n,function(r){return r.plane.bpmnElement.id===e.id});return n.splice(n.indexOf(i),1),i};Zn.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"];function Sc(e,t){e.invoke(W,this),this.postExecuted("shape.replace",function(n){var i=n.context.oldShape,r=n.context.newShape;if(!(!y(r,"bpmn:SubProcess")||!(y(i,"bpmn:Task")||y(i,"bpmn:CallActivity"))||!Se(r))){var o=xx(r);t.createShape({type:"bpmn:StartEvent"},o,r)}})}Sc.$inject=["injector","modeling"];te(Sc,W);function xx(e){return{x:e.x+e.width/6,y:e.y+e.height/2}}function Cc(e){W.call(this,e),this.preExecute("connection.create",function(t){const{target:n}=t;y(n,"bpmn:TextAnnotation")&&(t.parent=n.parent)},!0),this.preExecute(["shape.create","shape.resize","elements.move"],function(t){const n=t.shapes||[t.shape];n.length===1&&y(n[0],"bpmn:TextAnnotation")&&(t.hints=t.hints||{},t.hints.autoResize=!1)},!0)}te(Cc,W);Cc.$inject=["eventBus"];function Tc(e,t){W.call(this,e),this.postExecuted("shape.toggleCollapse",1500,function(n){var i=n.shape;if(Se(i))return;var r=Hr(i);r.forEach(function(a){var s=a.incoming.slice(),l=a.outgoing.slice();I(s,function(c){o(c,!0)}),I(l,function(c){o(c,!1)})});function o(a,s){r.indexOf(a.source)!==-1&&r.indexOf(a.target)!==-1||(s?t.reconnectEnd(a,i,de(i)):t.reconnectStart(a,i,de(i)))}},!0)}te(Tc,W);Tc.$inject=["eventBus","modeling"];var Cs=500;function Pc(e,t,n){W.call(this,e);function i(a){a.length&&a.forEach(function(s){s.type==="label"&&!s.businessObject.name&&(s.hidden=!0)})}function r(a,s){var l=a.children,c=s,p,u;return p=wx(l).concat([a]),u=Ih(p),u?(c.width=Math.max(u.width,c.width),c.height=Math.max(u.height,c.height),c.x=u.x+(u.width-c.width)/2,c.y=u.y+(u.height-c.height)/2):(c.x=a.x+(a.width-c.width)/2,c.y=a.y+(a.height-c.height)/2),c}function o(a,s){return{x:a.x+(a.width-s.width)/2,y:a.y+(a.height-s.height)/2,width:s.width,height:s.height}}this.executed(["shape.toggleCollapse"],Cs,function(a){var s=a.context,l=s.shape;y(l,"bpmn:SubProcess")&&(l.collapsed?Ie(l).isExpanded=!1:(i(l.children),Ie(l).isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],Cs,function(a){var s=a.context,l=s.shape;l.collapsed?Ie(l).isExpanded=!1:Ie(l).isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],Cs,function(a){var s=a.context.shape,l=t.getDefaultSize(s),c;s.collapsed?c=o(s,l):c=r(s,l),n.resizeShape(s,c,null,{autoResize:s.collapsed?!1:"nwse"})})}te(Pc,W);Pc.$inject=["eventBus","elementFactory","modeling"];function wx(e){return e.filter(function(t){return!t.hidden})}function Rc(e,t,n,i){t.invoke(W,this),this.preExecute("shape.delete",function(r){var o=r.context,a=o.shape,s=a.businessObject;xe(a)||(y(a,"bpmn:Participant")&&Se(a)&&n.ids.unclaim(s.processRef.id),i.unclaimId(s.id,s))}),this.preExecute("connection.delete",function(r){var o=r.context,a=o.connection,s=a.businessObject;i.unclaimId(s.id,s)}),this.preExecute("canvas.updateRoot",function(){var r=e.getRootElement(),o=r.businessObject;y(r,"bpmn:Collaboration")&&n.ids.unclaim(o.id)})}te(Rc,W);Rc.$inject=["canvas","injector","moddle","modeling"];function kc(e,t){W.call(this,e),this.preExecute("connection.delete",function(n){var i=n.context,r=i.connection,o=r.source;Sx(r,o)&&t.updateProperties(o,{default:null})})}te(kc,W);kc.$inject=["eventBus","modeling"];function Sx(e,t){if(!y(e,"bpmn:SequenceFlow"))return!1;var n=Z(t),i=Z(e);return n.get("default")===i}var Cx=500,Tx=5e3;function Ac(e,t,n){W.call(this,e);var i;function r(){return i=i||new Px,i.enter(),i}function o(){if(!i)throw new Error(n("out of bounds release"));return i}function a(){if(!i)throw new Error(n("out of bounds release"));var l=i.leave();return l&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null),l}var s=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(s,Tx,function(l){r()}),this.postExecuted(s,Cx,function(l){a()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(l){var c=l.context,p=c.shape,u=o();p.labelTarget||(y(p,"bpmn:Lane")&&u.addLane(p),y(p,"bpmn:FlowNode")&&u.addFlowNode(p))})}Ac.$inject=["eventBus","modeling","translate"];te(Ac,W);function Px(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}const Rx={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","compensateBoundaryEventBehaviour","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","layoutConnectionBehavior","messageFlowBehavior","nonInterruptingBehavior","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","textAnnotationBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior"],adaptiveLabelPositioningBehavior:["type",Kl],appendBehavior:["type",Xl],associationBehavior:["type",Zl],attachEventBehavior:["type",Aa],boundaryEventBehavior:["type",Ql],compensateBoundaryEventBehaviour:["type",Jl],createBehavior:["type",ec],createDataObjectBehavior:["type",tc],createParticipantBehavior:["type",nc],dataInputAssociationBehavior:["type",ic],dataStoreBehavior:["type",rc],deleteLaneBehavior:["type",oc],detachEventBehavior:["type",Ma],dropOnFlowBehavior:["type",ac],eventBasedGatewayBehavior:["type",sc],fixHoverBehavior:["type",Mh],groupBehavior:["type",lc],importDockingFix:["type",Nh],isHorizontalFix:["type",cc],labelBehavior:["type",uc],layoutConnectionBehavior:["type",pc],messageFlowBehavior:["type",hc],nonInterruptingBehavior:["type",mc],removeElementBehavior:["type",gc],removeEmbeddedLabelBoundsBehavior:["type",vc],removeParticipantBehavior:["type",yc],replaceConnectionBehavior:["type",_c],replaceElementBehaviour:["type",$a],resizeBehavior:["type",Gh],resizeLaneBehavior:["type",Yh],rootElementReferenceBehavior:["type",xc],spaceToolBehavior:["type",Kh],subProcessPlaneBehavior:["type",Zn],subProcessStartEventBehavior:["type",Sc],textAnnotationBehavior:["type",Cc],toggleCollapseConnectionBehaviour:["type",Tc],toggleElementCollapseBehaviour:["type",Pc],unclaimIdBehavior:["type",Rc],unsetDefaultFlowBehavior:["type",kc],updateFlowNodeRefsBehavior:["type",Ac]};function Xh(e,t){var n=dt(e,t,-15);return n!=="intersect"?n:null}function st(e){$t.call(this,e)}te(st,$t);st.$inject=["eventBus"];st.prototype.init=function(){this.addRule("connection.start",function(e){var t=e.source;return kx(t)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},r=i.targetParent,o=i.targetAttach;if(o)return!1;r&&(n.parent=r);try{return qo(t,n)}finally{r&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection,n=e.source,i=e.target;return qo(n,i,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){var t=e.shape,n=e.newBounds;return om(t,n)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return De(i)&&!la(t,i)?!1:bl(t,function(r){return De(r)?qo(r.source,r.target,r):r.host?Sr(r,r.host,null,n):al(r,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return Sr(n,t,null,i)||im(n,t,i)||rm(n,t)||la(n,t)}),this.addRule("shape.create",function(e){return al(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return Sr(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element,n=e.elements;return um(n,t)})};st.prototype.canConnectMessageFlow=lm;st.prototype.canConnectSequenceFlow=cm;st.prototype.canConnectDataAssociation=Ic;st.prototype.canConnectAssociation=am;st.prototype.canConnectCompensationAssociation=sm;st.prototype.canMove=rm;st.prototype.canAttach=Sr;st.prototype.canReplace=im;st.prototype.canDrop=Zi;st.prototype.canInsert=la;st.prototype.canCreate=al;st.prototype.canConnect=qo;st.prototype.canResize=om;st.prototype.canCopy=um;function kx(e){return il(e)?null:ve(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function il(e){return!e||xe(e)}function Ax(e,t){return e===t}function Dp(e){do{if(y(e,"bpmn:Process"))return Z(e);if(y(e,"bpmn:Participant"))return Z(e).processRef||Z(e)}while(e=e.parent)}function rl(e){return y(e,"bpmn:TextAnnotation")}function Dc(e){return y(e,"bpmn:Group")&&!e.labelTarget}function Zh(e){return y(e,"bpmn:BoundaryEvent")&&en(e,"bpmn:CompensateEventDefinition")}function Ba(e){return Z(e).isForCompensation}function Dx(e,t){var n=Dp(e),i=Dp(t);return n===i}function Ix(e){return y(e,"bpmn:InteractionNode")&&!y(e,"bpmn:BoundaryEvent")&&(!y(e,"bpmn:Event")||y(e,"bpmn:ThrowEvent")&&Jh(e,"bpmn:MessageEventDefinition"))}function Mx(e){return y(e,"bpmn:InteractionNode")&&!Ba(e)&&(!y(e,"bpmn:Event")||y(e,"bpmn:CatchEvent")&&Jh(e,"bpmn:MessageEventDefinition"))&&!(y(e,"bpmn:BoundaryEvent")&&!en(e,"bpmn:MessageEventDefinition"))}function Ip(e){for(var t=e;t=t.parent;){if(y(t,"bpmn:FlowElementsContainer"))return Z(t);if(y(t,"bpmn:Participant"))return Z(t).processRef}return null}function Qh(e,t){var n=Ip(e),i=Ip(t);return n===i}function en(e,t){var n=Z(e);return!!Oe(n.eventDefinitions||[],function(i){return y(i,t)})}function Jh(e,t){var n=Z(e);return(n.eventDefinitions||[]).every(function(i){return y(i,t)})}function Nx(e){return y(e,"bpmn:FlowNode")&&!y(e,"bpmn:EndEvent")&&!vt(e)&&!(y(e,"bpmn:IntermediateThrowEvent")&&en(e,"bpmn:LinkEventDefinition"))&&!Zh(e)&&!Ba(e)}function Ox(e){return y(e,"bpmn:FlowNode")&&!y(e,"bpmn:StartEvent")&&!y(e,"bpmn:BoundaryEvent")&&!vt(e)&&!(y(e,"bpmn:IntermediateCatchEvent")&&en(e,"bpmn:LinkEventDefinition"))&&!Ba(e)}function Lx(e){return y(e,"bpmn:ReceiveTask")||y(e,"bpmn:IntermediateCatchEvent")&&(en(e,"bpmn:MessageEventDefinition")||en(e,"bpmn:TimerEventDefinition")||en(e,"bpmn:ConditionalEventDefinition")||en(e,"bpmn:SignalEventDefinition"))}function $x(e){for(var t=[];e;)e=e.parent,e&&t.push(e);return t}function ol(e,t){var n=$x(t);return n.indexOf(e)!==-1}function qo(e,t,n){if(il(e)||il(t))return null;if(!y(n,"bpmn:DataAssociation")){if(lm(e,t))return{type:"bpmn:MessageFlow"};if(cm(e,t))return{type:"bpmn:SequenceFlow"}}var i=Ic(e,t);return i||(sm(e,t)?{type:"bpmn:Association",associationDirection:"One"}:am(e,t)?{type:"bpmn:Association",associationDirection:"None"}:!1)}function Zi(e,t){return xe(e)||Dc(e)?!0:y(t,"bpmn:Participant")&&!Se(t)?!1:y(e,"bpmn:Participant")?y(t,"bpmn:Process")||y(t,"bpmn:Collaboration"):ve(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:y(e,"bpmn:Lane")?y(t,"bpmn:Participant")||y(t,"bpmn:Lane"):y(e,"bpmn:BoundaryEvent")&&!Bx(e)?!1:y(e,"bpmn:FlowElement")&&!y(e,"bpmn:DataStoreReference")?y(t,"bpmn:FlowElementsContainer")?Se(t):ve(t,["bpmn:Participant","bpmn:Lane"]):y(e,"bpmn:DataStoreReference")&&y(t,"bpmn:Collaboration")?Ji(Z(t).get("participants"),function(n){return!!n.get("processRef")}):ve(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?ve(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):y(e,"bpmn:MessageFlow")?y(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t:!1}function Bx(e){return Z(e).cancelActivity&&(em(e)||tm(e))}function jx(e){return!xe(e)&&y(e,"bpmn:BoundaryEvent")}function Vx(e){return y(e,"bpmn:Lane")}function Fx(e){return jx(e)||y(e,"bpmn:IntermediateThrowEvent")&&em(e)?!0:y(e,"bpmn:IntermediateCatchEvent")&&tm(e)}function em(e){var t=Z(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function tm(e){return nm(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function nm(e,t){return t.some(function(n){return en(e,n)})}function Hx(e){return y(e,"bpmn:ReceiveTask")&&Oe(e.incoming,function(t){return y(t.source,"bpmn:EventBasedGateway")})}function Sr(e,t,n,i){if(Array.isArray(e)||(e=[e]),e.length!==1)return!1;var r=e[0];return xe(r)||!Fx(r)||vt(t)||!y(t,"bpmn:Activity")||Ba(t)||i&&!Xh(i,t)||Hx(t)?!1:"attach"}function im(e,t,n){if(!t)return!1;var i={replacements:[]};return I(e,function(r){vt(t)||y(r,"bpmn:StartEvent")&&r.type!=="label"&&Zi(r,t)&&(mg(r)||i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),(vg(r)||gg(r)||yg(r))&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),nm(r,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&y(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"})),y(t,"bpmn:Transaction")||en(r,"bpmn:CancelEventDefinition")&&r.type!=="label"&&(y(r,"bpmn:EndEvent")&&Zi(r,t)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:EndEvent"}),y(r,"bpmn:BoundaryEvent")&&Sr(r,t,null,n)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:BoundaryEvent"}))}),i.replacements.length?i:!1}function rm(e,t){return Ji(e,Vx)?!1:t?e.every(function(n){return Zi(n,t)}):!0}function al(e,t,n,i){return t?xe(e)||Dc(e)?!0:Ax(n,t)||n&&ol(n,t)?!1:Zi(e,t)||la(e,t):!1}function om(e,t){return y(e,"bpmn:SubProcess")?Se(e)&&(!t||t.width>=100&&t.height>=80):!!(y(e,"bpmn:Lane")||y(e,"bpmn:Participant")||rl(e)||Dc(e))}function zx(e,t){var n=rl(e),i=rl(t);return(n||i)&&n!==i}function am(e,t){return ol(t,e)||ol(e,t)?!1:zx(e,t)?!0:!!Ic(e,t)}function sm(e,t){return Qh(e,t)&&Zh(e)&&y(t,"bpmn:Activity")&&!Gx(t,e)&&!vt(t)}function lm(e,t){return Mp(e)&&!Mp(t)?!1:Ix(e)&&Mx(t)&&!Dx(e,t)}function cm(e,t){return Nx(e)&&Ox(t)&&Qh(e,t)&&!(y(e,"bpmn:EventBasedGateway")&&!Lx(t))}function Ic(e,t){return ve(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ve(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:ve(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ve(e,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function la(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(e.length!==1)return!1;e=e[0]}return t.source===e||t.target===e?!1:ve(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!xe(t)&&y(e,"bpmn:FlowNode")&&!y(e,"bpmn:BoundaryEvent")&&Zi(e,t.parent)}function Ux(e,t){return e&&t&&e.indexOf(t)!==-1}function um(e,t){return xe(t)?!0:!(y(t,"bpmn:Lane")&&!Ux(e,t.parent))}function Mp(e){return na(e,"bpmn:Process")||na(e,"bpmn:Collaboration")}function Gx(e,t){return e.attachers.includes(t)}const Wx={__depends__:[cn],__init__:["bpmnRules"],bpmnRules:["type",st]};var Yx=2e3;function pm(e,t){e.on("saveXML.start",Yx,n);function n(){var i=t.getRootElements();I(i,function(r){var o=Ie(r),a,s;a=Hr([r],!1),a=ye(a,function(l){return l!==r&&!l.labelTarget}),s=Et(a,Ie),o.set("planeElement",s)})}}pm.$inject=["eventBus","canvas"];const qx={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",pm]};function ja(e){W.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(n){var i=n.context,r=i.shape||i.connection,o=i.parent,a=t.getOrdering(r,o);a&&(a.parent!==void 0&&(i.parent=a.parent),i.parentIndex=a.index)}),this.preExecute(["shape.move","connection.move"],function(n){var i=n.context,r=i.shape||i.connection,o=i.newParent||r.parent,a=t.getOrdering(r,o);a&&(a.parent!==void 0&&(i.newParent=a.parent),i.newParentIndex=a.index)})}ja.prototype.getOrdering=function(e,t){return null};te(ja,W);function Mc(e,t,n){ja.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:9,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:TextAnnotation",order:{level:9}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function r(s){if(s.labelTarget)return{level:10};var l=Oe(i,function(c){return ve(s,[c.type])});return l&&l.order||{level:1}}function o(s){var l=s.order;if(l||(s.order=l=r(s)),!l)throw new Error("no order for <"+s.id+">");return l}function a(s,l,c){for(var p=l;p&&!ve(p,c);)p=p.parent;if(!p)throw new Error("no parent for <"+s.id+"> in <"+(l&&l.id)+">");return p}this.getOrdering=function(s,l){if(s.labelTarget||y(s,"bpmn:TextAnnotation"))return{parent:t.findRoot(l)||t.getRootElement(),index:-1};var c=o(s);c.containers&&(l=a(s,l,c.containers));var p=l.children.indexOf(s),u=_g(l.children,function(d){return!s.labelTarget&&d.labelTarget?!1:c.level<o(d).level});return u!==-1&&p!==-1&&p<u&&(u-=1),{index:u,parent:l}}}Mc.$inject=["eventBus","canvas","translate"];te(Mc,ja);const Kx={__depends__:[hf],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",Mc]};function Yr(){}Yr.prototype.get=function(){return this._data};Yr.prototype.set=function(e){this._data=e};Yr.prototype.clear=function(){var e=this._data;return delete this._data,e};Yr.prototype.isEmpty=function(){return!this._data};const Xx={clipboard:["type",Yr]};var Zx="drop-ok",Np="drop-not-ok",Op="attach-ok",Lp="new-parent",$p="create",Qx=2e3;function dm(e,t,n,i,r){function o(l,c,p,u,d){if(!c)return!1;l=ye(l,function(b){var T=b.labelTarget;return!b.parent&&!(xe(b)&&l.indexOf(T)!==-1)});var f=Oe(l,function(b){return!De(b)}),h=!1,v=!1,m=!1;jp(l)&&(h=r.allowed("shape.attach",{position:p,shape:f,target:c})),h||(jp(l)?m=r.allowed("shape.create",{position:p,shape:f,source:u,target:c}):m=r.allowed("elements.create",{elements:l,position:p,target:c}));var S=d.connectionTarget;return m||h?(f&&u&&(v=r.allowed("connection.create",{source:S===u?f:u,target:S===u?u:f,hints:{targetParent:c,targetAttach:h}})),{attach:h,connect:v}):m===null||h===null?null:!1}function a(l,c){[Op,Zx,Np,Lp].forEach(function(p){p===c?e.addMarker(l,p):e.removeMarker(l,p)})}n.on(["create.move","create.hover"],function(l){var c=l.context,p=c.elements,u=l.hover,d=c.source,f=c.hints||{};if(!u){c.canExecute=!1,c.target=null;return}Bp(l);var h={x:l.x,y:l.y},v=c.canExecute=u&&o(p,u,h,d,f);u&&v!==null&&(c.target=u,v&&v.attach?a(u,Op):a(u,v?Lp:Np))}),n.on(["create.end","create.out","create.cleanup"],function(l){var c=l.hover;c&&a(c,null)}),n.on("create.end",function(l){var c=l.context,p=c.source,u=c.shape,d=c.elements,f=c.target,h=c.canExecute,v=h&&h.attach,m=h&&h.connect,S=c.hints||{};if(h===!1||!f)return!1;Bp(l);var b={x:l.x,y:l.y};m?u=i.appendShape(p,u,b,f,{attach:v,connection:m===!0?{}:m,connectionTarget:S.connectionTarget}):(d=i.createElements(d,b,f,N({},S,{attach:v})),u=Oe(d,function(T){return!De(T)})),N(c,{elements:d,shape:u}),N(l,{elements:d,shape:u})});function s(){var l=t.context();l&&l.prefix===$p&&t.cancel()}n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],Qx,function(){n.off("elements.changed",s)})}),this.start=function(l,c,p){Pe(c)||(c=[c]);var u=Oe(c,function(h){return!De(h)});if(u){p=N({elements:c,hints:{},shape:u},p||{}),I(c,function(h){_e(h.x)||(h.x=0),_e(h.y)||(h.y=0)});var d=ye(c,function(h){return!h.hidden}),f=Pt(d);I(c,function(h){De(h)&&(h.waypoints=Et(h.waypoints,function(v){return{x:v.x-f.x-f.width/2,y:v.y-f.y-f.height/2}})),N(h,{x:h.x-f.x-f.width/2,y:h.y-f.y-f.height/2})}),t.init(l,$p,{cursor:"grabbing",autoActivate:!0,data:{shape:u,elements:c,context:p}})}}}dm.$inject=["canvas","dragging","eventBus","modeling","rules"];function Bp(e){var t=e.context,n=t.createConstraints;n&&(n.left&&(e.x=Math.max(e.x,n.left)),n.right&&(e.x=Math.min(e.x,n.right)),n.top&&(e.y=Math.max(e.y,n.top)),n.bottom&&(e.y=Math.min(e.y,n.bottom)))}function jp(e){return e&&e.length===1&&!De(e[0])}var Jx=750;function fm(e,t,n,i,r){function o(a){var s=Ee("g");pe(s,r.cls("djs-drag-group",["no-events"]));var l=Ee("g");return a.forEach(function(c){var p;c.hidden||(c.waypoints?(p=n._createContainer("connection",l),n.drawConnection(Gi(p),c)):(p=n._createContainer("shape",l),n.drawShape(Gi(p),c),mt(p,c.x,c.y)),i.addDragger(c,s,p))}),s}t.on("create.move",Jx,function(a){var s=a.hover,l=a.context,c=l.elements,p=l.dragGroup;p||(p=l.dragGroup=o(c));var u;s?(p.parentNode||(u=e.getActiveLayer(),Te(u,p)),mt(p,a.x,a.y)):pt(p)}),t.on("create.cleanup",function(a){var s=a.context,l=s.dragGroup;l&&pt(l)})}fm.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const Va={__depends__:[Sn,rr,cn,En],__init__:["create","createPreview"],create:["type",dm],createPreview:["type",fm]};function Nc(e){var t=this;this._lastMoveEvent=null;function n(i){t._lastMoveEvent=i}e.on("canvas.init",function(i){var r=t._svg=i.svg;r.addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}Nc.$inject=["eventBus"];Nc.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||ew(0,0)};function ew(e,t){var n=document.createEvent("MouseEvent"),i=e,r=t,o=e,a=t;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,r,o,a,!1,!1,!1,!1,0,null),n}const qr={__init__:["mouse"],mouse:["type",Nc]};function qt(e,t,n,i,r,o,a,s){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=r,this._modeling=o,this._mouse=a,this._rules=s,r.on("copyPaste.copyElement",function(l){var c=l.descriptor,p=l.element,u=l.elements;c.priority=1,c.id=p.id;var d=Oe(u,function(f){return f===p.parent});d&&(c.parent=p.parent.id),tw(p)&&(c.priority=2,c.host=p.host.id),De(p)&&(c.priority=3,c.source=p.source.id,c.target=p.target.id,c.waypoints=nw(p)),xe(p)&&(c.priority=4,c.labelTarget=p.labelTarget.id),I(["x","y","width","height"],function(f){_e(p[f])&&(c[f]=p[f])}),c.hidden=p.hidden,c.collapsed=p.collapsed}),r.on("copyPaste.pasteElements",function(l){var c=l.hints;N(c,{createElementsBehavior:!1})})}qt.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];qt.prototype.copy=function(e){var t,n;return Pe(e)||(e=e?[e]:[]),t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}),t===!1?n={}:n=this.createTree(Pe(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n};qt.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}};qt.prototype._paste=function(e,t,n,i){I(e,function(o){_e(o.x)||(o.x=0),_e(o.y)||(o.y=0)});var r=Pt(e);return I(e,function(o){De(o)&&(o.waypoints=Et(o.waypoints,function(a){return{x:a.x-r.x-r.width/2,y:a.y-r.y-r.height/2}})),N(o,{x:o.x-r.x-r.width/2,y:o.y-r.y-r.height/2})}),this._modeling.createElements(e,n,t,N({},i))};qt.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},r=[];return I(e,function(o,a){o=on(o,"priority"),I(o,function(s){var l=N({},bn(s,["priority"]));i[s.parent]?l.parent=i[s.parent]:delete l.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:l});var c;if(De(l)){l.source=i[s.source],l.target=i[s.target],c=i[s.id]=t.createConnection(l),r.push(c);return}if(xe(l)){l.labelTarget=i[l.labelTarget],c=i[s.id]=t.createLabel(l),r.push(c);return}l.host&&(l.host=i[l.host]),c=i[s.id]=t.createShape(l),r.push(c)})}),r};qt.prototype.createConnection=function(e){var t=this._elementFactory.createConnection(bn(e,["id"]));return t};qt.prototype.createLabel=function(e){var t=this._elementFactory.createLabel(bn(e,["id"]));return t};qt.prototype.createShape=function(e){var t=this._elementFactory.createShape(bn(e,["id"]));return t};qt.prototype.hasRelations=function(e,t){var n,i,r;return!(De(e)&&(i=Oe(t,mn({id:e.source.id})),r=Oe(t,mn({id:e.target.id})),!i||!r)||xe(e)&&(n=Oe(t,mn({id:e.labelTarget.id})),!n))};qt.prototype.createTree=function(e){var t=this._rules,n=this,i={},r=[],o=va(e);function a(c,p){return t.allowed("element.copy",{element:c,elements:p})}function s(c,p){var u=Oe(r,function(d){return c===d.element});if(!u){r.push({element:c,depth:p});return}u.depth<p&&(r=l(u,r),r.push({element:u.element,depth:p}))}function l(c,p){var u=p.indexOf(c);return u!==-1&&p.splice(u,1),p}return ba(o,function(c,p,u){if(xe(c))return;I(c.labels,function(h){s(h,u)});function d(h){h&&h.length&&I(h,function(v){I(v.labels,function(m){s(m,u)}),s(v,u)})}I([c.attachers,c.incoming,c.outgoing],d),s(c,u);var f=[];return c.children&&(f=c.children.slice()),n._eventBus.fire("copyPaste.createTree",{element:c,children:f}),f}),e=Et(r,function(c){return c.element}),r=Et(r,function(c){return c.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:c.descriptor,element:c.element,elements:e}),c}),r=on(r,function(c){return c.descriptor.priority}),e=Et(r,function(c){return c.element}),I(r,function(c){var p=c.depth;if(!n.hasRelations(c.element,e)){Fp(c.element,e);return}if(!a(c.element,e)){Fp(c.element,e);return}i[p]||(i[p]=[]),i[p].push(c.descriptor)}),i};function tw(e){return!!e.host}function nw(e){return Et(e.waypoints,function(t){return t=Vp(t),t.original&&(t.original=Vp(t.original)),t})}function Vp(e){return N({},e)}function Fp(e,t){var n=t.indexOf(e);return n===-1?t:t.splice(n,1)}const iw={__depends__:[Xx,Va,qr,cn],__init__:["copyPaste"],copyPaste:["type",qt]};function Ts(e,t,n){Pe(n)||(n=[n]),I(n,function(i){mf(e[i])||(t[i]=e[i])})}var Ps=750;function hm(e,t,n){function i(l,c){var p=e.create(l.$type);return n.copyElement(l,p,null,c)}t.on("copyPaste.copyElement",Ps,function(l){var c=l.descriptor,p=l.element,u=Z(p);if(xe(p))return c;var d=c.businessObject=i(u,!0),f=c.di=i(Ie(p),!0);f.bpmnElement=d,Ts(d,c,"name"),Ts(f,c,"isExpanded"),u.default&&(c.default=u.default.id)});var r="-bpmn-js-refs";function o(l){return l[r]=l[r]||{}}function a(l,c){l[r]=c}function s(l,c,p){var u=Z(l);return l.default&&(p[l.default]={element:u,property:"default"}),l.host&&(Z(l).attachedToRef=Z(c[l.host])),bn(p,qn(p,function(d,f,h){var v=f.element,m=f.property;return h===l.id&&(v.set(m,u),d.push(l.id)),d},[]))}t.on("copyPaste.pasteElement",function(l){var c=l.cache,p=l.descriptor,u=p.businessObject,d=p.di;if(xe(p)){p.businessObject=Z(c[p.labelTarget]),p.di=Ie(c[p.labelTarget]);return}u=p.businessObject=i(u),d=p.di=i(d),d.bpmnElement=u,Ts(p,u,["isExpanded","name"]),p.type=u.$type}),t.on("copyPaste.copyElement",Ps,function(l){var c=l.descriptor,p=l.element;if(y(p,"bpmn:Participant")){var u=Z(p);u.processRef&&(c.processRef=i(u.processRef,!0))}}),t.on("copyPaste.pasteElement",function(l){var c=l.descriptor,p=c.processRef;p&&(c.processRef=i(p))}),t.on("copyPaste.pasteElement",Ps,function(l){var c=l.cache,p=l.descriptor;a(c,s(p,c,o(c)))})}hm.$inject=["bpmnFactory","eventBus","moddleCopy"];var rw=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing","categoryValue"];function Kr(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",function(i){var r=i.propertyNames;if(!(!r||!r.length))return on(r,function(o){return o==="extensionElements"})}),e.on("moddleCopy.canCopyProperty",function(i){var r=i.parent,o=yn(r)&&r.$descriptor,a=i.propertyName;if(a&&rw.indexOf(a)!==-1||a&&o&&!Oe(o.properties,mn({name:a})))return!1}),e.on("moddleCopy.canSetCopiedProperty",function(i){var r=i.property;if(ow(r,"bpmn:ExtensionElements")&&(!r.values||!r.values.length))return!1})}Kr.$inject=["eventBus","bpmnFactory","moddle"];Kr.prototype.copyElement=function(e,t,n,i=!1){var r=this;n&&!Pe(n)&&(n=[n]),n=n||sl(e.$descriptor);var o=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t,clone:i});return o===!1||(Pe(o)&&(n=o),I(n,function(a){var s;jn(e,a)&&(s=e.get(a));var l=r.copyProperty(s,t,a,i);if(Tt(l)){var c=r._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:l,propertyName:a});c!==!1&&t.set(a,l)}})),t};Kr.prototype.copyProperty=function(e,t,n,i=!1){var r=this,o=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n,clone:i});if(o!==!1){if(o)return yn(o)&&o.$type&&!o.$parent&&(o.$parent=t),o;var a=this._moddle.getPropertyDescriptor(t,n);if(!a.isReference)return a.isId?e&&this._copyId(e,t,i):Pe(e)?qn(e,function(s,l){return o=r.copyProperty(l,t,n,i),o?s.concat(o):s},[]):yn(e)&&e.$type?this._moddle.getElementDescriptor(e).isGeneric?void 0:(o=r._bpmnFactory.create(e.$type),o.$parent=t,o=r.copyElement(e,o,null,i),o):e}};Kr.prototype._copyId=function(e,t,n=!1){if(n)return e;if(!this._moddle.ids.assigned(e))return this._moddle.ids.claim(e,t),e};function sl(e,t){return qn(e.properties,function(n,i){return t&&i.default?n:n.concat(i.name)},[])}function ow(e,t){return e&&rn(e.$instanceOf)&&e.$instanceOf(t)}const mm={__depends__:[iw],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",hm],moddleCopy:["type",Kr]};var Hp=Math.round;function Oc(e,t){this._modeling=e,this._eventBus=t}Oc.$inject=["modeling","eventBus"];Oc.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,r=this._eventBus;r.fire("replace.start",{element:e,attrs:t,hints:n});var o=t.width||e.width,a=t.height||e.height,s=t.x||e.x,l=t.y||e.y,c=Hp(s+o/2),p=Hp(l+a/2),u=i.replaceShape(e,N({},t,{x:c,y:p,width:o,height:a}),n);return r.fire("replace.end",{element:e,newElement:u,hints:n}),u};function vm(e,t){t.on("replace.end",500,function(n){const{newElement:i,hints:r={}}=n;r.select!==!1&&e.select(i)})}vm.$inject=["selection","eventBus"];const aw={__init__:["replace","replaceSelectionBehavior"],replaceSelectionBehavior:["type",vm],replace:["type",Oc]};function sw(e,t,n){Pe(n)||(n=[n]),I(n,function(i){mf(e[i])||(t[i]=e[i])})}var lw=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function cw(e,t){var n=e&&jn(e,"collapsed")?e.collapsed:!Se(e),i;return t&&(jn(t,"collapsed")||jn(t,"isExpanded"))?i=jn(t,"collapsed")?t.collapsed:!t.isExpanded:i=n,n!==i}function gm(e,t,n,i,r,o){function a(s,l,c){c=c||{};var p=l.type,u=s.businessObject;if(Mo(u)&&p==="bpmn:SubProcess"&&cw(s,l))return i.toggleCollapse(s),s;var d=e.create(p),f={type:p,businessObject:d};f.di={},p==="bpmn:ExclusiveGateway"&&(f.di.isMarkerVisible=!0),sw(s.di,f.di,["fill","stroke","background-color","border-color","color"]);var h=sl(u.$descriptor),v=sl(d.$descriptor,!0),m=uw(h,v);N(d,an(l,lw));var S=ye(m,function(T){return T==="eventDefinitions"?zp(s,l.eventDefinitionType):T==="loopCharacteristics"?!vt(d):jn(d,T)||T==="processRef"&&l.isExpanded===!1||T==="triggeredByEvent"?!1:T==="isForCompensation"?!vt(d):!0});if(d=n.copyElement(u,d,S),l.eventDefinitionType&&(zp(d,l.eventDefinitionType)||(f.eventDefinitionType=l.eventDefinitionType,f.eventDefinitionAttrs=l.eventDefinitionAttrs)),y(u,"bpmn:Activity")){if(Mo(u))f.isExpanded=Se(s);else if(l&&jn(l,"isExpanded")){f.isExpanded=l.isExpanded;var b=t.getDefaultSize(d,{isExpanded:f.isExpanded});f.width=b.width,f.height=b.height,f.x=s.x-(f.width-s.width)/2,f.y=s.y-(f.height-s.height)/2}Se(s)&&!y(u,"bpmn:Task")&&f.isExpanded&&(f.width=s.width,f.height=s.height)}return Mo(u)&&!Mo(d)&&(c.moveChildren=!1),y(u,"bpmn:Participant")&&(l.isExpanded===!0?d.processRef=e.create("bpmn:Process"):c.moveChildren=!1,f.width=s.width,f.height=t.getDefaultSize(f).height),o.allowed("shape.resize",{shape:d})||(f.height=t.getDefaultSize(f).height,f.width=t.getDefaultSize(f).width),d.name=u.name,ve(u,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&ve(d,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(d.default=u.default),l.host&&!y(u,"bpmn:BoundaryEvent")&&y(d,"bpmn:BoundaryEvent")&&(f.host=l.host),(f.type==="bpmn:DataStoreReference"||f.type==="bpmn:DataObjectReference")&&(f.x=s.x+(s.width-f.width)/2),r.replaceElement(s,f,{...c,targetElement:l})}this.replaceElement=a}gm.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules"];function Mo(e){return y(e,"bpmn:SubProcess")}function zp(e,t){var n=Z(e);return t&&n.get("eventDefinitions").some(function(i){return y(i,t)})}function uw(e,t){return e.filter(function(n){return t.includes(n)})}const ym={__depends__:[mm,aw,En],bpmnReplace:["type",gm]};var pw=250;function Pi(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}Pi.$inject=["eventBus","dragging"];Pi.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error(`A tool has to be registered with it's "events"`);n.push(e),this.bindEvents(e,t)};Pi.prototype.isActive=function(e){return e&&this._active===e};Pi.prototype.length=function(e){return this._tools.length};Pi.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))};Pi.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(o){var a=o.context;if(!a.reactivate&&this.isActive(e)){this.setActive(null),i.cancel();return}this.setActive(e)},this),I(t,function(o){r.push(o+".ended"),r.push(o+".canceled")}),n.on(r,pw,function(o){this._active&&(dw(o)||this.setActive(null))},this)};function dw(e){var t=e.originalEvent&&e.originalEvent.target;return t&&Yn(t,'.group[data-group="tools"]')}const Fa={__depends__:[Sn],__init__:["toolManager"],toolManager:["type",Pi]};function fw(e,t){if(e==="x"){if(t>0)return"e";if(t<0)return"w"}if(e==="y"){if(t>0)return"s";if(t<0)return"n"}return null}function hw(e,t){var n=[];return I(e.concat(t),function(i){var r=i.incoming,o=i.outgoing;I(r.concat(o),function(a){var s=a.source,l=a.target;(_r(e,s)||_r(e,l)||_r(t,s)||_r(t,l))&&(_r(n,a)||n.push(a))})}),n}function _r(e,t){return e.indexOf(t)!==-1}function mw(e,t,n){var i=e.x,r=e.y,o=e.width,a=e.height,s=n.x,l=n.y;switch(t){case"n":return{x:i,y:r+l,width:o,height:a-l};case"s":return{x:i,y:r,width:o,height:a+l};case"w":return{x:i+s,y:r,width:o-s,height:a};case"e":return{x:i,y:r,width:o+s,height:a};default:throw new Error("unknown direction: "+t)}}var Rs=Math.abs,vw=Math.round,fn={x:"width",y:"height"},_m="crosshair",Ln={n:"top",w:"left",s:"bottom",e:"right"},gw=1500,No={n:"s",w:"e",s:"n",e:"w"},Oo=20;function Bt(e,t,n,i,r,o,a){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=r,this._toolManager=o,this._mouse=a;var s=this;o.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(l){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(l.originalEvent)})}),n.on("spaceTool.move",gw,function(l){var c=l.context,p=c.initialized;p||(p=c.initialized=s.init(l,c)),p&&Gp(l)}),n.on("spaceTool.end",function(l){var c=l.context,p=c.axis,u=c.direction,d=c.movingShapes,f=c.resizingShapes,h=c.start;if(c.initialized){Gp(l);var v={x:0,y:0};v[p]=vw(l["d"+p]),s.makeSpace(d,f,v,u,h),n.once("spaceTool.ended",function(m){s.activateSelection(m.originalEvent,!0,!0)})}})}Bt.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];Bt.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:_m,data:{context:{reactivate:n}},trapClick:!1})};Bt.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:_m,data:{context:{}}})};Bt.prototype.makeSpace=function(e,t,n,i,r){return this._modeling.createSpace(e,t,n,i,r)};Bt.prototype.init=function(e,t){var n=Rs(e.dx)>Rs(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(Rs(i)<5)return!1;i<0&&(i*=-1),Mr(e)&&(i*=-1);var o=fw(n,i),a=this._canvas.getRootElement();!vf(e)&&e.hover&&(a=e.hover);var s=[...Hr(a,!0),...a.attachers||[]],l=this.calculateAdjustments(s,n,i,r),c=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:o,shapes:l.resizingShapes,start:r}),p=yw(l,n,o,r,c);return N(t,l,{axis:n,direction:o,spaceToolConstraints:p,start:r}),wa("resize-"+(n==="x"?"ew":"ns")),!0};Bt.prototype.calculateAdjustments=function(e,t,n,i){var r=this._rules,o=[],a=[],s=[],l=[];function c(d){o.includes(d)||o.push(d);var f=d.label;f&&!o.includes(f)&&o.push(f)}function p(d){a.includes(d)||a.push(d)}I(e,function(d){if(!(!d.parent||xe(d))){if(De(d)){l.push(d);return}var f=d[t],h=f+d[fn[t]];if(_w(d)&&(n>0&&de(d)[t]>i||n<0&&de(d)[t]<i)){s.push(d);return}if(n>0&&f>i||n<0&&h<i){c(d);return}if(f<i&&h>i&&r.allowed("shape.resize",{shape:d})){p(d);return}}}),I(o,function(d){var f=d.attachers;f&&I(f,function(h){c(h)})});var u=o.concat(a);return I(s,function(d){var f=d.host;vi(u,f)&&c(d)}),u=o.concat(a),I(l,function(d){var f=d.source,h=d.target,v=d.label;vi(u,f)&&vi(u,h)&&v&&c(v)}),{movingShapes:o,resizingShapes:a}};Bt.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Bt.prototype.isActive=function(){var e=this._dragging.context();return e?/^spaceTool/.test(e.prefix):!1};function Up(e){return{top:e.top-Oo,right:e.right+Oo,bottom:e.bottom+Oo,left:e.left-Oo}}function Gp(e){var t=e.context,n=t.spaceToolConstraints;if(n){var i,r;_e(n.left)&&(i=Math.max(e.x,n.left),e.dx=e.dx+i-e.x,e.x=i),_e(n.right)&&(i=Math.min(e.x,n.right),e.dx=e.dx+i-e.x,e.x=i),_e(n.top)&&(r=Math.max(e.y,n.top),e.dy=e.dy+r-e.y,e.y=r),_e(n.bottom)&&(r=Math.min(e.y,n.bottom),e.dy=e.dy+r-e.y,e.y=r)}}function yw(e,t,n,i,r){var o=e.movingShapes,a=e.resizingShapes;if(a.length){var s={},l,c;return I(a,function(p){var u=p.attachers,d=p.children,f=se(p),h=ye(d,function(Y){return!De(Y)&&!xe(Y)&&!vi(o,Y)&&!vi(a,Y)}),v=ye(d,function(Y){return!De(Y)&&!xe(Y)&&vi(o,Y)}),m,S,b,T=[],C=[],k,A,j,V;h.length&&(S=Up(se(Pt(h))),m=i-f[Ln[n]]+S[Ln[n]],n==="n"?s.bottom=c=_e(c)?Math.min(c,m):m:n==="w"?s.right=c=_e(c)?Math.min(c,m):m:n==="s"?s.top=l=_e(l)?Math.max(l,m):m:n==="e"&&(s.left=l=_e(l)?Math.max(l,m):m)),v.length&&(b=Up(se(Pt(v))),m=i-b[Ln[No[n]]]+f[Ln[No[n]]],n==="n"?s.bottom=c=_e(c)?Math.min(c,m):m:n==="w"?s.right=c=_e(c)?Math.min(c,m):m:n==="s"?s.top=l=_e(l)?Math.max(l,m):m:n==="e"&&(s.left=l=_e(l)?Math.max(l,m):m)),u&&u.length&&(u.forEach(function(Y){vi(o,Y)?T.push(Y):C.push(Y)}),T.length&&(k=se(Pt(T.map(de))),A=f[Ln[No[n]]]-(k[Ln[No[n]]]-i)),C.length&&(j=se(Pt(C.map(de))),V=j[Ln[n]]-(f[Ln[n]]-i)),n==="n"?(m=Math.min(A||1/0,V||1/0),s.bottom=c=_e(c)?Math.min(c,m):m):n==="w"?(m=Math.min(A||1/0,V||1/0),s.right=c=_e(c)?Math.min(c,m):m):n==="s"?(m=Math.max(A||-1/0,V||-1/0),s.top=l=_e(l)?Math.max(l,m):m):n==="e"&&(m=Math.max(A||-1/0,V||-1/0),s.left=l=_e(l)?Math.max(l,m):m));var H=r&&r[p.id];H&&(n==="n"?(m=i+p[fn[t]]-H[fn[t]],s.bottom=c=_e(c)?Math.min(c,m):m):n==="w"?(m=i+p[fn[t]]-H[fn[t]],s.right=c=_e(c)?Math.min(c,m):m):n==="s"?(m=i-p[fn[t]]+H[fn[t]],s.top=l=_e(l)?Math.max(l,m):m):n==="e"&&(m=i-p[fn[t]]+H[fn[t]],s.left=l=_e(l)?Math.max(l,m):m))}),s}}function vi(e,t){return e.indexOf(t)!==-1}function _w(e){return!!e.host}var ks="djs-dragging",Wp="djs-resizing",bw=250,Lo=Math.max;function bm(e,t,n,i,r){function o(a,s){I(a,function(l){r.addDragger(l,s),n.addMarker(l,ks)})}e.on("spaceTool.selection.start",function(a){var s=n.getLayer("space"),l=a.context,c={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},p=Ee("g");pe(p,i.cls("djs-crosshair-group",["no-events"])),Te(s,p);var u=Ee("path");pe(u,"d",c.x),Ne(u).add("djs-crosshair"),Te(p,u);var d=Ee("path");pe(d,"d",c.y),Ne(d).add("djs-crosshair"),Te(p,d),l.crosshairGroup=p}),e.on("spaceTool.selection.move",function(a){var s=a.context.crosshairGroup;mt(s,a.x,a.y)}),e.on("spaceTool.selection.cleanup",function(a){var s=a.context,l=s.crosshairGroup;l&&pt(l)}),e.on("spaceTool.move",bw,function(a){var s=a.context,l=s.line,c=s.axis,p=s.movingShapes,u=s.resizingShapes;if(s.initialized){if(!s.dragGroup){var d=n.getLayer("space");l=Ee("path"),pe(l,"d","M0,0 L0,0"),Ne(l).add("djs-crosshair"),Te(d,l),s.line=l;var f=Ee("g");pe(f,i.cls("djs-drag-group",["no-events"])),Te(n.getActiveLayer(),f),o(p,f);var h=s.movingConnections=t.filter(function(C){var k=!1;I(p,function(H){I(H.outgoing,function(Y){C===Y&&(k=!0)})});var A=!1;I(p,function(H){I(H.incoming,function(Y){C===Y&&(A=!0)})});var j=!1;I(u,function(H){I(H.outgoing,function(Y){C===Y&&(j=!0)})});var V=!1;return I(u,function(H){I(H.incoming,function(Y){C===Y&&(V=!0)})}),De(C)&&(k||j)&&(A||V)});o(h,f),s.dragGroup=f}if(!s.frameGroup){var v=Ee("g");pe(v,i.cls("djs-frame-group",["no-events"])),Te(n.getActiveLayer(),v);var m=[];I(u,function(C){var k=r.addFrame(C,v),A=k.getBBox();m.push({element:k,initialBounds:A}),n.addMarker(C,Wp)}),s.frameGroup=v,s.frames=m}var S={x:"M"+a.x+", -10000 L"+a.x+", 10000",y:"M -10000, "+a.y+" L 10000, "+a.y};pe(l,{d:S[c]});var b={x:"y",y:"x"},T={x:a.dx,y:a.dy};T[b[s.axis]]=0,mt(s.dragGroup,T.x,T.y),I(s.frames,function(C){var k=C.element,A=C.initialBounds,j,V;s.direction==="e"?pe(k,{width:Lo(A.width+T.x,5)}):(j=Lo(A.width-T.x,5),pe(k,{width:j,x:A.x+A.width-j})),s.direction==="s"?pe(k,{height:Lo(A.height+T.y,5)}):(V=Lo(A.height-T.y,5),pe(k,{height:V,y:A.y+A.height-V}))})}}),e.on("spaceTool.cleanup",function(a){var s=a.context,l=s.movingShapes,c=s.movingConnections,p=s.resizingShapes,u=s.line,d=s.dragGroup,f=s.frameGroup;I(l,function(h){n.removeMarker(h,ks)}),I(c,function(h){n.removeMarker(h,ks)}),d&&(pt(u),pt(d)),I(p,function(h){n.removeMarker(h,Wp)}),f&&pt(f)})}bm.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];const Ew={__init__:["spaceToolPreview"],__depends__:[Sn,cn,Fa,rr,qr],spaceTool:["type",Bt],spaceToolPreview:["type",bm]};function Ha(e){e.invoke(Bt,this)}Ha.$inject=["injector"];te(Ha,Bt);Ha.prototype.calculateAdjustments=function(e,t,n,i){var r=Bt.prototype.calculateAdjustments.call(this,e,t,n,i);return r.resizingShapes=r.resizingShapes.filter(function(o){return!(y(o,"bpmn:TextAnnotation")||xw(o)&&(t==="y"&&_n(o)||t==="x"&&!_n(o)))}),r};function xw(e){return y(e,"bpmn:Participant")&&!Z(e).processRef}const Em={__depends__:[Ew],spaceTool:["type",Ha]};function Ve(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}Ve.$inject=["eventBus","injector"];Ve.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";const n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction()};Ve.prototype.canExecute=function(e,t){const n={command:e,context:t},i=this._getHandler(e);let r=this._fire(e,"canExecute",n);if(r===void 0){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r};Ve.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,e!==!1&&this._fire("changed",{trigger:"clear"})};Ve.prototype.undo=function(){let e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};Ve.prototype.redo=function(){let e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};Ve.prototype.register=function(e,t){this._setHandler(e,t)};Ve.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");const n=this._injector.instantiate(t);this.register(e,n)};Ve.prototype.canUndo=function(){return!!this._getUndoAction()};Ve.prototype.canRedo=function(){return!!this._getRedoAction()};Ve.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};Ve.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};Ve.prototype._internalUndo=function(e){const t=e.command,n=e.context,i=this._getHandler(t);this._atomicDo(()=>{this._fire(t,"revert",e),i.revert&&this._markDirty(i.revert(n)),this._revertedAction(e),this._fire(t,"reverted",e)})};Ve.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);const i=t?[e+"."+t,t]:[e];let r;n=this._eventBus.createEvent(n);for(const o of i)if(r=this._eventBus.fire("commandStack."+o,n),n.cancelBubble)break;return r};Ve.prototype._createId=function(){return this._uid++};Ve.prototype._atomicDo=function(e){const t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}};Ve.prototype._internalExecute=function(e,t){const n=e.command,i=e.context,r=this._getHandler(n);if(!r)throw new Error("no command handler registered for <"+n+">");this._pushAction(e),t||(this._fire(n,"preExecute",e),r.preExecute&&r.preExecute(i),this._fire(n,"preExecuted",e)),this._atomicDo(()=>{this._fire(n,"execute",e),r.execute&&this._markDirty(r.execute(i)),this._executedAction(e,t),this._fire(n,"executed",e)}),t||(this._fire(n,"postExecute",e),r.postExecute&&r.postExecute(i),this._fire(n,"postExecuted",e)),this._popAction()};Ve.prototype._pushAction=function(e){const t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)};Ve.prototype._popAction=function(){const e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:bg("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)};Ve.prototype._markDirty=function(e){const t=this._currentExecution;e&&(e=Pe(e)?e:[e],t.dirty=t.dirty.concat(e))};Ve.prototype._executedAction=function(e,t){const n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)};Ve.prototype._revertedAction=function(e){this._stackIdx--};Ve.prototype._getHandler=function(e){return this._handlerMap[e]};Ve.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};const ww={commandStack:["type",Ve]};function Fn(e,t){if(typeof t!="function")throw new Error("removeFn iterator must be a function");if(e){for(var n;n=e[0];)t(n);return e}}var Sw=250,Yp=1400;function Lc(e,t,n){W.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",Yp,function(r){var o=r.context,a=o.shapes,s=o.validatedShapes;o.shapes=qp(a),o.validatedShapes=qp(s)}),i&&t.on("shape.move.start",Sw,function(r){var o=r.context,a=o.shapes,s=[];I(a,function(l){I(l.labels,function(c){!c.hidden&&o.shapes.indexOf(c)===-1&&s.push(c),l.labelTarget&&s.push(l)})}),I(s,function(l){i.makeDraggable(o,l,!0)})}),this.preExecuted("elements.move",Yp,function(r){var o=r.context,a=o.closure,s=a.enclosedElements,l=[];I(s,function(c){I(c.labels,function(p){s[p.id]||l.push(p)})}),a.addAll(l)}),this.preExecute(["connection.delete","shape.delete"],function(r){var o=r.context,a=o.connection||o.shape;Fn(a.labels,function(s){n.removeShape(s,{nested:!0})})}),this.execute("shape.delete",function(r){var o=r.context,a=o.shape,s=a.labelTarget;s&&(o.labelTargetIndex=Cl(s.labels,a),o.labelTarget=s,a.labelTarget=null)}),this.revert("shape.delete",function(r){var o=r.context,a=o.shape,s=o.labelTarget,l=o.labelTargetIndex;s&&(tt(s.labels,a,l),a.labelTarget=s)})}te(Lc,W);Lc.$inject=["injector","eventBus","modeling"];function qp(e){return ye(e,function(t){return e.indexOf(t.labelTarget)===-1})}const Cw={__init__:["labelSupport"],labelSupport:["type",Lc]};var Tw=251,Kp=1401,Xp="attach-ok";function $c(e,t,n,i,r){W.call(this,t);var o=e.get("movePreview",!1);t.on("shape.move.start",Kp,function(a){var s=a.context,l=s.shapes,c=s.validatedShapes;s.shapes=Pw(l),s.validatedShapes=Rw(c)}),o&&t.on("shape.move.start",Tw,function(a){var s=a.context,l=s.shapes,c=ll(l);I(c,function(p){o.makeDraggable(s,p,!0),I(p.labels,function(u){o.makeDraggable(s,u,!0)})})}),o&&t.on("shape.move.start",function(a){var s=a.context,l=s.shapes;if(l.length===1){var c=l[0],p=c.host;p&&(n.addMarker(p,Xp),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(p,Xp)}))}}),this.preExecuted("elements.move",Kp,function(a){var s=a.context,l=s.closure,c=s.shapes,p=ll(c);I(p,function(u){l.add(u,l.topLevel[u.host.id])})}),this.postExecuted("elements.move",function(a){var s=a.context,l=s.shapes,c=s.newHost,p;c&&l.length!==1||(c?p=l:p=ye(l,function(u){var d=u.host;return kw(u)&&!Aw(l,d)}),I(p,function(u){r.updateAttachment(u,c)}))}),this.postExecuted("elements.move",function(a){var s=a.context.shapes;I(s,function(l){I(l.attachers,function(c){I(c.outgoing.slice(),function(p){var u=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});u||r.removeConnection(p)}),I(c.incoming.slice(),function(p){var u=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});u||r.removeConnection(p)})})})}),this.postExecute("shape.create",function(a){var s=a.context,l=s.shape,c=s.host;c&&r.updateAttachment(l,c)}),this.postExecute("shape.replace",function(a){var s=a.context,l=s.oldShape,c=s.newShape;Fn(l.attachers,function(p){var u=i.allowed("elements.move",{target:c,shapes:[p]});u==="attach"?r.updateAttachment(p,c):r.removeShape(p)}),c.attachers.length&&I(c.attachers,function(p){var u=Cp(p,l,c);r.moveShape(p,u,p.parent)})}),this.postExecute("shape.resize",function(a){var s=a.context,l=s.shape,c=s.oldBounds,p=s.newBounds,u=l.attachers,d=s.hints||{};d.attachSupport!==!1&&I(u,function(f){var h=Cp(f,c,p);r.moveShape(f,h,f.parent),I(f.labels,function(v){r.moveShape(v,h,v.parent)})})}),this.preExecute("shape.delete",function(a){var s=a.context.shape;Fn(s.attachers,function(l){r.removeShape(l)}),s.host&&r.updateAttachment(s,null)})}te($c,W);$c.$inject=["injector","eventBus","canvas","rules","modeling"];function ll(e){return Qo(Et(e,function(t){return t.attachers||[]}))}function Pw(e){var t=ll(e);return Eg("id",e,t)}function Rw(e){var t=ya(e,"id");return ye(e,function(n){for(;n;){if(n.host&&t[n.host.id])return!1;n=n.parent}return!0})}function kw(e){return!!e.host}function Aw(e,t){return e.indexOf(t)!==-1}const Dw={__depends__:[cn],__init__:["attachSupport"],attachSupport:["type",$c]};function jt(e){this._model=e}jt.$inject=["moddle"];jt.prototype._needsId=function(e){return ve(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};jt.prototype._ensureId=function(e){if(e.id){this._model.ids.claim(e.id,e);return}var t;y(e,"bpmn:Activity")?t="Activity":y(e,"bpmn:Event")?t="Event":y(e,"bpmn:Gateway")?t="Gateway":ve(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?t="Flow":t=(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))};jt.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n};jt.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};jt.prototype.createDiShape=function(e,t){return this.create("bpmndi:BPMNShape",N({bpmnElement:e,bounds:this.createDiBounds()},t))};jt.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)};jt.prototype.createDiWaypoints=function(e){var t=this;return Et(e,function(n){return t.createDiWaypoint(n)})};jt.prototype.createDiWaypoint=function(e){return this.create("dc:Point",an(e,["x","y"]))};jt.prototype.createDiEdge=function(e,t){return this.create("bpmndi:BPMNEdge",N({bpmnElement:e,waypoint:this.createDiWaypoints([])},t))};jt.prototype.createDiPlane=function(e,t){return this.create("bpmndi:BPMNPlane",N({bpmnElement:e},t))};function Rt(e,t,n,i){W.call(this,e),this._bpmnFactory=t,this._translate=i;var r=this;function o(h){var v=h.context,m=v.hints||{},S;!v.cropped&&m.createElementsBehavior!==!1&&(S=v.connection,S.waypoints=n.getCroppedWaypoints(S),v.cropped=!0)}this.executed(["connection.layout","connection.create"],o),this.reverted(["connection.layout"],function(h){delete h.context.cropped});function a(h){var v=h.context;r.updateParent(v.shape||v.connection,v.oldParent)}function s(h){var v=h.context,m=v.shape||v.connection,S=v.parent||v.newParent;r.updateParent(m,S)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ct(a)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ct(s));function l(h){var v=h.context,m=v.oldRoot,S=m.children;I(S,function(b){y(b,"bpmn:BaseElement")&&r.updateParent(b)})}this.executed(["canvas.updateRoot"],l),this.reverted(["canvas.updateRoot"],l);function c(h){var v=h.context.shape;y(v,"bpmn:BaseElement")&&r.updateBounds(v)}this.executed(["shape.move","shape.create","shape.resize"],Ct(function(h){h.context.shape.type!=="label"&&c(h)})),this.reverted(["shape.move","shape.create","shape.resize"],Ct(function(h){h.context.shape.type!=="label"&&c(h)})),e.on("shape.changed",function(h){h.element.type==="label"&&c({context:{shape:h.element}})});function p(h){r.updateConnection(h.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],Ct(p)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],Ct(p));function u(h){r.updateConnectionWaypoints(h.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Ct(u)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Ct(u)),this.executed("connection.reconnect",Ct(function(h){var v=h.context,m=v.connection,S=v.oldSource,b=v.newSource,T=Z(m),C=Z(S),k=Z(b);T.conditionExpression&&!ve(k,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(v.oldConditionExpression=T.conditionExpression,delete T.conditionExpression),S!==b&&C.default===T&&(v.oldDefault=C.default,delete C.default)})),this.reverted("connection.reconnect",Ct(function(h){var v=h.context,m=v.connection,S=v.oldSource,b=v.newSource,T=Z(m),C=Z(S),k=Z(b);v.oldConditionExpression&&(T.conditionExpression=v.oldConditionExpression),v.oldDefault&&(C.default=v.oldDefault,delete k.default)}));function d(h){r.updateAttachment(h.context)}this.executed(["element.updateAttachment"],Ct(d)),this.reverted(["element.updateAttachment"],Ct(d)),this.executed("element.updateLabel",Ct(f)),this.reverted("element.updateLabel",Ct(f));function f(h){const{element:v}=h.context,m=zn(v),S=Ie(v),b=S&&S.get("label");Yi(v)||Ho(v)||(m&&!b?S.set("label",t.create("bpmndi:BPMNLabel")):!m&&b&&S.set("label",void 0))}}te(Rt,W);Rt.$inject=["eventBus","bpmnFactory","connectionDocking","translate"];Rt.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject};Rt.prototype.updateParent=function(e,t){if(!xe(e)&&!(y(e,"bpmn:DataStoreReference")&&e.parent&&y(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,r=Ie(e),o=n&&n.businessObject,a=Ie(n);y(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,o,t&&t.businessObject),y(e,"bpmn:DataOutputAssociation")&&(e.source?o=e.source.businessObject:o=null),y(e,"bpmn:DataInputAssociation")&&(e.target?o=e.target.businessObject:o=null),this.updateSemanticParent(i,o),y(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,o),this.updateDiParent(r,a)}};Rt.prototype.updateBounds=function(e){var t=Ie(e),n=Mw(e);if(n){var i=Gt(n,t.get("bounds"));N(n,{x:e.x+i.x,y:e.y+i.y})}var r=xe(e)?this._getLabel(t):t,o=r.bounds;o||(o=this._bpmnFactory.createDiBounds(),r.set("bounds",o)),N(o,{x:e.x,y:e.y,width:e.width,height:e.height})};Rt.prototype.updateFlowNodeRefs=function(e,t,n){if(n!==t){var i,r;y(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),Qe(i,e)),y(t,"bpmn:Lane")&&(r=t.get("flowNodeRef"),tt(r,e))}};Rt.prototype.updateDiConnection=function(e,t,n){var i=Ie(e),r=Ie(t),o=Ie(n);i.sourceElement&&i.sourceElement.bpmnElement!==Z(t)&&(i.sourceElement=t&&r),i.targetElement&&i.targetElement.bpmnElement!==Z(n)&&(i.targetElement=n&&o)};Rt.prototype.updateDiParent=function(e,t){if(t&&!y(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(Qe(n,e),e.$parent=null)}};function Iw(e){for(;e&&!y(e,"bpmn:Definitions");)e=e.$parent;return e}Rt.prototype.getLaneSet=function(e){var t,n;return y(e,"bpmn:Lane")?(t=e.childLaneSet,t||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(y(e,"bpmn:Participant")&&(e=e.processRef),n=e.get("laneSets"),t=n[0],t||(t=this._bpmnFactory.create("bpmn:LaneSet"),t.$parent=e,n.push(t)),t)};Rt.prototype.updateSemanticParent=function(e,t,n){var i,r=this._translate;if(e.$parent!==t&&!((y(e,"bpmn:DataInput")||y(e,"bpmn:DataOutput"))&&(y(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(y(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if(y(e,"bpmn:FlowElement")){if(t){if(y(t,"bpmn:Participant"))t=t.processRef;else if(y(t,"bpmn:Lane"))do t=t.$parent.$parent;while(y(t,"bpmn:Lane"))}i="flowElements"}else if(y(e,"bpmn:Artifact")){for(;t&&!y(t,"bpmn:Process")&&!y(t,"bpmn:SubProcess")&&!y(t,"bpmn:Collaboration");)if(y(t,"bpmn:Participant")){t=t.processRef;break}else t=t.$parent;i="artifacts"}else if(y(e,"bpmn:MessageFlow"))i="messageFlows";else if(y(e,"bpmn:Participant")){i="participants";var o=e.processRef,a;o&&(a=Iw(e.$parent||t),e.$parent&&(Qe(a.get("rootElements"),o),o.$parent=null),t&&(tt(a.get("rootElements"),o),o.$parent=a))}else y(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":y(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(r("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var s;if(e.$parent&&(s=e.$parent.get(i),Qe(s,e)),t?(s=t.get(i),s.push(e),e.$parent=t):e.$parent=null,n){var l=n.get(i);Qe(s,e),t&&(l||(l=[],t.set(i,l)),l.push(e))}}};Rt.prototype.updateConnectionWaypoints=function(e){var t=Ie(e);t.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))};Rt.prototype.updateConnection=function(e){var t=e.connection,n=Z(t),i=t.source,r=Z(i),o=t.target,a=Z(t.target),s;if(y(n,"bpmn:DataAssociation"))y(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=r,s=e.parent||e.newParent||a,this.updateSemanticParent(n,a,s)):y(n,"bpmn:DataOutputAssociation")&&(s=e.parent||e.newParent||r,this.updateSemanticParent(n,r,s),n.targetRef=a);else{var l=y(n,"bpmn:SequenceFlow");n.sourceRef!==r&&(l&&(Qe(n.sourceRef&&n.sourceRef.get("outgoing"),n),r&&r.get("outgoing")&&r.get("outgoing").push(n)),n.sourceRef=r),n.targetRef!==a&&(l&&(Qe(n.targetRef&&n.targetRef.get("incoming"),n),a&&a.get("incoming")&&a.get("incoming").push(n)),n.targetRef=a)}this.updateConnectionWaypoints(t),this.updateDiConnection(t,i,o)};Rt.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};function Ct(e){return function(t){var n=t.context,i=n.shape||n.connection||n.element;y(i,"bpmn:BaseElement")&&e(t)}}function Mw(e){if(y(e,"bpmn:Activity")){var t=Ie(e);if(t){var n=t.get("label");if(n)return n.get("bounds")}}}function Qn(e,t,n){Tl.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}te(Qn,Tl);Qn.$inject=["bpmnFactory","moddle","translate"];Qn.prototype._baseCreate=Tl.prototype.create;Qn.prototype.create=function(e,t){if(e==="label"){var n=t.di||this._bpmnFactory.createDiLabel();return this._baseCreate(e,N({type:"label",di:n},xg,t))}return this.createElement(e,t)};Qn.prototype.createElement=function(e,t){var n,i=this._translate;t=N({},t||{});var r=t.businessObject,o=t.di;if(!r){if(!t.type)throw new Error(i("no shape type specified"));r=this._bpmnFactory.create(t.type),wg(r)}if(!Ow(o)){var a=N({},o||{},{id:r.id+"_di"});e==="root"?o=this._bpmnFactory.createDiPlane(r,a):e==="connection"?o=this._bpmnFactory.createDiEdge(r,a):o=this._bpmnFactory.createDiShape(r,a)}y(r,"bpmn:Group")&&(t=N({isFrame:!0},t)),t=Nw(r,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&(t=cl(o,t,"isExpanded")),y(r,"bpmn:SubProcess")&&(t.collapsed=!Se(r,o)),y(r,"bpmn:ExclusiveGateway")&&(jn(t,"isMarkerVisible")?t.isMarkerVisible===void 0?o.isMarkerVisible=!1:t=cl(o,t,"isMarkerVisible"):o.isMarkerVisible=!0),Tt(t.triggeredByEvent)&&(r.triggeredByEvent=t.triggeredByEvent,delete t.triggeredByEvent),Tt(t.cancelActivity)&&(r.cancelActivity=t.cancelActivity,delete t.cancelActivity);var s,l;return t.eventDefinitionType&&(s=r.get("eventDefinitions")||[],l=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),t.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(l.condition=this._bpmnFactory.create("bpmn:FormalExpression")),s.push(l),l.$parent=r,r.eventDefinitions=s,delete t.eventDefinitionType),n=this.getDefaultSize(r,o),t=N({id:r.id},n,t,{businessObject:r,di:o}),this._baseCreate(e,t)};Qn.prototype.getDefaultSize=function(e,t){var n=Z(e);return t=t||Ie(e),y(n,"bpmn:SubProcess")?Se(n,t)?{width:350,height:200}:{width:100,height:80}:y(n,"bpmn:Task")?{width:100,height:80}:y(n,"bpmn:Gateway")?{width:50,height:50}:y(n,"bpmn:Event")?{width:36,height:36}:y(n,"bpmn:Participant")?Se(n,t)?{width:600,height:250}:{width:400,height:60}:y(n,"bpmn:Lane")?{width:400,height:100}:y(n,"bpmn:DataObjectReference")?{width:36,height:50}:y(n,"bpmn:DataStoreReference")?{width:50,height:50}:y(n,"bpmn:TextAnnotation")?{width:100,height:30}:y(n,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Qn.prototype.createParticipantShape=function(e){return yn(e)||(e={isExpanded:e}),e=N({type:"bpmn:Participant"},e||{}),e.isExpanded!==!1&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};function Nw(e,t,n){return I(n,function(i){t=cl(e,t,i)}),t}function cl(e,t,n){return t[n]===void 0?t:(e[n]=t[n],bn(t,[n]))}function Ow(e){return ve(e,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])}function za(e,t){this._modeling=e,this._canvas=t}za.$inject=["modeling","canvas"];za.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;I(n,function(r){var o={x:0,y:0};Tt(i.left)?o.x=i.left-r.x:Tt(i.right)?o.x=i.right-r.width-r.x:Tt(i.center)?o.x=i.center-Math.round(r.width/2)-r.x:Tt(i.top)?o.y=i.top-r.y:Tt(i.bottom)?o.y=i.bottom-r.height-r.y:Tt(i.middle)&&(o.y=i.middle-Math.round(r.height/2)-r.y),t.moveElements([r],o,r.parent)})};za.prototype.postExecute=function(e){};function Ua(e){this._modeling=e}Ua.$inject=["modeling"];Ua.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,r=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:r.attach}),e.shape=i};Ua.prototype.postExecute=function(e){var t=e.hints||{};Lw(e.source,e.shape)||(t.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))};function Lw(e,t){return Ji(e.outgoing,function(n){return n.target===t})}function Ga(e,t){this._canvas=e,this._layouter=t}Ga.$inject=["canvas","layouter"];Ga.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,o=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,r,o),t};Ga.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var $o=Math.round;function Bc(e){this._modeling=e}Bc.$inject=["modeling"];Bc.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,r=e.position,o=e.hints,a=this._modeling;I(t,function(u){_e(u.x)||(u.x=0),_e(u.y)||(u.y=0)});var s=ye(t,function(u){return!u.hidden}),l=Pt(s);I(t,function(u){De(u)&&(u.waypoints=Et(u.waypoints,function(d){return{x:$o(d.x-l.x-l.width/2+r.x),y:$o(d.y-l.y-l.height/2+r.y)}})),N(u,{x:$o(u.x-l.x-l.width/2+r.x),y:$o(u.y-l.y-l.height/2+r.y)})});var c=va(t),p={};I(t,function(u){if(De(u)){p[u.id]=_e(i)?a.createConnection(p[u.source.id],p[u.target.id],i,u,u.parent||n,o):a.createConnection(p[u.source.id],p[u.target.id],u,u.parent||n,o);return}var d=N({},o);c.indexOf(u)===-1&&(d.autoResize=!1),xe(u)&&(d=bn(d,["attach"])),p[u.id]=_e(i)?a.createShape(u,an(u,["x","y","width","height"]),u.parent||n,i,d):a.createShape(u,an(u,["x","y","width","height"]),u.parent||n,d)}),e.elements=El(p)};var Zp=Math.round;function Jn(e){this._canvas=e}Jn.$inject=["canvas"];Jn.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?N(t,n):N(t,{x:n.x-Zp(t.width/2),y:n.y-Zp(t.height/2)}),this._canvas.addShape(t,i,r),t};Jn.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t};function Xr(e){Jn.call(this,e)}te(Xr,Jn);Xr.$inject=["canvas"];var $w=Jn.prototype.execute;Xr.prototype.execute=function(e){var t=e.shape;return jw(t),t.labelTarget=e.labelTarget,$w.call(this,e)};var Bw=Jn.prototype.revert;Xr.prototype.revert=function(e){return e.shape.labelTarget=null,Bw.call(this,e)};function jw(e){["width","height"].forEach(function(t){typeof e[t]>"u"&&(e[t]=0)})}function Zr(e,t){this._canvas=e,this._modeling=t}Zr.$inject=["canvas","modeling"];Zr.prototype.preExecute=function(e){var t=this._modeling,n=e.connection;Fn(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),Fn(n.outgoing,function(i){t.removeConnection(i,{nested:!0})})};Zr.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=Cl(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t};Zr.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,tt(n.children,t,i),this._canvas.addConnection(t,n),t};function jc(e,t){this._modeling=e,this._elementRegistry=t}jc.$inject=["modeling","elementRegistry"];jc.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;I(i,function(r){n.get(r.id)&&(r.waypoints?t.removeConnection(r):t.removeShape(r))})};function Qr(e,t){this._canvas=e,this._modeling=t}Qr.$inject=["canvas","modeling"];Qr.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;Fn(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),Fn(n.outgoing,function(i){t.removeConnection(i,{nested:!0})}),Fn(n.children,function(i){De(i)?t.removeConnection(i,{nested:!0}):t.removeShape(i,{nested:!0})})};Qr.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=Cl(i.children,n),t.removeShape(n),n};Qr.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return tt(i.children,n,r),t.addShape(n,i),n};function Wa(e){this._modeling=e}Wa.$inject=["modeling"];var Qp={x:"y",y:"x"};Wa.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function o(m,S){m.range.min=Math.min(S[i],m.range.min),m.range.max=Math.max(S[i]+S[r],m.range.max)}function a(m){return m[i]+m[r]/2}function s(m){return m.length-1}function l(m){return m.max-m.min}function c(m,S){var b={y:0};b[i]=m-a(S),b[i]&&(b[Qp[i]]=0,t.moveElements([S],b,S.parent))}var p=n[0],u=s(n),d=n[u],f,h,v=0;I(n,function(m,S){var b,T,C;if(m.elements.length<2){S&&S!==n.length-1&&(o(m,m.elements[0]),v+=l(m.range));return}b=on(m.elements,i),T=b[0],S===u&&(T=b[s(b)]),C=a(T),m.range=null,I(b,function(k){if(c(C,k),m.range===null){m.range={min:k[i],max:k[i]+k[r]};return}o(m,k)}),S&&S!==n.length-1&&(v+=l(m.range))}),h=Math.abs(d.range.min-p.range.max),f=Math.round((h-v)/(n.length-1)),!(f<n.length-1)&&I(n,function(m,S){var b={},T;m===p||m===d||(T=n[S-1],m.range.max=0,I(m.elements,function(C,k){b[Qp[i]]=0,b[i]=T.range.max-C[i]+f,m.range.min!==C[i]&&(b[i]+=C[i]-m.range.min),b[i]&&t.moveElements([C],b,C.parent),m.range.max=Math.max(C[i]+C[r],k?m.range.max:0)}))})};Wa.prototype.postExecute=function(e){};function Ya(e,t){this._layouter=e,this._canvas=t}Ya.$inject=["layouter","canvas"];Ya.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return N(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t};Ya.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};function Vc(){}Vc.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldParent=o,e.oldParentIndex=Qe(o.children,t),tt(i.children,t,r),t.parent=i,I(t.waypoints,function(a){a.x+=n.x,a.y+=n.y,a.original&&(a.original.x+=n.x,a.original.y+=n.y)}),t};Vc.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,o=e.delta;return Qe(n.children,t),tt(i.children,t,r),t.parent=i,I(t.waypoints,function(a){a.x-=o.x,a.y-=o.y,a.original&&(a.original.x-=o.x,a.original.y-=o.y)}),t};function Fc(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Fc.prototype.add=function(e,t){return this.addAll([e],t)};Fc.prototype.addAll=function(e,t){var n=Sg(e,!!t,this);return N(this,n),this};function Jr(e){this._modeling=e}Jr.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]};Jr.prototype.moveClosure=function(e,t,n,i,r){var o=this._modeling,a=e.allShapes,s=e.allConnections,l=e.enclosedConnections,c=e.topLevel,p=!1;r&&r.parent===n&&(p=!0),I(a,function(u){o.moveShape(u,t,c[u.id]&&!p&&n,{recurse:!1,layout:!1})}),I(s,function(u){var d=!!a[u.source.id],f=!!a[u.target.id];l[u.id]&&d&&f?o.moveConnection(u,t,c[u.id]&&!p&&n):o.layoutConnection(u,{connectionStart:d&&dc(u,u.source,t),connectionEnd:f&&fc(u,u.target,t)})})};Jr.prototype.getClosure=function(e){return new Fc().addAll(e,!0)};function qa(e){this._helper=new Jr(e)}qa.$inject=["modeling"];qa.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)};qa.prototype.postExecute=function(e){var t=e.hints,n;t&&t.primaryShape&&(n=t.primaryShape,t.oldParent=n.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,n)};function Ri(e){this._modeling=e,this._helper=new Jr(e)}Ri.$inject=["modeling"];Ri.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldBounds=an(t,["x","y","width","height"]),e.oldParent=o,e.oldParentIndex=Qe(o.children,t),tt(i.children,t,r),N(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t};Ri.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;i.layout!==!1&&(I(t.incoming,function(o){r.layoutConnection(o,{connectionEnd:fc(o,t,n)})}),I(t.outgoing,function(o){r.layoutConnection(o,{connectionStart:dc(o,t,n)})})),i.recurse!==!1&&this.moveChildren(e)};Ri.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return tt(n.children,t,i),N(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t};Ri.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)};Ri.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};function eo(e){this._modeling=e}eo.$inject=["modeling"];eo.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return Pe(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};eo.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,r=e.dockingOrPoints,o=e.hints||{},a={};o.connectionStart&&(a.connectionStart=o.connectionStart),o.connectionEnd&&(a.connectionEnd=o.connectionEnd),o.layoutConnection!==!1&&(n&&(!i||o.docking==="source")&&(a.connectionStart=a.connectionStart||Jp(Pe(r)?r[0]:r)),i&&(!n||o.docking==="target")&&(a.connectionEnd=a.connectionEnd||Jp(Pe(r)?r[r.length-1]:r)),o.newWaypoints&&(a.waypoints=o.newWaypoints),this._modeling.layoutConnection(t,a))};eo.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,r=e.connection;return t&&(r.source=t),n&&(r.target=n),i&&(r.waypoints=i),r};function Jp(e){return e.original||e}function Tn(e,t){this._modeling=e,this._rules=t}Tn.$inject=["modeling","rules"];Tn.prototype.preExecute=function(e){var t=this,n=this._modeling,i=this._rules,r=e.oldShape,o=e.newData,a=e.hints||{},s;function l(h,v,m){return i.allowed("connection.reconnect",{connection:m,source:h,target:v})}var c={x:o.x,y:o.y},p={x:r.x,y:r.y,width:r.width,height:r.height};s=e.newShape=e.newShape||t.createShape(o,c,r.parent,a),r.host&&n.updateAttachment(s,r.host);var u;a.moveChildren!==!1&&(u=r.children.slice(),n.moveElements(u,{x:0,y:0},s,a));var d=r.incoming.slice(),f=r.outgoing.slice();I(d,function(h){var v=h.source,m=l(v,s,h);m&&t.reconnectEnd(h,s,Oa(h,s,p),a)}),I(f,function(h){var v=h.target,m=l(s,v,h);m&&t.reconnectStart(h,s,Na(h,s,p),a)})};Tn.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)};Tn.prototype.execute=function(e){};Tn.prototype.revert=function(e){};Tn.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)};Tn.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)};Tn.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)};function to(e){this._modeling=e}to.$inject=["modeling"];to.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},N(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};to.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds,r=e.hints||{};r.layout!==!1&&(I(n.incoming,function(o){t.layoutConnection(o,{connectionEnd:Oa(o,n,i)})}),I(n.outgoing,function(o){t.layoutConnection(o,{connectionStart:Na(o,n,i)})}))};to.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return N(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};function ei(e){this._modeling=e}ei.$inject=["modeling"];ei.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,r=e.resizingShapes,o=e.start,a={};this.moveShapes(i,t),I(r,function(s){a[s.id]=Fw(s)}),this.resizeShapes(r,t,n),this.updateConnectionWaypoints(hw(i,r),t,n,o,i,r,a)};ei.prototype.execute=function(){};ei.prototype.revert=function(){};ei.prototype.moveShapes=function(e,t){var n=this;I(e,function(i){n._modeling.moveShape(i,t,null,{autoResize:!1,layout:!1,recurse:!1})})};ei.prototype.resizeShapes=function(e,t,n){var i=this;I(e,function(r){var o=mw(r,n,t);i._modeling.resizeShape(r,o,null,{attachSupport:!1,autoResize:!1,layout:!1})})};ei.prototype.updateConnectionWaypoints=function(e,t,n,i,r,o,a){var s=this,l=r.concat(o);I(e,function(c){var p=c.source,u=c.target,d=Vw(c),f=xm(n),h={};$n(l,p)&&$n(l,u)?(d=Et(d,function(v){return td(v,i,n)&&(v[f]=v[f]+t[f]),v.original&&td(v.original,i,n)&&(v.original[f]=v.original[f]+t[f]),v}),s._modeling.updateWaypoints(c,d,{labelBehavior:!1})):($n(l,p)||$n(l,u))&&($n(r,p)?h.connectionStart=dc(c,p,t):$n(r,u)?h.connectionEnd=fc(c,u,t):$n(o,p)?h.connectionStart=Na(c,p,a[p.id]):$n(o,u)&&(h.connectionEnd=Oa(c,u,a[u.id])),s._modeling.layoutConnection(c,h))})};function ed(e){return N({},e)}function Vw(e){return Et(e.waypoints,function(t){return t=ed(t),t.original&&(t.original=ed(t.original)),t})}function xm(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function td(e,t,n){var i=xm(n);if(/e|s/.test(n))return e[i]>t;if(/n|w/.test(n))return e[i]<t}function $n(e,t){return e.indexOf(t)!==-1}function Fw(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}function Ka(e){this._modeling=e}Ka.$inject=["modeling"];Ka.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=wm(n),t.collapsed=!t.collapsed;var i=Sm(n,t.collapsed);return[t].concat(i)};Ka.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=t.children,r=Cm(i,n);return t.collapsed=!t.collapsed,[t].concat(r)};function wm(e){var t={};return I(e,function(n){t[n.id]=n.hidden,n.children&&(t=N({},t,wm(n.children)))}),t}function Sm(e,t){var n=[];return I(e,function(i){i.hidden=t,n=n.concat(i),i.children&&(n=n.concat(Sm(i.children,i.collapsed||t)))}),n}function Cm(e,t){var n=[];return I(e,function(i){i.hidden=t[i.id],n=n.concat(i),i.children&&(n=n.concat(Cm(i.children,t)))}),n}function Xa(e){this._modeling=e}Xa.$inject=["modeling"];Xa.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=Tm(i,t),Pm(n,t),t.host=n,t};Xa.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,Tm(n,t),Pm(i,t,r),t};function Tm(e,t){return Qe(e&&e.attachers,t)}function Pm(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),tt(i,t,n)}}function Hc(){}Hc.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t};Hc.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};function Re(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Re.$inject=["eventBus","elementFactory","commandStack"];Re.prototype.getHandlers=function(){return{"shape.append":Ua,"shape.create":Jn,"shape.delete":Qr,"shape.move":Ri,"shape.resize":to,"shape.replace":Tn,"shape.toggleCollapse":Ka,spaceTool:ei,"label.create":Xr,"connection.create":Ga,"connection.delete":Zr,"connection.move":Vc,"connection.layout":Ya,"connection.updateWaypoints":Hc,"connection.reconnect":eo,"elements.create":Bc,"elements.move":qa,"elements.delete":jc,"elements.distribute":Wa,"elements.align":za,"element.updateAttachment":Xa}};Re.prototype.registerHandlers=function(e){I(this.getHandlers(),function(t,n){e.registerHandler(n,t)})};Re.prototype.moveShape=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=null);var o={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)};Re.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)};Re.prototype.moveElements=function(e,t,n,i){i=i||{};var r=i.attach,o=n,a;r===!0?(a=n,o=n.parent):r===!1&&(a=null);var s={shapes:e,delta:t,newParent:o,newHost:a,hints:i};this._commandStack.execute("elements.move",s)};Re.prototype.moveConnection=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=void 0);var o={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)};Re.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)};Re.prototype.createConnection=function(e,t,n,i,r,o){typeof n=="object"&&(o=r,r=i,i=n,n=void 0),i=this._create("connection",i);var a={source:e,target:t,parent:r,parentIndex:n,connection:i,hints:o};return this._commandStack.execute("connection.create",a),a.connection};Re.prototype.createShape=function(e,t,n,i,r){typeof i!="number"&&(r=i,i=void 0),r=r||{};var o=r.attach,a,s;e=this._create("shape",e),o?(a=n.parent,s=n):a=n;var l={position:t,shape:e,parent:a,parentIndex:i,host:s,hints:r};return this._commandStack.execute("shape.create",l),l.shape};Re.prototype.createElements=function(e,t,n,i,r){Pe(e)||(e=[e]),typeof i!="number"&&(r=i,i=void 0),r=r||{};var o={position:t,elements:e,parent:n,parentIndex:i,hints:r};return this._commandStack.execute("elements.create",o),o.elements};Re.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape};Re.prototype.appendShape=function(e,t,n,i,r){r=r||{},t=this._create("shape",t);var o={source:e,position:n,target:i,shape:t,connection:r.connection,connectionParent:r.connectionParent,hints:r};return this._commandStack.execute("shape.append",o),o.shape};Re.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)};Re.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)};Re.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)};Re.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)};Re.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape};Re.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)};Re.prototype.resizeShape=function(e,t,n,i){var r={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)};Re.prototype.createSpace=function(e,t,n,i,r){var o={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:r};this._commandStack.execute("spaceTool",o)};Re.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)};Re.prototype.reconnect=function(e,t,n,i,r){var o={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:r||{}};this._commandStack.execute("connection.reconnect",o)};Re.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,N(i,{docking:"source"}))};Re.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,N(i,{docking:"target"}))};Re.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)};Re.prototype._create=function(e,t){return Cg(t)?t:this._elementFactory.create(e,t)};Re.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};function no(e){this._elementRegistry=e}no.$inject=["elementRegistry"];no.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var r=e.changed||this._getVisualReferences(n).concat(t),o=e.oldProperties||Hw(n,Hs(i));return Rm(n,i),e.oldProperties=o,e.changed=r,r};no.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return Rm(n,t),i};no.prototype._getVisualReferences=function(e){var t=this._elementRegistry;return y(e,"bpmn:DataObject")?zw(e,t):[]};function Hw(e,t){return qn(t,function(n,i){return n[i]=e.get(i),n},{})}function Rm(e,t){I(t,function(n,i){e.set(i,n)})}function zw(e,t){return t.filter(function(n){return y(n,"bpmn:DataObjectReference")&&Z(n).dataObjectRef===e})}var br="default",vn="id",km="di",Uw={width:0,height:0};function io(e,t,n,i,r){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=r}io.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"];io.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var r=this._elementRegistry,o=this._moddle.ids,a=t.businessObject,s=Kw(e.properties),l=e.oldProperties||Gw(t,s);return Am(s,a)&&(o.unclaim(a[vn]),r.updateId(t,s[vn]),o.claim(s[vn],a)),br in s&&(s[br]&&n.push(r.get(s[br].id)),a[br]&&n.push(r.get(a[br].id))),Dm(t,s),e.oldProperties=l,e.changed=n,n};io.prototype.postExecute=function(e){var t=e.element,n=t.label,i=n&&Z(n).name;if(i){var r=this._textRenderer.getExternalLabelBounds(n,i);this._modeling.resizeShape(n,r,Uw)}};io.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,r=t.businessObject,o=this._elementRegistry,a=this._moddle.ids;return Dm(t,i),Am(n,r)&&(a.unclaim(n[vn]),o.updateId(t,i[vn]),a.claim(i[vn],r)),e.changed};function Am(e,t){return vn in e&&e[vn]!==t[vn]}function Gw(e,t){var n=Hs(t),i=e.businessObject,r=Ie(e);return qn(n,function(o,a){return a!==km?o[a]=i.get(a):o[a]=Ww(r,Hs(t.di)),o},{})}function Ww(e,t){return qn(t,function(n,i){return n[i]=e&&e.get(i),n},{})}function Dm(e,t){var n=e.businessObject,i=Ie(e);I(t,function(r,o){o!==km?n.set(o,r):i&&Yw(i,r)})}function Yw(e,t){I(t,function(n,i){e.set(i,n)})}var qw=["default"];function Kw(e){var t=N({},e);return qw.forEach(function(n){n in e&&(t[n]=Z(t[n]))}),t}function Za(e,t){this._canvas=e,this._modeling=t}Za.$inject=["canvas","modeling"];Za.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=t.getRootElement(),o=r.businessObject,a=o.$parent,s=Ie(r);return t.setRootElement(n),t.removeRootElement(r),tt(a.rootElements,i),i.$parent=a,Qe(a.rootElements,o),o.$parent=null,r.di=null,s.bpmnElement=i,n.di=s,e.oldRoot=r,[]};Za.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=e.oldRoot,o=r.businessObject,a=i.$parent,s=Ie(n);return t.setRootElement(r),t.removeRootElement(n),Qe(a.rootElements,i),i.$parent=null,tt(a.rootElements,o),o.$parent=a,n.di=null,s.bpmnElement=o,r.di=s,[]};function zc(e,t){this._modeling=e,this._spaceTool=t}zc.$inject=["modeling","spaceTool"];zc.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,r=e.location,o=Mt(i),a=o===i,s=a?i:i.parent,l=Xn(s);l.length||n.createShape({type:"bpmn:Lane"},{x:i.x+zi,y:i.y,width:i.width-zi,height:i.height},s);var c=[];ba(o,function(v){return c.push(v),v.label&&c.push(v.label),v===i?[]:ye(v.children,function(m){return m!==i})});var p=r==="top"?-120:120,u=r==="top"?i.y:i.y+i.height,d=u+(r==="top"?10:-10),f=r==="top"?"n":"s",h=t.calculateAdjustments(c,"y",p,d);t.makeSpace(h.movingShapes,h.resizingShapes,{x:0,y:p},f,d),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(a?zi:0),y:u-(r==="top"?120:0),width:i.width-(a?zi:0),height:120},s)};function Uc(e,t){this._modeling=e,this._translate=t}Uc.$inject=["modeling","translate"];Uc.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,r=e.count,o=Xn(i),a=o.length;if(a>r)throw new Error(n("more than {count} child lanes",{count:r}));var s=Math.round(i.height/r),l,c,p,u,d;for(d=0;d<r;d++)l=i.y+d*s,d===r-1?c=i.height-s*d:c=s,p={x:i.x+zi,y:l,width:i.width-zi,height:c},d<a?t.resizeShape(o[d],p):(u={type:"bpmn:Lane"},t.createShape(u,p,i))};function ro(e,t){this._modeling=e,this._spaceTool=t}ro.$inject=["modeling","spaceTool"];ro.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds,i=e.balanced;i!==!1?this.resizeBalanced(t,n):this.resizeSpace(t,n)};ro.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=TE(e,t);n.resizeShape(e,t),i.forEach(function(r){n.resizeShape(r.shape,r.newBounds)})};ro.prototype.resizeSpace=function(e,t){var n=this._spaceTool,i=se(e),r=se(t),o=Dh(r,i),a=Mt(e),s=[],l=[];ba(a,function(h){return s.push(h),(y(h,"bpmn:Lane")||y(h,"bpmn:Participant"))&&l.push(h),h.children});var c,p,u,d,f;(o.bottom||o.top)&&(c=o.bottom||o.top,p=e.y+(o.bottom?e.height:0)+(o.bottom?-10:10),u=o.bottom?"s":"n",d=o.top>0||o.bottom<0?-c:c,f=n.calculateAdjustments(s,"y",d,p),n.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:c},u)),(o.left||o.right)&&(c=o.right||o.left,p=e.x+(o.right?e.width:0)+(o.right?-10:100),u=o.right?"e":"w",d=o.left>0||o.right<0?-c:c,f=n.calculateAdjustments(l,"x",d,p),n.makeSpace(f.movingShapes,f.resizingShapes,{x:c,y:0},u))};var Br="flowNodeRef",Gc="lanes";function oo(e){this._elementRegistry=e}oo.$inject=["elementRegistry"];oo.prototype._computeUpdates=function(e,t){var n=[],i=[],r={},o=[];function a(p,u){var d=se(u),f={x:p.x+p.width/2,y:p.y+p.height/2};return f.x>d.left&&f.x<d.right&&f.y>d.top&&f.y<d.bottom}function s(p){n.indexOf(p)===-1&&(o.push(p),n.push(p))}function l(p){var u=Mt(p);return r[u.id]||(r[u.id]=Ia(u)),r[u.id]}function c(p){if(!p.parent)return[];var u=l(p);return u.filter(function(d){return a(p,d)}).map(function(d){return d.businessObject})}return t.forEach(function(p){var u=Mt(p);if(!(!u||n.indexOf(u)!==-1)){var d=u.children.filter(function(f){return y(f,"bpmn:FlowNode")});d.forEach(s),n.push(u)}}),e.forEach(s),o.forEach(function(p){var u=p.businessObject,d=u.get(Gc),f=d.slice(),h=c(p);i.push({flowNode:u,remove:f,add:h})}),t.forEach(function(p){var u=p.businessObject;p.parent||u.get(Br).forEach(function(d){i.push({flowNode:d,remove:[u],add:[]})})}),i};oo.prototype.execute=function(e){var t=e.updates;return t||(t=e.updates=this._computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(n){var i=n.flowNode,r=i.get(Gc);n.remove.forEach(function(o){Qe(r,o),Qe(o.get(Br),i)}),n.add.forEach(function(o){tt(r,o),tt(o.get(Br),i)})}),[]};oo.prototype.revert=function(e){var t=e.updates;return t.forEach(function(n){var i=n.flowNode,r=i.get(Gc);n.add.forEach(function(o){Qe(r,o),Qe(o.get(Br),i)}),n.remove.forEach(function(o){tt(r,o),tt(o.get(Br),i)})}),[]};function Qa(e){this._moddle=e}Qa.$inject=["moddle"];Qa.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;return r?t.claim(n,i):t.unclaim(n),[]};Qa.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;return r?t.unclaim(n):t.claim(n,i),[]};var Xw={fill:void 0,stroke:void 0};function Wc(e){this._commandStack=e,this._normalizeColor=function(t){if(t){if(ga(t)){var n=Zw(t);if(n)return n}throw new Error("invalid color value: "+t)}}}Wc.$inject=["commandStack"];Wc.prototype.postExecute=function(e){var t=e.elements,n=e.colors||Xw,i=this,r={};"fill"in n&&N(r,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&N(r,{"border-color":this._normalizeColor(n.stroke)}),I(t,function(o){var a=De(o)?an(r,["border-color"]):r,s=Ie(o);if(Qw(a),xe(o))i._commandStack.execute("element.updateModdleProperties",{element:o,moddleElement:s.label,properties:{color:r["border-color"]}});else{if(!ve(s,["bpmndi:BPMNEdge","bpmndi:BPMNShape"]))return;i._commandStack.execute("element.updateProperties",{element:o,properties:{di:a}})}})};function Zw(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}function Qw(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}var Jw={width:0,height:0};function Im(e,t,n){function i(l,c){var p=l.label||l,u=l.labelTarget||l;return Tg(p,c),[p,u]}function r(l){var c=l.element,p=c.businessObject,u=l.newLabel;if(!xe(c)&&Yi(c)&&!_a(c)&&!nd(u)){var d=7,f=gf(c);f={x:f.x,y:f.y+d},e.createLabel(c,f,{id:p.id+"_label",businessObject:p,di:c.di})}}function o(l){return l.oldLabel=zn(l.element),i(l.element,l.newLabel)}function a(l){return i(l.element,l.oldLabel)}function s(l){var c=l.element,p=c.label||c,u=l.newLabel,d=l.newBounds,f=l.hints||{};if(!(!xe(p)&&!y(p,"bpmn:TextAnnotation"))){if(xe(p)&&nd(u)){f.removeShape!==!1&&e.removeShape(p,{unsetLabel:!1});return}var h=zn(c);typeof d>"u"&&(d=t.getExternalLabelBounds(p,h)),d&&e.resizeShape(p,d,Jw)}}this.preExecute=r,this.execute=o,this.revert=a,this.postExecute=s}Im.$inject=["modeling","textRenderer","bpmnFactory"];function nd(e){return!e||!e.trim()}function ft(e,t,n,i){Re.call(this,e,t,n),this._bpmnRules=i}te(ft,Re);ft.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];ft.prototype.getHandlers=function(){var e=Re.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=no,e["element.updateProperties"]=io,e["canvas.updateRoot"]=Za,e["lane.add"]=zc,e["lane.resize"]=ro,e["lane.split"]=Uc,e["lane.updateRefs"]=oo,e["id.updateClaim"]=Qa,e["element.setColor"]=Wc,e["element.updateLabel"]=Im,e};ft.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})};ft.prototype.connect=function(e,t,n,i){var r=this._bpmnRules;if(n||(n=r.canConnect(e,t)),!!n)return this.createConnection(e,t,n,e.parent,i)};ft.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})};ft.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})};ft.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})};ft.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane};ft.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})};ft.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e};ft.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};this._commandStack.execute("canvas.updateRoot",t)};ft.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})};ft.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})};ft.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};ft.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};function Mm(){}Mm.prototype.layoutConnection=function(e,t){return t=t||{},[t.connectionStart||de(t.source||e.source),t.connectionEnd||de(t.target||e.target)]};var Bo=20,e0=5,ca=Math.round,id=20,t0={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function n0(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}function i0(e,t){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[e].test(t)}function Nm(e,t,n){var i=dt(t,e,e0),r=n.split(":")[0],o=ca((t.x-e.x)/2+e.x),a=ca((t.y-e.y)/2+e.y),s,l,c=i0(r,i),p=/h|r|l/.test(r),u=!1,d=!1;return c?(s=p?{x:o,y:e.y}:{x:e.x,y:a},l=p?"h:h":"v:v"):(u=n0(i,r),l=p?"h:v":"v:h",u?p?(d=a===e.y,s={x:e.x+Bo*(/l/.test(r)?-1:1),y:d?a+Bo:a}):(d=o===e.x,s={x:d?o+Bo:o,y:e.y+Bo*(/t/.test(r)?-1:1)}):s={x:o,y:a}),{waypoints:Yc(e,s,l).concat(s),directions:l,turnNextDirections:d}}function r0(e,t,n){return Nm(e,t,n)}function o0(e,t,n){var i=Nm(t,e,rd(n));return{waypoints:i.waypoints.slice().reverse(),directions:rd(i.directions),turnNextDirections:i.turnNextDirections}}function a0(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n=n=="h"?"v":"h"),t.turnNextDirections&&(i=i=="h"?"v":"h");var r=n+":"+i,o=Yc(e.waypoints[e.waypoints.length-1],t.waypoints[0],r);return{waypoints:o,directions:r}}function rd(e){return e.split(":").reverse().join(":")}function s0(e,t,n){var i=ca((t.x-e.x)/2+e.x),r=ca((t.y-e.y)/2+e.y);if(n==="h:v")return[{x:t.x,y:e.y}];if(n==="v:h")return[{x:e.x,y:t.y}];if(n==="h:h")return[{x:i,y:e.y},{x:i,y:t.y}];if(n==="v:v")return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function Yc(e,t,n){if(n=n||"h:h",!v0(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Om(n)){var i=r0(e,t,n),r=o0(e,t,n),o=a0(i,r);return[].concat(i.waypoints,o.waypoints,r.waypoints)}return s0(e,t,n)}function l0(e,t,n){var i=Yc(e,t,n);return i.unshift(e),i.push(t),Lm(i)}function c0(e,t,n,i,r){var o=r&&r.preferredLayouts||[],a=Pg(o,"straight")[0]||"h:h",s=t0[a]||0,l=dt(e,t,s),c=m0(l,a);n=n||de(e),i=i||de(t);var p=c.split(":"),u=ad(n,e,p[0],g0(l)),d=ad(i,t,p[1],l);return l0(u,d,c)}function u0(e,t,n,i,r,o){Pe(n)&&(r=n,o=i,n=de(e),i=de(t)),o=N({preferredLayouts:[]},o),r=r||[];var a=o.preferredLayouts,s=a.indexOf("straight")!==-1,l;return l=s&&d0(e,t,n,i,o),l||(l=o.connectionEnd&&h0(t,e,i,r),l)||(l=o.connectionStart&&f0(e,t,n,r),l)?l:!o.connectionStart&&!o.connectionEnd&&r&&r.length?r:c0(e,t,n,i,o)}function p0(e,t,n){return e>=t&&e<=n}function od(e,t,n){var i={x:"width",y:"height"};return p0(t[e],n[e],n[e]+n[i[e]])}function d0(e,t,n,i,r){var o={},a,s;return s=dt(e,t),/^(top|bottom|left|right)$/.test(s)?(/top|bottom/.test(s)&&(a="x"),/left|right/.test(s)&&(a="y"),r.preserveDocking==="target"?od(a,i,e)?(o[a]=i[a],[{x:o.x!==void 0?o.x:n.x,y:o.y!==void 0?o.y:n.y,original:{x:o.x!==void 0?o.x:n.x,y:o.y!==void 0?o.y:n.y}},{x:i.x,y:i.y}]):null:od(a,n,t)?(o[a]=n[a],[{x:n.x,y:n.y},{x:o.x!==void 0?o.x:i.x,y:o.y!==void 0?o.y:i.y,original:{x:o.x!==void 0?o.x:i.x,y:o.y!==void 0?o.y:i.y}}]):null):null}function f0(e,t,n,i){return qc(e,t,n,i)}function h0(e,t,n,i){var r=i.slice().reverse();return r=qc(e,t,n,r),r?r.reverse():null}function qc(e,t,n,i){function r(p){return p.length<3?!0:p.length>4?!1:!!Oe(p,function(u,d){var f=p[d-1];return f&&cf(u,f)<3})}function o(p,u,d){var f=hn(u,p);switch(f){case"v":return{x:d.x,y:p.y};case"h":return{x:p.x,y:d.y}}return{x:p.x,y:p.y}}function a(p,u,d){var f;for(f=p.length-2;f!==0;f--)if(bu(p[f],u,id)||bu(p[f],d,id))return p.slice(f);return p}if(r(i))return null;var s=i[0],l=i.slice(),c;return l[0]=n,l[1]=o(l[1],s,n),c=a(l,e,t),c!==l&&(l=qc(e,t,n,c)),l&&hn(l)?null:l}function m0(e,t){if(Om(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}function v0(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}function Om(e){return e&&/t|r|b|l/.test(e)}function g0(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}function ad(e,t,n,i){if(n==="h"&&(n=/left/.test(i)?"l":"r"),n==="v"&&(n=/top/.test(i)?"t":"b"),n==="t")return{original:e,x:e.x,y:t.y};if(n==="r")return{original:e,x:t.x+t.width,y:e.y};if(n==="b")return{original:e,x:e.x,y:t.y+t.height};if(n==="l")return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function Lm(e){return e.reduce(function(t,n,i){var r=t[t.length-1],o=e[i+1];return uf(r,o,n,0)||t.push(n),t},[])}var y0=-10,_0=40,Kc={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},Ko={top:"t",right:"r",bottom:"b",left:"l"};function Xc(){}te(Xc,Mm);Xc.prototype.layoutConnection=function(e,t){t||(t={});var n=t.source||e.source,i=t.target||e.target,r=t.waypoints||e.waypoints,o=t.connectionStart,a=t.connectionEnd,s,l;return o||(o=sd(r&&r[0],n)),a||(a=sd(r&&r[r.length-1],i)),(y(e,"bpmn:Association")||y(e,"bpmn:DataAssociation"))&&r&&!ld(n,i)?[].concat([o],r.slice(1,-1),[a]):(y(e,"bpmn:MessageFlow")?s=E0(n,i):(y(e,"bpmn:SequenceFlow")||ld(n,i))&&(n===i?s={preferredLayouts:k0(n,e)}:y(n,"bpmn:BoundaryEvent")?s={preferredLayouts:A0(n,i,a)}:jr(n)||jr(i)?s=w0(n):y(n,"bpmn:Gateway")?s={preferredLayouts:["v:h"]}:y(i,"bpmn:Gateway")?s={preferredLayouts:["h:v"]}:s={preferredLayouts:["h:h"]}),s&&(s=N(s,t),l=Lm(u0(n,i,o,a,r,s))),l||[o,a])};function b0(e){var t=e.host;return dt(de(e),t,y0)}function E0(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:x0(e,t)}}function x0(e,t){return y(t,"bpmn:Participant")?"source":y(e,"bpmn:Participant")?"target":jr(t)?"source":jr(e)||y(t,"bpmn:Event")?"target":y(e,"bpmn:Event")?"source":null}function w0(e){return{preferredLayouts:["straight","h:h"],preserveDocking:S0(e)}}function S0(e){return jr(e)?"target":"source"}function sd(e,t){return e?e.original||e:de(t)}function ld(e,t){return y(t,"bpmn:Activity")&&y(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function jr(e){return y(e,"bpmn:SubProcess")&&Se(e)}function Cr(e,t){return e===t}function C0(e,t){return t.indexOf(e)!==-1}function Tr(e){var t=/right|left/.exec(e);return t&&t[0]}function gi(e){var t=/top|bottom/.exec(e);return t&&t[0]}function T0(e,t){return Kc[e]===t}function P0(e,t){var n=Tr(e),i=Kc[n];return t.indexOf(i)!==-1}function R0(e,t){var n=gi(e),i=Kc[n];return t.indexOf(i)!==-1}function ul(e){return e==="right"||e==="left"}function k0(e,t){var n=t.waypoints,i=n&&n.length&&dt(n[0],e);return i==="top"?["t:r"]:i==="right"?["r:b"]:i==="left"?["l:t"]:["b:l"]}function A0(e,t,n){var i=de(e),r=de(t),o=b0(e),a,s,l=Cr(e.host,t),c=C0(o,["top","right","bottom","left"]),p=dt(r,i,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return l?D0(o,c,e,t,n):(a=I0(o,p,c),s=M0(o,p,c),[a+":"+s])}function D0(e,t,n,i,r){var o=t?e:gi(e),a=Ko[o],s;return t?ul(e)?s=cd("y",n,i,r)?"h":"b":s=cd("x",n,i,r)?"v":"l":s="v",[a+":"+s]}function cd(e,t,n,i){var r=_0;return!(As(e,i,n,r)||As(e,i,{x:n.x+n.width,y:n.y+n.height},r)||As(e,i,de(t),r))}function As(e,t,n,i){return Math.abs(t[e]-n[e])<i}function I0(e,t,n){return n?Ko[e]:Cr(gi(e),gi(t))||T0(Tr(e),Tr(t))?Ko[gi(e)]:Ko[Tr(e)]}function M0(e,t,n){return n?ul(e)?P0(e,t)||Cr(e,t)?"h":"v":R0(e,t)||Cr(e,t)?"v":"h":ul(t)||Cr(gi(e),gi(t))&&Tr(t)?"h":"v"}function ud(e){return N({original:e.point.original||e.point},e.actual)}function ti(e,t){this._elementRegistry=e,this._graphicsFactory=t}ti.$inject=["elementRegistry","graphicsFactory"];ti.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),o=e.waypoints.slice(i.idx+1,r.idx);return o.unshift(ud(i)),o.push(ud(r)),o};ti.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,r,o,a;return r=n?0:i.length-1,o=i[r],a=this._getIntersection(t,e,n),{point:o,actual:a||o,idx:r}};ti.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return Fs(i,r,n)};ti.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)};ti.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)};ti.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};const $m={__init__:["modeling","bpmnUpdater"],__depends__:[Rx,Wx,qx,Kx,ym,ww,Cw,Dw,En,yf,Em],bpmnFactory:["type",jt],bpmnUpdater:["type",Rt],elementFactory:["type",Qn],modeling:["type",ft],layouter:["type",Xc],connectionDocking:["type",ti]},pd=Math.round;function Ja(e,t,n,i,r,o){this._complexPreview=e,this._connectionDocking=t,this._elementFactory=n,this._eventBus=i,this._layouter=r,this._rules=o}Ja.prototype.create=function(e,t,n){const i=this._complexPreview,r=this._connectionDocking,o=this._elementFactory,a=this._eventBus,s=this._layouter,l=this._rules,c=o.createShape(N({type:t},n)),p=a.fire("autoPlace",{source:e,shape:c});if(!p)return;N(c,{x:p.x-pd(c.width/2),y:p.y-pd(c.height/2)});const u=l.allowed("connection.create",{source:e,target:c,hints:{targetParent:e.parent}});let d=null;u&&(d=o.createConnection(u),d.waypoints=s.layoutConnection(d,{source:e,target:c}),d.waypoints=r.getCroppedWaypoints(d,e,c)),i.create({created:[c,d].filter(f=>!Vs(f))})};Ja.prototype.cleanUp=function(){this._complexPreview.cleanUp()};Ja.$inject=["complexPreview","connectionDocking","elementFactory","eventBus","layouter","rules"];const N0={__depends__:[Hl,aE,$m],__init__:["appendPreview"],appendPreview:["type",Ja]};var dd=Math.min,fd=Math.max;function Ds(e){e.preventDefault()}function Pr(e){e.stopPropagation()}function O0(e){return e.nodeType===Node.TEXT_NODE}function L0(e){return[].slice.call(e)}function Kt(e){this.container=e.container,this.parent=rt('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=ot("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=yi(this.autoResize,this),this.handlePaste=yi(this.handlePaste,this)}Kt.prototype.create=function(e,t,n,i){var r=this,o=this.parent,a=this.content,s=this.container;i=this.options=i||{},t=this.style=t||{};var l=an(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);N(o.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},l);var c=an(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return N(a.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&N(a.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),a.innerText=n,ce.bind(a,"keydown",this.keyHandler),ce.bind(a,"mousedown",Pr),ce.bind(a,"paste",r.handlePaste),i.autoResize&&ce.bind(a,"input",this.autoResize),i.resizable&&this.resizable(t),s.appendChild(o),this.setSelection(a.lastChild,a.lastChild&&a.lastChild.length),o};Kt.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault();var i;if(e.clipboardData?i=e.clipboardData.getData("text/plain"):i=window.clipboardData.getData("Text"),this.insertText(i),t.autoResize){var r=this.autoResize(n);r&&this.resizeHandler(r)}};Kt.prototype.insertText=function(e){e=$0(e);var t=document.execCommand("insertText",!1,e);t||this._insertTextIE(e)};Kt.prototype._insertTextIE=function(e){var t=this.getSelection(),n=t.startContainer,i=t.endContainer,r=t.startOffset,o=t.endOffset,a=t.commonAncestorContainer,s=L0(a.childNodes),l,c;if(O0(a)){var p=n.textContent;n.textContent=p.substring(0,r)+e+p.substring(o),l=n,c=r+e.length}else if(n===this.content&&i===this.content){var u=document.createTextNode(e);this.content.insertBefore(u,s[r]),l=u,c=u.textContent.length}else{var d=s.indexOf(n),f=s.indexOf(i);s.forEach(function(h,v){v===d?h.textContent=n.textContent.substring(0,r)+e+i.textContent.substring(o):v>d&&v<=f&&Wi(h)}),l=n,c=r+e.length}l&&c!==void 0&&setTimeout(function(){self.setSelection(l,c)})};Kt.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}};Kt.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,o=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=rt('<div class="djs-direct-editing-resize-handle"></div>');var s,l,c,p,u=function(h){Ds(h),Pr(h),s=h.clientX,l=h.clientY;var v=t.getBoundingClientRect();c=v.width,p=v.height,ce.bind(document,"mousemove",d),ce.bind(document,"mouseup",f)},d=function(h){Ds(h),Pr(h);var v=dd(fd(c+h.clientX-s,i),o),m=dd(fd(p+h.clientY-l,r),a);t.style.width=v+"px",t.style.height=m+"px",e.resizeHandler({width:c,height:p,dx:h.clientX-s,dy:h.clientY-l})},f=function(h){Ds(h),Pr(h),ce.unbind(document,"mousemove",d,!1),ce.unbind(document,"mouseup",f,!1)};ce.bind(n,"mousedown",u)}N(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)};Kt.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),ce.unbind(t,"keydown",this.keyHandler),ce.unbind(t,"mousedown",Pr),ce.unbind(t,"input",this.autoResize),ce.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),Wi(n)),Wi(e)};Kt.prototype.getValue=function(){return this.content.innerText.trim()};Kt.prototype.getSelection=function(){var e=window.getSelection(),t=e.getRangeAt(0);return t};Kt.prototype.setSelection=function(e,t){var n=document.createRange();e===null?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};function $0(e){return e.replace(/\r\n|\r|\n/g,`
`)}function Vt(e,t){this._eventBus=e,this._providers=[],this._textbox=new Kt({container:t.getContainer(),keyHandler:yi(this._handleKey,this),resizeHandler:yi(this._handleResize,this)})}Vt.$inject=["eventBus","canvas"];Vt.prototype.registerProvider=function(e){this._providers.push(e)};Vt.prototype.isActive=function(e){return!!(this._active&&(!e||this._active.element===e))};Vt.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())};Vt.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})};Vt.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0};Vt.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue(),o=e.context.text;(r!==o||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,r,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}};Vt.prototype.getValue=function(){return this._textbox.getValue()};Vt.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;if(t===27)return e.preventDefault(),this.cancel();if(t===13&&!e.shiftKey)return e.preventDefault(),this.complete()};Vt.prototype._handleResize=function(e){this._fire("resize",e)};Vt.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=Oe(this._providers,function(i){return(t=i.activate(e))?i:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};const Bm={__depends__:[ma],__init__:["directEditing"],directEditing:["type",Vt]};function hd(e){return function(t){var n=t.target,i=Z(e),r=i.eventDefinitions&&i.eventDefinitions[0],o=i.$type===n.type,a=(r&&r.$type)===n.eventDefinitionType,s=!!n.triggeredByEvent==!!i.triggeredByEvent,l=n.isExpanded===void 0||n.isExpanded===Se(e);return!o||!a||!s||!l}}var B0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],j0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],V0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],F0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],H0=[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],z0=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],jm=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],U0=jm,md=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],G0=[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],W0=[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],Y0=[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],q0=[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],K0=[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],X0=[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty pool/participant";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];const vd={"start-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
    <g transform="translate(0 995.64)">
      <path d="m1899 28.357c21.545 567.43-598.38 1023.5-1133.6 835.92-548.09-147.21-801.57-873.95-463.59-1330 302.62-480.3 1071.7-507.54 1407.6-49.847 122.14 153.12 190.07 348.07 189.59 543.91z" fill="none" stroke="currentColor" stroke-dasharray="418.310422, 361.2328165" stroke-linecap="round" stroke-width="100"/>
    </g>
  </svg>`,"intermediate-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
     <g transform="translate(0 995.64)" fill="none" stroke="currentColor" stroke-linecap="round">
        <circle cx="1024" cy="28.357" r="875" stroke-dasharray="418.310422, 361.2328165" stroke-width="100"/>
        <circle cx="1024" cy="28.357" r="685" stroke-dasharray="348.31044857,261.23283643" stroke-dashoffset="500" stroke-width="100"/>
     </g>
  </svg>`};function Dt(e,t,n,i,r,o,a,s){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=r,this._rules=o,this._translate=a,this._moddleCopy=s,this._register()}Dt.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate","moddleCopy"];Dt.prototype._register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};Dt.prototype.getPopupMenuEntries=function(e){var t=e.businessObject,n=this._rules,i=[];if(Pe(e)||!n.allowed("shape.replace",{element:e}))return{};var r=hd(e);return y(t,"bpmn:DataObjectReference")?this._createEntries(e,G0):y(t,"bpmn:DataStoreReference")&&!y(e.parent,"bpmn:Collaboration")?this._createEntries(e,W0):y(t,"bpmn:StartEvent")&&!y(t.$parent,"bpmn:SubProcess")?(i=ye(B0,r),this._createEntries(e,i)):y(t,"bpmn:Participant")?(i=ye(X0,function(o){return Se(e)!==o.target.isExpanded}),this._createEntries(e,i)):y(t,"bpmn:StartEvent")&&vt(t.$parent)?(i=ye(q0,function(o){var a=o.target,s=a.isInterrupting!==!1,l=t.isInterrupting===s;return r(o)||!r(o)&&!l}),this._createEntries(e,i)):y(t,"bpmn:StartEvent")&&!vt(t.$parent)&&y(t.$parent,"bpmn:SubProcess")?(i=ye(j0,r),this._createEntries(e,i)):y(t,"bpmn:EndEvent")?(i=ye(F0,function(o){var a=o.target;return a.eventDefinitionType=="bpmn:CancelEventDefinition"&&!y(t.$parent,"bpmn:Transaction")?!1:r(o)}),this._createEntries(e,i)):y(t,"bpmn:BoundaryEvent")?(i=ye(Y0,function(o){var a=o.target;if(a.eventDefinitionType=="bpmn:CancelEventDefinition"&&!y(t.attachedToRef,"bpmn:Transaction"))return!1;var s=a.cancelActivity!==!1,l=t.cancelActivity==s;return r(o)||!r(o)&&!l}),this._createEntries(e,i)):y(t,"bpmn:IntermediateCatchEvent")||y(t,"bpmn:IntermediateThrowEvent")?(i=ye(V0,r),this._createEntries(e,i)):y(t,"bpmn:Gateway")?(i=ye(H0,r),this._createEntries(e,i)):y(t,"bpmn:Transaction")?(i=ye(jm,r),this._createEntries(e,i)):vt(t)&&Se(e)?(i=ye(U0,r),this._createEntries(e,i)):y(t,"bpmn:SubProcess")&&Se(e)?(i=ye(z0,r),this._createEntries(e,i)):y(t,"bpmn:AdHocSubProcess")&&!Se(e)?(i=ye(md,function(o){var a=o.target,s=a.type==="bpmn:SubProcess",l=a.isExpanded===!0;return hd(a)&&(!s||l)}),this._createEntries(e,i)):y(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,K0):y(t,"bpmn:FlowNode")?(i=ye(md,r),y(t,"bpmn:SubProcess")&&!Se(e)&&(i=ye(i,function(o){return o.label!=="Sub-process (collapsed)"})),this._createEntries(e,i)):{}};Dt.prototype.getPopupMenuHeaderEntries=function(e){var t={};return y(e,"bpmn:Activity")&&!vt(e)&&(t={...t,...this._getLoopCharacteristicsHeaderEntries(e)}),y(e,"bpmn:DataObjectReference")&&(t={...t,...this._getCollectionHeaderEntries(e)}),y(e,"bpmn:Participant")&&(t={...t,...this._getParticipantMultiplicityHeaderEntries(e)}),y(e,"bpmn:SubProcess")&&!y(e,"bpmn:Transaction")&&!vt(e)&&(t={...t,...this._getAdHocHeaderEntries(e)}),Fh(e)&&(t={...t,...this._getNonInterruptingHeaderEntries(e)}),t};Dt.prototype._createEntries=function(e,t){var n={},i=this;return I(t,function(r){n[r.actionName]=i._createEntry(r,e)}),n};Dt.prototype._createSequenceFlowEntries=function(e,t){var n=Z(e),i={},r=this._modeling,o=this._moddle,a=this;return I(t,function(s){switch(s.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(y(n.sourceRef,"bpmn:ExclusiveGateway")||y(n.sourceRef,"bpmn:InclusiveGateway")||y(n.sourceRef,"bpmn:ComplexGateway")||y(n.sourceRef,"bpmn:Activity"))&&(i={...i,[s.actionName]:a._createEntry(s,e,function(){r.updateProperties(e.source,{default:n})})});break;case"replace-with-conditional-flow":!n.conditionExpression&&y(n.sourceRef,"bpmn:Activity")&&(i={...i,[s.actionName]:a._createEntry(s,e,function(){var l=o.create("bpmn:FormalExpression",{body:""});r.updateProperties(e,{conditionExpression:l})})});break;default:y(n.sourceRef,"bpmn:Activity")&&n.conditionExpression&&(i={...i,[s.actionName]:a._createEntry(s,e,function(){r.updateProperties(e,{conditionExpression:void 0})})}),(y(n.sourceRef,"bpmn:ExclusiveGateway")||y(n.sourceRef,"bpmn:InclusiveGateway")||y(n.sourceRef,"bpmn:ComplexGateway")||y(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n&&(i={...i,[s.actionName]:a._createEntry(s,e,function(){r.updateProperties(e.source,{default:void 0})})})}}),i};Dt.prototype._createEntry=function(e,t,n){var i=this._translate,r=this._bpmnReplace.replaceElement,o=function(){return r(t,e.target)},a=e.label;return a&&typeof a=="function"&&(a=a(t)),n=n||o,{label:i(a),className:e.className,action:n}};Dt.prototype._getLoopCharacteristicsHeaderEntries=function(e){var t=this,n=this._translate;function i(c,p){if(p.active){t._modeling.updateProperties(e,{loopCharacteristics:void 0});return}const u=e.businessObject.get("loopCharacteristics"),d=t._moddle.create(p.options.loopCharacteristics);u&&t._moddleCopy.copyElement(u,d),d.set("isSequential",p.options.isSequential),t._modeling.updateProperties(e,{loopCharacteristics:d})}var r=Z(e),o=r.loopCharacteristics,a,s,l;return o&&(a=o.isSequential,s=o.isSequential===void 0,l=o.isSequential!==void 0&&!o.isSequential),{"toggle-parallel-mi":{className:"bpmn-icon-parallel-mi-marker",title:n("Parallel multi-instance"),active:l,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},"toggle-sequential-mi":{className:"bpmn-icon-sequential-mi-marker",title:n("Sequential multi-instance"),active:a,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},"toggle-loop":{className:"bpmn-icon-loop-marker",title:n("Loop"),active:s,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}}};Dt.prototype._getCollectionHeaderEntries=function(e){var t=this,n=this._translate,i=e.businessObject.dataObjectRef;if(!i)return{};function r(a,s){t._modeling.updateModdleProperties(e,i,{isCollection:!s.active})}var o=i.isCollection;return{"toggle-is-collection":{className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:o,action:r}}};Dt.prototype._getParticipantMultiplicityHeaderEntries=function(e){var t=this,n=this._bpmnFactory,i=this._translate;function r(a,s){var l=s.active,c;l||(c=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:c})}var o=e.businessObject.participantMultiplicity;return{"toggle-participant-multiplicity":{className:"bpmn-icon-parallel-mi-marker",title:i("Participant multiplicity"),active:!!o,action:r}}};Dt.prototype._getAdHocHeaderEntries=function(e){var t=this._translate,n=Z(e),i=y(n,"bpmn:AdHocSubProcess"),r=this._bpmnReplace.replaceElement;return{"toggle-adhoc":{className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(o,a){return i?r(e,{type:"bpmn:SubProcess"},{autoResize:!1,layoutConnection:!1}):r(e,{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}}}};Dt.prototype._getNonInterruptingHeaderEntries=function(e){const t=this._translate,n=Z(e),i=this,r=Hh(e),o=y(e,"bpmn:BoundaryEvent")?vd["intermediate-event-non-interrupting"]:vd["start-event-non-interrupting"],a=!n[r];return{"toggle-non-interrupting":{imageHtml:o,title:t("Toggle non-interrupting"),active:a,action:function(){i._modeling.updateProperties(e,{[r]:!!a})}}}};const Z0={__depends__:[jl,ym,Hl],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",Dt]};function or(e,t,n,i,r,o,a,s,l,c,p,u,d){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=r,this._elementFactory=o,this._connect=a,this._create=s,this._popupMenu=l,this._canvas=c,this._rules=p,this._translate=u,this._eventBus=n,this._appendPreview=d,e.autoPlace!==!1&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(f){var h=f.context,v=h.shape;if(!(!Mr(f)||!i.isOpen(v))){var m=i.getEntries(v);m.replace&&m.replace.action.click(f,v)}})}or.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate","appendPreview"];or.prototype.getMultiElementContextPadEntries=function(e){var t=this._modeling,n={};return this._isDeleteAllowed(e)&&N(n,{delete:{group:"edit",className:"bpmn-icon-trash",title:this._translate("Delete"),action:{click:function(i,r){t.removeElements(r.slice())}}}}),n};or.prototype._isDeleteAllowed=function(e){var t=this._rules.allowed("elements.delete",{elements:e});return Pe(t)?bl(t,function(n){return Q0(t,n)}):t};or.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,r=this._connect,o=this._create,a=this._popupMenu,s=this._rules,l=this._autoPlace,c=this._translate,p=this._appendPreview,u={};if(e.type==="label")return u;var d=e.businessObject;function f(C,k){r.start(C,k)}function h(C,k){n.removeElements([k])}function v(C){var k=5,A=t.getPad(C).html,j=A.getBoundingClientRect(),V={x:j.left,y:j.bottom+k};return V}function m(C,k,A,j){function V(U,ie){var G=i.createShape(N({type:C},j));o.start(U,G,{source:ie}),p.cleanUp()}var H=l?function(U,ie){var G=i.createShape(N({type:C},j));l.append(ie,G),p.cleanUp()}:V,Y=l?function(U,ie){return p.create(ie,C,j),()=>{p.cleanUp()}}:null;return{group:"model",className:k,title:A,action:{dragstart:V,click:H,hover:Y}}}function S(C){return function(k,A){n.splitLane(A,C),t.open(A,!0)}}if(ve(d,["bpmn:Lane","bpmn:Participant"])&&Se(e)){var b=Xn(e);N(u,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:c("Add lane above"),action:{click:function(C,k){n.addLane(k,"top")}}}}),b.length<2&&(e.height>=120&&N(u,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:c("Divide into two lanes"),action:{click:S(2)}}}),e.height>=180&&N(u,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:c("Divide into three lanes"),action:{click:S(3)}}})),N(u,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:c("Add lane below"),action:{click:function(C,k){n.addLane(k,"bottom")}}}})}y(d,"bpmn:FlowNode")&&(y(d,"bpmn:EventBasedGateway")?N(u,{"append.receive-task":m("bpmn:ReceiveTask","bpmn-icon-receive-task",c("Append receive task")),"append.message-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",c("Append message intermediate catch event"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",c("Append timer intermediate catch event"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",c("Append conditional intermediate catch event"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",c("Append signal intermediate catch event"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):gd(d,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?N(u,{"append.compensation-activity":m("bpmn:Task","bpmn-icon-task",c("Append compensation activity"),{isForCompensation:!0})}):!y(d,"bpmn:EndEvent")&&!d.isForCompensation&&!gd(d,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!vt(d)&&N(u,{"append.end-event":m("bpmn:EndEvent","bpmn-icon-end-event-none",c("Append end event")),"append.gateway":m("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",c("Append gateway"),{isMarkerVisible:!0}),"append.append-task":m("bpmn:Task","bpmn-icon-task",c("Append task")),"append.intermediate-event":m("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",c("Append intermediate/boundary event"))})),a.isEmpty(e,"bpmn-replace")||N(u,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:c("Change element"),action:{click:function(C,k){var A=N(v(k),{cursor:{x:C.x,y:C.y}});a.open(k,"bpmn-replace",A,{title:c("Change element"),width:300,search:!0})}}}}),y(d,"bpmn:SequenceFlow")&&N(u,{"append.text-annotation":m("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),ve(d,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&N(u,{"append.text-annotation":m("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation")),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect to other element"),action:{click:f,dragstart:f}}}),y(d,"bpmn:TextAnnotation")&&N(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using association"),action:{click:f,dragstart:f}}}),ve(d,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&N(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using data input association"),action:{click:f,dragstart:f}}}),y(d,"bpmn:Group")&&N(u,{"append.text-annotation":m("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))});var T=s.allowed("elements.delete",{elements:[e]});return Pe(T)&&(T=T[0]===e),T&&N(u,{delete:{group:"edit",className:"bpmn-icon-trash",title:c("Delete"),action:{click:h}}}),u};function gd(e,t,n){var i=e.$instanceOf(t),r=!1,o=e.eventDefinitions||[];return I(o,function(a){a.$type===n&&(r=!0)}),i&&r}function Q0(e,t){return e.indexOf(t)!==-1}const J0={__depends__:[N0,Bm,Ff,En,Yl,Va,Z0],__init__:["contextPadProvider"],contextPadProvider:["type",or]};var eS={horizontal:["x","width"],vertical:["y","height"]},yd=5;function Pn(e,t){this._modeling=e,this._filters=[],this.registerFilter(function(n){var i=t.allowed("elements.distribute",{elements:n});return Pe(i)?i:i?n:[]})}Pn.$inject=["modeling","rules"];Pn.prototype.registerFilter=function(e){if(typeof e!="function")throw new Error("the filter has to be a function");this._filters.push(e)};Pn.prototype.trigger=function(e,t){var n=this._modeling,i,r;if(!(e.length<3)&&(this._setOrientation(t),r=this._filterElements(e),i=this._createGroups(r),!(i.length<=2)))return n.distributeElements(i,this._axis,this._dimension),i};Pn.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,r=[].concat(e);return t.length?(I(t,function(o){r=o(r,n,i)}),r):e};Pn.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,r=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var o=on(e,i);return I(o,function(a,s){var l=n._findRange(a,i,r),c,p=t[t.length-1];p&&n._hasIntersection(p.range,l)?t[t.length-1].elements.push(a):(c={range:l,elements:[a]},t.push(c))}),t};Pn.prototype._setOrientation=function(e){var t=eS[e];this._axis=t[0],this._dimension=t[1]};Pn.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)};Pn.prototype._findRange=function(e){var t=e[this._axis],n=e[this._dimension];return{min:t+yd,max:t+n-yd}};const tS={__init__:["distributeElements"],distributeElements:["type",Pn]};function es(e){$t.call(this,e)}es.$inject=["eventBus"];te(es,$t);es.prototype.init=function(){this.addRule("elements.distribute",function(e){var t=e.elements;return t=ye(t,function(n){var i=ve(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||i)}),t=va(t),t.length<3?!1:t})};var _d={horizontal:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
                <polyline points="450 400 450 150 1350 150 1350 400" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
                <rect x="150" y="450" width="600" height="1200" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
                <rect x="1050" y="450" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
              </svg>`,vertical:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
              <polyline points="400 1350 150 1350 150 450 400 450" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
              <rect x="450" y="150" width="1200" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="450" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
            </svg>`},nS=900;function ao(e,t,n,i){this._distributeElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",nS,this)}ao.$inject=["popupMenu","distributeElements","translate","rules"];ao.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&N(t,this._getEntries(e)),t};ao.prototype._isAllowed=function(e){return this._rules.allowed("elements.distribute",{elements:e})};ao.prototype._getEntries=function(e){var t=this._distributeElements,n=this._translate,i=this._popupMenu,r={"distribute-elements-horizontal":{group:"distribute",title:n("Distribute elements horizontally"),className:"bjs-align-elements-menu-entry",imageHtml:_d.horizontal,action:function(o,a){t.trigger(e,"horizontal"),i.close()}},"distribute-elements-vertical":{group:"distribute",title:n("Distribute elements vertically"),imageHtml:_d.vertical,action:function(o,a){t.trigger(e,"vertical"),i.close()}}};return r};const iS={__depends__:[jl,tS],__init__:["bpmnDistributeElements","distributeElementsMenuProvider"],bpmnDistributeElements:["type",es],distributeElementsMenuProvider:["type",ao]};var Vm="is not a registered action",rS="is already registered";function Ft(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}Ft.$inject=["eventBus","injector"];Ft.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),o=e.get("copyPaste",!1),a=e.get("canvas",!1),s=e.get("rules",!1),l=e.get("keyboardMove",!1),c=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),o&&i&&this.register("copy",function(){var p=i.get();if(p.length)return o.copy(p)}),o&&this.register("paste",function(){o.paste()}),r&&this.register("stepZoom",function(p){r.stepZoom(p.value)}),a&&this.register("zoom",function(p){a.zoom(p.value)}),n&&i&&s&&this.register("removeSelection",function(){var p=i.get();if(p.length){var u=s.allowed("elements.delete",{elements:p}),d;u!==!1&&(Pe(u)?d=u:d=p,d.length&&n.removeElements(d.slice()))}}),l&&this.register("moveCanvas",function(p){l.moveCanvas(p)}),c&&this.register("moveSelection",function(p){c.moveSelection(p.direction,p.accelerated)})};Ft.prototype.trigger=function(e,t){if(!this._actions[e])throw Zc(e,Vm);return this._actions[e](t)};Ft.prototype.register=function(e,t){var n=this;if(typeof e=="string")return this._registerAction(e,t);I(e,function(i,r){n._registerAction(r,i)})};Ft.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw Zc(e,rS);this._actions[e]=t};Ft.prototype.unregister=function(e){if(!this.isRegistered(e))throw Zc(e,Vm);this._actions[e]=void 0};Ft.prototype.getActions=function(){return Object.keys(this._actions)};Ft.prototype.isRegistered=function(e){return!!this._actions[e]};function Zc(e,t){return new Error(e+" "+t)}const oS={__init__:["editorActions"],editorActions:["type",Ft]};function ts(e){e.invoke(Ft,this)}te(ts,Ft);ts.$inject=["injector"];ts.prototype._registerDefaultActions=function(e){Ft.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),o=e.get("lassoTool",!1),a=e.get("handTool",!1),s=e.get("globalConnect",!1),l=e.get("distributeElements",!1),c=e.get("alignElements",!1),p=e.get("directEditing",!1),u=e.get("searchPad",!1),d=e.get("modeling",!1),f=e.get("contextPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var h=t.getRootElement(),v=n.filter(function(m){return m!==h});return i.select(v),v}),r&&this._registerAction("spaceTool",function(){r.toggle()}),o&&this._registerAction("lassoTool",function(){o.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&l&&this._registerAction("distributeElements",function(h){var v=i.get(),m=h.type;v.length&&l.trigger(v,m)}),i&&c&&this._registerAction("alignElements",function(h){var v=i.get(),m=[],S=h.type;v.length&&(m=ye(v,function(b){return!y(b,"bpmn:Lane")}),c.trigger(m,S))}),i&&d&&this._registerAction("setColor",function(h){var v=i.get();v.length&&d.setColor(v,h)}),i&&p&&this._registerAction("directEditing",function(){var h=i.get();h.length&&p.activate(h[0])}),u&&this._registerAction("find",function(){u.toggle()}),t&&d&&this._registerAction("moveToOrigin",function(){var h=t.getRootElement(),v,m;y(h,"bpmn:Collaboration")?m=n.filter(function(S){return y(S.parent,"bpmn:Collaboration")}):m=n.filter(function(S){return S!==h&&!y(S.parent,"bpmn:SubProcess")}),v=Pt(m),d.moveElements(m,{x:-v.x,y:-v.y},h)}),i&&f&&this._registerAction("replaceElement",function(h){f.triggerEntry("replace","click",h)})};const aS={__depends__:[oS],editorActions:["type",ts]};function Fm(e){e.on(["create.init","shape.move.init"],function(t){var n=t.context,i=t.shape;ve(i,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}Fm.$inject=["eventBus"];var Xo=10;function Is(e,t,n){return n||(n="round"),Math[n](e/t)*t}var sS=1200,lS=800;function ni(e,t,n){var i=!n||n.active!==!1;this._eventBus=t;var r=this;t.on("diagram.init",lS,function(){r.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],sS,function(o){var a=o.originalEvent;if(!(!r.active||a&&At(a))){var s=o.context,l=s.gridSnappingContext;l||(l=s.gridSnappingContext={}),["x","y"].forEach(function(c){var p={},u=uS(o,c,e);u&&(p.offset=u);var d=cS(o,c);d&&N(p,d),Xi(o,c)||r.snapEvent(o,c,p)})}})}ni.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);Ye(e,t,i)};ni.prototype.getGridSpacing=function(){return Xo};ni.prototype.snapValue=function(e,t){var n=0;t&&t.offset&&(n=t.offset),e+=n,e=Is(e,Xo);var i,r;return t&&t.min&&(i=t.min,_e(i)&&(i=Is(i+n,Xo,"ceil"),e=Math.max(e,i))),t&&t.max&&(r=t.max,_e(r)&&(r=Is(r+n,Xo,"floor"),e=Math.min(e,r))),e-=n,e};ni.prototype.isActive=function(){return this.active};ni.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})};ni.prototype.toggleActive=function(){this.setActive(!this.active)};ni.$inject=["elementRegistry","eventBus","config.gridSnapping"];function cS(e,t){var n=e.context,i=n.createConstraints,r=n.resizeConstraints||{},o=n.gridSnappingContext,a=o.snapConstraints;if(a&&a[t])return a[t];a||(a=o.snapConstraints={}),a[t]||(a[t]={});var s=n.direction;i&&(Zo(t)?(a.x.min=i.left,a.x.max=i.right):(a.y.min=i.top,a.y.max=i.bottom));var l=r.min,c=r.max;return l&&(Zo(t)?Ed(s)?a.x.max=l.left:a.x.min=l.right:bd(s)?a.y.max=l.top:a.y.min=l.bottom),c&&(Zo(t)?Ed(s)?a.x.min=c.left:a.x.max=c.right:bd(s)?a.y.min=c.top:a.y.max=c.bottom),a[t]}function uS(e,t,n){var i=e.context,r=e.shape,o=i.gridSnappingContext,a=o.snapLocation,s=o.snapOffset;return s&&_e(s[t])||(s||(s=o.snapOffset={}),_e(s[t])||(s[t]=0),!r)||(n.get(r.id)||(Zo(t)?s[t]+=r[t]+r.width/2:s[t]+=r[t]+r.height/2),!a)||(t==="x"?/left/.test(a)?s[t]-=r.width/2:/right/.test(a)&&(s[t]+=r.width/2):/top/.test(a)?s[t]-=r.height/2:/bottom/.test(a)&&(s[t]+=r.height/2)),s[t]}function Zo(e){return e==="x"}function bd(e){return e.indexOf("n")!==-1}function Ed(e){return e.indexOf("w")!==-1}function ki(e,t){W.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(i){var r=i.context,o=r.hints||{},a=o.autoResize;if(a){var s=r.shape,l=r.newBounds;ga(a)?r.newBounds=n.snapComplex(l,a):r.newBounds=n.snapSimple(s,l)}})}ki.$inject=["eventBus","gridSnapping","modeling"];te(ki,W);ki.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t};ki.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e};ki.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),r=/e/.test(t),o={};return o.width=n.snapValue(e.width,{min:e.width}),r&&(i?(o.x=n.snapValue(e.x,{max:e.x}),o.width+=n.snapValue(e.x-o.x,{min:e.x-o.x})):e.x=e.x+e.width-o.width),N(e,o),e};ki.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),r=/s/.test(t),o={};return o.height=n.snapValue(e.height,{min:e.height}),i&&(r?(o.y=n.snapValue(e.y,{max:e.y}),o.height+=n.snapValue(e.y-o.y,{min:e.y-o.y})):e.y=e.y+e.height-o.height),N(e,o),e};var pS=2e3;function Hm(e,t){e.on(["spaceTool.move","spaceTool.end"],pS,function(n){var i=n.context;if(i.initialized){var r=i.axis,o;r==="x"?(o=t.snapValue(n.dx),n.x=n.x+o-n.dx,n.dx=o):(o=t.snapValue(n.dy),n.y=n.y+o-n.dy,n.dy=o)}})}Hm.$inject=["eventBus","gridSnapping"];const dS={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",ki],gridSnappingSpaceToolBehavior:["type",Hm]},fS={__depends__:[dS],__init__:["gridSnapping"],gridSnapping:["type",ni]};var hS=2e3;function zm(e,t){e.on("autoPlace",hS,function(n){var i=n.source,r=de(i),o=n.shape,a=lh(i,o);return["x","y"].forEach(function(s){var l={};a[s]!==r[s]&&(a[s]>r[s]?l.min=a[s]:l.max=a[s],y(o,"bpmn:TextAnnotation")&&(mS(s)?l.offset=-o.width/2:l.offset=-o.height/2),a[s]=t.snapValue(a[s],l))}),a})}zm.$inject=["eventBus","gridSnapping"];function mS(e){return e==="x"}var vS=1750;function Um(e,t,n){t.on(["create.start","shape.move.start"],vS,function(i){var r=i.context,o=r.shape,a=e.getRootElement();if(!(!y(o,"bpmn:Participant")||!y(a,"bpmn:Process")||!a.children.length)){var s=r.createConstraints;s&&(o.width=n.snapValue(o.width,{min:o.width}),o.height=n.snapValue(o.height,{min:o.height}))}})}Um.$inject=["canvas","eventBus","gridSnapping"];var gS=3e3;function ns(e,t,n){W.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],gS,function(r){var o=r.context,a=o.connection,s=o.hints||{},l=a.waypoints;s.connectionStart||s.connectionEnd||s.createElementsBehavior===!1||yS(l)&&n.updateWaypoints(a,i.snapMiddleSegments(l))})}ns.$inject=["eventBus","gridSnapping","modeling"];te(ns,W);ns.prototype.snapMiddleSegments=function(e){var t=this._gridSnapping,n;e=e.slice();for(var i=1;i<e.length-2;i++)n=ES(t,e[i],e[i+1]),e[i]=n[0],e[i+1]=n[1];return e};function yS(e){return e.length>3}function _S(e){return e==="h"}function bS(e){return e==="v"}function ES(e,t,n){var i=hn(t,n),r={};return _S(i)&&(r.y=e.snapValue(t.y)),bS(i)&&(r.x=e.snapValue(t.x)),("x"in r||"y"in r)&&(t=N({},t,r),n=N({},n,r)),[t,n]}const xS={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",zm],gridSnappingParticipantBehavior:["type",Um],gridSnappingLayoutConnectionBehavior:["type",ns]},wS={__depends__:[fS,xS],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",Fm]};var SS=30,CS=30;function so(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(i){var r=i.element,o=i.gfx;if(y(r,"bpmn:Lane"))return n._createParticipantHit(r,o);if(y(r,"bpmn:Participant"))return Se(r)?n._createParticipantHit(r,o):n._createDefaultHit(r,o);if(y(r,"bpmn:SubProcess"))return Se(r)?n._createSubProcessHit(r,o):n._createDefaultHit(r,o)})}so.$inject=["eventBus","interactionEvents"];so.prototype._createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0};so.prototype._createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:SS,height:e.height}),!0};so.prototype._createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:CS}),!0};const TS={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",so]};function is(e){e.invoke(er,this)}te(is,er);is.$inject=["injector"];is.prototype.registerBindings=function(e,t){er.prototype.registerBindings.call(this,e,t);function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("selectElements",function(i){var r=i.keyEvent;if(e.isKey(["a","A"],r)&&e.isCmd(r))return t.trigger("selectElements"),!0}),n("find",function(i){var r=i.keyEvent;if(e.isKey(["f","F"],r)&&e.isCmd(r))return t.trigger("find"),!0}),n("spaceTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["s","S"],r))return t.trigger("spaceTool"),!0}),n("lassoTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["l","L"],r))return t.trigger("lassoTool"),!0}),n("handTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["h","H"],r))return t.trigger("handTool"),!0}),n("globalConnectTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["c","C"],r))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["e","E"],r))return t.trigger("directEditing"),!0}),n("replaceElement",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["r","R"],r))return t.trigger("replaceElement",r),!0})};const PS={__depends__:[Al],__init__:["keyboardBindings"],keyboardBindings:["type",is]};var RS={moveSpeed:1,moveSpeedAccelerated:10},kS=1500,xd="left",wd="up",Sd="right",Cd="down",AS={ArrowLeft:xd,Left:xd,ArrowUp:wd,Up:wd,ArrowRight:Sd,Right:Sd,ArrowDown:Cd,Down:Cd},DS={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function Gm(e,t,n,i,r){var o=this;this._config=N({},RS,e||{}),t.addListener(kS,function(a){var s=a.keyEvent,l=AS[s.key];if(l&&!t.isCmd(s)){var c=t.isShift(s);return o.moveSelection(l,c),!0}}),this.moveSelection=function(a,s){var l=r.get();if(l.length){var c=this._config[s?"moveSpeedAccelerated":"moveSpeed"],p=DS[a](c),u=i.allowed("elements.move",{shapes:l});u&&n.moveElements(l,p)}}}Gm.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const IS={__depends__:[Al,En],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",Gm]};var Td=10;function lo(e,t,n,i){this._dragging=i,this._rules=t;var r=this;function o(l,c){var p=l.shape,u=l.direction,d=l.resizeConstraints,f;l.delta=c,f=yE(p,u,c),l.newBounds=bE(f,d),l.canExecute=r.canResize(l)}function a(l){var c=l.resizeConstraints,p=l.minBounds;c===void 0&&(p===void 0&&(p=r.computeMinResizeBox(l)),l.resizeConstraints={min:se(p)})}function s(l){var c=l.shape,p=l.canExecute,u=l.newBounds;if(p){if(u=ff(u),!MS(c,u))return;n.resizeShape(c,u)}}e.on("resize.start",function(l){a(l.context)}),e.on("resize.move",function(l){var c={x:l.dx,y:l.dy};o(l.context,c)}),e.on("resize.end",function(l){s(l.context)})}lo.prototype.canResize=function(e){var t=this._rules,n=an(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)};lo.prototype.activate=function(e,t,n){var i=this._dragging,r,o;if(typeof n=="string"&&(n={direction:n}),r=N({shape:t},n),o=r.direction,!o)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");i.init(e,Wm(t,o),"resize",{autoActivate:!0,cursor:NS(o),data:{shape:t,context:r}})};lo.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i,r;return i=e.minDimensions||{width:Td,height:Td},r=Ih(t,e.childrenBoxPadding),EE(n,t,i,r)};lo.$inject=["eventBus","rules","modeling","dragging"];function MS(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function Wm(e,t){var n=de(e),i=se(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function NS(e){var t="resize-";return e==="n"||e==="s"?t+"ns":e==="e"||e==="w"?t+"ew":e==="nw"||e==="se"?t+"nwse":t+"nesw"}var Pd="djs-resizing",Rd="resize-not-ok",OS=500;function Ym(e,t,n){function i(o){var a=o.shape,s=o.newBounds,l=o.frame;l||(l=o.frame=n.addFrame(a,t.getActiveLayer()),t.addMarker(a,Pd)),s.width>5&&pe(l,{x:s.x,width:s.width}),s.height>5&&pe(l,{y:s.y,height:s.height}),o.canExecute?Ne(l).remove(Rd):Ne(l).add(Rd)}function r(o){var a=o.shape,s=o.frame;s&&pt(o.frame),t.removeMarker(a,Pd)}e.on("resize.move",OS,function(o){i(o.context)}),e.on("resize.cleanup",function(o){r(o.context)})}Ym.$inject=["eventBus","canvas","previewSupport"];var jo=-6,Vo=8,Fo=20,Er="djs-resizer",LS=["n","w","s","e","nw","ne","se","sw"];function ii(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(o){var a=o.newSelection;r.removeResizers(),a.length===1&&I(a,yi(r.addResizer,r))}),e.on("shape.changed",function(o){var a=o.element;n.isSelected(a)&&(r.removeResizers(),r.addResizer(a))})}ii.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(o){wl(o)&&i.activate(o,e,n)}ce.bind(t,"mousedown",r),ce.bind(t,"touchstart",r)};ii.prototype._createResizer=function(e,t,n,i){var r=this._getResizersParent(),o=$S(i),a=Ee("g");Ne(a).add(Er),Ne(a).add(Er+"-"+e.id),Ne(a).add(Er+"-"+i),Te(r,a);var s=Ee("rect");pe(s,{x:-Vo/2+o.x,y:-Vo/2+o.y,width:Vo,height:Vo}),Ne(s).add(Er+"-visual"),Te(a,s);var l=Ee("rect");return pe(l,{x:-Fo/2+o.x,y:-Fo/2+o.y,width:Fo,height:Fo}),Ne(l).add(Er+"-hit"),Te(a,l),Rg(a,t,n),a};ii.prototype.createResizer=function(e,t){var n=Wm(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)};ii.prototype.addResizer=function(e){var t=this;De(e)||!this._resize.canResize({shape:e})||I(LS,function(n){t.createResizer(e,n)})};ii.prototype.removeResizers=function(){var e=this._getResizersParent();Sl(e)};ii.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};ii.$inject=["eventBus","canvas","selection","resize"];function $S(e){var t={x:0,y:0};return e.indexOf("e")!==-1?t.x=-jo:e.indexOf("w")!==-1&&(t.x=jo),e.indexOf("s")!==-1?t.y=-jo:e.indexOf("n")!==-1&&(t.y=jo),t}const qm={__depends__:[cn,Sn,rr],__init__:["resize","resizePreview","resizeHandles"],resize:["type",lo],resizePreview:["type",Ym],resizeHandles:["type",ii]};var BS=2e3;function co(e,t,n,i,r,o,a){this._bpmnFactory=t,this._canvas=n,this._modeling=r,this._textRenderer=a,i.registerProvider(this),e.on("element.dblclick",function(l){s(l.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set","selection.changed"],function(){i.isActive()&&i.complete()}),e.on(["shape.remove","connection.remove"],BS,function(l){i.isActive(l.element)&&i.cancel()}),e.on(["commandStack.changed"],function(l){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(l){o.removeResizers()}),e.on("create.end",500,function(l){var c=l.context,p=c.shape,u=l.context.canExecute,d=l.isTouch;d||u&&(c.hints&&c.hints.createElementsBehavior===!1||s(p))}),e.on("autoPlace.end",500,function(l){s(l.shape)});function s(l,c){(c||ve(l,["bpmn:Task","bpmn:TextAnnotation","bpmn:Participant"])||Qc(l))&&i.activate(l)}}co.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];co.prototype.activate=function(e){var t=zn(e);if(t!==void 0){var n={text:t},i=this.getEditingBBox(e);N(n,i);var r={};return(ve(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||Qc(e))&&N(r,{centerVertically:!0}),Yi(e)&&N(r,{autoResize:!0}),y(e,"bpmn:TextAnnotation")&&N(r,{resizable:!0,autoResize:!0}),N(n,{options:r}),n}};co.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),r={x:i.x+i.width/2,y:i.y+i.height/2},o={x:i.x,y:i.y},a=t.zoom(),s=this._textRenderer.getDefaultStyle(),l=this._textRenderer.getExternalStyle(),c=l.fontSize*a,p=l.lineHeight,u=s.fontSize*a,d=s.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};if(y(e,"bpmn:Lane")||FS(e)){var h=_n(e),v=h?{width:i.height,height:30*a,x:i.x-i.height/2+15*a,y:r.y-30*a/2}:{width:i.width,height:30*a};N(o,v),N(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px",transform:h?"rotate(-90deg)":null})}if(VS(e)){var m=_n(e),S=m?{width:i.width,height:i.height}:{width:i.height,height:i.width,x:r.x-i.height/2,y:r.y-i.width/2};N(o,S),N(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px",transform:m?null:"rotate(-90deg)"})}(ve(e,["bpmn:Task","bpmn:CallActivity"])||Qc(e))&&(N(o,{width:i.width,height:i.height}),N(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"})),jS(e)&&(N(o,{width:i.width,x:i.x}),N(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"}));var b=90*a,T=7*a,C=4*a;if(n.labelTarget&&(N(o,{width:b,height:i.height+T+C,x:r.x-b/2,y:i.y-T}),N(f,{fontSize:c+"px",lineHeight:p,paddingTop:T+"px",paddingBottom:C+"px"})),Yi(n)&&!_a(n)&&!xe(n)){var k=gf(e),A=t.getAbsoluteBBox({x:k.x,y:k.y,width:0,height:0}),j=c+T+C;N(o,{width:b,height:j,x:A.x-b/2,y:A.y-j/2}),N(f,{fontSize:c+"px",lineHeight:p,paddingTop:T+"px",paddingBottom:C+"px"})}return y(e,"bpmn:TextAnnotation")&&(N(o,{width:i.width,height:i.height,minWidth:30*a,minHeight:10*a}),N(f,{textAlign:"left",paddingTop:5*a+"px",paddingBottom:7*a+"px",paddingLeft:7*a+"px",paddingRight:5*a+"px",fontSize:u+"px",lineHeight:d})),{bounds:o,style:f}};co.prototype.update=function(e,t,n,i){var r,o;y(e,"bpmn:TextAnnotation")&&(o=this._canvas.getAbsoluteBBox(e),r={x:e.x,y:e.y,width:e.width/o.width*i.width,height:e.height/o.height*i.height}),HS(t)&&(t=null),this._modeling.updateLabel(e,t,r)};function Qc(e){return y(e,"bpmn:SubProcess")&&!Se(e)}function jS(e){return y(e,"bpmn:SubProcess")&&Se(e)}function VS(e){return y(e,"bpmn:Participant")&&!Se(e)}function FS(e){return y(e,"bpmn:Participant")&&Se(e)}function HS(e){return!e||!e.trim()}var kd="djs-element-hidden",Ad="djs-label-hidden";function Km(e,t,n){var i=this,r=t.getDefaultLayer(),o,a,s;e.on("directEditing.activate",function(l){var c=l.active;if(o=c.element.label||c.element,y(o,"bpmn:TextAnnotation")){a=t.getAbsoluteBBox(o),s=Ee("g");var p=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:o.height,position:{mx:0,my:0}}),u=i.path=Ee("path");pe(u,{d:p,strokeWidth:2,stroke:zS(o)}),Te(s,u),Te(r,s),mt(s,o.x,o.y)}y(o,"bpmn:TextAnnotation")||o.labelTarget?t.addMarker(o,kd):(y(o,"bpmn:Task")||y(o,"bpmn:CallActivity")||y(o,"bpmn:SubProcess")||y(o,"bpmn:Participant"))&&t.addMarker(o,Ad)}),e.on("directEditing.resize",function(l){if(y(o,"bpmn:TextAnnotation")){var c=l.height,p=l.dy,u=Math.max(o.height/a.height*(c+p),0),d=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:u,position:{mx:0,my:0}});pe(i.path,{d})}}),e.on(["directEditing.complete","directEditing.cancel"],function(l){var c=l.active;c&&(t.removeMarker(c.element.label||c.element,kd),t.removeMarker(o,Ad)),o=void 0,a=void 0,s&&(pt(s),s=void 0)})}Km.$inject=["eventBus","canvas","pathMap"];function zS(e,t){var n=Ie(e);return n.get("stroke")||t||"black"}const US={__depends__:[yf,qm,Bm],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",co],labelEditingPreview:["type",Km]};var GS=new kg("tt");function WS(e){var t=rt('<div class="djs-tooltip-container" />');return Ea(t,{position:"absolute",width:"0",height:"0"}),e.insertBefore(t,e.firstChild),t}function YS(e,t,n){Ea(e,{left:t+"px",top:n+"px"})}function Jc(e,t){e.style.display=t===!1?"none":""}var Xm="djs-tooltip",Ms="."+Xm;function St(e,t){this._eventBus=e,this._canvas=t,this._ids=GS,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=WS(t.getContainer());var n=this;Ut.bind(this._tooltipRoot,Ms,"mousedown",function(i){i.stopPropagation()}),Ut.bind(this._tooltipRoot,Ms,"mouseover",function(i){n.trigger("mouseover",i)}),Ut.bind(this._tooltipRoot,Ms,"mouseout",function(i){n.trigger("mouseout",i)}),this._init()}St.$inject=["eventBus","canvas"];St.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=N({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t};St.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get(bt(n,"data-tooltip-id"));i&&(e==="mouseover"&&i.timeout&&this.clearTimeout(i),e==="mouseout"&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))};St.prototype.get=function(e){return typeof e!="string"&&(e=e.id),this._tooltips[e]};St.prototype.clearTimeout=function(e){if(e=this.get(e),!!e){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}};St.prototype.setTimeout=function(e){if(e=this.get(e),!!e){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}};St.prototype.remove=function(e){var t=this.get(e);t&&(Wi(t.html),Wi(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])};St.prototype.show=function(){Jc(this._tooltipRoot)};St.prototype.hide=function(){Jc(this._tooltipRoot,!1)};St.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i};St.prototype._addTooltip=function(e){var t=e.id,n=e.html,i,r=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),ga(n)&&(n=rt(n)),i=rt('<div data-tooltip-id="'+t+'" class="'+Xm+'">'),Ea(i,{position:"absolute"}),i.appendChild(n),e.type&&xt(i).add("djs-tooltip-"+e.type),e.className&&xt(i).add(e.className),e.htmlContainer=i,r.appendChild(i),this._tooltips[t]=e,this._updateTooltip(e)};St.prototype._updateTooltip=function(e){var t=e.position,n=e.htmlContainer;YS(n,t.x,t.y)};St.prototype._updateTooltipVisibilty=function(e){I(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,r=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(r=!1),Jc(i,r))})};St.prototype._init=function(){var e=this;function t(n){e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}this._eventBus.on("canvas.viewbox.changing",function(n){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){t(n.viewbox)})};const qS={__init__:["tooltips"],tooltips:["type",St]};var KS="flow elements must be children of pools/participants";function Zm(e,t,n){function i(r,o,a){t.add({position:{x:r.x+5,y:r.y+5},type:"error",timeout:2e3,html:"<div>"+o+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(r){var o=r.context,a=o.shape,s=o.target;y(s,"bpmn:Collaboration")&&y(a,"bpmn:FlowNode")&&i(r,n(KS))})}Zm.$inject=["eventBus","tooltips","translate"];const XS={__depends__:[qS],__init__:["modelingFeedback"],modelingFeedback:["type",Zm]};var ZS=500,QS=1250,JS=1500,ua=Math.round;function e1(e){return{x:e.x+ua(e.width/2),y:e.y+ua(e.height/2)}}function Qm(e,t,n,i,r){function o(s,l,c,p){return r.allowed("elements.move",{shapes:s,delta:l,position:c,target:p})}e.on("shape.move.start",JS,function(s){var l=s.context,c=s.shape,p=i.get().slice();p.indexOf(c)===-1&&(p=[c]),p=t1(p),N(l,{shapes:p,validatedShapes:p,shape:c})}),e.on("shape.move.start",QS,function(s){var l=s.context,c=l.validatedShapes,p;if(p=l.canExecute=o(c),!p)return!1}),e.on("shape.move.move",ZS,function(s){var l=s.context,c=l.validatedShapes,p=s.hover,u={x:s.dx,y:s.dy},d={x:s.x,y:s.y},f;if(f=o(c,u,d,p),l.delta=u,l.canExecute=f,f===null){l.target=null;return}l.target=p}),e.on("shape.move.end",function(s){var l=s.context,c=l.delta,p=l.canExecute,u=p==="attach",d=l.shapes;if(p===!1)return!1;c.x=ua(c.x),c.y=ua(c.y),!(c.x===0&&c.y===0)&&n.moveElements(d,c,l.target,{primaryShape:l.shape,attach:u})}),e.on("element.mousedown",function(s){if(wl(s)){var l=lf(s);if(!l)throw new Error("must supply DOM mousedown event");return a(l,s.element)}});function a(s,l,c,p){if(yn(c)&&(p=c,c=!1),!(l.waypoints||!l.parent)&&!Ne(s.target).has("djs-hit-no-move")){var u=e1(l);return t.init(s,u,"shape.move",{cursor:"grabbing",autoActivate:c,data:{shape:l,context:p||{}}}),!0}}this.start=a}Qm.$inject=["eventBus","dragging","modeling","selection","rules"];function t1(e){var t=ya(e,"id");return ye(e,function(n){for(;n=n.parent;)if(t[n.id])return!1;return!0})}var Dd=499,Ns="djs-dragging",Id="drop-ok",Md="drop-not-ok",Nd="new-parent",Od="attach-ok";function Jm(e,t,n,i){function r(l){var c=o(l),p=n1(c);return p}function o(l){var c=Hr(l,!0),p=Et(c,function(u){return(u.incoming||[]).concat(u.outgoing||[])});return Qo(c.concat(p))}function a(l,c){[Od,Id,Md,Nd].forEach(function(p){p===c?t.addMarker(l,p):t.removeMarker(l,p)})}function s(l,c,p){i.addDragger(c,l.dragGroup),p&&t.addMarker(c,Ns),l.allDraggedElements?l.allDraggedElements.push(c):l.allDraggedElements=[c]}e.on("shape.move.start",Dd,function(l){var c=l.context,p=c.shapes,u=c.allDraggedElements,d=r(p);if(!c.dragGroup){var f=Ee("g");pe(f,n.cls("djs-drag-group",["no-events"]));var h=t.getActiveLayer();Te(h,f),c.dragGroup=f}d.forEach(function(v){i.addDragger(v,c.dragGroup)}),u?u=Qo([u,o(p)]):u=o(p),I(u,function(v){t.addMarker(v,Ns)}),c.allDraggedElements=u,c.differentParents=i1(p)}),e.on("shape.move.move",Dd,function(l){var c=l.context,p=c.dragGroup,u=c.target,d=c.shape.parent,f=c.canExecute;u&&(f==="attach"?a(u,Od):c.canExecute&&u&&u.id!==d.id?a(u,Nd):a(u,c.canExecute?Id:Md)),mt(p,l.dx,l.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(l){var c=l.context,p=c.target;p&&a(p,null)}),e.on("shape.move.cleanup",function(l){var c=l.context,p=c.allDraggedElements,u=c.dragGroup;I(p,function(d){t.removeMarker(d,Ns)}),u&&pt(u)}),this.makeDraggable=s}Jm.$inject=["eventBus","canvas","styles","previewSupport"];function n1(e){var t=ye(e,function(n){return De(n)?Oe(e,mn({id:n.source.id}))&&Oe(e,mn({id:n.target.id})):!0});return t}function i1(e){return Ag(ya(e,function(t){return t.parent&&t.parent.id}))!==1}const r1={__depends__:[ma,En,_f,cn,Sn,rr],__init__:["move","movePreview"],move:["type",Qm],movePreview:["type",Jm]},o1="M44.7648 11.3263L36.9892 2.64074C36.0451 1.58628 34.5651 0.988708 33.1904 0.988708H5.98667C3.22688 0.988708 0.989624 3.34892 0.989624 6.26039V55.0235C0.989624 57.9349 3.22688 60.2952 5.98667 60.2952H40.966C43.7257 60.2952 45.963 57.9349 45.963 55.0235V14.9459C45.963 13.5998 45.6407 12.3048 44.7648 11.3263Z",a1="M1.03845 48.1347C1.03845 49.3511 1.07295 50.758 1.38342 52.064C1.69949 53.3938 2.32428 54.7154 3.56383 55.6428C6.02533 57.4841 10.1161 58.7685 14.8212 59.6067C19.5772 60.4538 25.1388 60.8738 30.6831 60.8738C36.2276 60.8738 41.7891 60.4538 46.545 59.6067C51.2504 58.7687 55.3412 57.4842 57.8028 55.6429C59.0424 54.7156 59.6673 53.3938 59.9834 52.064C60.2938 50.7579 60.3285 49.351 60.3285 48.1344V13.8415C60.3285 12.6249 60.2938 11.218 59.9834 9.91171C59.6673 8.58194 59.0423 7.2602 57.8027 6.33294C55.341 4.49168 51.2503 3.20723 46.545 2.36914C41.7891 1.522 36.2276 1.10204 30.6831 1.10205C25.1388 1.10206 19.5772 1.52206 14.8213 2.36923C10.1162 3.20734 6.02543 4.49183 3.5639 6.33314C2.32433 7.26038 1.69951 8.58206 1.38343 9.91181C1.07295 11.2179 1.03845 12.6247 1.03845 13.8411V48.1347Z",s1={width:36,height:50},l1={width:50,height:50};function Ld(e,t,n){return Ee("path",{d:e,strokeWidth:2,transform:`translate(${t.x}, ${t.y})`,...n})}const Bn=5;function rs(e,t){this._styles=t,e.registerProvider(this)}rs.$inject=["outline","styles"];rs.prototype.getOutline=function(e){const t=this._styles.cls("djs-outline",["no-fill"]);var n;if(!xe(e))return y(e,"bpmn:Gateway")?(n=Ee("rect"),N(n.style,{"transform-box":"fill-box",transform:"rotate(45deg)","transform-origin":"center"}),pe(n,N({x:2,y:2,rx:4,width:e.width-4,height:e.height-4},t))):ve(e,["bpmn:Task","bpmn:SubProcess","bpmn:Group"])?(n=Ee("rect"),pe(n,N({x:-Bn,y:-Bn,rx:14,width:e.width+Bn*2,height:e.height+Bn*2},t))):y(e,"bpmn:EndEvent")?(n=Ee("circle"),pe(n,N({cx:e.width/2,cy:e.height/2,r:e.width/2+Bn+1},t))):y(e,"bpmn:Event")?(n=Ee("circle"),pe(n,N({cx:e.width/2,cy:e.height/2,r:e.width/2+Bn},t))):y(e,"bpmn:DataObjectReference")&&$d(e,"bpmn:DataObjectReference")?n=Ld(o1,{x:-6,y:-6},t):y(e,"bpmn:DataStoreReference")&&$d(e,"bpmn:DataStoreReference")&&(n=Ld(a1,{x:-6,y:-6},t)),n};rs.prototype.updateOutline=function(e,t){if(!xe(e))return ve(e,["bpmn:SubProcess","bpmn:Group"])?(pe(t,{width:e.width+Bn*2,height:e.height+Bn*2}),!0):!!ve(e,["bpmn:Event","bpmn:Gateway","bpmn:DataStoreReference","bpmn:DataObjectReference"])};function $d(e,t){var n;return t==="bpmn:DataObjectReference"?n=s1:t==="bpmn:DataStoreReference"&&(n=l1),e.width===n.width&&e.height===n.height}const c1={__depends__:[_f],__init__:["outlineProvider"],outlineProvider:["type",rs]};var ev=".djs-palette-toggle",tv=".entry",u1=ev+", "+tv,pl="djs-palette-",p1="shown",dl="open",Bd="two-column",d1=1e3;function qe(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(i){var r=i.tool;n.updateToolHighlight(r)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}qe.$inject=["eventBus","canvas"];qe.prototype.registerProvider=function(e,t){t||(t=e,e=d1),this._eventBus.on("palette.getProviders",e,function(n){n.providers.push(t)}),this._rebuild()};qe.prototype.getEntries=function(){var e=this._getProviders();return e.reduce(h1,{})};qe.prototype._rebuild=function(){if(this._diagramInitialized){var e=this._getProviders();e.length&&(this._container||this._init(),this._update())}};qe.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=rt(qe.HTML_MARKUP);n.appendChild(i),xt(n).add(pl+p1),Ut.bind(i,u1,"click",function(r){var o=r.delegateTarget;if(_l(o,ev))return e.toggle();e.trigger("click",r)}),ce.bind(i,"mousedown",function(r){r.stopPropagation()}),Ut.bind(i,tv,"dragstart",function(r){e.trigger("dragstart",r)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})};qe.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};qe.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,r,o=xt(n),a=xt(t);"twoColumn"in e?r=e.twoColumn:r=this._needsCollapse(t.clientHeight,this._entries||{}),o.toggle(Bd,r),a.toggle(pl+Bd,r),"open"in e&&(o.toggle(dl,e.open),a.toggle(pl+dl,e.open)),i.fire("palette.changed",{twoColumn:r,open:this.isOpen()})};qe.prototype._update=function(){var e=ot(".djs-palette-entries",this._container),t=this._entries=this.getEntries();bf(e),I(t,function(n,i){var r=n.group||"default",o=ot("[data-group="+Dr(r)+"]",e);o||(o=rt('<div class="group"></div>'),bt(o,"data-group",r),e.appendChild(o));var a=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),s=rt(a);if(o.appendChild(s),!n.separator&&(bt(s,"data-action",i),n.title&&bt(s,"title",n.title),n.className&&f1(s,n.className),n.imageUrl)){var l=rt("<img>");bt(l,"src",n.imageUrl),s.appendChild(l)}}),this.open()};qe.prototype.trigger=function(e,t,n){var i,r,o=t.delegateTarget||t.target;return o?(i=bt(o,"data-action"),r=t.originalEvent||t,this.triggerEntry(i,e,r,n)):t.preventDefault()};qe.prototype.triggerEntry=function(e,t,n,i){var r=this._entries,o,a;if(o=r[e],!!o&&(a=o.action,this._eventBus.fire("palette.trigger",{entry:o,event:n})!==!1)){if(rn(a)){if(t==="click")return a(n,i)}else if(a[t])return a[t](n,i);n.preventDefault()}};qe.prototype._layoutChanged=function(){this._toggleState({})};qe.prototype._needsCollapse=function(e,t){var n=50,i=Object.keys(t).length*46;return e<i+n};qe.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};qe.prototype.open=function(){this._toggleState({open:!0})};qe.prototype.toggle=function(){this.isOpen()?this.close():this.open()};qe.prototype.isActiveTool=function(e){return e&&this._activeTool===e};qe.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=ot(".djs-palette-entries",this._container),this._toolsContainer=ot("[data-group=tools]",t)),n=this._toolsContainer,I(n.children,function(i){var r=i.getAttribute("data-action");if(r){var o=xt(i);r=r.replace("-tool",""),o.contains("entry")&&r===e?o.add("highlighted-entry"):o.remove("highlighted-entry")}})};qe.prototype.isOpen=function(){return xt(this._container).has(dl)};qe.prototype._getParentContainer=function(){return this._canvas.getContainer()};qe.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function f1(e,t){var n=xt(e),i=Pe(t)?t:t.split(/\s+/g);i.forEach(function(r){n.add(r)})}function h1(e,t){var n=t.getPaletteEntries();return rn(n)?n(e):(I(n,function(i,r){e[r]=i}),e)}const m1={__init__:["palette"],palette:["type",qe]};var nv="crosshair";function Ai(e,t,n,i,r,o,a){this._selection=r,this._dragging=n,this._mouse=a;var s=this,l={create:function(c){var p=t.getActiveLayer(),u;u=c.frame=Ee("rect"),pe(u,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),Te(p,u)},update:function(c){var p=c.frame,u=c.bbox;pe(p,{x:u.x,y:u.y,width:u.width,height:u.height})},remove:function(c){c.frame&&pt(c.frame)}};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(c){var p=c.originalEvent.target;!c.hover&&!(p instanceof SVGElement)||e.once("lasso.selection.ended",function(){s.activateLasso(c.originalEvent,!0)})}),e.on("lasso.end",function(c){var p=Os(c),u=i.filter(function(d){return d});s.select(u,p)}),e.on("lasso.start",function(c){var p=c.context;p.bbox=Os(c),l.create(p)}),e.on("lasso.move",function(c){var p=c.context;p.bbox=Os(c),l.update(p)}),e.on("lasso.cleanup",function(c){var p=c.context;l.remove(p)}),e.on("element.mousedown",1500,function(c){if(vf(c))return s.activateLasso(c.originalEvent),!0})}Ai.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];Ai.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:nv,data:{context:{}}})};Ai.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:nv,data:{context:{}}})};Ai.prototype.select=function(e,t){var n=Dg(e,t);this._selection.select(El(n))};Ai.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Ai.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};function Os(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y},i;return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?i={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?i={x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?i={x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?i={x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:i={x:n.x,y:n.y,width:0,height:0},i}const v1={__depends__:[Fa,qr],__init__:["lassoTool"],lassoTool:["type",Ai]};var Ls=1500,iv="grab";function ar(e,t,n,i,r,o){this._dragging=n,this._mouse=o;var a=this,s=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",Ls,function(l){if(Mr(l))return a.activateMove(l.originalEvent,!0),!1}),s&&s.addListener(Ls,function(l){if(!(!jd(l.keyEvent)||a.isActive())){var c=a._mouse.getLastMoveEvent();a.activateMove(c,!!c)}},"keyboard.keydown"),s&&s.addListener(Ls,function(l){!jd(l.keyEvent)||!a.isActive()||a.toggle()},"keyboard.keyup"),e.on("hand.end",function(l){var c=l.originalEvent.target;if(!l.hover&&!(c instanceof SVGElement))return!1;e.once("hand.ended",function(){a.activateMove(l.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(l){var c=t.viewbox().scale;t.scroll({dx:l.dx*c,dy:l.dy*c})}),e.on("hand.move.end",function(l){var c=l.context,p=c.reactivate;return!Mr(l)&&p&&e.once("hand.move.ended",function(u){a.activateHand(u.originalEvent,!0,!0)}),!1})}ar.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];ar.prototype.activateMove=function(e,t,n){typeof t=="object"&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:iv,data:{context:n||{}}})};ar.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:iv,data:{context:{reactivate:n}}})};ar.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)};ar.prototype.isActive=function(){var e=this._dragging.context();return e?/^(hand|hand\.move)$/.test(e.prefix):!1};function jd(e){return nt("Space",e)}const g1={__depends__:[Fa,qr],__init__:["handTool"],handTool:["type",ar]};var Vd="connect-ok",Fd="connect-not-ok";function sr(e,t,n,i,r,o,a){var s=this;this._dragging=t,this._rules=o,this._mouse=a,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(l){var c=l.context,p=l.hover,u=c.canStartConnect=s.canStartConnect(p);u!==null&&(c.startTarget=p,i.addMarker(p,u?Vd:Fd))}),e.on(["global-connect.out","global-connect.cleanup"],function(l){var c=l.context.startTarget,p=l.context.canStartConnect;c&&i.removeMarker(c,p?Vd:Fd)}),e.on(["global-connect.ended"],function(l){var c=l.context,p=c.startTarget,u={x:l.x,y:l.y},d=s.canStartConnect(p);if(d)return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,p,u)}),!1})}sr.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];sr.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})};sr.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)};sr.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)};sr.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};const y1={__depends__:[Yl,cn,Sn,Fa,qr],globalConnect:["type",sr]};function os(e,t,n,i,r,o,a,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=r,this._handTool=o,this._globalConnect=a,this._translate=s,e.registerProvider(this)}os.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];os.prototype.getPaletteEntries=function(){var e={},t=this._create,n=this._elementFactory,i=this._spaceTool,r=this._lassoTool,o=this._handTool,a=this._globalConnect,s=this._translate;function l(u,d,f,h,v){function m(S){var b=n.createShape(N({type:u},v));t.start(S,b)}return{group:d,className:f,title:h,action:{dragstart:m,click:m}}}function c(u){var d=n.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),f=n.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:d});t.start(u,[d,f],{hints:{autoSelect:[d]}})}function p(u){t.start(u,n.createParticipantShape())}return N(e,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:s("Activate hand tool"),action:{click:function(u){o.activateHand(u)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:s("Activate lasso tool"),action:{click:function(u){r.activateSelection(u)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:s("Activate create/remove space tool"),action:{click:function(u){i.activateSelection(u)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:s("Activate global connect tool"),action:{click:function(u){a.start(u)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":l("bpmn:StartEvent","event","bpmn-icon-start-event-none",s("Create start event")),"create.intermediate-event":l("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",s("Create intermediate/boundary event")),"create.end-event":l("bpmn:EndEvent","event","bpmn-icon-end-event-none",s("Create end event")),"create.exclusive-gateway":l("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",s("Create gateway"),{isMarkerVisible:!0}),"create.task":l("bpmn:Task","activity","bpmn-icon-task",s("Create task")),"create.data-object":l("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",s("Create data object reference")),"create.data-store":l("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",s("Create data store reference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:s("Create expanded sub-process"),action:{dragstart:c,click:c}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:s("Create pool/participant"),action:{dragstart:p,click:p}},"create.group":l("bpmn:Group","artifact","bpmn-icon-group",s("Create group"))}),e};const _1={__depends__:[m1,Va,Em,v1,g1,y1,hf],__init__:["paletteProvider"],paletteProvider:["type",os]};var b1=250;function eu(e,t,n,i,r){W.call(this,e);function o(s){var l=s.canExecute.replacements;I(l,function(c){var p=c.oldElementId,u={type:c.newElementType};if(!s.visualReplacements[p]){var d=t.get(p);N(u,{x:d.x,y:d.y});var f=n.createShape(u);i.addShape(f,d.parent);var h=ot('[data-element-id="'+Dr(d.id)+'"]',s.dragGroup);h&&pe(h,{display:"none"});var v=r.addDragger(f,s.dragGroup);s.visualReplacements[p]=v,i.removeShape(f)}})}function a(s){var l=s.visualReplacements;I(l,function(c,p){var u=ot('[data-element-id="'+Dr(p)+'"]',s.dragGroup);u&&pe(u,{display:"inline"}),c.remove(),l[p]&&delete l[p]})}e.on("shape.move.move",b1,function(s){var l=s.context,c=l.canExecute;l.visualReplacements||(l.visualReplacements={}),c&&c.replacements?o(l):a(l)})}eu.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];te(eu,W);const E1={__depends__:[rr],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",eu]};var x1=1250,$s=40,w1=20,S1=10,Hd=20,rv=["x","y"],C1=Math.abs;function ov(e){e.on(["connect.hover","connect.move","connect.end"],x1,function(t){var n=t.context,i=n.canExecute,r=n.start,o=n.hover,a=n.source,s=n.target;t.originalEvent&&At(t.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&o&&T1(t,o,A1(o)),o&&k1(i,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=Nt(r),ve(o,["bpmn:Event","bpmn:Gateway"])&&zd(t,Nt(o)),ve(o,["bpmn:Task","bpmn:SubProcess"])&&P1(t,o),y(a,"bpmn:BoundaryEvent")&&s===a.host&&R1(t)):av(i,"bpmn:MessageFlow")?(y(r,"bpmn:Event")&&(n.connectionStart=Nt(r)),y(o,"bpmn:Event")&&zd(t,Nt(o))):n.connectionStart=n.initialConnectionStart)})}ov.$inject=["eventBus"];function T1(e,t,n){rv.forEach(function(i){var r=sv(i,t);e[i]<t[i]+n?Ye(e,i,t[i]+n):e[i]>t[i]+r-n&&Ye(e,i,t[i]+r-n)})}function P1(e,t){var n=Nt(t);rv.forEach(function(i){D1(e,t,i)&&Ye(e,i,n[i])})}function R1(e){var t=e.context,n=t.source,i=t.target;if(!I1(t)){var r=Nt(n),o=dt(r,i,-10),a=[];/top|bottom/.test(o)&&a.push("x"),/left|right/.test(o)&&a.push("y"),a.forEach(function(s){var l=e[s],c;C1(l-r[s])<$s&&(l>r[s]?c=r[s]+$s:c=r[s]-$s,Ye(e,s,c))})}}function zd(e,t){Ye(e,"x",t.x),Ye(e,"y",t.y)}function av(e,t){return e&&e.type===t}function k1(e,t){return Ji(t,function(n){return av(e,n)})}function sv(e,t){return e==="x"?t.width:t.height}function A1(e){return y(e,"bpmn:Task")?S1:w1}function D1(e,t,n){return e[n]>t[n]+Hd&&e[n]<t[n]+sv(n,t)-Hd}function I1(e){var t=e.hover,n=e.source;return t&&n&&t===n}function ri(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}ri.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]};ri.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,this._snapLocations.indexOf(e)===-1&&this._snapLocations.push(e)};ri.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)};ri.prototype.getSnapLocations=function(){return this._snapLocations};ri.prototype.setSnapLocations=function(e){this._snapLocations=e};ri.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new as,n.initDefaults(this._defaultSnaps)),n};function as(){this._snapValues={}}as.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),n.x.indexOf(t.x)===-1&&n.x.push(t.x),n.y.indexOf(t.y)===-1&&n.y.push(t.y)};as.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&Ub(e[n],r[n],i)};as.prototype.initDefaults=function(e){var t=this;I(e||{},function(n,i){I(n,function(r){t.add(i,r)})})};var M1=1250;function un(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(r){i.initSnap(r)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],M1,function(r){var o=r.context,a=o.shape,s=o.snapContext,l=o.target;if(!(r.originalEvent&&At(r.originalEvent))&&!(Xi(r)||!l)){var c=s.pointsForTarget(l);c.initialized||(c=i.addSnapTargetPoints(c,a,l),c.initialized=!0),n.snap(r,c)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}un.$inject=["elementRegistry","eventBus","snapping"];un.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,r=n.snapContext;r||(r=n.snapContext=new ri);var o;t.get(i.id)?o=Nt(i,e):o={x:e.x+Nt(i).x,y:e.y+Nt(i).y};var a={x:o.x-i.width/2,y:o.y-i.height/2},s={x:o.x+i.width/2,y:o.y+i.height/2};return r.setSnapOrigin("mid",{x:o.x-e.x,y:o.y-e.y}),xe(i)||(r.setSnapOrigin("top-left",{x:a.x-e.x,y:a.y-e.y}),r.setSnapOrigin("bottom-right",{x:s.x-e.x,y:s.y-e.y})),r};un.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return I(i,function(r){if(xe(r)){xe(t)&&e.add("mid",Nt(r));return}if(De(r)){if(r.waypoints.length<3)return;var o=r.waypoints.slice(1,-1);I(o,function(a){e.add("mid",a)});return}e.add("mid",Nt(r))}),!_e(t.x)||!_e(t.y)||this._elementRegistry.get(t.id)&&e.add("mid",Nt(t)),e};un.prototype.getSnapTargets=function(e,t){return Sh(t).filter(function(n){return!N1(n)})};function N1(e){return!!e.hidden}var Ud=1500;function lr(e,t){t.invoke(un,this),e.on(["create.move","create.end"],Ud,B1),e.on(["create.move","create.end","shape.move.move","shape.move.end"],Ud,function(n){var i=n.context,r=i.canExecute,o=i.target,a=r&&(r==="attach"||r.attach);a&&!Xi(n)&&O1(n,o)})}te(lr,un);lr.$inject=["eventBus","injector"];lr.prototype.initSnap=function(e){var t=un.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return I(n.outgoing,function(r){var o=r.waypoints[0];o=o.original||o,t.setSnapOrigin(r.id+"-docking",Wd(o,i,e))}),I(n.incoming,function(r){var o=r.waypoints[r.waypoints.length-1];o=o.original||o,t.setSnapOrigin(r.id+"-docking",Wd(o,i,e))}),y(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t};lr.prototype.addSnapTargetPoints=function(e,t,n){un.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);I(i,function(o){($1(o)||L1([t,o],"bpmn:TextAnnotation"))&&(e.add("top-left",xh(o)),e.add("bottom-right",wh(o)))});var r=this._elementRegistry;return I(t.incoming,function(o){if(r.get(t.id)){Gd(i,o.source)||e.add("mid",de(o.source));var a=o.waypoints[0];e.add(o.id+"-docking",a.original||a)}}),I(t.outgoing,function(o){if(r.get(t.id)){Gd(i,o.target)||e.add("mid",de(o.target));var a=o.waypoints[o.waypoints.length-1];e.add(o.id+"-docking",a.original||a)}}),y(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e};lr.prototype.getSnapTargets=function(e,t){return un.prototype.getSnapTargets.call(this,e,t).filter(function(n){return!y(n,"bpmn:Lane")})};function O1(e,t){var n=se(t),i=Xh(e,t),r=e.context,o=r.shape,a;o.parent?a={x:0,y:0}:a=de(o),/top/.test(i)?Ye(e,"y",n.top-a.y):/bottom/.test(i)&&Ye(e,"y",n.bottom-a.y),/left/.test(i)?Ye(e,"x",n.left-a.x):/right/.test(i)&&Ye(e,"x",n.right-a.x)}function L1(e,t){return e.every(function(n){return y(n,t)})}function $1(e){return y(e,"bpmn:SubProcess")&&Se(e)?!0:y(e,"bpmn:Participant")}function B1(e){var t=e.context,n=t.createConstraints;if(n){var i=n.top,r=n.right,o=n.bottom,a=n.left;(a&&a>=e.x||r&&r<=e.x)&&Ye(e,"x",e.x),(i&&i>=e.y||o&&o<=e.y)&&Ye(e,"y",e.y)}}function Gd(e,t){return e.indexOf(t)!==-1}function Wd(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}var j1=1250;function uo(e,t){var n=this;e.on(["resize.start"],function(i){n.initSnap(i)}),e.on(["resize.move","resize.end"],j1,function(i){var r=i.context,o=r.shape,a=o.parent,s=r.direction,l=r.snapContext;if(!(i.originalEvent&&At(i.originalEvent))&&!Xi(i)){var c=l.pointsForTarget(a);c.initialized||(c=n.addSnapTargetPoints(c,o,a,s),c.initialized=!0),H1(s)&&Ye(i,"x",i.x),z1(s)&&Ye(i,"y",i.y),t.snap(i,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}uo.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,r=t.snapContext;r||(r=t.snapContext=new ri);var o=lv(n,i);return r.setSnapOrigin("corner",{x:o.x-e.x,y:o.y-e.y}),r};uo.prototype.addSnapTargetPoints=function(e,t,n,i){var r=this.getSnapTargets(t,n);return I(r,function(o){e.add("corner",wh(o)),e.add("corner",xh(o))}),e.add("corner",lv(t,i)),e};uo.$inject=["eventBus","snapping"];uo.prototype.getSnapTargets=function(e,t){return Sh(t).filter(function(n){return!V1(n,e)&&!De(n)&&!F1(n)&&!xe(n)})};function lv(e,t){var n=de(e),i=se(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function V1(e,t){return e.host===t}function F1(e){return!!e.hidden}function H1(e){return e==="n"||e==="s"}function z1(e){return e==="e"||e==="w"}var U1=7,G1=1e3;function oi(e){this._canvas=e,this._asyncHide=Ig(yi(this.hide,this),G1)}oi.$inject=["canvas"];oi.prototype.snap=function(e,t){var n=e.context,i=n.snapContext,r=i.getSnapLocations(),o={x:Xi(e,"x"),y:Xi(e,"y")};I(r,function(a){var s=i.getSnapOrigin(a),l={x:e.x+s.x,y:e.y+s.y};if(I(["x","y"],function(c){var p;o[c]||(p=t.snap(l,a,c,U1),p!==void 0&&(o[c]={value:p,originValue:p-s[c]}))}),o.x&&o.y)return!1}),this.showSnapLine("vertical",o.x&&o.x.value),this.showSnapLine("horizontal",o.y&&o.y.value),I(["x","y"],function(a){var s=o[a];yn(s)&&Ye(e,a,s.originValue)})};oi.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=Ee("path");return pe(n,{d:"M0,0 L0,0"}),Ne(n).add("djs-snap-line"),Te(t,n),{update:function(i){_e(i)?e==="horizontal"?pe(n,{d:"M-100000,"+i+" L+100000,"+i,display:""}):pe(n,{d:"M "+i+",-100000 L "+i+", +100000",display:""}):pe(n,{display:"none"})}}};oi.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};oi.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()};oi.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]};oi.prototype.hide=function(){I(this._snapLines,function(e){e.update()})};const W1={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",un],resizeSnapping:["type",uo],snapping:["type",oi]},Y1={__depends__:[W1],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",ov],createMoveSnapping:["type",lr]};function ue(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=rt(ue.BOX_HTML),this._searchInput=ot(ue.INPUT_SELECTOR,this._container),this._resultsContainer=ot(ue.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}ue.$inject=["canvas","eventBus","overlays","selection"];ue.prototype._bindEvents=function(){var e=this;function t(n,i,r,o){e._eventMaps.push({el:n,type:r,listener:Ut.bind(n,i,r,o)})}t(document,"html","click",function(n){e.close()}),t(this._container,ue.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),t(this._container,ue.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),e._scrollToNode(n.delegateTarget),e._preselect(n.delegateTarget)}),t(this._container,ue.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),e._select(n.delegateTarget)}),t(this._container,ue.INPUT_SELECTOR,"keydown",function(n){nt("ArrowUp",n)&&n.preventDefault(),nt("ArrowDown",n)&&n.preventDefault()}),t(this._container,ue.INPUT_SELECTOR,"keyup",function(n){if(nt("Escape",n))return e.close();if(nt("Enter",n)){var i=e._getCurrentResult();return i?e._select(i):e.close()}if(nt("ArrowUp",n))return e._scrollToDirection(!0);if(nt("ArrowDown",n))return e._scrollToDirection();nt(["ArrowLeft","ArrowRight"],n)||e._search(n.delegateTarget.value)})};ue.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){Ut.unbind(e.el,e.type,e.listener)})};ue.prototype._search=function(e){var t=this;if(this._clearResults(),!(!e||e==="")){var n=this._searchProvider.find(e);if(n.length){n.forEach(function(r){var o=r.element.id,a=t._createResultNode(r,o);t._results[o]={element:r.element,node:a}});var i=ot(ue.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}};ue.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};ue.prototype._scrollToNode=function(e){if(!(!e||e===this._getCurrentResult())){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}};ue.prototype._clearResults=function(){bf(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")};ue.prototype._getCurrentResult=function(){return ot(ue.RESULT_SELECTED_SELECTOR,this._resultsContainer)};ue.prototype._createResultNode=function(e,t){var n=rt(ue.RESULT_HTML);return e.primaryTokens.length>0&&Yd(n,e.primaryTokens,ue.RESULT_PRIMARY_HTML),Yd(n,e.secondaryTokens,ue.RESULT_SECONDARY_HTML),bt(n,ue.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n};ue.prototype.registerProvider=function(e){this._searchProvider=e};ue.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,xt(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};ue.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,xt(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))};ue.prototype.toggle=function(){this.isOpen()?this.close():this.open()};ue.prototype.isOpen=function(){return this._open};ue.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&xt(t).remove(ue.RESULT_SELECTED_CLASS);var n=bt(e,ue.RESULT_ID_ATTRIBUTE),i=this._results[n].element;xt(e).add(ue.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}};ue.prototype._select=function(e){var t=bt(e,ue.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};ue.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=Pt(e),n=q1(t);this._overlayId=this._overlays.add(e,n)}};function q1(e){var t=6,n=e.width+t*2,i=e.height+t*2,r={width:n+"px",height:i+"px"},o=rt('<div class="'+ue.OVERLAY_CLASS+'"></div>');return Ea(o,r),{position:{bottom:i-t,right:n-t},show:!0,html:o}}function Yd(e,t,n){var i=K1(t),r=rt(n);r.innerHTML=i,e.appendChild(r)}function K1(e){var t="";return e.forEach(function(n){n.matched?t+='<strong class="'+ue.RESULT_HIGHLIGHT_CLASS+'">'+Eu(n.matched)+"</strong>":t+=Eu(n.normal)}),t!==""?t:null}ue.CONTAINER_SELECTOR=".djs-search-container";ue.INPUT_SELECTOR=".djs-search-input input";ue.RESULTS_CONTAINER_SELECTOR=".djs-search-results";ue.RESULT_SELECTOR=".djs-search-result";ue.RESULT_SELECTED_CLASS="djs-search-result-selected";ue.RESULT_SELECTED_SELECTOR="."+ue.RESULT_SELECTED_CLASS;ue.RESULT_ID_ATTRIBUTE="data-result-id";ue.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";ue.OVERLAY_CLASS="djs-search-overlay";ue.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>';ue.RESULT_HTML='<div class="djs-search-result"></div>';ue.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';ue.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const X1={__depends__:[sf,En],searchPad:["type",ue]};function tu(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}tu.$inject=["elementRegistry","searchPad","canvas"];tu.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(i){return!i.labelTarget});return n=ye(n,function(i){return i!==t}),n=Et(n,function(i){return{primaryTokens:Kd(zn(i),e),secondaryTokens:Kd(i.id,e),element:i}}),n=ye(n,function(i){return qd(i.primaryTokens)||qd(i.secondaryTokens)}),n=on(n,function(i){return zn(i.element)+i.element.id}),n};function qd(e){var t=ye(e,function(n){return!!n.matched});return t.length>0}function Kd(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(r!==0&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}const Z1={__depends__:[X1],__init__:["bpmnSearch"],bpmnSearch:["type",tu]};var Q1='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function tn(e){zr.call(this,e)}te(tn,zr);tn.Viewer=Fr;tn.NavigatedViewer=Nr;tn.prototype.createDiagram=function(){return this.importXML(Q1)};tn.prototype._interactionModules=[Af,Nf,k_,$f];tn.prototype._modelingModules=[nb,Hl,Tb,bb,Wb,Yl,Qb,J0,mm,Va,iS,aS,wS,TS,PS,IS,US,$m,XS,r1,c1,_1,E1,qm,Y1,Z1];tn.prototype._modules=[].concat(Fr.prototype._modules,tn.prototype._interactionModules,tn.prototype._modelingModules);function Xd(){return`Process_${Math.random().toString(36).slice(2,12)}`}const J1=`<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" targetNamespace="http://www.flowable.org/processdef">
  <process id="process_${Xd()}" name="name_${Xd()}">
    <startEvent id="startNode1" name="开始" />
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_flow">
    <bpmndi:BPMNPlane id="BPMNPlane_flow" bpmnElement="T-2d89e7a3-ba79-4abd-9f64-ea59621c258c">
      <bpmndi:BPMNShape id="BPMNShape_startNode1" bpmnElement="startNode1" bioc:stroke="">
        <omgdc:Bounds x="240" y="200" width="30" height="30" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="242" y="237" width="23" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>`,eC={name:"Flowable",uri:"http://flowable.org/bpmn",prefix:"flowable",xml:{tagAlias:"lowerCase"},associations:[],types:[{name:"flowable:extCandidateUsers",isAbstract:!0,extends:[],superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"body",type:"String",isBody:!0}]},{name:"flowable:extAssignee",isAbstract:!0,extends:[],superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"body",type:"String",isBody:!0}]},{name:"flowable:property",superClass:["Element"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isAttr:!0,type:"String"}]},{name:"flowable:properties",isAbstract:!0,extends:[],superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"flowable:property",isMany:!0}]},{name:"InOutBinding",superClass:["Element"],isAbstract:!0,properties:[{name:"source",isAttr:!0,type:"String"},{name:"sourceExpression",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"businessKey",isAttr:!0,type:"String"},{name:"local",isAttr:!0,type:"Boolean",default:!1},{name:"variables",isAttr:!0,type:"String"}]},{name:"In",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"Out",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"AsyncCapable",isAbstract:!0,extends:["bpmn:Activity","bpmn:Gateway","bpmn:Event"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1},{name:"asyncBefore",isAttr:!0,type:"Boolean",default:!1},{name:"asyncAfter",isAttr:!0,type:"Boolean",default:!1},{name:"exclusive",isAttr:!0,type:"Boolean",default:!0}]},{name:"flowable:in",superClass:["Element"],properties:[{name:"source",type:"string",isAttr:!0},{name:"target",type:"string",isAttr:!0}]},{name:"flowable:out",superClass:["Element"],properties:[{name:"source",type:"string",isAttr:!0},{name:"target",type:"string",isAttr:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"JobPriorized",isAbstract:!0,extends:["bpmn:Process","flowable:AsyncCapable"],properties:[{name:"jobPriority",isAttr:!0,type:"String"}]},{name:"SignalEventDefinition",isAbstract:!0,extends:["bpmn:SignalEventDefinition"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1}]},{name:"ErrorEventDefinition",isAbstract:!0,extends:["bpmn:ErrorEventDefinition"],properties:[{name:"errorCodeVariable",isAttr:!0,type:"String"},{name:"errorMessageVariable",isAttr:!0,type:"String"}]},{name:"Error",isAbstract:!0,extends:["bpmn:Error"],properties:[{name:"flowable:errorMessage",isAttr:!0,type:"String"}]},{name:"PotentialStarter",superClass:["Element"],properties:[{name:"resourceAssignmentExpression",type:"bpmn:ResourceAssignmentExpression"}]},{name:"UserTask",isAbstract:!0,extends:["bpmn:UserTask"],properties:[{name:"timerEventDefinition",type:"Expression"},{name:"multiInstanceLoopCharacteristics",type:"MultiInstanceLoopCharacteristics"}]},{name:"StartEvent",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"timerEventDefinition",type:"Expression"}]},{name:"FormSupported",isAbstract:!0,extends:["bpmn:StartEvent","bpmn:UserTask"],properties:[{name:"formHandlerClass",isAttr:!0,type:"String"},{name:"formKey",isAttr:!0,type:"String"}]},{name:"TemplateSupported",isAbstract:!0,extends:["bpmn:Process","bpmn:FlowElement"],properties:[{name:"modelerTemplate",isAttr:!0,type:"String"}]},{name:"Initiator",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"initiator",isAttr:!0,type:"String"}]},{name:"ScriptTask",isAbstract:!0,extends:["bpmn:ScriptTask"],properties:[{name:"resultVariable",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"}]},{name:"Process",isAbstract:!0,extends:["bpmn:Process"],properties:[{name:"candidateStarterGroups",isAttr:!0,type:"String"},{name:"candidateStarterUsers",isAttr:!0,type:"String"},{name:"versionTag",isAttr:!0,type:"String"},{name:"historyTimeToLive",isAttr:!0,type:"String"},{name:"isStartableInTasklist",isAttr:!0,type:"Boolean",default:!0}]},{name:"EscalationEventDefinition",isAbstract:!0,extends:["bpmn:EscalationEventDefinition"],properties:[{name:"escalationCodeVariable",isAttr:!0,type:"String"}]},{name:"FormalExpression",isAbstract:!0,extends:["bpmn:FormalExpression"],properties:[{name:"resource",isAttr:!0,type:"String"}]},{name:"Assignable",extends:["bpmn:UserTask"],properties:[{name:"candidateGroups",isAttr:!0,type:"String"},{name:"dueDate",isAttr:!0,type:"String"},{name:"followUpDate",isAttr:!0,type:"String"},{name:"priority",isAttr:!0,type:"String"}]},{name:"CallActivity",extends:["bpmn:CallActivity"],properties:[{name:"calledElementBinding",isAttr:!0,type:"String",default:"latest"},{name:"calledElementVersion",isAttr:!0,type:"String"},{name:"calledElementVersionTag",isAttr:!0,type:"String"},{name:"calledElementTenantId",isAttr:!0,type:"String"},{name:"caseRef",isAttr:!0,type:"String"},{name:"caseBinding",isAttr:!0,type:"String",default:"latest"},{name:"caseVersion",isAttr:!0,type:"String"},{name:"caseTenantId",isAttr:!0,type:"String"},{name:"variableMappingClass",isAttr:!0,type:"String"},{name:"variableMappingDelegateExpression",isAttr:!0,type:"String"}]},{name:"ServiceTaskLike",extends:["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"resultVariable",isAttr:!0,type:"String"}]},{name:"ExclusiveGateway",isAbstract:!0,extends:["bpmn:ExclusiveGateway"],properties:[{name:"serviceClass",isAttr:!0,type:"String"}]},{name:"DmnCapable",extends:["bpmn:BusinessRuleTask"],properties:[{name:"decisionRef",isAttr:!0,type:"String"},{name:"decisionRefBinding",isAttr:!0,type:"String",default:"latest"},{name:"decisionRefVersion",isAttr:!0,type:"String"},{name:"mapDecisionResult",isAttr:!0,type:"String",default:"resultList"},{name:"decisionRefTenantId",isAttr:!0,type:"String"}]},{name:"ExternalCapable",extends:["flowable:ServiceTaskLike"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"topic",isAttr:!0,type:"String"}]},{name:"TaskPriorized",extends:["bpmn:Process","flowable:ExternalCapable"],properties:[{name:"taskPriority",isAttr:!0,type:"String"}]},{name:"Properties",superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"Property",isMany:!0}]},{name:"Property",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0}]},{name:"Connector",superClass:["Element"],meta:{allowedIn:["flowable:ServiceTaskLike"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"}]},{name:"InputOutput",superClass:["Element"],meta:{allowedIn:["bpmn:FlowNode","flowable:Connector"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"},{name:"inputParameters",isMany:!0,type:"InputParameter"},{name:"outputParameters",isMany:!0,type:"OutputParameter"}]},{name:"InputOutputParameter",properties:[{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"InputOutputParameterDefinition",isAbstract:!0},{name:"List",superClass:["InputOutputParameterDefinition"],properties:[{name:"items",isMany:!0,type:"InputOutputParameterDefinition"}]},{name:"Map",superClass:["InputOutputParameterDefinition"],properties:[{name:"entries",isMany:!0,type:"Entry"}]},{name:"Entry",properties:[{name:"key",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"Value",superClass:["InputOutputParameterDefinition"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Script",superClass:["InputOutputParameterDefinition"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Field",superClass:["Element"],meta:{allowedIn:["flowable:ServiceTaskLike","flowable:ExecutionListener","flowable:TaskListener"]},properties:[{name:"name",isAttr:!0,type:"String"},{name:"expression",isAttr:!0,type:"expression"},{name:"string",type:"string"},{name:"stringValue",isAttr:!0,type:"String"}]},{name:"string",superClass:["Element"],meta:{allowedIn:["flowable:Field"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"expression",superClass:["Element"],meta:{allowedIn:["flowable:Field"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"InputParameter",superClass:["InputOutputParameter"]},{name:"OutputParameter",superClass:["InputOutputParameter"]},{name:"Collectable",isAbstract:!0,extends:["bpmn:MultiInstanceLoopCharacteristics"],superClass:["flowable:AsyncCapable"],properties:[{name:"collection",isAttr:!0,type:"String"},{name:"elementVariable",isAttr:!0,type:"String"}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression"},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"FailedJobRetryTimeCycle",superClass:["Element"],meta:{allowedIn:["flowable:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"ExecutionListener",superClass:["Element"],meta:{allowedIn:["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"TaskListener",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"FormProperty",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0}]},{name:"FormData",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"fields",type:"FormField",isMany:!0},{name:"businessKey",type:"String",isAttr:!0}]},{name:"FormField",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"label",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"defaultValue",type:"String",isAttr:!0},{name:"properties",type:"Properties"},{name:"validation",type:"Validation"},{name:"values",type:"Value",isMany:!0}]},{name:"Validation",superClass:["Element"],properties:[{name:"constraints",type:"Constraint",isMany:!0}]},{name:"Constraint",superClass:["Element"],properties:[{name:"name",type:"String",isAttr:!0},{name:"config",type:"String",isAttr:!0}]},{name:"ConditionalEventDefinition",isAbstract:!0,extends:["bpmn:ConditionalEventDefinition"],properties:[{name:"variableName",isAttr:!0,type:"String"},{name:"variableEvent",isAttr:!0,type:"String"}]}],emumerations:[]},tC=(e,t)=>(t=t||{},e=vy[e]||e,e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})),nC={translate:["value",tC]};class cv extends os{constructor(n,i,r,o,a,s,l,c){super(n,i,r,o,a,s,l,c);et(this,"_palette");et(this,"_create");et(this,"_elementFactory");et(this,"_spaceTool");et(this,"_lassoTool");et(this,"_handTool");et(this,"_globalConnect");et(this,"_translate");this._palette=n,this._create=i,this._elementFactory=r,this._spaceTool=o,this._lassoTool=a,this._handTool=s,this._globalConnect=l,this._translate=c}getPaletteEntries(){const n={},i=this._create,r=this._elementFactory,o=this._translate;function a(l,c,p,u,d){function f(v){const m=r.createShape(N({type:l},d));i.start(v,m,null)}const h=l.replace(/^bpmn:/,"");return{group:c,className:p,title:u||o("Create {type}",{type:h}),action:{dragstart:f,click:f}}}function s(l){const c=Un().getBpmnFactory(),p=c.create("bpmn:UserTask",{isForCompensation:!1});p.loopCharacteristics=c.create("bpmn:MultiInstanceLoopCharacteristics");const u=r.createShape({type:"bpmn:UserTask",businessObject:p});i.start(l,u,{})}return N(n,{"create.parallel-gateway":a("bpmn:ParallelGateway","gateway","bpmn-icon-gateway-parallel","并行网关"),"create.event-base-gateway":a("bpmn:EventBasedGateway","gateway","bpmn-icon-gateway-eventbased","事件网关"),"gateway-separator":{group:"gateway",separator:!0},"create.user-task":a("bpmn:UserTask","activity","bpmn-icon-user-task","创建用户任务"),"create.multi-instance-user-task":{group:"activity",type:"bpmn:UserTask",className:"bpmn-icon-user task-multi-instance",title:"创建多实例用户任务",action:{click:s,dragstart:s}},"task-separator":{group:"activity",separator:!0}}),n}}cv.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];var iC=1e3;function cr(e,t){var n=this;t=t||iC,e.on(["render.shape","render.connection"],t,function(i,r){var o=i.type,a=r.element,s=r.gfx,l=r.attrs;if(n.canRender(a))return o==="render.shape"?n.drawShape(s,a,l):n.drawConnection(s,a,l)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(i,r){if(n.canRender(r))return i.type==="render.getShapePath"?n.getShapePath(r):n.getConnectionPath(r)})}cr.prototype.canRender=function(e){};cr.prototype.drawShape=function(e,t){};cr.prototype.drawConnection=function(e,t){};cr.prototype.getShapePath=function(e){};cr.prototype.getConnectionPath=function(e){};var fl=2,uv={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":fl,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":fl,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function rC(e,t){return uv[t]?e.style[t]:e.getAttributeNS(null,t)}function oC(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=uv[i];r?(r===fl&&typeof n=="number"&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function aC(e,t){var n=Object.keys(t),i,r;for(i=0,r;r=n[i];i++)oC(e,r,t[r])}function Bs(e,t,n){return typeof t=="string"?rC(e,t):(aC(e,t),e)}const sC=1500;class pv extends cr{constructor(n,i,r){super(n,sC);et(this,"bpmnRenderer");et(this,"modeling");this.bpmnRenderer=i,this.modeling=r}canRender(n){return!n.labelTarget}drawShape(n,i){const r=this.bpmnRenderer.drawShape(n,i),{type:o,width:a,height:s}=i;return o==="bpmn:StartEvent"?(Bs(r,{fill:"#77DF6D"}),r):o==="bpmn:EndEvent"?(Bs(r,{fill:"#EE7B77"}),r):(o==="bpmn:UserTask"&&Bs(r,{fill:"#A9C4F8"}),r)}getShapePath(n){return this.bpmnRenderer.getShapePath(n)}}pv.$inject=["eventBus","bpmnRenderer"];class lC extends or{constructor(n,i,r,o,a,s,l,c,p,u,d,f){super(n,i,r,o,a,s,l,c,p,u,d,f);et(this,"_contextPad");et(this,"_modeling");et(this,"_elementFactory");et(this,"_autoPlace");et(this,"_connect");et(this,"_create");et(this,"_popupMenu");et(this,"_canvas");et(this,"_rules");this._contextPad=o,this._modeling=a,this._elementFactory=s,this._connect=l,this._create=c,this._popupMenu=p,this._canvas=u,this._rules=d,this._autoPlace=i.get("autoPlace",!1)}getContextPadEntries(n){const i={},r=(l,c)=>{const p=this._elementFactory.createShape({type:"bpmn:UserTask"});this._create.start(l,p,{source:c})},o=(l,c)=>{const u=Un().getModeler().get("bpmnFactory"),d=u.create("bpmn:UserTask",{isForCompensation:!1});d.loopCharacteristics=u.create("bpmn:MultiInstanceLoopCharacteristics");const f=this._elementFactory.createShape({type:"bpmn:UserTask",businessObject:d});this._create.start(l,f,{source:c})},a=this._autoPlace?(l,c)=>{const p=Un().getModeler().get("bpmnFactory"),u=p.create("bpmn:UserTask",{isForCompensation:!1});u.loopCharacteristics=p.create("bpmn:MultiInstanceLoopCharacteristics");const d=this._elementFactory.createShape({type:"bpmn:UserTask",businessObject:u});this._autoPlace.append(c,d)}:o,s=this._autoPlace?(l,c)=>{const p=this._elementFactory.createShape({type:"bpmn:UserTask"});this._autoPlace.append(c,p)}:r;return i["append.append-user-task"]={group:"model",className:"bpmn-icon-user-task",title:"用户任务",action:{dragstart:r,click:s}},i["append.append-multi-instance-user-task"]={group:"model",className:"bpmn-icon-user",title:"多实例用户任务",action:{dragstart:o,click:a}},i}}const cC=[{__init__:["customPaletteProvider","customContextPadProvider","customRenderer"],customPaletteProvider:["type",cv],customRenderer:["type",pv],customContextPadProvider:["type",lC]},nC],uC={class:"containers-bpmn"},pC={width:"0",height:"0",style:{position:"absolute"}},dC={class:"app-containers-bpmn"},fC={class:"process-toolbar"},hC={class:"open-bar"},mC={key:0,class:"panel-content"},vC=["innerHTML"],gC=Le({name:"BpmnDesign"}),yC=Le({...gC,emits:["closeCallBack","saveCallBack"],setup(e,{expose:t,emit:n}){const i=n,{visible:r,title:o,openDialog:a,closeDialog:s}=xi({title:"编辑流程"}),l=Un(),{proxy:c}=bi(),p=$(!1),u=$(!0),d=$(),f=$(),h=$(),v=$(1),m=$(!1),S=$(!1),b=$(""),T=$(""),C=$(!1),k=()=>{p.value=!p.value,setTimeout(()=>{u.value=!p.value},100)},A=()=>{h.value=new tn({container:d.value,keyboard:{bindTo:window},propertiesPanel:{parent:f.value},additionalModules:cC,moddleExtensions:{flowable:eC}})},j=()=>{l.getModeler()&&(l.getModeler().destroy(),l.setModeler(void 0)),l.setModeler(h.value)},V=X=>{X||(X=J1),h.value.importXML(X)},H=()=>{v.value=h.value.get("canvas").zoom("fit-viewport");const X=document.querySelector(".app-containers-bpmn .viewport").getBBox(),J=h.value.get("canvas").viewbox(),oe={x:X.x+X.width/2-65,y:X.y+X.height/2};h.value.get("canvas").viewbox({x:oe.x-J.width/2,y:oe.y-J.height/2,width:J.width,height:J.height}),v.value=X.width/J.width*1.8},Y=(X=!0)=>{v.value=h.value.get("canvas").zoom(),v.value+=X?.1:-.1,h.value.get("canvas").zoom(v.value)},U=async()=>{try{const{xml:X}=await h.value.saveXML({format:!0});O(`${q().name}.bpmn20.xml`,X,"application/xml")}catch(X){c==null||c.$modal.msgError(X)}},ie=async()=>{try{const{svg:X}=await h.value.saveSVG();O(q().name,X,"image/svg+xml")}catch(X){c==null||c.$modal.msgError(X)}},G=async()=>{try{const{xml:X}=await h.value.saveXML({format:!0});b.value=X,m.value=!0}catch(X){c==null||c.$modal.msgError(X)}},D=async()=>{try{const{svg:X}=await h.value.saveSVG();T.value=X,S.value=!0}catch(X){c==null||c.$modal.msgError(X)}};Ar({curType:"",curNode:"",expValue:""});const O=(X,J,oe)=>{const ke=document.createElement("a"),lt=window.URL.createObjectURL(new Blob([J],{type:oe}));ke.href=lt,ke.download=X,ke.click(),window.URL.revokeObjectURL(lt)},q=()=>{var J;const X=(J=h.value)==null?void 0:J.getDefinitions().rootElements;for(let oe=0;oe<X.length;oe++)if(X[oe].$type==="bpmn:Process")return X[oe]},re=()=>{const X=q();return{id:X.id,name:X.name}},ne=async()=>{const{xml:X}=await h.value.saveXML({format:!0}),{svg:J}=await h.value.saveSVG(),oe=re();let ke={xml:X,svg:J,key:oe.id,name:oe.name,loading:C};i("saveCallBack",ke)},ge=X=>{a(),Jt(()=>{V(X)})},$e=()=>{s()};return _i(()=>{Jt(()=>{A(),j()})}),t({initDiagram:V,saveXml:ne,open:ge,close:$e}),(X,J)=>{const oe=Wn,ke=Qi,lt=sy,L=eg,R=tg,ee=ng,fe=Mg,me=Ng,K=ig,he=lg,Me=we("highlightjs"),ct=Ei,Ht=gl;return ae(),Ce(Wt,null,[z("div",uC,[(ae(),Ce("svg",pC,J[6]||(J[6]=[z("defs",null,[z("marker",{id:"markerArrow-dark-mode",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"},[z("path",{d:"M 1 5 L 11 10 L 1 15 Z",class:"arrow-dark"})])],-1)]))),kt((ae(),Ce("div",dC,[g(me,{class:"h-full"},{default:w(()=>[g(me,{style:{"align-items":"stretch"}},{default:w(()=>[g(fe,null,{default:w(()=>[z("div",fC,[g(lt,{wrap:"",size:10},{default:w(()=>[g(ke,{effect:"dark",content:"自适应屏幕",placement:"bottom"},{default:w(()=>[g(oe,{size:"small",icon:"Rank",onClick:H})]),_:1}),g(ke,{effect:"dark",content:"放大",placement:"bottom"},{default:w(()=>[g(oe,{size:"small",icon:"ZoomIn",onClick:J[0]||(J[0]=Ae=>Y(!0))})]),_:1}),g(ke,{effect:"dark",content:"缩小",placement:"bottom"},{default:w(()=>[g(oe,{size:"small",icon:"ZoomOut",onClick:J[1]||(J[1]=Ae=>Y(!1))})]),_:1}),g(ke,{effect:"dark",content:"后退",placement:"bottom"},{default:w(()=>[g(oe,{size:"small",icon:"Back",onClick:J[2]||(J[2]=Ae=>E(h).get("commandStack").undo())})]),_:1}),g(ke,{effect:"dark",content:"前进",placement:"bottom"},{default:w(()=>[g(oe,{size:"small",icon:"Right",onClick:J[3]||(J[3]=Ae=>E(h).get("commandStack").redo())})]),_:1})]),_:1}),g(lt,{wrap:"",size:10,style:{float:"right","padding-right":"10px"}},{default:w(()=>[g(oe,{size:"small",type:"primary",onClick:ne},{default:w(()=>J[7]||(J[7]=[F("保 存")])),_:1}),g(ee,{size:"small"},{dropdown:w(()=>[g(R,null,{default:w(()=>[g(L,{icon:"Document",onClick:G},{default:w(()=>J[9]||(J[9]=[F("XML预览")])),_:1}),g(L,{icon:"View",onClick:D},{default:w(()=>J[10]||(J[10]=[F(" SVG预览")])),_:1})]),_:1})]),default:w(()=>[g(oe,{size:"small",type:"primary"},{default:w(()=>J[8]||(J[8]=[F(" 预 览 ")])),_:1})]),_:1}),g(ee,{size:"small"},{dropdown:w(()=>[g(R,null,{default:w(()=>[g(L,{icon:"Download",onClick:U},{default:w(()=>J[12]||(J[12]=[F("下载XML")])),_:1}),g(L,{icon:"Download",onClick:ie},{default:w(()=>J[13]||(J[13]=[F(" 下载SVG")])),_:1})]),_:1})]),default:w(()=>[g(oe,{size:"small",type:"primary"},{default:w(()=>J[11]||(J[11]=[F(" 下 载 ")])),_:1})]),_:1})]),_:1})])]),_:1}),z("div",{ref_key:"canvas",ref:d,class:"canvas"},null,512)]),_:1}),z("div",{class:hi({"process-panel":!0,hide:E(p)})},[z("div",{class:"process-panel-bar",onClick:k},[z("div",hC,[g(he,{type:"default",underline:!1},{default:w(()=>[g(K,{"class-name":"open-bar","icon-class":E(p)?"caret-back":"caret-forward"},null,8,["icon-class"])]),_:1})])]),g(ml,{"enter-active-class":"animate__animated animate__fadeIn"},{default:w(()=>[E(h)?kt((ae(),Ce("div",mC,[g(i_,{modeler:E(h)},null,8,["modeler"])],512)),[[Qt,E(u)]]):Ke("",!0)]),_:1})],2)]),_:1})])),[[Ht,E(C)]])]),z("div",null,[g(ct,{modelValue:E(m),"onUpdate:modelValue":J[4]||(J[4]=Ae=>Ue(m)?m.value=Ae:null),title:"XML预览",width:"80%","append-to-body":""},{default:w(()=>[g(Me,{code:E(b),language:"XML"},null,8,["code"])]),_:1},8,["modelValue"])]),z("div",null,[g(ct,{modelValue:E(S),"onUpdate:modelValue":J[5]||(J[5]=Ae=>Ue(S)?S.value=Ae:null),title:"SVG预览",width:"80%","append-to-body":""},{default:w(()=>[z("div",{style:{"text-align":"center"},innerHTML:E(T)},null,8,vC)]),_:1},8,["modelValue"])])],64)}}}),_C={class:"design"},bC={class:"modeler"},EC=Le({name:"Design"}),xC=Le({...EC,emits:["closeCallBack"],setup(e,{expose:t,emit:n}){const{proxy:i}=bi(),r=$(),o=$(),a=n,{visible:s,title:l}=xi({title:"编辑流程"}),c=$(""),p=async d=>{s.value=!0,c.value=d;const{data:f}=await Cf(d);o.value=f,r.value.initDiagram(o.value.xml)},u=async d=>{await(i==null?void 0:i.$modal.confirm("是否确认保存？")),d.loading.value=!0,o.value.id=c.value,o.value.xml=d.xml,o.value.svg=d.svg,o.value.key=d.key,o.value.name=d.name,py(o.value).then(f=>{f.code===200&&(s.value=!1,i==null||i.$modal.msgSuccess("保存成功"),a("closeCallBack",d))}),d.loading.value=!1};return t({open:p}),(d,f)=>{const h=Ei;return ae(),Ce("div",_C,[g(h,{modelValue:E(s),"onUpdate:modelValue":f[0]||(f[0]=v=>Ue(s)?s.value=v:null),width:"100%",fullscreen:"",title:E(l)},{default:w(()=>[z("div",bC,[g(yC,{ref_key:"bpmnDesignRef",ref:r,onSaveCallBack:u},null,512)])]),_:1},8,["modelValue","title"])])}}}),wC=ha(xC,[["__scopeId","data-v-58bcc757"]]),SC={class:"p-2"},CC={class:"mb-[10px]"},TC={class:"dialog-footer"},PC=Le({name:"Model"}),aT=Le({...PC,setup(e){const{proxy:t}=bi(),n=$(),i=$(),r=$(),o=$(),a=$(!1),s=$(!0),l=$([]),c=$(!0),p=$(!0),u=$(!0),d=$(0),f=$([]),h=$([]),v=$(""),m=$(""),S=Ar({visible:!1,title:""}),b={id:"",name:"",key:"",categoryCode:"",xml:"",svg:"",description:""},T=Ar({form:{...b},queryParams:{pageNum:1,pageSize:10,name:"",key:"",categoryCode:""},rules:{name:[{required:!0,message:"模型不能为空",trigger:"blur"}],key:[{required:!0,message:"模型KEY不能为空",trigger:"blur"}],categoryCode:[{required:!0,message:"流程分类不能为空",trigger:"blur"}]}}),{queryParams:C,form:k,rules:A}=of(T);_i(()=>{ie(),oe()});const j=L=>{C.value.categoryCode=L.categoryCode,L.categoryCode==="ALL"&&(C.value.categoryCode=""),H()},V=(L,R)=>L?R.categoryName.indexOf(L)!==-1:!0;nf(()=>{var L;(L=r.value)==null||L.filter(v.value)},{flush:"post"});const H=()=>{C.value.pageNum=1,ie()},Y=()=>{var L;(L=i.value)==null||L.resetFields(),C.value.categoryCode="",C.value.pageNum=1,C.value.pageSize=10,H()},U=L=>{l.value=L.map(R=>R.id),c.value=L.length!==1,p.value=!L.length},ie=async()=>{s.value=!0;const L=await ly(C.value);f.value=L.rows,d.value=L.total,s.value=!1},G=async L=>{const R=(L==null?void 0:L.id)||l.value;await(t==null?void 0:t.$modal.confirm("是否确认删除模型id为【"+R+"】的数据项？")),s.value=!0,await dy(R).finally(()=>s.value=!1),await ie(),t==null||t.$modal.msgSuccess("删除成功")},D=async(L,R)=>{await(t==null?void 0:t.$modal.confirm("是否部署模型key为【"+R+"】流程？")),s.value=!0,await fy(L).finally(()=>s.value=!1),await ie(),t==null||t.$modal.msgSuccess("部署成功")},O=()=>{m.value="add",l.value=[],oe(),k.value={...b},S.visible=!0,S.title="新增模型"},q=()=>{m.value="update",S.title="修改模型",Jt(async()=>{await oe();const L=l.value[0],R=await Cf(L);Object.assign(k.value,R.data),S.visible=!0})},re=L=>{m.value="copy",S.title="复制模型",Jt(async()=>{await oe(),k.value={...b},k.value.id=L.id,S.visible=!0})},ne=()=>{n.value.validate(async L=>{L&&(a.value=!0,m.value==="copy"?(await hy(k.value),t==null||t.$modal.msgSuccess("操作成功")):l.value&&l.value.length>0&&m.value==="update"?(k.value.id=l.value[0],await uy(k.value),t==null||t.$modal.msgSuccess("操作成功")):(lt(k.value.key,k.value.name),k.value.xml=ke.value,await cy(k.value),t==null||t.$modal.msgSuccess("操作成功")),S.visible=!1,await ie())})},ge=()=>{$e(),S.visible=!1},$e=()=>{k.value={...b},n.value.resetFields()},X=async L=>{await o.value.open(L)},J=()=>{t==null||t.$download.zip("/workflow/model/export/zip/"+l.value,"模型")},oe=async()=>{const L=await jg();h.value=[];const R={categoryCode:"ALL",categoryName:"顶级节点",children:[]};R.children=t==null?void 0:t.handleTree(L.data,"id","parentId"),h.value.push(R)},ke=$(""),lt=async(L,R)=>(ke.value=`<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" targetNamespace="http://www.flowable.org/processdef">
  <process id="${L}" name="${R}">
    <startEvent id="startNode1" name="开始" />
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_flow">
    <bpmndi:BPMNPlane id="BPMNPlane_flow" bpmnElement="T-2d89e7a3-ba79-4abd-9f64-ea59621c258c">
      <bpmndi:BPMNShape id="BPMNShape_startNode1" bpmnElement="startNode1" bioc:stroke="">
        <omgdc:Bounds x="240" y="200" width="30" height="30" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="242" y="237" width="23" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>`,ke);return(L,R)=>{const ee=Yt,fe=Vg,me=xf,K=Fg,he=Ot,Me=Wn,ct=Lt,Ht=sg,Ae=Hg,He=og,ai=ag,Di=af,Rn=rg,ht=Ei,ur=gl;return ae(),Ce("div",SC,[g(Ae,{gutter:20},{default:w(()=>[g(K,{lg:4,xs:24,style:{}},{default:w(()=>[g(me,{shadow:"hover"},{default:w(()=>[g(ee,{modelValue:E(v),"onUpdate:modelValue":R[0]||(R[0]=Je=>Ue(v)?v.value=Je:null),placeholder:"请输入流程分类名","prefix-icon":"Search",clearable:""},null,8,["modelValue"]),g(fe,{ref_key:"categoryTreeRef",ref:r,class:"mt-2","node-key":"id",data:E(h),props:{label:"categoryName",children:"children"},"expand-on-click-node":!1,"filter-node-method":V,"highlight-current":"","default-expand-all":"",onNodeClick:j},null,8,["data"])]),_:1})]),_:1}),g(K,{lg:20,xs:24},{default:w(()=>{var Je,kn;return[g(ml,{"enter-active-class":(Je=E(t))==null?void 0:Je.animate.searchAnimate.enter,"leave-active-class":(kn=E(t))==null?void 0:kn.animate.searchAnimate.leave},{default:w(()=>[kt(z("div",CC,[g(me,{shadow:"hover"},{default:w(()=>[kt(g(ct,{ref_key:"queryFormRef",ref:i,model:E(C),inline:!0},{default:w(()=>[g(he,{label:"模型名称",prop:"name"},{default:w(()=>[g(ee,{modelValue:E(C).name,"onUpdate:modelValue":R[1]||(R[1]=Be=>E(C).name=Be),placeholder:"请输入模型名称",clearable:"",onKeyup:kr(H,["enter"])},null,8,["modelValue"])]),_:1}),g(he,{label:"模型KEY",prop:"key"},{default:w(()=>[g(ee,{modelValue:E(C).key,"onUpdate:modelValue":R[2]||(R[2]=Be=>E(C).key=Be),placeholder:"请输入模型KEY",clearable:"",onKeyup:kr(H,["enter"])},null,8,["modelValue"])]),_:1}),g(he,null,{default:w(()=>[g(Me,{type:"primary",icon:"Search",onClick:H},{default:w(()=>R[14]||(R[14]=[F("搜索")])),_:1}),g(Me,{icon:"Refresh",onClick:Y},{default:w(()=>R[15]||(R[15]=[F("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[Qt,E(u)]])]),_:1})],512),[[Qt,E(u)]])]),_:1},8,["enter-active-class","leave-active-class"]),g(me,{shadow:"hover"},{header:w(()=>[g(Ae,{gutter:10,class:"mb8"},{default:w(()=>[g(K,{span:1.5},{default:w(()=>[g(Me,{type:"primary",plain:"",icon:"Plus",onClick:O},{default:w(()=>R[16]||(R[16]=[F("新增")])),_:1})]),_:1}),g(K,{span:1.5},{default:w(()=>[g(Me,{type:"success",plain:"",icon:"Edit",disabled:E(c),onClick:R[3]||(R[3]=Be=>q())},{default:w(()=>R[17]||(R[17]=[F("修改")])),_:1},8,["disabled"])]),_:1}),g(K,{span:1.5},{default:w(()=>[g(Me,{type:"danger",plain:"",icon:"Delete",disabled:E(p),onClick:R[4]||(R[4]=Be=>G())},{default:w(()=>R[18]||(R[18]=[F("删除")])),_:1},8,["disabled"])]),_:1}),g(K,{span:1.5},{default:w(()=>[g(Me,{type:"primary",plain:"",disabled:E(p),icon:"Download",onClick:R[5]||(R[5]=Be=>J())},{default:w(()=>R[19]||(R[19]=[F("导出")])),_:1},8,["disabled"])]),_:1}),g(Ht,{showSearch:E(u),"onUpdate:showSearch":R[6]||(R[6]=Be=>Ue(u)?u.value=Be:null),onQueryTable:ie},null,8,["showSearch"])]),_:1})]),default:w(()=>[kt((ae(),ze(ai,{border:"",data:E(f),onSelectionChange:U},{default:w(()=>[g(He,{type:"selection",width:"55",align:"center"}),g(He,{fixed:"",align:"center",type:"index",label:"序号",width:"80"}),g(He,{align:"center","show-overflow-tooltip":!0,prop:"name",label:"模型名称",width:"200"}),g(He,{align:"center",prop:"key",label:"模型KEY"}),g(He,{align:"center",prop:"version",label:"版本号",width:"90"},{default:w(Be=>[F(" v"+nn(Be.row.version)+".0",1)]),_:1}),g(He,{align:"center",prop:"metaInfo",label:"备注说明","min-width":"130"}),g(He,{align:"center","show-overflow-tooltip":!0,prop:"createTime",label:"创建时间",width:"160"}),g(He,{align:"center","show-overflow-tooltip":!0,prop:"lastUpdateTime",label:"更新时间",width:"160"}),g(He,{fixed:"right",label:"操作",align:"center",width:"170","class-name":"small-padding fixed-width"},{default:w(Be=>[g(Ae,{gutter:10,class:"mb8"},{default:w(()=>[g(K,{span:1.5},{default:w(()=>[g(Me,{link:"",type:"primary",size:"small",icon:"Pointer",onClick:si=>X(Be.row.id)},{default:w(()=>R[20]||(R[20]=[F("设计流程")])),_:2},1032,["onClick"])]),_:2},1024),g(K,{span:1.5},{default:w(()=>[g(Me,{link:"",type:"primary",size:"small",icon:"Delete",onClick:si=>G(Be.row)},{default:w(()=>R[21]||(R[21]=[F("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),g(Ae,{gutter:10,class:"mb8"},{default:w(()=>[g(K,{span:1.5},{default:w(()=>[g(Me,{link:"",type:"primary",size:"small",icon:"ScaleToOriginal",onClick:si=>D(Be.row.id,Be.row.key)},{default:w(()=>R[22]||(R[22]=[F(" 流程部署 ")])),_:2},1032,["onClick"])]),_:2},1024),g(K,{span:1.5},{default:w(()=>[g(Me,{link:"",type:"primary",size:"small",icon:"CopyDocument",onClick:si=>re(Be.row)},{default:w(()=>R[23]||(R[23]=[F(" 复制模型 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ur,E(s)]]),kt(g(Di,{page:E(C).pageNum,"onUpdate:page":R[7]||(R[7]=Be=>E(C).pageNum=Be),limit:E(C).pageSize,"onUpdate:limit":R[8]||(R[8]=Be=>E(C).pageSize=Be),total:E(d),onPagination:ie},null,8,["page","limit","total"]),[[Qt,E(d)>0]])]),_:1})]}),_:1})]),_:1}),g(wC,{ref_key:"designRef",ref:o,onCloseCallBack:H},null,512),g(ht,{modelValue:E(S).visible,"onUpdate:modelValue":R[13]||(R[13]=Je=>E(S).visible=Je),title:E(S).title,width:"650px","append-to-body":"","close-on-click-modal":!1},{footer:w(()=>[z("span",TC,[g(Me,{type:"primary",onClick:ne},{default:w(()=>R[24]||(R[24]=[F("确 定")])),_:1}),g(Me,{onClick:ge},{default:w(()=>R[25]||(R[25]=[F("取 消")])),_:1})])]),default:w(()=>[g(ct,{ref_key:"formRef",ref:n,model:E(k),rules:E(A),"label-width":"100px"},{default:w(()=>[g(he,{label:"模型名称：",prop:"name"},{default:w(()=>[g(ee,{modelValue:E(k).name,"onUpdate:modelValue":R[9]||(R[9]=Je=>E(k).name=Je),disabled:E(l)&&E(l).length>0&&E(m)==="update",maxlength:"20","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1}),g(he,{label:"模型KEY：",prop:"key"},{default:w(()=>[g(ee,{modelValue:E(k).key,"onUpdate:modelValue":R[10]||(R[10]=Je=>E(k).key=Je),disabled:E(l)&&E(l).length>0&&E(m)==="update",maxlength:"20","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1}),g(he,{label:"流程分类",prop:"categoryCode"},{default:w(()=>[g(Rn,{modelValue:E(k).categoryCode,"onUpdate:modelValue":R[11]||(R[11]=Je=>E(k).categoryCode=Je),data:E(h),props:{value:"categoryCode",label:"categoryName",children:"children"},"value-key":"categoryCode",placeholder:"请选择流程分类","check-strictly":""},null,8,["modelValue","data"])]),_:1}),g(he,{label:"备注：",prop:"description"},{default:w(()=>[g(ee,{modelValue:E(k).description,"onUpdate:modelValue":R[12]||(R[12]=Je=>E(k).description=Je),type:"textarea",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{aT as default};
