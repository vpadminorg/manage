import{ac as h,d as ie,$ as q,r as v,a0 as ae,b as Se,J as Ee,a1 as Ue,o as u,c as T,j as e,k as l,w as b,x as F,e as a,t as ne,F as $,p as L,m as f,y as p,Y as oe,a2 as De,Z as Ke,R as qe,T as Fe,G as $e,C as Le,D as Re,I as Ie,ad as Ne,a3 as Pe,ah as Be,W as ze,v as Ae}from"./index-_v2uieGc.js";/* empty css                       *//* empty css                 *//* empty css                */import{_ as Qe}from"./index-B7XPQ3lw.js";import{E as je,a as Ge}from"./el-table-column-Q2QHI77F.js";import"./el-checkbox-C6h3hzMD.js";import{_ as Oe}from"./index-DXIR9_gV.js";/* empty css               */import{_ as Je}from"./index-Bi2yoGwv.js";/* empty css               */import{E as Me,a as We}from"./el-form-item-BZcdB44L.js";import{E as Ye}from"./index-7OoO_SlU.js";import{E as Ze}from"./index-DJNwvRpE.js";import{E as He}from"./index-ctcZQfix.js";import{E as Xe,a as xe}from"./index-BAqBBdde.js";import"./_initCloneObject-DMl0_0C4.js";/* empty css                */import"./index-BFoUAo4m.js";import"./_baseClone-Cj6s47u0.js";const et=r=>h({url:"/system/client/list",method:"get",params:r}),tt=r=>h({url:"/system/client/"+r,method:"get"}),lt=r=>h({url:"/system/client",method:"post",data:r}),at=r=>h({url:"/system/client",method:"put",data:r}),nt=r=>h({url:"/system/client/"+r,method:"delete"});function ot(r,o){return h({url:"/system/client/changeStatus",method:"put",data:{clientId:r,status:o}})}const it={class:"p-2"},st={class:"search"},ut={class:"dialog-footer"},dt=ie({name:"Client"}),Kt=ie({...dt,setup(r){const{proxy:o}=Fe(),{sys_normal_disable:R}=q(o==null?void 0:o.useDict("sys_normal_disable")),{sys_grant_type:Q}=q(o==null?void 0:o.useDict("sys_grant_type")),{sys_device_type:j}=q(o==null?void 0:o.useDict("sys_device_type")),G=v([]),C=v(!1),w=v(!0),S=v(!0),I=v([]),O=v(!0),J=v(!0),N=v(0),M=v(),P=v(),g=ae({visible:!1,title:""}),W={id:void 0,clientId:void 0,clientKey:void 0,clientSecret:void 0,grantTypeList:void 0,deviceType:void 0,activeTimeout:void 0,timeout:void 0,status:void 0},se=ae({form:{...W},queryParams:{pageNum:1,pageSize:10,clientId:void 0,clientKey:void 0,clientSecret:void 0,grantType:void 0,deviceType:void 0,activeTimeout:void 0,timeout:void 0,status:void 0},rules:{id:[{required:!0,message:"id不能为空",trigger:"blur"}],clientId:[{required:!0,message:"客户端id不能为空",trigger:"blur"}],clientKey:[{required:!0,message:"客户端key不能为空",trigger:"blur"}],clientSecret:[{required:!0,message:"客户端秘钥不能为空",trigger:"blur"}],grantTypeList:[{required:!0,message:"授权类型不能为空",trigger:"change"}],deviceType:[{required:!0,message:"设备类型不能为空",trigger:"change"}]}}),{queryParams:d,form:s,rules:ue}=q(se),V=async()=>{w.value=!0;const i=await et(d.value);G.value=i.rows,N.value=i.total,w.value=!1},de=()=>{B(),g.visible=!1},B=()=>{var i;s.value={...W},(i=P.value)==null||i.resetFields()},E=()=>{d.value.pageNum=1,V()},re=()=>{var i;(i=M.value)==null||i.resetFields(),E()},ce=i=>{I.value=i.map(n=>n.id),O.value=i.length!=1,J.value=!i.length},me=()=>{B(),g.visible=!0,g.title="添加客户端管理"},Y=async i=>{B();const n=(i==null?void 0:i.id)||I.value[0],y=await tt(n);Object.assign(s.value,y.data),g.visible=!0,g.title="修改客户端管理"},pe=()=>{var i;(i=P.value)==null||i.validate(async n=>{n&&(C.value=!0,s.value.id?await at(s.value).finally(()=>C.value=!1):await lt(s.value).finally(()=>C.value=!1),o==null||o.$modal.msgSuccess("修改成功"),g.visible=!1,await V())})},Z=async i=>{const n=(i==null?void 0:i.id)||I.value;await(o==null?void 0:o.$modal.confirm('是否确认删除客户端管理编号为"'+n+'"的数据项？').finally(()=>w.value=!1)),await nt(n),o==null||o.$modal.msgSuccess("删除成功"),await V()},_e=()=>{o==null||o.download("system/client/export",{...d.value},`client_${new Date().getTime()}.xlsx`)},ve=async i=>{let n=i.status==="0"?"启用":"停用";try{await(o==null?void 0:o.$modal.confirm('确认要"'+n+'"吗?')),await ot(i.clientId,i.status),o==null||o.$modal.msgSuccess(n+"成功")}catch{i.status=i.status==="0"?"1":"0"}};return Se(()=>{V()}),(i,n)=>{var te,le;const y=$e,c=Me,z=Le,A=Re,_=Ie,H=We,U=Ye,fe=Je,ge=Ze,m=je,X=Oe,ye=Ne,D=Pe,be=Ge,Ve=Qe,ke=He,x=Ee("question-filled"),ee=Be,he=Xe,Te=xe,Ce=ze,k=Ue("hasPermi"),we=Ae;return u(),T("div",it,[e(De,{"enter-active-class":(te=a(o))==null?void 0:te.animate.searchAnimate.enter,"leave-active-class":(le=a(o))==null?void 0:le.animate.searchAnimate.leave},{default:l(()=>[b(F("div",st,[e(H,{ref_key:"queryFormRef",ref:M,model:a(d),inline:!0},{default:l(()=>[e(c,{label:"客户端key",prop:"clientKey"},{default:l(()=>[e(y,{modelValue:a(d).clientKey,"onUpdate:modelValue":n[0]||(n[0]=t=>a(d).clientKey=t),placeholder:"请输入客户端key",clearable:"",onKeyup:ne(E,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"客户端秘钥",prop:"clientSecret"},{default:l(()=>[e(y,{modelValue:a(d).clientSecret,"onUpdate:modelValue":n[1]||(n[1]=t=>a(d).clientSecret=t),placeholder:"请输入客户端秘钥",clearable:"",onKeyup:ne(E,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"状态",prop:"status"},{default:l(()=>[e(A,{modelValue:a(d).status,"onUpdate:modelValue":n[2]||(n[2]=t=>a(d).status=t),placeholder:"状态",clearable:""},{default:l(()=>[(u(!0),T($,null,L(a(R),t=>(u(),f(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,null,{default:l(()=>[e(_,{type:"primary",icon:"Search",onClick:E},{default:l(()=>[p("搜索")]),_:1}),e(_,{icon:"Refresh",onClick:re},{default:l(()=>[p("重置")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[oe,a(S)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(ke,{shadow:"never"},{header:l(()=>[e(ge,{gutter:10,class:"mb8"},{default:l(()=>[e(U,{span:1.5},{default:l(()=>[b((u(),f(_,{type:"primary",plain:"",icon:"Plus",onClick:me},{default:l(()=>[p("新增")]),_:1})),[[k,["system:client:add"]]])]),_:1}),e(U,{span:1.5},{default:l(()=>[b((u(),f(_,{type:"success",plain:"",icon:"Edit",disabled:a(O),onClick:n[3]||(n[3]=t=>Y())},{default:l(()=>[p(" 修改 ")]),_:1},8,["disabled"])),[[k,["system:client:edit"]]])]),_:1}),e(U,{span:1.5},{default:l(()=>[b((u(),f(_,{type:"danger",plain:"",icon:"Delete",disabled:a(J),onClick:n[4]||(n[4]=t=>Z())},{default:l(()=>[p(" 删除 ")]),_:1},8,["disabled"])),[[k,["system:client:remove"]]])]),_:1}),e(U,{span:1.5},{default:l(()=>[b((u(),f(_,{type:"warning",plain:"",icon:"Download",onClick:_e},{default:l(()=>[p("导出")]),_:1})),[[k,["system:client:export"]]])]),_:1}),e(fe,{showSearch:a(S),"onUpdate:showSearch":n[5]||(n[5]=t=>Ke(S)?S.value=t:null),onQueryTable:V},null,8,["showSearch"])]),_:1})]),default:l(()=>[b((u(),f(be,{data:a(G),onSelectionChange:ce},{default:l(()=>[e(m,{type:"selection",width:"55",align:"center"}),(u(),f(m,{key:0,label:"id",align:"center",prop:"id"})),e(m,{label:"客户端id",align:"center",prop:"clientId"}),e(m,{label:"客户端key",align:"center",prop:"clientKey"}),e(m,{label:"客户端秘钥",align:"center",prop:"clientSecret"}),e(m,{label:"授权类型",align:"center"},{default:l(t=>[e(X,{options:a(Q),value:t.row.grantTypeList},null,8,["options","value"])]),_:1}),e(m,{label:"设备类型",align:"center"},{default:l(t=>[e(X,{options:a(j),value:t.row.deviceType},null,8,["options","value"])]),_:1}),e(m,{label:"Token活跃超时时间",align:"center",prop:"activeTimeout"}),e(m,{label:"Token固定超时时间",align:"center",prop:"timeout"}),e(m,{key:"status",label:"状态",align:"center"},{default:l(t=>[e(ye,{modelValue:t.row.status,"onUpdate:modelValue":K=>t.row.status=K,"active-value":"0","inactive-value":"1",onChange:K=>ve(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(m,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(t=>[e(D,{content:"修改",placement:"top"},{default:l(()=>[b(e(_,{link:"",type:"primary",icon:"Edit",onClick:K=>Y(t.row)},null,8,["onClick"]),[[k,["system:client:edit"]]])]),_:2},1024),e(D,{content:"删除",placement:"top"},{default:l(()=>[b(e(_,{link:"",type:"primary",icon:"Delete",onClick:K=>Z(t.row)},null,8,["onClick"]),[[k,["system:client:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[we,a(w)]]),b(e(Ve,{page:a(d).pageNum,"onUpdate:page":n[6]||(n[6]=t=>a(d).pageNum=t),limit:a(d).pageSize,"onUpdate:limit":n[7]||(n[7]=t=>a(d).pageSize=t),total:a(N),onPagination:V},null,8,["page","limit","total"]),[[oe,a(N)>0]])]),_:1}),e(Ce,{modelValue:a(g).visible,"onUpdate:modelValue":n[15]||(n[15]=t=>a(g).visible=t),title:a(g).title,width:"500px","append-to-body":""},{footer:l(()=>[F("div",ut,[e(_,{loading:a(C),type:"primary",onClick:pe},{default:l(()=>[p("确 定")]),_:1},8,["loading"]),e(_,{onClick:de},{default:l(()=>[p("取 消")]),_:1})])]),default:l(()=>[e(H,{ref_key:"clientFormRef",ref:P,model:a(s),rules:a(ue),"label-width":"100px"},{default:l(()=>[e(c,{label:"客户端key",prop:"clientKey"},{default:l(()=>[e(y,{modelValue:a(s).clientKey,"onUpdate:modelValue":n[8]||(n[8]=t=>a(s).clientKey=t),disabled:a(s).id!=null,placeholder:"请输入客户端key"},null,8,["modelValue","disabled"])]),_:1}),e(c,{label:"客户端秘钥",prop:"clientSecret"},{default:l(()=>[e(y,{modelValue:a(s).clientSecret,"onUpdate:modelValue":n[9]||(n[9]=t=>a(s).clientSecret=t),disabled:a(s).id!=null,placeholder:"请输入客户端秘钥"},null,8,["modelValue","disabled"])]),_:1}),e(c,{label:"授权类型",prop:"grantTypeList"},{default:l(()=>[e(A,{modelValue:a(s).grantTypeList,"onUpdate:modelValue":n[10]||(n[10]=t=>a(s).grantTypeList=t),multiple:"",placeholder:"请输入授权类型"},{default:l(()=>[(u(!0),T($,null,L(a(Q),t=>(u(),f(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"设备类型",prop:"deviceType"},{default:l(()=>[e(A,{modelValue:a(s).deviceType,"onUpdate:modelValue":n[11]||(n[11]=t=>a(s).deviceType=t),placeholder:"请输入设备类型"},{default:l(()=>[(u(!0),T($,null,L(a(j),t=>(u(),f(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{prop:"activeTimeout","label-width":"auto"},{label:l(()=>[F("span",null,[e(D,{content:"指定时间无操作则过期（单位：秒），默认30分钟（1800秒）",placement:"top"},{default:l(()=>[e(ee,null,{default:l(()=>[e(x)]),_:1})]),_:1}),p(" Token活跃超时时间 ")])]),default:l(()=>[e(y,{modelValue:a(s).activeTimeout,"onUpdate:modelValue":n[12]||(n[12]=t=>a(s).activeTimeout=t),placeholder:"请输入Token活跃超时时间"},null,8,["modelValue"])]),_:1}),e(c,{prop:"timeout","label-width":"auto"},{label:l(()=>[F("span",null,[e(D,{content:"指定时间必定过期（单位：秒），默认七天（604800秒）",placement:"top"},{default:l(()=>[e(ee,null,{default:l(()=>[e(x)]),_:1})]),_:1}),p(" Token固定超时时间 ")])]),default:l(()=>[e(y,{modelValue:a(s).timeout,"onUpdate:modelValue":n[13]||(n[13]=t=>a(s).timeout=t),placeholder:"请输入Token固定超时时间"},null,8,["modelValue"])]),_:1}),e(c,{label:"状态"},{default:l(()=>[e(Te,{modelValue:a(s).status,"onUpdate:modelValue":n[14]||(n[14]=t=>a(s).status=t)},{default:l(()=>[(u(!0),T($,null,L(a(R),t=>(u(),f(he,{key:t.value,value:t.value},{default:l(()=>[p(qe(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Kt as default};
