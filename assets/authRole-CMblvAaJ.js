import{d as w,u as P,r as i,b as q,o as y,c as z,x as r,j as a,k as s,e as t,w as C,m as G,R as S,X as M,Y as X,Z as V,y as x,n as T,G as Y,I as Z,v as H,T as J}from"./index-_v2uieGc.js";import{_ as Q}from"./index-B7XPQ3lw.js";import{E as W,a as ee}from"./el-table-column-Q2QHI77F.js";import"./el-checkbox-C6h3hzMD.js";import{E as te,a as ae}from"./el-form-item-BZcdB44L.js";/* empty css               *//* empty css               */import{u as le,a as oe}from"./index-B43E_f47.js";import{E as ne}from"./index-7OoO_SlU.js";import{E as se}from"./index-DJNwvRpE.js";import"./_initCloneObject-DMl0_0C4.js";import"./_baseClone-Cj6s47u0.js";const ie={class:"p-2"},re={class:"panel"},ue=r("h4",{class:"panel-title"},"基本信息",-1),ce={class:"panel"},de=r("h4",{class:"panel-title"},"角色信息",-1),me={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},pe=r("div",null,null,-1),_e=w({name:"AuthRole"}),Ve=w({..._e,setup(fe){const h=P(),{proxy:d}=J(),v=i(!0),b=i(0),m=i(1),p=i(10),k=i([]),E=i([]),f=i([]),c=i({nickName:void 0,userName:"",userId:void 0}),g=i(),j=l=>{var e;l.flag=!l.flag,(e=g.value)==null||e.toggleRowSelection(l,l.flag)},B=l=>{k.value=l.map(e=>e.roleId)},O=l=>String(l.roleId),I=()=>{const l={fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0,path:"/vpadmin/system/user"};d==null||d.$tab.closeOpenPage(l)},$=async()=>{const l=c.value.userId,e=k.value.join(",");await le({userId:l,roleIds:e}).then(()=>{d==null||d.$modal.msgSuccess("授权成功"),I()}).catch(()=>{T(()=>{E.value.forEach(n=>{var u;n!=null&&n.flag&&((u=g.value)==null||u.toggleRowSelection(n,!0))})})})},F=async()=>{const l=h.params&&h.params.userId;if(l){v.value=!0;const e=await oe(l);Object.assign(c.value,e.data.user),Object.assign(f.value,e.data.roles),b.value=f.value.length,Object.assign(E,f),await T(()=>{f.value.forEach(n=>{var u;n!=null&&n.flag&&((u=g.value)==null||u.toggleRowSelection(n,!0))})}),v.value=!1}};return q(()=>{F()}),(l,e)=>{const n=Y,u=te,R=ne,U=se,A=ae,_=W,D=ee,K=Q,N=Z,L=H;return y(),z("div",ie,[r("div",re,[ue,a(A,{model:t(c),inline:!0},{default:s(()=>[a(U,{gutter:10},{default:s(()=>[a(R,{span:2.5},{default:s(()=>[a(u,{label:"用户昵称",prop:"nickName"},{default:s(()=>[a(n,{modelValue:t(c).nickName,"onUpdate:modelValue":e[0]||(e[0]=o=>t(c).nickName=o),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),a(R,{span:2.5},{default:s(()=>[a(u,{label:"登录账号",prop:"userName"},{default:s(()=>[a(n,{modelValue:t(c).userName,"onUpdate:modelValue":e[1]||(e[1]=o=>t(c).userName=o),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),r("div",ce,[de,r("div",null,[C((y(),G(D,{ref_key:"tableRef",ref:g,"row-key":O,data:t(f).slice((t(m)-1)*t(p),t(m)*t(p)),onRowClick:j,onSelectionChange:B},{default:s(()=>[a(_,{label:"序号",width:"55",type:"index",align:"center"},{default:s(o=>[r("span",null,S((t(m)-1)*t(p)+o.$index+1),1)]),_:1}),a(_,{type:"selection","reserve-selection":!0,width:"55"}),a(_,{label:"角色编号",align:"center",prop:"roleId"}),a(_,{label:"角色名称",align:"center",prop:"roleName"}),a(_,{label:"权限字符",align:"center",prop:"roleKey"}),a(_,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:s(o=>[r("span",null,S(t(M)(o.row.createTime)),1)]),_:1})]),_:1},8,["data"])),[[L,t(v)]]),C(a(K,{page:t(m),"onUpdate:page":e[2]||(e[2]=o=>V(m)?m.value=o:null),limit:t(p),"onUpdate:limit":e[3]||(e[3]=o=>V(p)?p.value=o:null),total:t(b)},null,8,["page","limit","total"]),[[X,t(b)>0]]),r("div",me,[a(N,{type:"primary",onClick:e[4]||(e[4]=o=>$())},{default:s(()=>[x("提交")]),_:1}),a(N,{onClick:e[5]||(e[5]=o=>I())},{default:s(()=>[x("返回")]),_:1})]),pe])])])}}});export{Ve as default};
