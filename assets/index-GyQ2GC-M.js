import{d as _,r as y,b as p,n as b,w as k,e as v,o as x,c as T,u as E,g as B,v as C,f as I,l as q,s as R,E as d}from"./index-D4nD6lq3.js";const S={class:"social-callback"},M=_({__name:"index",setup(J){const o=E(),s=y(!0),u=o.query.code,c=o.query.state,f=o.query.source,n=JSON.parse(atob(c)),w=n.tenantId?n.tenantId:"000000",i=n.domain,r=async e=>{if(e.code!==200)throw new Error(e.msg);e.data!==null&&R(e.data.access_token),d.success(e.msg),setTimeout(()=>{location.href="/index"},2e3)},l=e=>{d.error(e.message),setTimeout(()=>{location.href="/index"},2e3)},g=async e=>{try{const t=await I(e);await r(t),s.value=!1}catch(t){l(t)}},h=async e=>{try{const t=await q(e);await r(t),s.value=!1}catch(t){l(t)}},m=async()=>{let e=window.location.origin;if(i!==e){let a=new URL(window.location.href);a.host=i,window.location.href=a.toString();return}const t={socialCode:u,socialState:c,tenantId:w,source:f,clientId:"436efb388d684aadab73ef3cbba8f287",grantType:"socialPortal",redirect:window.location.href};B()?await h(t):await g(t)};return p(()=>{b(()=>{m()})}),(e,t)=>{const a=C;return k((x(),T("div",S,null,512)),[[a,v(s)]])}}});export{M as default};
