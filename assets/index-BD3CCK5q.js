import{aa as j,d as se,Y as le,r as f,Z as te,b as he,$ as Ue,o as u,c as y,j as l,k as o,w as b,m as oe,e as t,x as ne,F as V,q as w,p,y as C,W as re,a0 as Fe,X as Pe,t as ie,Q as De,R as qe,N as Re,G as $e,C as Ie,D as Be,I as Le,ab as xe,a1 as Ae,U as Qe,v as ze}from"./index-D4nD6lq3.js";/* empty css                       *//* empty css                 */import{_ as Ge}from"./index-BH-aX6uU.js";import{E as Ke,a as Me}from"./el-table-column-Nw9CsZCh.js";import"./el-checkbox-DpS0yAA0.js";import{_ as Ye}from"./index-Cu5tDpmP.js";/* empty css               */import{_ as Oe}from"./index-CeC1FWzw.js";/* empty css               *//* empty css                */import{E as Ze,a as We}from"./el-form-item-oceQVxPu.js";import{g as Xe}from"./edit-Gdd43g-6.js";import{E as He}from"./index-DWSlLEJi.js";import{E as Je}from"./index-I5OlcPyW.js";import{E as ea}from"./index-fvT2sidt.js";import{E as aa,a as la}from"./index-BaDxqmMz.js";import"./_initCloneObject-Cyh6om-O.js";/* empty css                */import"./index-CsUbaV0a.js";import"./_baseClone-zQQn4kcl.js";const ta=v=>j({url:"/vpadmin/paymentConfig/list",method:"get",params:v}),oa=v=>j({url:"/vpadmin/paymentConfig/"+v,method:"get"}),na=v=>j({url:"/vpadmin/paymentConfig",method:"post",data:v}),ue=v=>j({url:"/vpadmin/paymentConfig",method:"put",data:v}),ra=v=>j({url:"/vpadmin/paymentConfig/"+v,method:"delete"}),ia={class:"p-2"},ua={class:"mb-[10px]"},sa={class:"dialog-footer"},ma=se({name:"PaymentConfig"}),Pa=se({...ma,setup(v){const{proxy:i}=qe(),{sys_normal_disable:A,vpa_payment_platform_type:q,vpa_payment_type:R}=le(i==null?void 0:i.useDict("sys_normal_disable","vpa_payment_platform_type","vpa_payment_type")),Q=f([]),h=f(!1),U=f(!0),F=f(!0),$=f([]),z=f(!0),G=f(!0),I=f(0),K=f(),B=f(),L=f([]),g=te({visible:!1,title:"",isEdit:!1}),M={id:void 0,projectId:void 0,projectName:void 0,platform:void 0,paymentType:void 0,tierName:void 0,autoSend:"1",emailFrom:void 0,emailContent:void 0},me=te({form:{...M},queryParams:{pageNum:1,pageSize:10,projectName:void 0,platform:void 0,paymentType:void 0,tierName:void 0,autoSend:void 0,params:{}},rules:{id:[{required:!0,message:"主键不能为空",trigger:"blur"}],projectId:[{required:!0,message:"关联的项目ID不能为空",trigger:"blur"}],projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],platform:[{required:!0,message:"支付平台不能为空",trigger:"change"}],paymentType:[{required:!0,message:"支付类型不能为空",trigger:"change"}],autoSend:[{required:!0,message:"自动发送邮件不能为空",trigger:"blur"}],tierName:[{required:!0,message:"用户等级不能为空",trigger:"blur"}]}}),{queryParams:s,form:r,rules:de}=le(me),k=async()=>{U.value=!0;const n=await ta(s.value);Q.value=n.rows,I.value=n.total,U.value=!1},Y=async()=>{try{const n=await Xe();L.value=n.data}catch(n){console.error("Failed to fetch project list:",n)}},pe=()=>{x(),g.visible=!1},x=()=>{var n;r.value={...M},r.value.tierName=void 0,(n=B.value)==null||n.resetFields()},P=()=>{s.value.pageNum=1,k()},fe=()=>{var n;(n=K.value)==null||n.resetFields(),P()},ve=n=>{$.value=n.map(a=>a.id),z.value=n.length!=1,G.value=!n.length},ce=n=>{const a=L.value.find(m=>m.id===n);a&&(r.value.projectName=a.projectName)},ge=async(n,a)=>{try{const m=a==="0"?"确认要启用该配置吗？":"确认要禁用该配置吗？";await Re.confirm(m,"确认信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ue({...n,autoSend:a}),i==null||i.$modal.msgSuccess("更新成功")}catch(m){console.error("Failed to update autoSend status:",m),i==null||i.$modal.msgError("更新失败"),n.autoSend=a==="0"?"1":"0"}},_e=()=>{x(),Y(),g.visible=!0,g.title="添加支付配置信息"},O=async n=>{x(),await Y();const a=(n==null?void 0:n.id)||$.value[0],m=await oa(a);Object.assign(r.value,m.data),g.visible=!0,g.title="修改支付配置信息"},ye=()=>{var n;(n=B.value)==null||n.validate(async a=>{a&&(h.value=!0,r.value.id?await ue(r.value).finally(()=>h.value=!1):await na(r.value).finally(()=>h.value=!1),i==null||i.$modal.msgSuccess("操作成功"),g.visible=!1,await k())})},Z=async n=>{const a=(n==null?void 0:n.id)||$.value;await(i==null?void 0:i.$modal.confirm('是否确认删除支付配置信息编号为"'+a+'"的数据项？').finally(()=>U.value=!1)),await ra(a),i==null||i.$modal.msgSuccess("删除成功"),await k()},be=()=>{i==null||i.download("vpadmin/paymentConfig/export",{...s.value},`paymentConfig_${new Date().getTime()}.xlsx`)};return he(()=>{k()}),(n,a)=>{var ee,ae;const m=$e,d=Ze,S=Ie,N=Be,c=Le,W=We,X=He,D=Je,Ce=Oe,Ve=ea,_=Ke,H=Ye,we=xe,J=Ae,ke=Me,Se=Ge,Ne=aa,Ee=la,Te=Qe,E=Ue("hasPermi"),je=ze;return u(),y("div",ia,[l(Fe,{"enter-active-class":(ee=t(i))==null?void 0:ee.animate.searchAnimate.enter,"leave-active-class":(ae=t(i))==null?void 0:ae.animate.searchAnimate.leave},{default:o(()=>[b(oe("div",ua,[l(X,{shadow:"hover"},{default:o(()=>[l(W,{ref_key:"queryFormRef",ref:K,model:t(s),inline:!0},{default:o(()=>[l(d,{label:"项目名称",prop:"projectName"},{default:o(()=>[l(m,{modelValue:t(s).projectName,"onUpdate:modelValue":a[0]||(a[0]=e=>t(s).projectName=e),placeholder:"请输入项目名称",clearable:"",onKeyup:ne(P,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"支付平台",prop:"platform"},{default:o(()=>[l(N,{modelValue:t(s).platform,"onUpdate:modelValue":a[1]||(a[1]=e=>t(s).platform=e),placeholder:"请选择支付平台",clearable:""},{default:o(()=>[(u(!0),y(V,null,w(t(q),e=>(u(),p(S,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"支付类型",prop:"paymentType"},{default:o(()=>[l(N,{modelValue:t(s).paymentType,"onUpdate:modelValue":a[2]||(a[2]=e=>t(s).paymentType=e),placeholder:"请选择支付类型",clearable:""},{default:o(()=>[(u(!0),y(V,null,w(t(R),e=>(u(),p(S,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"用户等级",prop:"tierName"},{default:o(()=>[l(m,{modelValue:t(s).tierName,"onUpdate:modelValue":a[3]||(a[3]=e=>t(s).tierName=e),placeholder:"请输入用户等级",clearable:"",onKeyup:ne(P,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"自动发送邮件",prop:"status"},{default:o(()=>[l(N,{modelValue:t(s).autoSend,"onUpdate:modelValue":a[4]||(a[4]=e=>t(s).autoSend=e),placeholder:"请选择",clearable:""},{default:o(()=>[(u(!0),y(V,null,w(t(A),e=>(u(),p(S,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(c,{type:"primary",icon:"Search",onClick:P},{default:o(()=>a[18]||(a[18]=[C("搜索")])),_:1}),l(c,{icon:"Refresh",onClick:fe},{default:o(()=>a[19]||(a[19]=[C("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[re,t(F)]])]),_:1},8,["enter-active-class","leave-active-class"]),l(X,{shadow:"never"},{header:o(()=>[l(Ve,{gutter:10,class:"mb8"},{default:o(()=>[l(D,{span:1.5},{default:o(()=>[b((u(),p(c,{type:"primary",plain:"",icon:"Plus",onClick:_e},{default:o(()=>a[20]||(a[20]=[C("新增")])),_:1})),[[E,["vpadmin:paymentConfig:add"]]])]),_:1}),l(D,{span:1.5},{default:o(()=>[b((u(),p(c,{type:"success",plain:"",icon:"Edit",disabled:t(z),onClick:a[5]||(a[5]=e=>O())},{default:o(()=>a[21]||(a[21]=[C("修改")])),_:1},8,["disabled"])),[[E,["vpadmin:paymentConfig:edit"]]])]),_:1}),l(D,{span:1.5},{default:o(()=>[b((u(),p(c,{type:"danger",plain:"",icon:"Delete",disabled:t(G),onClick:a[6]||(a[6]=e=>Z())},{default:o(()=>a[22]||(a[22]=[C("删除")])),_:1},8,["disabled"])),[[E,["vpadmin:paymentConfig:remove"]]])]),_:1}),l(D,{span:1.5},{default:o(()=>[b((u(),p(c,{type:"warning",plain:"",icon:"Download",onClick:be},{default:o(()=>a[23]||(a[23]=[C("导出")])),_:1})),[[E,["vpadmin:paymentConfig:export"]]])]),_:1}),l(Ce,{showSearch:t(F),"onUpdate:showSearch":a[7]||(a[7]=e=>Pe(F)?F.value=e:null),onQueryTable:k},null,8,["showSearch"])]),_:1})]),default:o(()=>[b((u(),p(ke,{data:t(Q),onSelectionChange:ve},{default:o(()=>[l(_,{type:"selection",width:"55",align:"center"}),l(_,{label:"项目名称",align:"center",prop:"projectName"}),l(_,{label:"支付平台",align:"center",prop:"platform"},{default:o(e=>[l(H,{options:t(q),value:e.row.platform},null,8,["options","value"])]),_:1}),l(_,{label:"支付类型",align:"center",prop:"paymentType"},{default:o(e=>[l(H,{options:t(R),value:e.row.paymentType},null,8,["options","value"])]),_:1}),l(_,{label:"用户等级",align:"center",prop:"tierName"}),l(_,{key:"status",label:"自动发送邮件",align:"center"},{default:o(e=>[l(we,{modelValue:e.row.autoSend,"onUpdate:modelValue":T=>e.row.autoSend=T,"active-value":"0","inactive-value":"1",onChange:T=>ge(e.row,T)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(_,{label:"发件人地址",align:"center",prop:"emailFrom"}),l(_,{label:"邮件正文",align:"center",prop:"emailContent"}),l(_,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o(e=>[l(J,{content:"修改",placement:"top"},{default:o(()=>[b(l(c,{link:"",type:"primary",icon:"Edit",onClick:T=>O(e.row)},null,8,["onClick"]),[[E,["vpadmin:paymentConfig:edit"]]])]),_:2},1024),l(J,{content:"删除",placement:"top"},{default:o(()=>[b(l(c,{link:"",type:"primary",icon:"Delete",onClick:T=>Z(e.row)},null,8,["onClick"]),[[E,["vpadmin:paymentConfig:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[je,t(U)]]),b(l(Se,{page:t(s).pageNum,"onUpdate:page":a[8]||(a[8]=e=>t(s).pageNum=e),limit:t(s).pageSize,"onUpdate:limit":a[9]||(a[9]=e=>t(s).pageSize=e),total:t(I),onPagination:k},null,8,["page","limit","total"]),[[re,t(I)>0]])]),_:1}),l(Te,{modelValue:t(g).visible,"onUpdate:modelValue":a[17]||(a[17]=e=>t(g).visible=e),title:t(g).title,width:"500px","append-to-body":""},{footer:o(()=>[oe("div",sa,[l(c,{loading:t(h),type:"primary",onClick:ye},{default:o(()=>a[24]||(a[24]=[C("确 定")])),_:1},8,["loading"]),l(c,{onClick:pe},{default:o(()=>a[25]||(a[25]=[C("取 消")])),_:1})])]),default:o(()=>[l(W,{ref_key:"paymentConfigFormRef",ref:B,model:t(r),rules:t(de),"label-width":"80px"},{default:o(()=>[l(d,{label:"项目",prop:"projectId"},{default:o(()=>[l(N,{modelValue:t(r).projectId,"onUpdate:modelValue":a[10]||(a[10]=e=>t(r).projectId=e),placeholder:"请选择项目",onChange:ce},{default:o(()=>[(u(!0),y(V,null,w(t(L),e=>(u(),p(S,{key:e.id,label:e.projectName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"支付平台",prop:"platform"},{default:o(()=>[l(N,{modelValue:t(r).platform,"onUpdate:modelValue":a[11]||(a[11]=e=>t(r).platform=e),placeholder:"请选择支付平台"},{default:o(()=>[(u(!0),y(V,null,w(t(q),e=>(u(),p(S,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"支付类型",prop:"paymentType"},{default:o(()=>[l(N,{modelValue:t(r).paymentType,"onUpdate:modelValue":a[12]||(a[12]=e=>t(r).paymentType=e),placeholder:"请选择支付类型"},{default:o(()=>[(u(!0),y(V,null,w(t(R),e=>(u(),p(S,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r).paymentType==="2"?(u(),p(d,{key:0,label:"用户等级",prop:"tierName"},{default:o(()=>[l(m,{modelValue:t(r).tierName,"onUpdate:modelValue":a[13]||(a[13]=e=>t(r).tierName=e),placeholder:"请输入用户等级"},null,8,["modelValue"])]),_:1})):ie("",!0),l(d,{label:"自动发送邮件",prop:"status"},{default:o(()=>[l(Ee,{modelValue:t(r).autoSend,"onUpdate:modelValue":a[14]||(a[14]=e=>t(r).autoSend=e)},{default:o(()=>[(u(!0),y(V,null,w(t(A),e=>(u(),p(Ne,{key:e.value,value:e.value},{default:o(()=>[C(De(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r).autoSend==="0"?(u(),y(V,{key:1},[l(d,{label:"发件人地址",prop:"emailFrom"},{default:o(()=>[l(m,{modelValue:t(r).emailFrom,"onUpdate:modelValue":a[15]||(a[15]=e=>t(r).emailFrom=e),placeholder:"请输入发件人地址"},null,8,["modelValue"])]),_:1}),l(d,{label:"邮件正文",prop:"emailContent"},{default:o(()=>[l(m,{modelValue:t(r).emailContent,"onUpdate:modelValue":a[16]||(a[16]=e=>t(r).emailContent=e),type:"textarea",rows:5,placeholder:"vpadmin不负责保存您任何受保护的内容，请不要将任何受保护的digital content, license keys等直接放到邮件内容里.  You can provide a publicly available link to the content you are selling. e.g. a Google Drive url, a YouTube video or a Zoom invite."},null,8,["modelValue"])]),_:1})],64)):ie("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Pa as default};
