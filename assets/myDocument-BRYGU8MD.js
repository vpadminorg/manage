import{d as ie,$ as re,r,b as ce,b5 as ue,o as u,c as me,j as e,k as a,e as s,Z as x,a2 as de,w as S,x as z,t as pe,y as w,Y as D,m,q as _,R as K,T as fe,a0 as _e,G as ge,I as ye,ab as we,a3 as ve,v as he}from"./index-SwfHvmsR.js";import{_ as be}from"./submitVerify.vue_vue_type_script_setup_true_lang-D6rwGtVq.js";import{_ as ke}from"./index-CwtlzU0C.js";import{E as Ce,a as Se}from"./el-table-column-DvXjLevZ.js";import"./el-checkbox-gjRiKN0S.js";import{_ as Ee}from"./index-YuVMnXy9.js";/* empty css               */import{_ as Ve}from"./index-D6KF0Zrv.js";import{E as Ne,a as Te}from"./el-form-item-BTGfmHo9.js";/* empty css               *//* empty css                *//* empty css                */import{f as De,d as Ke,c as Re}from"./index-C7R48aWB.js";import{l as $e}from"./index-eHxN05NE.js";import{w as Be}from"./index-BWlz0r_B.js";import{E as Ie}from"./index-Bqsyo0rw.js";import{E as Ae}from"./index-BMMvtxBL.js";import{E as Le}from"./index-Cu3lnjet.js";import{E as Fe}from"./index-gXvdNh_C.js";import"./index-CGdMu446.js";import"./el-link-Df0SgTmF.js";import"./el-upload-PgF9WVll.js";import"./index-Ss8K7cVg.js";import"./_baseClone-D_rg-wPN.js";import"./_initCloneObject-DuYGRlJO.js";/* empty css                    */import"./index-BQP_JAWv.js";import"./index.vue_vue_type_script_setup_true_lang-3Mlv33ch.js";import"./index-DmpAF7Ib.js";import"./multiInstanceUser.vue_vue_type_script_setup_true_name_User_lang-HQ8JtlCz.js";const Pe={class:"p-2"},Ue={class:"mb-[10px]"},yt=ie({__name:"myDocument",setup(qe){const{proxy:l}=fe(),{wf_business_status:O}=re(l==null?void 0:l.useDict("wf_business_status")),R=r(),$=r(),d=r(!0),B=r([]),Q=r(!0),J=r(!0),g=r(!0),E=r(0),I=r([]),V=r([]),v=r(""),h=r("running"),i=r({pageNum:1,pageSize:10,name:void 0,categoryCode:void 0});ce(()=>{p(),G()});const Y=n=>{i.value.categoryCode=n.categoryCode,n.categoryCode==="ALL"&&(i.value.categoryCode=""),y()},j=(n,o)=>n?o.categoryName.indexOf(n)!==-1:!0;ue(()=>{$.value.filter(v.value)},{flush:"post"});const G=async()=>{const n=await $e();V.value=[];const o={categoryCode:"ALL",categoryName:"顶级节点",children:[]};o.children=l==null?void 0:l.handleTree(n.data,"id","parentId"),V.value.push(o)},y=()=>{p()},H=()=>{var n;(n=R.value)==null||n.resetFields(),i.value.categoryCode="",i.value.pageNum=1,i.value.pageSize=10,y()},M=n=>{B.value=n.map(o=>o.businessKey),Q.value=n.length!==1,J.value=!n.length},p=()=>{d.value=!0,De(i.value).then(n=>{I.value=n.rows,E.value=n.total,d.value=!1})},Z=async n=>{const o=n.businessKey||B.value;await(l==null?void 0:l.$modal.confirm("是否确认删除业务id为【"+o+"】的数据项？")),d.value=!0,h.value==="running"&&(await Ke(o).finally(()=>d.value=!1),p()),l==null||l.$modal.msgSuccess("删除成功")},W=async n=>{await(l==null?void 0:l.$modal.confirm("是否确认撤销当前单据？")),d.value=!0,h.value==="running"&&(await Re(n).finally(()=>d.value=!1),p()),l==null||l.$modal.msgSuccess("撤销成功")},A=async(n,o)=>{const b=_e({wfDefinitionConfigVo:n.wfDefinitionConfigVo,wfNodeConfigVo:n.wfNodeConfigVo,businessKey:n.businessKey,taskId:n.id,type:o});Be.routerJump(b,l)};return(n,o)=>{const b=ge,X=Ie,N=Ae,L=Le,F=Ne,f=ye,ee=Te,te=Ve,P=Fe,c=Ce,U=we,ne=Ee,k=ve,ae=Se,oe=ke,le=be,se=he;return u(),me("div",Pe,[e(P,{gutter:20},{default:a(()=>[e(L,{lg:4,xs:24,style:{}},{default:a(()=>[e(N,{shadow:"hover"},{default:a(()=>[e(b,{modelValue:s(v),"onUpdate:modelValue":o[0]||(o[0]=C=>x(v)?v.value=C:null),placeholder:"请输入流程分类名","prefix-icon":"Search",clearable:""},null,8,["modelValue"]),e(X,{ref_key:"categoryTreeRef",ref:$,class:"mt-2","node-key":"id",data:s(V),props:{label:"categoryName",children:"children"},"expand-on-click-node":!1,"filter-node-method":j,"highlight-current":"","default-expand-all":"",onNodeClick:Y},null,8,["data"])]),_:1})]),_:1}),e(L,{lg:20,xs:24},{default:a(()=>{var C,q;return[e(de,{"enter-active-class":(C=s(l))==null?void 0:C.animate.searchAnimate.enter,"leave-active-class":(q=s(l))==null?void 0:q.animate.searchAnimate.leave},{default:a(()=>[S(z("div",Ue,[e(N,{shadow:"hover"},{default:a(()=>[S(e(ee,{ref_key:"queryFormRef",ref:R,model:s(i),inline:!0,"label-width":"120px"},{default:a(()=>[e(F,{label:"流程定义名称",prop:"name"},{default:a(()=>[e(b,{modelValue:s(i).name,"onUpdate:modelValue":o[1]||(o[1]=t=>s(i).name=t),placeholder:"请输入流程定义名称",onKeyup:pe(y,["enter"])},null,8,["modelValue"])]),_:1}),e(F,null,{default:a(()=>[e(f,{type:"primary",icon:"Search",onClick:y},{default:a(()=>[w("搜索")]),_:1}),e(f,{icon:"Refresh",onClick:H},{default:a(()=>[w("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[D,s(g)]])]),_:1})],512),[[D,s(g)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(N,{shadow:"hover"},{header:a(()=>[e(P,{gutter:10,class:"mb8"},{default:a(()=>[e(te,{showSearch:s(g),"onUpdate:showSearch":o[2]||(o[2]=t=>x(g)?g.value=t:null),onQueryTable:y},null,8,["showSearch"])]),_:1})]),default:a(()=>[S((u(),m(ae,{border:"",data:s(I),onSelectionChange:M},{default:a(()=>[e(c,{type:"selection",width:"55",align:"center"}),e(c,{align:"center",type:"index",label:"序号",width:"60"}),_("",!0),e(c,{"show-overflow-tooltip":!0,align:"center",label:"流程定义名称"},{default:a(t=>[z("span",null,K(t.row.processDefinitionName)+"v"+K(t.row.processDefinitionVersion)+".0",1)]),_:1}),e(c,{align:"center",prop:"processDefinitionKey",label:"流程定义KEY"}),e(c,{align:"center",prop:"processDefinitionVersion",label:"版本号",width:"90"},{default:a(t=>[w(" v"+K(t.row.processDefinitionVersion)+".0",1)]),_:1}),s(h)==="running"?(u(),m(c,{key:1,align:"center",prop:"isSuspended",label:"状态","min-width":"70"},{default:a(t=>[t.row.isSuspended?(u(),m(U,{key:1,type:"danger"},{default:a(()=>[w("挂起")]),_:1})):(u(),m(U,{key:0,type:"success"},{default:a(()=>[w("激活")]),_:1}))]),_:1})):_("",!0),e(c,{align:"center",label:"流程状态","min-width":"70"},{default:a(t=>[e(ne,{options:s(O),value:t.row.businessStatus},null,8,["options","value"])]),_:1}),e(c,{align:"center",prop:"startTime",label:"启动时间",width:"160"}),s(h)==="finish"?(u(),m(c,{key:2,align:"center",prop:"endTime",label:"结束时间",width:"160"})):_("",!0),e(c,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(t=>[t.row.businessStatus==="draft"||t.row.businessStatus==="cancel"||t.row.businessStatus==="back"?(u(),m(k,{key:0,content:"修改",placement:"top"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"Edit",onClick:T=>A(t.row,"update")},null,8,["onClick"])]),_:2},1024)):_("",!0),t.row.businessStatus==="draft"||t.row.businessStatus==="cancel"||t.row.businessStatus==="back"?(u(),m(k,{key:1,content:"删除",placement:"top"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"Delete",onClick:T=>Z(t.row)},null,8,["onClick"])]),_:2},1024)):_("",!0),e(k,{placement:"top",content:"查看"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"View",onClick:T=>A(t.row,"view")},null,8,["onClick"])]),_:2},1024),t.row.businessStatus==="waiting"?(u(),m(k,{key:2,content:"撤销",placement:"top"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"Notification",onClick:T=>W(t.row.businessKey)},null,8,["onClick"])]),_:2},1024)):_("",!0)]),_:1})]),_:1},8,["data"])),[[se,s(d)]]),S(e(oe,{page:s(i).pageNum,"onUpdate:page":o[3]||(o[3]=t=>s(i).pageNum=t),limit:s(i).pageSize,"onUpdate:limit":o[4]||(o[4]=t=>s(i).pageSize=t),total:s(E),onPagination:p},null,8,["page","limit","total"]),[[D,s(E)>0]])]),_:1})]}),_:1})]),_:1}),e(le,{ref:"submitVerifyRef",onSubmitCallback:p},null,512)])}}});export{yt as default};
