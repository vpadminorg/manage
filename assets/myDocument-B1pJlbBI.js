import{d as ie,Y as re,r,b as ue,b3 as ce,o as c,c as me,j as e,k as a,e as s,X as z,a0 as de,w as S,m as Q,x as pe,y as w,W as D,p as m,t as _,Q as K,R as fe,Z as _e,G as ge,I as ye,a9 as we,a1 as ve,v as be}from"./index-D4nD6lq3.js";import{_ as he}from"./submitVerify.vue_vue_type_script_setup_true_lang-Ds9EluLr.js";import{_ as ke}from"./index-BH-aX6uU.js";import{E as Ce,a as Se}from"./el-table-column-Nw9CsZCh.js";import"./el-checkbox-DpS0yAA0.js";import{_ as Ee}from"./index-Cu5tDpmP.js";/* empty css               */import{_ as Ve}from"./index-CeC1FWzw.js";import{E as Ne,a as Te}from"./el-form-item-oceQVxPu.js";/* empty css               *//* empty css                *//* empty css                */import{f as De,d as Ke,c as Re}from"./index-tWgKF5mO.js";import{l as $e}from"./index-DkTz8tRe.js";import{w as Be}from"./index-BWlz0r_B.js";import{E as Ie}from"./index-CsUbaV0a.js";import{E as Ae}from"./index-DWSlLEJi.js";import{E as Le}from"./index-I5OlcPyW.js";import{E as Fe}from"./index-fvT2sidt.js";import"./index-BxYbo8VD.js";import"./el-link-BLiuvJwr.js";import"./el-upload-D0KnpWzb.js";import"./index-BWD8n9py.js";import"./_baseClone-zQQn4kcl.js";import"./_initCloneObject-Cyh6om-O.js";/* empty css                    */import"./index-B-G_MFQm.js";import"./index.vue_vue_type_script_setup_true_lang-D7mrRZGd.js";import"./index-BOrFPrtb.js";import"./multiInstanceUser.vue_vue_type_script_setup_true_name_User_lang-DrW4tg51.js";const Pe={class:"p-2"},Ue={class:"mb-[10px]"},yt=ie({__name:"myDocument",setup(xe){const{proxy:l}=fe(),{wf_business_status:q}=re(l==null?void 0:l.useDict("wf_business_status")),R=r(),$=r(),d=r(!0),B=r([]),O=r(!0),J=r(!0),g=r(!0),E=r(0),I=r([]),V=r([]),v=r(""),b=r("running"),i=r({pageNum:1,pageSize:10,name:void 0,categoryCode:void 0});ue(()=>{p(),G()});const Y=o=>{i.value.categoryCode=o.categoryCode,o.categoryCode==="ALL"&&(i.value.categoryCode=""),y()},j=(o,t)=>o?t.categoryName.indexOf(o)!==-1:!0;ce(()=>{$.value.filter(v.value)},{flush:"post"});const G=async()=>{const o=await $e();V.value=[];const t={categoryCode:"ALL",categoryName:"顶级节点",children:[]};t.children=l==null?void 0:l.handleTree(o.data,"id","parentId"),V.value.push(t)},y=()=>{p()},H=()=>{var o;(o=R.value)==null||o.resetFields(),i.value.categoryCode="",i.value.pageNum=1,i.value.pageSize=10,y()},M=o=>{B.value=o.map(t=>t.businessKey),O.value=o.length!==1,J.value=!o.length},p=()=>{d.value=!0,De(i.value).then(o=>{I.value=o.rows,E.value=o.total,d.value=!1})},W=async o=>{const t=o.businessKey||B.value;await(l==null?void 0:l.$modal.confirm("是否确认删除业务id为【"+t+"】的数据项？")),d.value=!0,b.value==="running"&&(await Ke(t).finally(()=>d.value=!1),p()),l==null||l.$modal.msgSuccess("删除成功")},X=async o=>{await(l==null?void 0:l.$modal.confirm("是否确认撤销当前单据？")),d.value=!0,b.value==="running"&&(await Re(o).finally(()=>d.value=!1),p()),l==null||l.$modal.msgSuccess("撤销成功")},A=async(o,t)=>{const h=_e({wfDefinitionConfigVo:o.wfDefinitionConfigVo,wfNodeConfigVo:o.wfNodeConfigVo,businessKey:o.businessKey,taskId:o.id,type:t});Be.routerJump(h,l)};return(o,t)=>{const h=ge,Z=Ie,N=Ae,L=Le,F=Ne,f=ye,ee=Te,te=Ve,P=Fe,u=Ce,U=we,ne=Ee,k=ve,oe=Se,ae=ke,le=he,se=be;return c(),me("div",Pe,[e(P,{gutter:20},{default:a(()=>[e(L,{lg:4,xs:24,style:{}},{default:a(()=>[e(N,{shadow:"hover"},{default:a(()=>[e(h,{modelValue:s(v),"onUpdate:modelValue":t[0]||(t[0]=C=>z(v)?v.value=C:null),placeholder:"请输入流程分类名","prefix-icon":"Search",clearable:""},null,8,["modelValue"]),e(Z,{ref_key:"categoryTreeRef",ref:$,class:"mt-2","node-key":"id",data:s(V),props:{label:"categoryName",children:"children"},"expand-on-click-node":!1,"filter-node-method":j,"highlight-current":"","default-expand-all":"",onNodeClick:Y},null,8,["data"])]),_:1})]),_:1}),e(L,{lg:20,xs:24},{default:a(()=>{var C,x;return[e(de,{"enter-active-class":(C=s(l))==null?void 0:C.animate.searchAnimate.enter,"leave-active-class":(x=s(l))==null?void 0:x.animate.searchAnimate.leave},{default:a(()=>[S(Q("div",Ue,[e(N,{shadow:"hover"},{default:a(()=>[S(e(ee,{ref_key:"queryFormRef",ref:R,model:s(i),inline:!0,"label-width":"120px"},{default:a(()=>[e(F,{label:"流程定义名称",prop:"name"},{default:a(()=>[e(h,{modelValue:s(i).name,"onUpdate:modelValue":t[1]||(t[1]=n=>s(i).name=n),placeholder:"请输入流程定义名称",onKeyup:pe(y,["enter"])},null,8,["modelValue"])]),_:1}),e(F,null,{default:a(()=>[e(f,{type:"primary",icon:"Search",onClick:y},{default:a(()=>t[5]||(t[5]=[w("搜索")])),_:1}),e(f,{icon:"Refresh",onClick:H},{default:a(()=>t[6]||(t[6]=[w("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[D,s(g)]])]),_:1})],512),[[D,s(g)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(N,{shadow:"hover"},{header:a(()=>[e(P,{gutter:10,class:"mb8"},{default:a(()=>[e(te,{showSearch:s(g),"onUpdate:showSearch":t[2]||(t[2]=n=>z(g)?g.value=n:null),onQueryTable:y},null,8,["showSearch"])]),_:1})]),default:a(()=>[S((c(),m(oe,{border:"",data:s(I),onSelectionChange:M},{default:a(()=>[e(u,{type:"selection",width:"55",align:"center"}),e(u,{align:"center",type:"index",label:"序号",width:"60"}),_("",!0),e(u,{"show-overflow-tooltip":!0,align:"center",label:"流程定义名称"},{default:a(n=>[Q("span",null,K(n.row.processDefinitionName)+"v"+K(n.row.processDefinitionVersion)+".0",1)]),_:1}),e(u,{align:"center",prop:"processDefinitionKey",label:"流程定义KEY"}),e(u,{align:"center",prop:"processDefinitionVersion",label:"版本号",width:"90"},{default:a(n=>[w(" v"+K(n.row.processDefinitionVersion)+".0",1)]),_:1}),s(b)==="running"?(c(),m(u,{key:1,align:"center",prop:"isSuspended",label:"状态","min-width":"70"},{default:a(n=>[n.row.isSuspended?(c(),m(U,{key:1,type:"danger"},{default:a(()=>t[8]||(t[8]=[w("挂起")])),_:1})):(c(),m(U,{key:0,type:"success"},{default:a(()=>t[7]||(t[7]=[w("激活")])),_:1}))]),_:1})):_("",!0),e(u,{align:"center",label:"流程状态","min-width":"70"},{default:a(n=>[e(ne,{options:s(q),value:n.row.businessStatus},null,8,["options","value"])]),_:1}),e(u,{align:"center",prop:"startTime",label:"启动时间",width:"160"}),s(b)==="finish"?(c(),m(u,{key:2,align:"center",prop:"endTime",label:"结束时间",width:"160"})):_("",!0),e(u,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(n=>[n.row.businessStatus==="draft"||n.row.businessStatus==="cancel"||n.row.businessStatus==="back"?(c(),m(k,{key:0,content:"修改",placement:"top"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"Edit",onClick:T=>A(n.row,"update")},null,8,["onClick"])]),_:2},1024)):_("",!0),n.row.businessStatus==="draft"||n.row.businessStatus==="cancel"||n.row.businessStatus==="back"?(c(),m(k,{key:1,content:"删除",placement:"top"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"Delete",onClick:T=>W(n.row)},null,8,["onClick"])]),_:2},1024)):_("",!0),e(k,{placement:"top",content:"查看"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"View",onClick:T=>A(n.row,"view")},null,8,["onClick"])]),_:2},1024),n.row.businessStatus==="waiting"?(c(),m(k,{key:2,content:"撤销",placement:"top"},{default:a(()=>[e(f,{link:"",type:"primary",icon:"Notification",onClick:T=>X(n.row.businessKey)},null,8,["onClick"])]),_:2},1024)):_("",!0)]),_:1})]),_:1},8,["data"])),[[se,s(d)]]),S(e(ae,{page:s(i).pageNum,"onUpdate:page":t[3]||(t[3]=n=>s(i).pageNum=n),limit:s(i).pageSize,"onUpdate:limit":t[4]||(t[4]=n=>s(i).pageSize=n),total:s(E),onPagination:p},null,8,["page","limit","total"]),[[D,s(E)>0]])]),_:1})]}),_:1})]),_:1}),e(le,{ref:"submitVerifyRef",onSubmitCallback:p},null,512)])}}});export{yt as default};
