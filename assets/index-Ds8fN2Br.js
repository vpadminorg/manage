import{ac as L,d as re,$ as ee,r as c,a0 as te,b as Ee,a1 as Le,o as d,c as U,j as t,k as o,w as _,x as le,e as a,F as k,p as E,m as f,t as ae,y as b,Y as oe,a2 as je,Z as Ie,q as Ne,R as Se,T as Re,P as De,C as Te,D as Fe,G as $e,I as qe,ad as Be,a3 as xe,W as ze,v as Ae}from"./index-_v2uieGc.js";/* empty css                       *//* empty css                 */import{_ as Ke}from"./index-B7XPQ3lw.js";import{E as Me,a as Qe}from"./el-table-column-Q2QHI77F.js";import"./el-checkbox-C6h3hzMD.js";import{_ as Ge}from"./index-DXIR9_gV.js";/* empty css               */import{_ as Oe}from"./index-Bi2yoGwv.js";/* empty css               *//* empty css                */import{E as We,a as Ye}from"./el-form-item-BZcdB44L.js";import{g as Ze}from"./edit-r0yTrOmk.js";import{E as He}from"./index-ctcZQfix.js";import{E as Je}from"./index-7OoO_SlU.js";import{E as Xe}from"./index-DJNwvRpE.js";import{E as et,a as tt}from"./index-BAqBBdde.js";import"./_initCloneObject-DMl0_0C4.js";/* empty css                */import"./index-BFoUAo4m.js";import"./_baseClone-Cj6s47u0.js";const lt=p=>L({url:"/vpadmin/thirdPartyLoginConfig/list",method:"get",params:p}),at=p=>L({url:"/vpadmin/thirdPartyLoginConfig/"+p,method:"get"}),ot=p=>L({url:"/vpadmin/thirdPartyLoginConfig",method:"post",data:p}),ne=p=>L({url:"/vpadmin/thirdPartyLoginConfig",method:"put",data:p}),nt=p=>L({url:"/vpadmin/thirdPartyLoginConfig/"+p,method:"delete"}),rt={class:"p-2"},it={class:"mb-[10px]"},st={class:"dialog-footer"},dt=re({name:"ThirdPartyLoginConfig"}),Nt=re({...dt,setup(p){const{proxy:i}=Re(),{sys_normal_disable:x,vpa_social_login_type:T}=ee(i==null?void 0:i.useDict("sys_normal_disable","vpa_social_login_type")),z=c([]),j=c(!1),I=c(!0),N=c(!0),F=c([]),A=c(!0),K=c(!0),$=c(0),S=c([]),M=c(),q=c(),v=te({visible:!1,title:"",isEdit:!1}),Q={id:void 0,platform:void 0,clientId:void 0,clientSecret:void 0,redirectUri:void 0,status:"0",projectName:void 0,projectId:void 0},ie=te({form:{...Q},queryParams:{pageNum:1,pageSize:10,platform:void 0,projectName:void 0,redirectUri:void 0,status:void 0,params:{}},rules:{id:[{required:!0,message:"主键不能为空",trigger:"blur"}],platform:[{required:!0,message:"第三方平台不能为空",trigger:"change"}],clientId:[{required:!0,message:"客户端ID不能为空",trigger:"blur"}],clientSecret:[{required:!0,message:"客户端密钥不能为空",trigger:"blur"}],redirectUri:[{required:!0,message:"重定向URI不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}],projectId:[{required:!0,message:"项目不能为空",trigger:"change"}]}}),{queryParams:s,form:r,rules:se}=ee(ie),C=async()=>{I.value=!0;const n=await lt(s.value);z.value=n.rows,$.value=n.total,I.value=!1},de=()=>{B(),v.visible=!1},B=()=>{var n;r.value={...Q},(n=q.value)==null||n.resetFields()},R=()=>{s.value.pageNum=1,C()},ue=()=>{var n;(n=M.value)==null||n.resetFields(),R()},me=n=>{F.value=n.map(l=>l.id),A.value=n.length!=1,K.value=!n.length},G=async()=>{try{const n=await Ze();S.value=n.data}catch(n){console.error("Failed to fetch project list:",n)}},ce=n=>{const l=S.value.find(u=>u.id===n);l?(r.value.redirectUri=`${l.domain}`,r.value.projectName=l.projectName):(r.value.redirectUri="",r.value.projectName=void 0)},pe=()=>{B(),G(),r.value.redirectUri="",r.value.projectName=void 0,r.value.status="0",v.visible=!0,v.title="添加第三方登录配置信息"},O=async n=>{B(),await G();const l=(n==null?void 0:n.id)||F.value[0],u=await at(l);if(Object.assign(r.value,u.data),r.value.projectId){const y=S.value.find(m=>m.id===r.value.projectId);y&&(r.value.redirectUri=`${y.domain}`,r.value.projectName=y.projectName)}v.visible=!0,v.title="修改第三方登录配置信息"},ge=async(n,l)=>{try{const u=l==="0"?"确认要启用该配置吗？":"确认要禁用该配置吗？";await De.confirm(u,"确认信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ne({...n,status:l}),i==null||i.$modal.msgSuccess(l==="0"?"启用成功":"禁用成功")}catch(u){n.status=l==="0"?"1":"0",u!=="cancel"&&(console.error("Failed to update status:",u),i==null||i.$modal.msgError("操作失败"))}},fe=()=>{var n;(n=q.value)==null||n.validate(async l=>{l&&(j.value=!0,r.value.id?await ne(r.value).finally(()=>j.value=!1):await ot(r.value).finally(()=>j.value=!1),i==null||i.$modal.msgSuccess("操作成功"),v.visible=!1,await C())})},W=async n=>{const l=(n==null?void 0:n.id)||F.value;await(i==null?void 0:i.$modal.confirm('是否确认删除第三方登录配置信息编号为"'+l+'"的数据项？').finally(()=>I.value=!1)),await nt(l),i==null||i.$modal.msgSuccess("删除成功"),await C()},ve=()=>{i==null||i.download("vpadmin/thirdPartyLoginConfig/export",{...s.value},`thirdPartyLoginConfig_${new Date().getTime()}.xlsx`)};return Ee(()=>{C()}),(n,l)=>{var J,X;const u=Te,y=Fe,m=We,P=$e,g=qe,Y=Ye,Z=He,D=Je,_e=Oe,be=Xe,h=Me,ye=Ge,he=Be,H=xe,Ce=Qe,Ve=Ke,Ue=et,Pe=tt,we=ze,V=Le("hasPermi"),ke=Ae;return d(),U("div",rt,[t(je,{"enter-active-class":(J=a(i))==null?void 0:J.animate.searchAnimate.enter,"leave-active-class":(X=a(i))==null?void 0:X.animate.searchAnimate.leave},{default:o(()=>[_(le("div",it,[t(Z,{shadow:"hover"},{default:o(()=>[t(Y,{ref_key:"queryFormRef",ref:M,model:a(s),inline:!0},{default:o(()=>[t(m,{label:"第三方平台",prop:"platform"},{default:o(()=>[t(y,{modelValue:a(s).platform,"onUpdate:modelValue":l[0]||(l[0]=e=>a(s).platform=e),placeholder:"请选择第三方平台",clearable:""},{default:o(()=>[(d(!0),U(k,null,E(a(T),e=>(d(),f(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"项目名称",prop:"projectName"},{default:o(()=>[t(P,{modelValue:a(s).projectName,"onUpdate:modelValue":l[1]||(l[1]=e=>a(s).projectName=e),placeholder:"请输入项目名称",clearable:"",onKeyup:ae(R,["enter"])},null,8,["modelValue"])]),_:1}),t(m,{label:"重定向URI",prop:"redirectUri"},{default:o(()=>[t(P,{modelValue:a(s).redirectUri,"onUpdate:modelValue":l[2]||(l[2]=e=>a(s).redirectUri=e),placeholder:"请输入重定向URI",clearable:"",onKeyup:ae(R,["enter"])},null,8,["modelValue"])]),_:1}),t(m,{label:"状态",prop:"status"},{default:o(()=>[t(y,{modelValue:a(s).status,"onUpdate:modelValue":l[3]||(l[3]=e=>a(s).status=e),placeholder:"请选择状态",clearable:""},{default:o(()=>[(d(!0),U(k,null,E(a(x),e=>(d(),f(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,null,{default:o(()=>[t(g,{type:"primary",icon:"Search",onClick:R},{default:o(()=>[b("搜索")]),_:1}),t(g,{icon:"Refresh",onClick:ue},{default:o(()=>[b("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[oe,a(N)]])]),_:1},8,["enter-active-class","leave-active-class"]),t(Z,{shadow:"never"},{header:o(()=>[t(be,{gutter:10,class:"mb8"},{default:o(()=>[t(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"primary",plain:"",icon:"Plus",onClick:pe},{default:o(()=>[b("新增")]),_:1})),[[V,["vpadmin:thirdPartyLoginConfig:add"]]])]),_:1}),t(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"success",plain:"",icon:"Edit",disabled:a(A),onClick:l[4]||(l[4]=e=>O())},{default:o(()=>[b("修改")]),_:1},8,["disabled"])),[[V,["vpadmin:thirdPartyLoginConfig:edit"]]])]),_:1}),t(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"danger",plain:"",icon:"Delete",disabled:a(K),onClick:l[5]||(l[5]=e=>W())},{default:o(()=>[b("删除")]),_:1},8,["disabled"])),[[V,["vpadmin:thirdPartyLoginConfig:remove"]]])]),_:1}),t(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"warning",plain:"",icon:"Download",onClick:ve},{default:o(()=>[b("导出")]),_:1})),[[V,["vpadmin:thirdPartyLoginConfig:export"]]])]),_:1}),t(_e,{showSearch:a(N),"onUpdate:showSearch":l[6]||(l[6]=e=>Ie(N)?N.value=e:null),onQueryTable:C},null,8,["showSearch"])]),_:1})]),default:o(()=>[_((d(),f(Ce,{data:a(z),onSelectionChange:me},{default:o(()=>[t(h,{type:"selection",width:"55",align:"center"}),Ne("",!0),t(h,{label:"第三方平台",align:"center",prop:"platform"},{default:o(e=>[t(ye,{options:a(T),value:e.row.platform},null,8,["options","value"])]),_:1}),t(h,{label:"项目名称",align:"center",prop:"projectName"}),t(h,{label:"客户端ID",align:"center",prop:"clientId"}),t(h,{label:"客户端密钥",align:"center",prop:"clientSecret"}),t(h,{label:"重定向URI",align:"center",prop:"redirectUri"}),t(h,{key:"status",label:"状态",align:"center"},{default:o(e=>[t(he,{modelValue:e.row.status,"onUpdate:modelValue":w=>e.row.status=w,"active-value":"0","inactive-value":"1",onChange:w=>ge(e.row,w)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(h,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o(e=>[t(H,{content:"修改",placement:"top"},{default:o(()=>[_(t(g,{link:"",type:"primary",icon:"Edit",onClick:w=>O(e.row)},null,8,["onClick"]),[[V,["vpadmin:thirdPartyLoginConfig:edit"]]])]),_:2},1024),t(H,{content:"删除",placement:"top"},{default:o(()=>[_(t(g,{link:"",type:"primary",icon:"Delete",onClick:w=>W(e.row)},null,8,["onClick"]),[[V,["vpadmin:thirdPartyLoginConfig:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ke,a(I)]]),_(t(Ve,{page:a(s).pageNum,"onUpdate:page":l[7]||(l[7]=e=>a(s).pageNum=e),limit:a(s).pageSize,"onUpdate:limit":l[8]||(l[8]=e=>a(s).pageSize=e),total:a($),onPagination:C},null,8,["page","limit","total"]),[[oe,a($)>0]])]),_:1}),t(we,{modelValue:a(v).visible,"onUpdate:modelValue":l[15]||(l[15]=e=>a(v).visible=e),title:a(v).title,width:"500px","append-to-body":""},{footer:o(()=>[le("div",st,[t(g,{loading:a(j),type:"primary",onClick:fe},{default:o(()=>[b("确 定")]),_:1},8,["loading"]),t(g,{onClick:de},{default:o(()=>[b("取 消")]),_:1})])]),default:o(()=>[t(Y,{ref_key:"thirdPartyLoginConfigFormRef",ref:q,model:a(r),rules:a(se),"label-width":"120px"},{default:o(()=>[t(m,{label:"项目",prop:"projectId"},{default:o(()=>[t(y,{modelValue:a(r).projectId,"onUpdate:modelValue":l[9]||(l[9]=e=>a(r).projectId=e),placeholder:"请选择项目",onChange:ce},{default:o(()=>[(d(!0),U(k,null,E(a(S),e=>(d(),f(u,{key:e.id,label:e.projectName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"第三方平台",prop:"platform"},{default:o(()=>[t(y,{modelValue:a(r).platform,"onUpdate:modelValue":l[10]||(l[10]=e=>a(r).platform=e),placeholder:"请选择第三方平台"},{default:o(()=>[(d(!0),U(k,null,E(a(T),e=>(d(),f(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"客户端ID",prop:"clientId"},{default:o(()=>[t(P,{modelValue:a(r).clientId,"onUpdate:modelValue":l[11]||(l[11]=e=>a(r).clientId=e),placeholder:"请输入客户端ID"},null,8,["modelValue"])]),_:1}),t(m,{label:"客户端密钥",prop:"clientSecret"},{default:o(()=>[t(P,{modelValue:a(r).clientSecret,"onUpdate:modelValue":l[12]||(l[12]=e=>a(r).clientSecret=e),placeholder:"请输入客户端密钥"},null,8,["modelValue"])]),_:1}),t(m,{label:"重定向URI",prop:"redirectUri"},{default:o(()=>[t(P,{modelValue:a(r).redirectUri,"onUpdate:modelValue":l[13]||(l[13]=e=>a(r).redirectUri=e),placeholder:"请选择项目以自动填充重定向URI",disabled:""},null,8,["modelValue"])]),_:1}),t(m,{label:"状态",prop:"status"},{default:o(()=>[t(Pe,{modelValue:a(r).status,"onUpdate:modelValue":l[14]||(l[14]=e=>a(r).status=e)},{default:o(()=>[(d(!0),U(k,null,E(a(x),e=>(d(),f(Ue,{key:e.value,value:e.value},{default:o(()=>[b(Se(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Nt as default};
