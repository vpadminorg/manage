import{d as g,r as m,o as b,m as V,k as a,j as o,e as r,y as i,G as q,I as v,T as y}from"./index-SwfHvmsR.js";import{E,a as k}from"./el-form-item-BTGfmHo9.js";import{h as C}from"./index-DmpAF7Ib.js";const B=g({__name:"resetPwd",setup(h){const{proxy:l}=y(),w=m(),e=m({oldPassword:"",newPassword:"",confirmPassword:""}),c=m({oldPassword:[{required:!0,message:"旧密码不能为空",trigger:"blur"}],newPassword:[{required:!0,message:"新密码不能为空",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"},{pattern:/^[^<>"'|\\]+$/,message:`不能包含非法字符：< > " ' \\ |`,trigger:"blur"}],confirmPassword:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{required:!0,validator:(n,s,t)=>{e.value.newPassword!==s?t(new Error("两次输入的密码不一致")):t()},trigger:"blur"}]}),f=()=>{var n;(n=w.value)==null||n.validate(async s=>{s&&(await C(e.value.oldPassword,e.value.newPassword),l==null||l.$modal.msgSuccess("修改成功"))})},_=()=>{l==null||l.$tab.closePage()};return(n,s)=>{const t=q,u=E,p=v,P=k;return b(),V(P,{ref_key:"pwdRef",ref:w,model:r(e),rules:r(c),"label-width":"80px"},{default:a(()=>[o(u,{label:"旧密码",prop:"oldPassword"},{default:a(()=>[o(t,{modelValue:r(e).oldPassword,"onUpdate:modelValue":s[0]||(s[0]=d=>r(e).oldPassword=d),placeholder:"请输入旧密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(u,{label:"新密码",prop:"newPassword"},{default:a(()=>[o(t,{modelValue:r(e).newPassword,"onUpdate:modelValue":s[1]||(s[1]=d=>r(e).newPassword=d),placeholder:"请输入新密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(u,{label:"确认密码",prop:"confirmPassword"},{default:a(()=>[o(t,{modelValue:r(e).confirmPassword,"onUpdate:modelValue":s[2]||(s[2]=d=>r(e).confirmPassword=d),placeholder:"请确认新密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(u,null,{default:a(()=>[o(p,{type:"primary",onClick:f},{default:a(()=>[i("保存")]),_:1}),o(p,{type:"danger",onClick:_},{default:a(()=>[i("关闭")]),_:1})]),_:1})]),_:1},8,["model","rules"])}}});export{B as _};
