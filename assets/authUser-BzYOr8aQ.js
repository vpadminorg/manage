import{d as P,u as X,$ as x,r as c,a0 as ee,b as oe,a1 as ae,o as h,c as te,j as e,k as o,w as p,x as V,e as t,t as $,y as _,Y as A,a2 as le,m as y,Z as ne,R as se,T as re,G as ie,I as ce,a3 as me,v as ue}from"./index-SwfHvmsR.js";/* empty css                */import{_ as pe}from"./index-CwtlzU0C.js";import{E as de,a as _e}from"./el-table-column-DvXjLevZ.js";import"./el-checkbox-gjRiKN0S.js";import{_ as fe}from"./index-YuVMnXy9.js";/* empty css               */import{_ as he}from"./index-D6KF0Zrv.js";/* empty css               */import{E as ve,a as ge}from"./el-form-item-BTGfmHo9.js";import{a as we,b as be,c as Ce}from"./index-CdO65AIb.js";import{_ as ye}from"./selectUser.vue_vue_type_script_setup_true_name_SelectUser_lang-HepAlrjR.js";import{E as Ie}from"./index-Cu3lnjet.js";import{E as ke}from"./index-gXvdNh_C.js";import{E as Ee}from"./index-BMMvtxBL.js";import"./_initCloneObject-DuYGRlJO.js";/* empty css                */import"./index-Bqsyo0rw.js";import"./_baseClone-D_rg-wPN.js";const Se={class:"p-2"},Ne={class:"search"},Ue=P({name:"AuthUser"}),Je=P({...Ue,setup(Re){const F=X(),{proxy:a}=re(),{sys_normal_disable:B}=x(a==null?void 0:a.useDict("sys_normal_disable")),I=c([]),v=c(!0),f=c(!0),k=c(!0),g=c(0),E=c([]),S=c(),N=c(),s=ee({pageNum:1,pageSize:10,roleId:F.params.roleId,userName:void 0,phonenumber:void 0}),m=async()=>{v.value=!0;const l=await we(s);I.value=l.rows,g.value=l.total,v.value=!1},q=()=>{const l={path:"/system/role",fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0};a==null||a.$tab.closeOpenPage(l)},d=()=>{s.pageNum=1,m()},D=()=>{var l;(l=S.value)==null||l.resetFields(),d()},L=l=>{E.value=l.map(r=>r.userId),k.value=!l.length},j=()=>{var l;(l=N.value)==null||l.show()},z=async l=>{await(a==null?void 0:a.$modal.confirm('确认要取消该用户"'+l.userName+'"角色吗？')),await be({userId:l.userId,roleId:s.roleId}),await m(),a==null||a.$modal.msgSuccess("取消授权成功")},K=async()=>{const l=s.roleId,r=E.value.join(",");await(a==null?void 0:a.$modal.confirm("是否取消选中用户授权数据项?")),await Ce({roleId:l,userIds:r}),await m(),a==null||a.$modal.msgSuccess("取消授权成功")};return oe(()=>{m()}),(l,r)=>{var R,T;const U=ie,w=ve,u=ce,Q=ge,b=Ie,O=he,G=ke,i=de,M=fe,Y=me,Z=_e,H=pe,J=Ee,C=ae("hasPermi"),W=ue;return h(),te("div",Se,[e(le,{"enter-active-class":(R=t(a))==null?void 0:R.animate.searchAnimate.enter,"leave-active-class":(T=t(a))==null?void 0:T.animate.searchAnimate.leave},{default:o(()=>[p(V("div",Ne,[e(Q,{ref_key:"queryFormRef",ref:S,model:t(s),inline:!0},{default:o(()=>[e(w,{label:"用户名称",prop:"userName"},{default:o(()=>[e(U,{modelValue:t(s).userName,"onUpdate:modelValue":r[0]||(r[0]=n=>t(s).userName=n),placeholder:"请输入用户名称",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"手机号码",prop:"phonenumber"},{default:o(()=>[e(U,{modelValue:t(s).phonenumber,"onUpdate:modelValue":r[1]||(r[1]=n=>t(s).phonenumber=n),placeholder:"请输入手机号码",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,null,{default:o(()=>[e(u,{type:"primary",icon:"Search",onClick:d},{default:o(()=>[_("搜索")]),_:1}),e(u,{icon:"Refresh",onClick:D},{default:o(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[A,t(f)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(J,{shadow:"never"},{header:o(()=>[e(G,{gutter:10},{default:o(()=>[e(b,{span:1.5},{default:o(()=>[p((h(),y(u,{type:"primary",plain:"",icon:"Plus",onClick:j},{default:o(()=>[_("添加用户")]),_:1})),[[C,["system:role:add"]]])]),_:1}),e(b,{span:1.5},{default:o(()=>[p((h(),y(u,{type:"danger",plain:"",icon:"CircleClose",disabled:t(k),onClick:K},{default:o(()=>[_(" 批量取消授权 ")]),_:1},8,["disabled"])),[[C,["system:role:remove"]]])]),_:1}),e(b,{span:1.5},{default:o(()=>[e(u,{type:"warning",plain:"",icon:"Close",onClick:q},{default:o(()=>[_("关闭")]),_:1})]),_:1}),e(O,{showSearch:t(f),"onUpdate:showSearch":r[2]||(r[2]=n=>ne(f)?f.value=n:null),search:!0,onQueryTable:m},null,8,["showSearch"])]),_:1})]),default:o(()=>[p((h(),y(Z,{data:t(I),onSelectionChange:L},{default:o(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),e(i,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),e(i,{label:"邮箱",prop:"email","show-overflow-tooltip":!0}),e(i,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),e(i,{label:"状态",align:"center",prop:"status"},{default:o(n=>[e(M,{options:t(B),value:n.row.status},null,8,["options","value"])]),_:1}),e(i,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:o(n=>[V("span",null,se(n.row.createTime),1)]),_:1}),e(i,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o(n=>[e(Y,{content:"取消授权",placement:"top"},{default:o(()=>[p(e(u,{link:"",type:"primary",icon:"CircleClose",onClick:Te=>z(n.row)},null,8,["onClick"]),[[C,["system:role:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[W,t(v)]]),p(e(H,{page:t(s).pageNum,"onUpdate:page":r[3]||(r[3]=n=>t(s).pageNum=n),limit:t(s).pageSize,"onUpdate:limit":r[4]||(r[4]=n=>t(s).pageSize=n),total:t(g),onPagination:m},null,8,["page","limit","total"]),[[A,t(g)>0]]),e(ye,{ref_key:"selectRef",ref:N,"role-id":t(s).roleId,onOk:d},null,8,["role-id"])]),_:1})])}}});export{Je as default};
