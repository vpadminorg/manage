import{d as _,r as y,b as p,n as b,w as k,e as v,o as x,c as T,u as E,g as B,v as C,f as I,l as q,s as R,E as d}from"./index-CHPWXQMS.js";const S={class:"social-callback"},M=_({__name:"index",setup(J){const o=E(),n=y(!0),u=o.query.code,c=o.query.state,f=o.query.source,s=JSON.parse(atob(c)),w=s.tenantId?s.tenantId:"000000",i=s.domain,r=async e=>{if(e.code!==200)throw new Error(e.msg);e.data!==null&&R(e.data.access_token),d.success(e.msg),setTimeout(()=>{location.href="/manage/index"},2e3)},l=e=>{d.error(e.message),setTimeout(()=>{location.href="/manage/index"},2e3)},g=async e=>{try{const a=await I(e);await r(a),n.value=!1}catch(a){l(a)}},m=async e=>{try{const a=await q(e);await r(a),n.value=!1}catch(a){l(a)}},h=async()=>{let e=window.location.origin;if(i!==e){let t=new URL(window.location.href);t.host=i,window.location.href=t.toString();return}const a={socialCode:u,socialState:c,tenantId:w,source:f,clientId:"436efb388d684aadab73ef3cbba8f287",grantType:"socialPortal",redirect:window.location.href};B()?await m(a):await g(a)};return p(()=>{b(()=>{h()})}),(e,a)=>{const t=C;return k((x(),T("div",S,null,512)),[[t,v(n)]])}}});export{M as default};
