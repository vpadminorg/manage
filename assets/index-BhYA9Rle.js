import{d as le,$ as Z,r as _,a0 as H,b as Ve,a1 as Ee,o as i,c as N,j as e,k as l,w as b,x as $,e as o,t as J,F as q,p as A,m as h,y as v,Y as Ce,a2 as we,Z as ke,R as X,q as Ie,T as Ne,G as De,C as Te,D as Ue,I as Re,a3 as Se,W as Fe,v as $e}from"./index-SwfHvmsR.js";/* empty css                       *//* empty css                 */import{E as qe}from"./el-input-number-DEtIMJqx.js";/* empty css                */import"./el-checkbox-gjRiKN0S.js";import{E as Ae}from"./el-tree-select-BekMS_9a.js";import{E as Be,a as Pe}from"./el-table-column-DvXjLevZ.js";import{_ as xe}from"./index-YuVMnXy9.js";/* empty css               */import{_ as Le}from"./index-D6KF0Zrv.js";/* empty css               *//* empty css                */import{E as Ke,a as Oe}from"./el-form-item-BTGfmHo9.js";import{l as ee,g as Qe,a as Ge,u as je,b as ze,d as Me}from"./index-C8E-1XQk.js";import{l as We}from"./index-DmpAF7Ib.js";import{E as Ye}from"./index-BMMvtxBL.js";import{E as Ze}from"./index-Cu3lnjet.js";import{E as He}from"./index-gXvdNh_C.js";import{E as Je,a as Xe}from"./index-gGP__DGH.js";import"./index-CWevaQ9i.js";import"./index-Bqsyo0rw.js";import"./_initCloneObject-DuYGRlJO.js";import"./_baseClone-D_rg-wPN.js";const el={class:"p-2"},ll={class:"mb-[10px]"},tl={class:"dialog-footer"},al=le({name:"Dept"}),Tl=le({...al,setup(ol){const{proxy:s}=Ne(),{sys_normal_disable:D}=Z(s==null?void 0:s.useDict("sys_normal_disable")),T=_([]),U=_(!0),V=_(!0),E=_([]),C=_(!0),B=_([]),m=H({visible:!1,title:""}),P=_(),x=_(),R=_(),L={deptId:void 0,parentId:void 0,deptName:void 0,deptCategory:void 0,orderNum:0,leader:void 0,phone:void 0,email:void 0,status:"0"},te={form:{...L},queryParams:{pageNum:1,pageSize:10,deptName:void 0,deptCategory:void 0,status:void 0},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}},ae=H(te),{queryParams:f,form:d,rules:oe}=Z(ae),y=async()=>{U.value=!0;const n=await ee(f.value),a=s==null?void 0:s.handleTree(n.data,"deptId");a&&(T.value=a),U.value=!1};async function ne(n){if(n!==null&&n!==""&&n!==void 0){const a=await We(n);B.value=a.data}}const de=()=>{S(),m.visible=!1},S=()=>{var n;d.value={...L},(n=R.value)==null||n.resetFields()},w=()=>{y()},se=()=>{var n;(n=x.value)==null||n.resetFields(),w()},re=()=>{C.value=!C.value,K(T.value,C.value)},K=(n,a)=>{n.forEach(u=>{var r;(r=P.value)==null||r.toggleRowExpansion(u,a),u.children&&u.children.length>0&&K(u.children,a)})},O=async n=>{S();const a=await ee(),u=s==null?void 0:s.handleTree(a.data,"deptId");u&&(E.value=u,n&&n.deptId&&(d.value.parentId=n==null?void 0:n.deptId),m.visible=!0,m.title="添加部门")},ue=async n=>{S(),ne(n.deptId);const a=await Qe(n.deptId);d.value=a.data;const u=await Ge(n.deptId),r=s==null?void 0:s.handleTree(u.data,"deptId");if(r&&(E.value=r,r.length===0)){const k={deptId:a.data.parentId,deptName:a.data.parentName,children:[]};E.value.push(k)}m.visible=!0,m.title="修改部门"},pe=()=>{var n;(n=R.value)==null||n.validate(async a=>{a&&(d.value.deptId?await je(d.value):await ze(d.value),s==null||s.$modal.msgSuccess("操作成功"),m.visible=!1,await y())})},ie=async n=>{await(s==null?void 0:s.$modal.confirm('是否确认删除名称为"'+n.deptName+'"的数据项?')),await Me(n.deptId),await y(),s==null||s.$modal.msgSuccess("删除成功")};return Ve(()=>{y()}),(n,a)=>{var M,W;const u=De,r=Ke,k=Te,Q=Ue,c=Re,G=Oe,j=Ye,p=Ze,me=Le,z=He,g=Be,ce=xe,F=Se,_e=Pe,fe=Ae,ve=qe,ge=Je,be=Xe,he=Fe,I=Ee("hasPermi"),ye=$e;return i(),N("div",el,[e(we,{"enter-active-class":(M=o(s))==null?void 0:M.animate.searchAnimate.enter,"leave-active-class":(W=o(s))==null?void 0:W.animate.searchAnimate.leave},{default:l(()=>[b($("div",ll,[e(j,{shadow:"hover"},{default:l(()=>[e(G,{ref_key:"queryFormRef",ref:x,model:o(f),inline:!0},{default:l(()=>[e(r,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(u,{modelValue:o(f).deptName,"onUpdate:modelValue":a[0]||(a[0]=t=>o(f).deptName=t),placeholder:"请输入部门名称",clearable:"",onKeyup:J(w,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"类别编码",prop:"deptCategory"},{default:l(()=>[e(u,{modelValue:o(f).deptCategory,"onUpdate:modelValue":a[1]||(a[1]=t=>o(f).deptCategory=t),placeholder:"请输入类别编码",clearable:"",style:{width:"240px"},onKeyup:J(w,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"状态",prop:"status"},{default:l(()=>[e(Q,{modelValue:o(f).status,"onUpdate:modelValue":a[2]||(a[2]=t=>o(f).status=t),placeholder:"部门状态",clearable:""},{default:l(()=>[(i(!0),N(q,null,A(o(D),t=>(i(),h(k,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:l(()=>[e(c,{type:"primary",icon:"Search",onClick:w},{default:l(()=>[v("搜索")]),_:1}),e(c,{icon:"Refresh",onClick:se},{default:l(()=>[v("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[Ce,o(V)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(j,{shadow:"hover"},{header:l(()=>[e(z,{gutter:10},{default:l(()=>[e(p,{span:1.5},{default:l(()=>[b((i(),h(c,{type:"primary",plain:"",icon:"Plus",onClick:a[3]||(a[3]=t=>O())},{default:l(()=>[v("新增 ")]),_:1})),[[I,["system:dept:add"]]])]),_:1}),e(p,{span:1.5},{default:l(()=>[e(c,{type:"info",plain:"",icon:"Sort",onClick:re},{default:l(()=>[v("展开/折叠")]),_:1})]),_:1}),e(me,{showSearch:o(V),"onUpdate:showSearch":a[4]||(a[4]=t=>ke(V)?V.value=t:null),onQueryTable:y},null,8,["showSearch"])]),_:1})]),default:l(()=>[b((i(),h(_e,{ref_key:"deptTableRef",ref:P,data:o(T),"row-key":"deptId","tree-props":{children:"children",hasChildren:"hasChildren"},"default-expand-all":o(C)},{default:l(()=>[e(g,{prop:"deptName",label:"部门名称",width:"260"}),e(g,{prop:"deptCategory",align:"center",label:"类别编码",width:"200"}),e(g,{prop:"orderNum",align:"center",label:"排序",width:"200"}),e(g,{prop:"status",align:"center",label:"状态",width:"100"},{default:l(t=>[e(ce,{options:o(D),value:t.row.status},null,8,["options","value"])]),_:1}),e(g,{label:"创建时间",align:"center",prop:"createTime",width:"200"},{default:l(t=>[$("span",null,X(n.parseTime(t.row.createTime)),1)]),_:1}),e(g,{fixed:"right",align:"center",label:"操作"},{default:l(t=>[e(F,{content:"修改",placement:"top"},{default:l(()=>[b(e(c,{link:"",type:"primary",icon:"Edit",onClick:Y=>ue(t.row)},null,8,["onClick"]),[[I,["system:dept:edit"]]])]),_:2},1024),e(F,{content:"新增",placement:"top"},{default:l(()=>[b(e(c,{link:"",type:"primary",icon:"Plus",onClick:Y=>O(t.row)},null,8,["onClick"]),[[I,["system:dept:add"]]])]),_:2},1024),e(F,{content:"删除",placement:"top"},{default:l(()=>[b(e(c,{link:"",type:"primary",icon:"Delete",onClick:Y=>ie(t.row)},null,8,["onClick"]),[[I,["system:dept:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-expand-all"])),[[ye,o(U)]])]),_:1}),e(he,{modelValue:o(m).visible,"onUpdate:modelValue":a[13]||(a[13]=t=>o(m).visible=t),title:o(m).title,"destroy-on-close":"","append-to-body":"",width:"600px"},{footer:l(()=>[$("div",tl,[e(c,{type:"primary",onClick:pe},{default:l(()=>[v("确 定")]),_:1}),e(c,{onClick:de},{default:l(()=>[v("取 消")]),_:1})])]),default:l(()=>[e(G,{ref_key:"deptFormRef",ref:R,model:o(d),rules:o(oe),"label-width":"80px"},{default:l(()=>[e(z,null,{default:l(()=>[o(d).parentId!==0?(i(),h(p,{key:0,span:24},{default:l(()=>[e(r,{label:"上级部门",prop:"parentId"},{default:l(()=>[e(fe,{modelValue:o(d).parentId,"onUpdate:modelValue":a[5]||(a[5]=t=>o(d).parentId=t),data:o(E),props:{value:"deptId",label:"deptName",children:"children"},"value-key":"deptId",placeholder:"选择上级部门","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1})):Ie("",!0),e(p,{span:12},{default:l(()=>[e(r,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(u,{modelValue:o(d).deptName,"onUpdate:modelValue":a[6]||(a[6]=t=>o(d).deptName=t),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"类别编码",prop:"deptCategory"},{default:l(()=>[e(u,{modelValue:o(d).deptCategory,"onUpdate:modelValue":a[7]||(a[7]=t=>o(d).deptCategory=t),placeholder:"请输入类别编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"显示排序",prop:"orderNum"},{default:l(()=>[e(ve,{modelValue:o(d).orderNum,"onUpdate:modelValue":a[8]||(a[8]=t=>o(d).orderNum=t),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"负责人",prop:"leader"},{default:l(()=>[e(Q,{modelValue:o(d).leader,"onUpdate:modelValue":a[9]||(a[9]=t=>o(d).leader=t),placeholder:"请选择负责人"},{default:l(()=>[(i(!0),N(q,null,A(o(B),t=>(i(),h(k,{key:t.userId,label:t.userName,value:t.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"联系电话",prop:"phone"},{default:l(()=>[e(u,{modelValue:o(d).phone,"onUpdate:modelValue":a[10]||(a[10]=t=>o(d).phone=t),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"邮箱",prop:"email"},{default:l(()=>[e(u,{modelValue:o(d).email,"onUpdate:modelValue":a[11]||(a[11]=t=>o(d).email=t),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"部门状态"},{default:l(()=>[e(be,{modelValue:o(d).status,"onUpdate:modelValue":a[12]||(a[12]=t=>o(d).status=t)},{default:l(()=>[(i(!0),N(q,null,A(o(D),t=>(i(),h(ge,{key:t.value,value:t.value},{default:l(()=>[v(X(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Tl as default};
