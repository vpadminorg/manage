import{d as P,u as J,Y as x,r as m,Z as ee,b as oe,$ as te,o as v,c as ae,j as e,k as t,w as p,m as T,e as l,x as $,y as _,W as A,a0 as le,p as y,X as ne,Q as se,R as re,G as ie,I as me,a1 as ue,v as ce}from"./index-D4nD6lq3.js";/* empty css                */import{_ as pe}from"./index-BH-aX6uU.js";import{E as de,a as _e}from"./el-table-column-Nw9CsZCh.js";import"./el-checkbox-DpS0yAA0.js";import{_ as fe}from"./index-Cu5tDpmP.js";/* empty css               */import{_ as ve}from"./index-CeC1FWzw.js";/* empty css               */import{E as ge,a as he}from"./el-form-item-oceQVxPu.js";import{a as we,b as be,c as Ce}from"./index-CyG2HWXF.js";import{_ as ye}from"./selectUser.vue_vue_type_script_setup_true_name_SelectUser_lang-DT4LYczV.js";import{E as Ie}from"./index-I5OlcPyW.js";import{E as ke}from"./index-fvT2sidt.js";import{E as Ee}from"./index-DWSlLEJi.js";import"./_initCloneObject-Cyh6om-O.js";/* empty css                */import"./index-CsUbaV0a.js";import"./_baseClone-zQQn4kcl.js";const Se={class:"p-2"},Ne={class:"search"},Ue=P({name:"AuthUser"}),Ze=P({...Ue,setup(Re){const F=J(),{proxy:a}=re(),{sys_normal_disable:B}=x(a==null?void 0:a.useDict("sys_normal_disable")),I=m([]),g=m(!0),f=m(!0),k=m(!0),h=m(0),E=m([]),S=m(),N=m(),r=ee({pageNum:1,pageSize:10,roleId:F.params.roleId,userName:void 0,phonenumber:void 0}),u=async()=>{g.value=!0;const n=await we(r);I.value=n.rows,h.value=n.total,g.value=!1},q=()=>{const n={path:"/system/role",fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0};a==null||a.$tab.closeOpenPage(n)},d=()=>{r.pageNum=1,u()},D=()=>{var n;(n=S.value)==null||n.resetFields(),d()},L=n=>{E.value=n.map(o=>o.userId),k.value=!n.length},Q=()=>{var n;(n=N.value)==null||n.show()},j=async n=>{await(a==null?void 0:a.$modal.confirm('确认要取消该用户"'+n.userName+'"角色吗？')),await be({userId:n.userId,roleId:r.roleId}),await u(),a==null||a.$modal.msgSuccess("取消授权成功")},z=async()=>{const n=r.roleId,o=E.value.join(",");await(a==null?void 0:a.$modal.confirm("是否取消选中用户授权数据项?")),await Ce({roleId:n,userIds:o}),await u(),a==null||a.$modal.msgSuccess("取消授权成功")};return oe(()=>{u()}),(n,o)=>{var R,V;const U=ie,w=ge,c=me,K=he,b=Ie,O=ve,G=ke,i=de,M=fe,W=ue,X=_e,Y=pe,Z=Ee,C=te("hasPermi"),H=ce;return v(),ae("div",Se,[e(le,{"enter-active-class":(R=l(a))==null?void 0:R.animate.searchAnimate.enter,"leave-active-class":(V=l(a))==null?void 0:V.animate.searchAnimate.leave},{default:t(()=>[p(T("div",Ne,[e(K,{ref_key:"queryFormRef",ref:S,model:l(r),inline:!0},{default:t(()=>[e(w,{label:"用户名称",prop:"userName"},{default:t(()=>[e(U,{modelValue:l(r).userName,"onUpdate:modelValue":o[0]||(o[0]=s=>l(r).userName=s),placeholder:"请输入用户名称",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"手机号码",prop:"phonenumber"},{default:t(()=>[e(U,{modelValue:l(r).phonenumber,"onUpdate:modelValue":o[1]||(o[1]=s=>l(r).phonenumber=s),placeholder:"请输入手机号码",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(c,{type:"primary",icon:"Search",onClick:d},{default:t(()=>o[5]||(o[5]=[_("搜索")])),_:1}),e(c,{icon:"Refresh",onClick:D},{default:t(()=>o[6]||(o[6]=[_("重置")])),_:1})]),_:1})]),_:1},8,["model"])],512),[[A,l(f)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(Z,{shadow:"never"},{header:t(()=>[e(G,{gutter:10},{default:t(()=>[e(b,{span:1.5},{default:t(()=>[p((v(),y(c,{type:"primary",plain:"",icon:"Plus",onClick:Q},{default:t(()=>o[7]||(o[7]=[_("添加用户")])),_:1})),[[C,["system:role:add"]]])]),_:1}),e(b,{span:1.5},{default:t(()=>[p((v(),y(c,{type:"danger",plain:"",icon:"CircleClose",disabled:l(k),onClick:z},{default:t(()=>o[8]||(o[8]=[_(" 批量取消授权 ")])),_:1},8,["disabled"])),[[C,["system:role:remove"]]])]),_:1}),e(b,{span:1.5},{default:t(()=>[e(c,{type:"warning",plain:"",icon:"Close",onClick:q},{default:t(()=>o[9]||(o[9]=[_("关闭")])),_:1})]),_:1}),e(O,{showSearch:l(f),"onUpdate:showSearch":o[2]||(o[2]=s=>ne(f)?f.value=s:null),search:!0,onQueryTable:u},null,8,["showSearch"])]),_:1})]),default:t(()=>[p((v(),y(X,{data:l(I),onSelectionChange:L},{default:t(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),e(i,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),e(i,{label:"邮箱",prop:"email","show-overflow-tooltip":!0}),e(i,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),e(i,{label:"状态",align:"center",prop:"status"},{default:t(s=>[e(M,{options:l(B),value:s.row.status},null,8,["options","value"])]),_:1}),e(i,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:t(s=>[T("span",null,se(s.row.createTime),1)]),_:1}),e(i,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(s=>[e(W,{content:"取消授权",placement:"top"},{default:t(()=>[p(e(c,{link:"",type:"primary",icon:"CircleClose",onClick:Ve=>j(s.row)},null,8,["onClick"]),[[C,["system:role:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[H,l(g)]]),p(e(Y,{page:l(r).pageNum,"onUpdate:page":o[3]||(o[3]=s=>l(r).pageNum=s),limit:l(r).pageSize,"onUpdate:limit":o[4]||(o[4]=s=>l(r).pageSize=s),total:l(h),onPagination:u},null,8,["page","limit","total"]),[[A,l(h)>0]]),e(ye,{ref_key:"selectRef",ref:N,"role-id":l(r).roleId,onOk:d},null,8,["role-id"])]),_:1})])}}});export{Ze as default};
