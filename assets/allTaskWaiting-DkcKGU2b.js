import{d as we,r as i,$ as be,b as ye,o as m,c as R,x as C,j as e,k as t,e as l,Z as F,y as r,w as E,t as z,Y as A,a2 as ke,m as d,R as v,cZ as he,F as X,p as H,q as N,T as Ve,a0 as Ce,G as Ee,I as Ne,ab as De,W as Se,v as Ie}from"./index-BdO_PCud.js";import{_ as Ke}from"./index-DgC6oaAE.js";import{E as Re,a as Te}from"./el-table-column-CxrXonmB.js";import"./el-checkbox-DR_n8wcT.js";import{_ as Ue}from"./index-zX8pFNE7.js";/* empty css               */import{_ as Le}from"./index-DdfRnwzI.js";/* empty css               */import{E as Be,a as $e}from"./el-form-item-nBjrsFHP.js";/* empty css                *//* empty css                       *//* empty css                        */import{k as Fe,l as ze,u as Ae,m as Pe}from"./index-CrD_S-ys.js";import{_ as We}from"./multiInstanceUser.vue_vue_type_script_setup_true_name_User_lang-XoioSYUZ.js";import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang-Dha29s-4.js";import{w as Me}from"./index-BWlz0r_B.js";import{b as qe,a as Ye}from"./index-CXOsKnMC.js";import{E as Qe}from"./index-Da5mA8cC.js";import{E as Ge}from"./index-ChncSV8R.js";import{E as Je}from"./index-BPUStiGI.js";import"./_initCloneObject-LS9VQ7NB.js";/* empty css                */import"./index-B6gfFi8I.js";import"./_baseClone-CzasQ86Y.js";import"./index-C6QHa-Jl.js";const Oe={class:"p-2"},Ze={class:"mb-[10px]"},je={class:"mb-[10px]"},Xe={class:"clearfix"},Et=we({__name:"allTaskWaiting",setup(He){const b=i(),P=i(),W=i(),{proxy:u}=Ve(),{wf_business_status:ee}=be(u==null?void 0:u.useDict("wf_business_status")),w=i(!0),x=i([]),te=i(!0),M=i(!0),y=i(!0),D=i(0),S=i([]),T=i(""),I=i(!1),U=i(!0),q=i({key:"",value:""}),Y=i(),s=i({pageNum:1,pageSize:10,name:void 0,processDefinitionName:void 0,processDefinitionKey:void 0}),c=i("waiting"),ae=n=>{b.value&&(T.value="加签人员",b.value.getAddMultiInstanceList(n.id,[]))},le=n=>{b.value&&(T.value="减签人员",b.value.getDeleteMultiInstanceList(n.id))},f=()=>{c.value==="waiting"?L():Q()},ne=()=>{var n;(n=W.value)==null||n.resetFields(),s.value.pageNum=1,s.value.pageSize=10,f()},oe=n=>{x.value=n.map(o=>o.id),te.value=n.length!==1,M.value=!n.length},ie=async n=>{S.value=[],s.value.pageNum=1,n==="waiting"?L():Q()},L=()=>{w.value=!0,Fe(s.value).then(n=>{S.value=n.rows,D.value=n.total,w.value=!1})},Q=()=>{w.value=!0,ze(s.value).then(n=>{S.value=n.rows,D.value=n.total,w.value=!1})},se=()=>{P.value.open()},re=async n=>{n&&n.length>0?(await(u==null?void 0:u.$modal.confirm("是否确认提交？")),w.value=!0,await Ae(x.value,n[0].userId),f(),u==null||u.$modal.msgSuccess("操作成功")):u==null||u.$modal.msgWarning("请选择用户！")},ue=async n=>{U.value=!0,I.value=!0,Y.value=n.processDefinitionName;let o=await Pe(n.id);q.value=o.data,U.value=!1},me=n=>{const o=Ce({wfDefinitionConfigVo:n.wfDefinitionConfigVo,wfNodeConfigVo:n.wfNodeConfigVo,businessKey:n.businessKey,taskId:n.id,type:"view"});Me.routerJump(o,u)};return ye(()=>{L()}),(n,o)=>{var Z,j;const G=qe,ce=Ye,K=Qe,B=Ee,k=Be,_=Ne,J=$e,h=Ge,de=Le,$=Je,p=Re,V=De,pe=Ue,fe=Te,_e=Ke,ge=Se,O=Ie;return m(),R("div",Oe,[C("div",Ze,[e(K,{shadow:"hover",class:"text-center"},{default:t(()=>[e(ce,{modelValue:l(c),"onUpdate:modelValue":o[0]||(o[0]=a=>F(c)?c.value=a:null),onChange:o[1]||(o[1]=a=>ie(l(c)))},{default:t(()=>[e(G,{value:"waiting"},{default:t(()=>[r("待办任务")]),_:1}),e(G,{value:"finish"},{default:t(()=>[r("已办任务")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),e(ke,{"enter-active-class":(Z=l(u))==null?void 0:Z.animate.searchAnimate.enter,"leave-active-class":(j=l(u))==null?void 0:j.animate.searchAnimate.leave},{default:t(()=>[E(C("div",je,[e(K,{shadow:"hover"},{default:t(()=>[E(e(J,{ref_key:"queryFormRef",ref:W,model:l(s),inline:!0},{default:t(()=>[e(k,{label:"任务名称",prop:"name"},{default:t(()=>[e(B,{modelValue:l(s).name,"onUpdate:modelValue":o[2]||(o[2]=a=>l(s).name=a),placeholder:"请输入任务名称",onKeyup:z(f,["enter"])},null,8,["modelValue"])]),_:1}),e(k,{label:"流程定义名称","label-width":"100",prop:"processDefinitionName"},{default:t(()=>[e(B,{modelValue:l(s).processDefinitionName,"onUpdate:modelValue":o[3]||(o[3]=a=>l(s).processDefinitionName=a),placeholder:"请输入流程定义名称",onKeyup:z(f,["enter"])},null,8,["modelValue"])]),_:1}),e(k,{label:"流程定义KEY","label-width":"100",prop:"processDefinitionKey"},{default:t(()=>[e(B,{modelValue:l(s).processDefinitionKey,"onUpdate:modelValue":o[4]||(o[4]=a=>l(s).processDefinitionKey=a),placeholder:"请输入流程定义KEY",onKeyup:z(f,["enter"])},null,8,["modelValue"])]),_:1}),e(k,null,{default:t(()=>[e(_,{type:"primary",icon:"Search",onClick:f},{default:t(()=>[r("搜索")]),_:1}),e(_,{icon:"Refresh",onClick:ne},{default:t(()=>[r("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[A,l(y)]])]),_:1})],512),[[A,l(y)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(K,{shadow:"hover"},{header:t(()=>[e($,{gutter:10,class:"mb8"},{default:t(()=>[e(h,{span:1.5},{default:t(()=>[e(_,{type:"primary",plain:"",icon:"Edit",disabled:l(M),onClick:se},{default:t(()=>[r("修改办理人")]),_:1},8,["disabled"])]),_:1}),e(de,{showSearch:l(y),"onUpdate:showSearch":o[5]||(o[5]=a=>F(y)?y.value=a:null),onQueryTable:f},null,8,["showSearch"])]),_:1})]),default:t(()=>[E((m(),d(fe,{border:"",data:l(S),onSelectionChange:oe},{default:t(()=>[e(p,{type:"selection",width:"55",align:"center"}),e(p,{align:"center",type:"index",label:"序号",width:"60"}),e(p,{"show-overflow-tooltip":!0,align:"center",label:"流程定义名称"},{default:t(a=>[C("span",null,v(a.row.processDefinitionName)+"v"+v(a.row.processDefinitionVersion)+".0",1)]),_:1}),e(p,{align:"center",prop:"processDefinitionKey",label:"流程定义KEY"}),e(p,{align:"center",prop:"name",label:"任务名称"}),e(p,{align:"center",prop:"assigneeName",label:"办理人"},he({_:2},[l(c)==="waiting"?{name:"default",fn:t(a=>[a.row.participantVo&&a.row.assignee===null?(m(!0),R(X,{key:0},H(a.row.participantVo.candidateName,(g,ve)=>(m(),d(V,{key:ve,type:"success"},{default:t(()=>[r(v(g),1)]),_:2},1024))),128)):(m(),d(V,{key:1,type:"success"},{default:t(()=>[r(v(a.row.assigneeName||"无"),1)]),_:2},1024))]),key:"0"}:l(c)==="finish"?{name:"default",fn:t(a=>[e(V,{type:"success"},{default:t(()=>[r(v(a.row.assigneeName||"无"),1)]),_:2},1024)]),key:"1"}:void 0]),1024),e(p,{align:"center",label:"流程状态","min-width":"70"},{default:t(a=>[l(c)==="waiting"?(m(),d(pe,{key:0,options:l(ee),value:a.row.businessStatus},null,8,["options","value"])):(m(),d(V,{key:1,type:"success"},{default:t(()=>[r("已完成")]),_:1}))]),_:1}),l(c)==="waiting"?(m(),d(p,{key:0,align:"center",prop:"createTime",label:"创建时间",width:"160"})):N("",!0),l(c)==="finish"?(m(),d(p,{key:1,align:"center",prop:"startTime",label:"创建时间",width:"160"})):N("",!0),e(p,{label:"操作",align:"center",width:l(c)==="finish"?"80":"151"},{default:t(a=>[e($,{gutter:10,class:"mb8"},{default:t(()=>[e(h,{span:1.5},{default:t(()=>[e(_,{link:"",type:"primary",size:"small",icon:"View",onClick:g=>me(a.row)},{default:t(()=>[r("查看")]),_:2},1032,["onClick"])]),_:2},1024),l(c)==="waiting"?(m(),d(h,{key:0,span:1.5},{default:t(()=>[e(_,{link:"",type:"primary",size:"small",icon:"Document",onClick:g=>ue(a.row)},{default:t(()=>[r("流程变量")]),_:2},1032,["onClick"])]),_:2},1024)):N("",!0)]),_:2},1024),a.row.multiInstance?(m(),d($,{key:0,gutter:10,class:"mb8"},{default:t(()=>[e(h,{span:1.5},{default:t(()=>[e(_,{link:"",type:"primary",size:"small",icon:"Remove",onClick:g=>le(a.row)},{default:t(()=>[r("减签")]),_:2},1032,["onClick"])]),_:2},1024),e(h,{span:1.5},{default:t(()=>[e(_,{link:"",type:"primary",size:"small",icon:"CirclePlus",onClick:g=>ae(a.row)},{default:t(()=>[r("加签")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):N("",!0)]),_:1},8,["width"])]),_:1},8,["data"])),[[O,l(w)]]),E(e(_e,{page:l(s).pageNum,"onUpdate:page":o[6]||(o[6]=a=>l(s).pageNum=a),limit:l(s).pageSize,"onUpdate:limit":o[7]||(o[7]=a=>l(s).pageSize=a),total:l(D),onPagination:f},null,8,["page","limit","total"]),[[A,l(D)>0]])]),_:1}),e(We,{ref_key:"multiInstanceUserRef",ref:b,title:l(T),onSubmitCallback:f},null,8,["title"]),e(l(xe),{ref_key:"userSelectRef",ref:P,multiple:!1,onConfirmCallBack:re},null,512),e(ge,{modelValue:l(I),"onUpdate:modelValue":o[8]||(o[8]=a=>F(I)?I.value=a:null),draggable:"",title:"流程变量",width:"60%","close-on-click-modal":!1},{default:t(()=>[E((m(),d(K,{class:"box-card"},{header:t(()=>[C("div",Xe,[C("span",null,[r("流程定义名称："),e(V,null,{default:t(()=>[r(v(l(Y)),1)]),_:1})])])]),default:t(()=>[(m(!0),R(X,null,H(l(q),(a,g)=>(m(),R("div",{key:g},[a.key!=="_FLOWABLE_SKIP_EXPRESSION_ENABLED"?(m(),d(J,{key:0,"label-position":"right","label-width":"150px"},{default:t(()=>[e(k,{label:a.key+"："},{default:t(()=>[r(v(a.value),1)]),_:2},1032,["label"])]),_:2},1024)):N("",!0)]))),128))]),_:1})),[[O,l(U)]])]),_:1},8,["modelValue"])])}}});export{Et as default};
