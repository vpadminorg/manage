import{ac as K,d as oe,$ as J,r as b,a0 as X,b as Ve,a1 as Ce,o as r,c as ee,j as l,k as o,w as V,x as le,e,t as te,y as m,Y as ae,a2 as Ke,m as u,Z as he,q as g,F as we,p as Ee,R as Se,T as Ne,G as Ue,C as Pe,D as Ie,I as Fe,ab as qe,ad as Re,a3 as $e,W as De,v as Oe}from"./index-SwfHvmsR.js";/* empty css                       *//* empty css                 */import{_ as Te}from"./index-CwtlzU0C.js";import{E as xe,a as Be}from"./el-table-column-DvXjLevZ.js";import"./el-checkbox-gjRiKN0S.js";/* empty css               */import{_ as Le}from"./index-D6KF0Zrv.js";/* empty css               *//* empty css                */import{E as He,a as ze}from"./el-form-item-BTGfmHo9.js";import{E as Ae}from"./index-BMMvtxBL.js";import{E as Qe}from"./index-Cu3lnjet.js";import{E as je}from"./index-gXvdNh_C.js";import{E as Ge,a as Me}from"./index-gGP__DGH.js";import"./_initCloneObject-DuYGRlJO.js";/* empty css                */import"./index-Bqsyo0rw.js";import"./_baseClone-D_rg-wPN.js";function We(f){return K({url:"/resource/oss/config/list",method:"get",params:f})}function Ye(f){return K({url:"/resource/oss/config/"+f,method:"get"})}function Ze(f){return K({url:"/resource/oss/config",method:"post",data:f})}function Je(f){return K({url:"/resource/oss/config",method:"put",data:f})}function Xe(f){return K({url:"/resource/oss/config/"+f,method:"delete"})}function el(f,i,I){return K({url:"/resource/oss/config/changeStatus",method:"put",data:{ossConfigId:f,status:i,configKey:I}})}const ll={class:"p-2"},tl={class:"mb-[10px]"},al={class:"dialog-footer"},ol=oe({name:"OssConfig"}),hl=oe({...ol,setup(f){const{proxy:i}=Ne(),{sys_yes_no:I}=J(i==null?void 0:i.useDict("sys_yes_no")),F=b([]),E=b(!1),h=b(!0),S=b(!0),q=b([]),x=b(!0),B=b(!0),R=b(0),L=b(),$=b(),_=X({visible:!1,title:""}),v=b([{key:0,label:"主建",visible:!0},{key:1,label:"配置key",visible:!1},{key:2,label:"访问站点",visible:!0},{key:3,label:"自定义域名",visible:!0},{key:4,label:"桶名称",visible:!0},{key:5,label:"前缀",visible:!0},{key:6,label:"域",visible:!0},{key:7,label:"桶权限类型",visible:!0},{key:8,label:"状态",visible:!0}]),H={ossConfigId:void 0,configKey:"",accessKey:"",secretKey:"",bucketName:"",prefix:"",endpoint:"",domain:"",isHttps:"N",accessPolicy:"1",region:"",status:"1",remark:""},se=X({form:{...H},queryParams:{pageNum:1,pageSize:10,configKey:"",bucketName:"",status:""},rules:{configKey:[{required:!0,message:"configKey不能为空",trigger:"blur"}],accessKey:[{required:!0,message:"accessKey不能为空",trigger:"blur"},{min:2,max:200,message:"accessKey长度必须介于 2 和 100 之间",trigger:"blur"}],secretKey:[{required:!0,message:"secretKey不能为空",trigger:"blur"},{min:2,max:100,message:"secretKey长度必须介于 2 和 100 之间",trigger:"blur"}],bucketName:[{required:!0,message:"bucketName不能为空",trigger:"blur"},{min:2,max:100,message:"bucketName长度必须介于 2 和 100 之间",trigger:"blur"}],endpoint:[{required:!0,message:"endpoint不能为空",trigger:"blur"},{min:2,max:100,message:"endpoint名称长度必须介于 2 和 100 之间",trigger:"blur"}],accessPolicy:[{required:!0,message:"accessPolicy不能为空",trigger:"blur"}]}}),{queryParams:c,form:n,rules:ne}=J(se),C=async()=>{h.value=!0;const s=await We(c.value);F.value=s.rows,R.value=s.total,h.value=!1},ie=()=>{_.visible=!1,D()},D=()=>{var s;n.value={...H},(s=$.value)==null||s.resetFields()},N=()=>{c.value.pageNum=1,C()},re=()=>{var s;(s=L.value)==null||s.resetFields(),N()},ue=s=>{q.value=s.map(t=>t.ossConfigId),x.value=s.length!=1,B.value=!s.length},de=()=>{D(),_.visible=!0,_.title="添加对象存储配置"},z=async s=>{D();const t=(s==null?void 0:s.ossConfigId)||q.value[0],p=await Ye(t);Object.assign(n.value,p.data),_.visible=!0,_.title="修改对象存储配置"},me=()=>{var s;(s=$.value)==null||s.validate(async t=>{t&&(E.value=!0,n.value.ossConfigId?await Je(n.value).finally(()=>E.value=!1):await Ze(n.value).finally(()=>E.value=!1),i==null||i.$modal.msgSuccess("新增成功"),_.visible=!1,await C())})},ce=async s=>{let t=s.status==="0"?"启用":"停用";try{await(i==null?void 0:i.$modal.confirm('确认要"'+t+'""'+s.configKey+'"配置吗?')),await el(s.ossConfigId,s.status,s.configKey),await C(),i==null||i.$modal.msgSuccess(t+"成功")}catch{return}finally{s.status=s.status==="0"?"1":"0"}},A=async s=>{const t=(s==null?void 0:s.ossConfigId)||q.value;await(i==null?void 0:i.$modal.confirm('是否确认删除OSS配置编号为"'+t+'"的数据项?')),h.value=!0,await Xe(t).finally(()=>h.value=!1),await C(),i==null||i.$modal.msgSuccess("删除成功")};return Ve(()=>{C()}),(s,t)=>{var Y,Z;const p=Ue,d=He,Q=Pe,pe=Ie,k=Fe,j=ze,G=Ae,O=Qe,fe=Le,ge=je,y=xe,T=qe,ye=Re,M=$e,be=Be,_e=Te,U=Ge,W=Me,ve=De,w=Ce("hasPermi"),ke=Oe;return r(),ee("div",ll,[l(Ke,{"enter-active-class":(Y=e(i))==null?void 0:Y.animate.searchAnimate.enter,"leave-active-class":(Z=e(i))==null?void 0:Z.animate.searchAnimate.leave},{default:o(()=>[V(le("div",tl,[l(G,{shadow:"hover"},{default:o(()=>[l(j,{ref_key:"queryFormRef",ref:L,model:e(c),inline:!0},{default:o(()=>[l(d,{label:"配置key",prop:"configKey"},{default:o(()=>[l(p,{modelValue:e(c).configKey,"onUpdate:modelValue":t[0]||(t[0]=a=>e(c).configKey=a),placeholder:"配置key",clearable:"",onKeyup:te(N,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"桶名称",prop:"bucketName"},{default:o(()=>[l(p,{modelValue:e(c).bucketName,"onUpdate:modelValue":t[1]||(t[1]=a=>e(c).bucketName=a),placeholder:"请输入桶名称",clearable:"",onKeyup:te(N,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"是否默认",prop:"status"},{default:o(()=>[l(pe,{modelValue:e(c).status,"onUpdate:modelValue":t[2]||(t[2]=a=>e(c).status=a),placeholder:"请选择状态",clearable:""},{default:o(()=>[l(Q,{key:"0",label:"是",value:"0"}),l(Q,{key:"1",label:"否",value:"1"})]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(k,{type:"primary",icon:"search",onClick:N},{default:o(()=>[m("搜索")]),_:1}),l(k,{icon:"Refresh",onClick:re},{default:o(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[ae,e(S)]])]),_:1},8,["enter-active-class","leave-active-class"]),l(G,{shadow:"hover"},{header:o(()=>[l(ge,{gutter:10,class:"mb8"},{default:o(()=>[l(O,{span:1.5},{default:o(()=>[V((r(),u(k,{type:"primary",plain:"",icon:"Plus",onClick:de},{default:o(()=>[m("新增")]),_:1})),[[w,["system:ossConfig:add"]]])]),_:1}),l(O,{span:1.5},{default:o(()=>[V((r(),u(k,{type:"success",plain:"",icon:"Edit",disabled:e(x),onClick:t[3]||(t[3]=a=>z())},{default:o(()=>[m("修改")]),_:1},8,["disabled"])),[[w,["system:ossConfig:edit"]]])]),_:1}),l(O,{span:1.5},{default:o(()=>[V((r(),u(k,{type:"danger",plain:"",icon:"Delete",disabled:e(B),onClick:t[4]||(t[4]=a=>A())},{default:o(()=>[m(" 删除 ")]),_:1},8,["disabled"])),[[w,["system:ossConfig:remove"]]])]),_:1}),l(fe,{showSearch:e(S),"onUpdate:showSearch":t[5]||(t[5]=a=>he(S)?S.value=a:null),onQueryTable:C},null,8,["showSearch"])]),_:1})]),default:o(()=>[V((r(),u(be,{data:e(F),onSelectionChange:ue},{default:o(()=>[l(y,{type:"selection",width:"55",align:"center"}),e(v)[0].visible?(r(),u(y,{key:0,label:"主建",align:"center",prop:"ossConfigId"})):g("",!0),e(v)[1].visible?(r(),u(y,{key:1,label:"配置key",align:"center",prop:"configKey"})):g("",!0),e(v)[2].visible?(r(),u(y,{key:2,label:"访问站点",align:"center",prop:"endpoint",width:"200"})):g("",!0),e(v)[3].visible?(r(),u(y,{key:3,label:"自定义域名",align:"center",prop:"domain",width:"200"})):g("",!0),e(v)[4].visible?(r(),u(y,{key:4,label:"桶名称",align:"center",prop:"bucketName"})):g("",!0),e(v)[5].visible?(r(),u(y,{key:5,label:"前缀",align:"center",prop:"prefix"})):g("",!0),e(v)[6].visible?(r(),u(y,{key:6,label:"域",align:"center",prop:"region"})):g("",!0),e(v)[7].visible?(r(),u(y,{key:7,label:"桶权限类型",align:"center",prop:"accessPolicy"},{default:o(a=>[a.row.accessPolicy==="0"?(r(),u(T,{key:0,type:"warning"},{default:o(()=>[m("private")]),_:1})):g("",!0),a.row.accessPolicy==="1"?(r(),u(T,{key:1,type:"success"},{default:o(()=>[m("public")]),_:1})):g("",!0),a.row.accessPolicy==="2"?(r(),u(T,{key:2,type:"info"},{default:o(()=>[m("custom")]),_:1})):g("",!0)]),_:1})):g("",!0),e(v)[8].visible?(r(),u(y,{key:8,label:"是否默认",align:"center",prop:"status"},{default:o(a=>[l(ye,{modelValue:a.row.status,"onUpdate:modelValue":P=>a.row.status=P,"active-value":"0","inactive-value":"1",onChange:P=>ce(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):g("",!0),l(y,{label:"操作",fixed:"right",align:"center",width:"150","class-name":"small-padding"},{default:o(a=>[l(M,{content:"修改",placement:"top"},{default:o(()=>[V(l(k,{link:"",type:"primary",icon:"Edit",onClick:P=>z(a.row)},null,8,["onClick"]),[[w,["system:ossConfig:edit"]]])]),_:2},1024),l(M,{content:"删除",placement:"top"},{default:o(()=>[V(l(k,{link:"",type:"primary",icon:"Delete",onClick:P=>A(a.row)},null,8,["onClick"]),[[w,["system:ossConfig:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ke,e(h)]]),V(l(_e,{page:e(c).pageNum,"onUpdate:page":t[6]||(t[6]=a=>e(c).pageNum=a),limit:e(c).pageSize,"onUpdate:limit":t[7]||(t[7]=a=>e(c).pageSize=a),total:e(R),onPagination:C},null,8,["page","limit","total"]),[[ae,e(R)>0]])]),_:1}),l(ve,{modelValue:e(_).visible,"onUpdate:modelValue":t[19]||(t[19]=a=>e(_).visible=a),title:e(_).title,width:"800px","append-to-body":""},{footer:o(()=>[le("div",al,[l(k,{loading:e(E),type:"primary",onClick:me},{default:o(()=>[m("确 定")]),_:1},8,["loading"]),l(k,{onClick:ie},{default:o(()=>[m("取 消")]),_:1})])]),default:o(()=>[l(j,{ref_key:"ossConfigFormRef",ref:$,model:e(n),rules:e(ne),"label-width":"120px"},{default:o(()=>[l(d,{label:"配置key",prop:"configKey"},{default:o(()=>[l(p,{modelValue:e(n).configKey,"onUpdate:modelValue":t[8]||(t[8]=a=>e(n).configKey=a),placeholder:"请输入配置key"},null,8,["modelValue"])]),_:1}),l(d,{label:"访问站点",prop:"endpoint"},{default:o(()=>[l(p,{modelValue:e(n).endpoint,"onUpdate:modelValue":t[9]||(t[9]=a=>e(n).endpoint=a),placeholder:"请输入访问站点"},null,8,["modelValue"])]),_:1}),l(d,{label:"自定义域名",prop:"domain"},{default:o(()=>[l(p,{modelValue:e(n).domain,"onUpdate:modelValue":t[10]||(t[10]=a=>e(n).domain=a),placeholder:"请输入自定义域名"},null,8,["modelValue"])]),_:1}),l(d,{label:"accessKey",prop:"accessKey"},{default:o(()=>[l(p,{modelValue:e(n).accessKey,"onUpdate:modelValue":t[11]||(t[11]=a=>e(n).accessKey=a),placeholder:"请输入accessKey"},null,8,["modelValue"])]),_:1}),l(d,{label:"secretKey",prop:"secretKey"},{default:o(()=>[l(p,{modelValue:e(n).secretKey,"onUpdate:modelValue":t[12]||(t[12]=a=>e(n).secretKey=a),placeholder:"请输入秘钥","show-password":""},null,8,["modelValue"])]),_:1}),l(d,{label:"桶名称",prop:"bucketName"},{default:o(()=>[l(p,{modelValue:e(n).bucketName,"onUpdate:modelValue":t[13]||(t[13]=a=>e(n).bucketName=a),placeholder:"请输入桶名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"前缀",prop:"prefix"},{default:o(()=>[l(p,{modelValue:e(n).prefix,"onUpdate:modelValue":t[14]||(t[14]=a=>e(n).prefix=a),placeholder:"请输入前缀"},null,8,["modelValue"])]),_:1}),l(d,{label:"是否HTTPS"},{default:o(()=>[l(W,{modelValue:e(n).isHttps,"onUpdate:modelValue":t[15]||(t[15]=a=>e(n).isHttps=a)},{default:o(()=>[(r(!0),ee(we,null,Ee(e(I),a=>(r(),u(U,{key:a.value,value:a.value},{default:o(()=>[m(Se(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"桶权限类型"},{default:o(()=>[l(W,{modelValue:e(n).accessPolicy,"onUpdate:modelValue":t[16]||(t[16]=a=>e(n).accessPolicy=a)},{default:o(()=>[l(U,{value:"0"},{default:o(()=>[m("private")]),_:1}),l(U,{value:"1"},{default:o(()=>[m("public")]),_:1}),l(U,{value:"2"},{default:o(()=>[m("custom")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"域",prop:"region"},{default:o(()=>[l(p,{modelValue:e(n).region,"onUpdate:modelValue":t[17]||(t[17]=a=>e(n).region=a),placeholder:"请输入域"},null,8,["modelValue"])]),_:1}),l(d,{label:"备注",prop:"remark"},{default:o(()=>[l(p,{modelValue:e(n).remark,"onUpdate:modelValue":t[18]||(t[18]=a=>e(n).remark=a),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{hl as default};
