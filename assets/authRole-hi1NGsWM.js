import{d as V,u as K,r as i,b as L,o as N,c as P,x as s,j as o,k as n,e as t,w as y,m as q,R as w,X as z,Y as G,Z as C,y as S,n as M,G as X,I as Y,v as Z,T as H}from"./index-CHPWXQMS.js";import{_ as J}from"./index-B-gTLope.js";import{E as Q,a as W}from"./el-table-column-RcY-Zu97.js";import"./el-checkbox-Bs44zGAi.js";import{E as ee,a as te}from"./el-form-item-DYrO0bwr.js";/* empty css               *//* empty css               */import{u as oe,a as ae}from"./index-CvNpfgIQ.js";import{E as le}from"./index-CKs9yFWR.js";import{E as ne}from"./index-Cn5-TJFO.js";import"./_initCloneObject-CAq2WuN8.js";import"./_baseClone-fGdeM2Wz.js";const se={class:"p-2"},ie={class:"panel"},re=s("h4",{class:"panel-title"},"基本信息",-1),ue={class:"panel"},ce=s("h4",{class:"panel-title"},"角色信息",-1),de={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},me=s("div",null,null,-1),pe=V({name:"AuthRole"}),Ce=V({...pe,setup(_e){const h=K(),{proxy:c}=H(),g=i(!0),v=i(0),d=i(1),m=i(10),k=i([]),f=i([]),r=i({nickName:void 0,userName:"",userId:void 0}),b=i(),x=a=>{var e;a.flag=!a.flag,(e=b.value)==null||e.toggleRowSelection(a,a.flag)},T=a=>{k.value=a.map(e=>e.roleId)},j=a=>String(a.roleId),I=()=>{const a={fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0,path:"/system/user"};c==null||c.$tab.closeOpenPage(a)},B=async()=>{const a=r.value.userId,e=k.value.join(",");await oe({userId:a,roleIds:e}),c==null||c.$modal.msgSuccess("授权成功"),I()},$=async()=>{const a=h.params&&h.params.userId;if(a){g.value=!0;const e=await ae(a);Object.assign(r.value,e.data.user),Object.assign(f.value,e.data.roles),v.value=f.value.length,await M(()=>{f.value.forEach(u=>{var _;u!=null&&u.flag&&((_=b.value)==null||_.toggleRowSelection(u,!0))})}),g.value=!1}};return L(()=>{$()}),(a,e)=>{const u=X,_=ee,E=le,F=ne,U=te,p=Q,A=W,O=J,R=Y,D=Z;return N(),P("div",se,[s("div",ie,[re,o(U,{model:t(r),inline:!0},{default:n(()=>[o(F,{gutter:10},{default:n(()=>[o(E,{span:2.5},{default:n(()=>[o(_,{label:"用户昵称",prop:"nickName"},{default:n(()=>[o(u,{modelValue:t(r).nickName,"onUpdate:modelValue":e[0]||(e[0]=l=>t(r).nickName=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),o(E,{span:2.5},{default:n(()=>[o(_,{label:"登录账号",prop:"userName"},{default:n(()=>[o(u,{modelValue:t(r).userName,"onUpdate:modelValue":e[1]||(e[1]=l=>t(r).userName=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",ue,[ce,s("div",null,[y((N(),q(A,{ref_key:"tableRef",ref:b,"row-key":j,data:t(f).slice((t(d)-1)*t(m),t(d)*t(m)),onRowClick:x,onSelectionChange:T},{default:n(()=>[o(p,{label:"序号",width:"55",type:"index",align:"center"},{default:n(l=>[s("span",null,w((t(d)-1)*t(m)+l.$index+1),1)]),_:1}),o(p,{type:"selection","reserve-selection":!0,width:"55"}),o(p,{label:"角色编号",align:"center",prop:"roleId"}),o(p,{label:"角色名称",align:"center",prop:"roleName"}),o(p,{label:"权限字符",align:"center",prop:"roleKey"}),o(p,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:n(l=>[s("span",null,w(t(z)(l.row.createTime)),1)]),_:1})]),_:1},8,["data"])),[[D,t(g)]]),y(o(O,{page:t(d),"onUpdate:page":e[2]||(e[2]=l=>C(d)?d.value=l:null),limit:t(m),"onUpdate:limit":e[3]||(e[3]=l=>C(m)?m.value=l:null),total:t(v)},null,8,["page","limit","total"]),[[G,t(v)>0]]),s("div",de,[o(R,{type:"primary",onClick:e[4]||(e[4]=l=>B())},{default:n(()=>[S("提交")]),_:1}),o(R,{onClick:e[5]||(e[5]=l=>I())},{default:n(()=>[S("返回")]),_:1})]),me])])])}}});export{Ce as default};
