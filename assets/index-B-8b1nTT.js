import{d as Z,r as p,a0 as O,$ as ve,b as Ve,a1 as ye,o as c,c as G,j as e,k as n,w as g,x as D,e as a,t as T,y as b,Y as W,a2 as ke,m as v,Z as he,q,R as we,F as Ne,p as Ue,T as Ce,d7 as Te,d8 as Ee,d9 as Ie,da as Pe,db as Se,dc as $e,dd as De,G as qe,I as Fe,ad as xe,a3 as Re,C as Be,D as Le,W as Ke,v as Ye}from"./index-SwfHvmsR.js";import{E as ze}from"./el-date-picker-CnLWeVPa.js";import{_ as Ae}from"./index-CwtlzU0C.js";import{E as Me,a as Qe}from"./el-table-column-DvXjLevZ.js";import"./el-checkbox-gjRiKN0S.js";/* empty css               */import{_ as je}from"./index-D6KF0Zrv.js";/* empty css               *//* empty css                */import{E as He,a as Oe}from"./el-form-item-BTGfmHo9.js";import{s as Ge}from"./index-9KK4ZSRG.js";import{E as We}from"./index-BMMvtxBL.js";import{E as Ze}from"./index-Cu3lnjet.js";import{E as Je}from"./index-gXvdNh_C.js";import"./index-CWevaQ9i.js";import"./_initCloneObject-DuYGRlJO.js";/* empty css                */import"./index-Bqsyo0rw.js";import"./_baseClone-D_rg-wPN.js";const Xe={class:"p-2"},ea={class:"mb-[10px]"},aa={class:"dialog-footer"},la=Z({name:"Tenant"}),wa=Z({...la,setup(ta){const{proxy:d}=Ce(),F=p([]),x=p([]),N=p(!1),V=p(!0),U=p(!0),E=p([]),R=p(!0),B=p(!0),I=p(0),L=p(),P=p(),f=O({visible:!1,title:""}),K={id:void 0,tenantId:void 0,contactUserName:"",contactPhone:"",username:"",password:"",companyName:"",licenseNumber:"",domain:"",address:"",intro:"",remark:"",packageId:"",expireTime:"",accountCount:0,status:"0"},J=O({form:{...K},queryParams:{pageNum:1,pageSize:10,tenantId:"",contactUserName:"",contactPhone:"",companyName:""},rules:{id:[{required:!0,message:"id不能为空",trigger:"blur"}],tenantId:[{required:!0,message:"租户编号不能为空",trigger:"blur"}],contactUserName:[{required:!0,message:"联系人不能为空",trigger:"blur"}],contactPhone:[{required:!0,message:"联系电话不能为空",trigger:"blur"}],companyName:[{required:!0,message:"企业名称不能为空",trigger:"blur"}],username:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:2,max:20,message:"用户名称长度必须介于 2 和 20 之间",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:5,max:20,message:"用户密码长度必须介于 5 和 20 之间",trigger:"blur"}]}}),{queryParams:u,form:s,rules:X}=ve(J),Y=async()=>{const o=await Ge();x.value=o.data},y=async()=>{V.value=!0;const o=await Te(u.value);F.value=o.rows,I.value=o.total,V.value=!1},ee=async o=>{let l=o.status==="0"?"启用":"停用";try{await(d==null?void 0:d.$modal.confirm('确认要"'+l+'""'+o.companyName+'"租户吗？')),await Ee(o.id,o.tenantId,o.status),d==null||d.$modal.msgSuccess(l+"成功")}catch{o.status=o.status==="0"?"1":"0"}},ae=()=>{S(),f.visible=!1},S=()=>{var o;s.value={...K},(o=P.value)==null||o.resetFields()},h=()=>{u.value.pageNum=1,y()},le=()=>{var o;(o=L.value)==null||o.resetFields(),h()},te=o=>{E.value=o.map(l=>l.id),R.value=o.length!=1,B.value=!o.length},ne=()=>{S(),Y(),f.visible=!0,f.title="添加租户"},z=async o=>{S(),await Y();const l=(o==null?void 0:o.id)||E.value[0],i=await Ie(l);Object.assign(s.value,i.data),f.visible=!0,f.title="修改租户"},oe=()=>{var o;(o=P.value)==null||o.validate(async l=>{l&&(N.value=!0,s.value.id?await Pe(s.value).finally(()=>N.value=!1):await Se(s.value).finally(()=>N.value=!1),d==null||d.$modal.msgSuccess("操作成功"),f.visible=!1,await y())})},A=async o=>{const l=(o==null?void 0:o.id)||E.value;await(d==null?void 0:d.$modal.confirm('是否确认删除租户编号为"'+l+'"的数据项？')),V.value=!0,await $e(l).finally(()=>V.value=!1),await y(),d==null||d.$modal.msgSuccess("删除成功")},se=async o=>{try{await(d==null?void 0:d.$modal.confirm('是否确认同步租户套餐租户编号为"'+o.tenantId+'"的数据项？')),V.value=!0,await De(o.tenantId,o.packageId),await y(),d==null||d.$modal.msgSuccess("同步成功")}catch{return}finally{V.value=!1}},de=()=>{d==null||d.download("system/tenant/export",{...u.value},`tenant_${new Date().getTime()}.xlsx`)};return Ve(()=>{y()}),(o,l)=>{var j,H;const i=qe,r=He,m=Fe,M=Oe,Q=We,C=Ze,re=je,ie=Je,_=Me,ue=xe,$=Re,me=Qe,pe=Ae,ce=Be,ge=Le,fe=ze,_e=Ke,k=ye("hasPermi"),be=Ye;return c(),G("div",Xe,[e(ke,{"enter-active-class":(j=a(d))==null?void 0:j.animate.searchAnimate.enter,"leave-active-class":(H=a(d))==null?void 0:H.animate.searchAnimate.leave},{default:n(()=>[g(D("div",ea,[e(Q,{shadow:"hover"},{default:n(()=>[e(M,{ref_key:"queryFormRef",ref:L,model:a(u),inline:!0},{default:n(()=>[e(r,{label:"租户编号",prop:"tenantId"},{default:n(()=>[e(i,{modelValue:a(u).tenantId,"onUpdate:modelValue":l[0]||(l[0]=t=>a(u).tenantId=t),placeholder:"请输入租户编号",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"联系人",prop:"contactUserName"},{default:n(()=>[e(i,{modelValue:a(u).contactUserName,"onUpdate:modelValue":l[1]||(l[1]=t=>a(u).contactUserName=t),placeholder:"请输入联系人",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"联系电话",prop:"contactPhone"},{default:n(()=>[e(i,{modelValue:a(u).contactPhone,"onUpdate:modelValue":l[2]||(l[2]=t=>a(u).contactPhone=t),placeholder:"请输入联系电话",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"企业名称",prop:"companyName"},{default:n(()=>[e(i,{modelValue:a(u).companyName,"onUpdate:modelValue":l[3]||(l[3]=t=>a(u).companyName=t),placeholder:"请输入企业名称",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,null,{default:n(()=>[e(m,{type:"primary",icon:"Search",onClick:h},{default:n(()=>[b("搜索")]),_:1}),e(m,{icon:"Refresh",onClick:le},{default:n(()=>[b("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[W,a(U)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(Q,{shadow:"hover"},{header:n(()=>[e(ie,{gutter:10,class:"mb8"},{default:n(()=>[e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"primary",plain:"",icon:"Plus",onClick:ne},{default:n(()=>[b("新增")]),_:1})),[[k,["system:tenant:add"]]])]),_:1}),e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"success",plain:"",icon:"Edit",disabled:a(R),onClick:l[4]||(l[4]=t=>z())},{default:n(()=>[b("修改")]),_:1},8,["disabled"])),[[k,["system:tenant:edit"]]])]),_:1}),e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"danger",plain:"",icon:"Delete",disabled:a(B),onClick:l[5]||(l[5]=t=>A())},{default:n(()=>[b(" 删除 ")]),_:1},8,["disabled"])),[[k,["system:tenant:remove"]]])]),_:1}),e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"warning",plain:"",icon:"Download",onClick:de},{default:n(()=>[b("导出")]),_:1})),[[k,["system:tenant:export"]]])]),_:1}),e(re,{showSearch:a(U),"onUpdate:showSearch":l[6]||(l[6]=t=>he(U)?U.value=t:null),onQueryTable:y},null,8,["showSearch"])]),_:1})]),default:n(()=>[g((c(),v(me,{data:a(F),onSelectionChange:te},{default:n(()=>[e(_,{type:"selection",width:"55",align:"center"}),q("",!0),e(_,{label:"租户编号",align:"center",prop:"tenantId"}),e(_,{label:"联系人",align:"center",prop:"contactUserName"}),e(_,{label:"联系电话",align:"center",prop:"contactPhone"}),e(_,{label:"企业名称",align:"center",prop:"companyName"}),e(_,{label:"社会信用代码",align:"center",prop:"licenseNumber"}),e(_,{label:"过期时间",align:"center",prop:"expireTime",width:"180"},{default:n(t=>[D("span",null,we(o.parseTime(t.row.expireTime,"{y}-{m}-{d}")),1)]),_:1}),e(_,{label:"租户状态",align:"center",prop:"status"},{default:n(t=>[e(ue,{modelValue:t.row.status,"onUpdate:modelValue":w=>t.row.status=w,"active-value":"0","inactive-value":"1",onChange:w=>ee(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(_,{width:"150",label:"操作",align:"center",fixed:"right","class-name":"small-padding fixed-width"},{default:n(t=>[e($,{content:"修改",placement:"top"},{default:n(()=>[g(e(m,{link:"",type:"primary",icon:"Edit",onClick:w=>z(t.row)},null,8,["onClick"]),[[k,["system:tenant:edit"]]])]),_:2},1024),e($,{content:"同步套餐",placement:"top"},{default:n(()=>[g(e(m,{link:"",type:"primary",icon:"Refresh",onClick:w=>se(t.row)},null,8,["onClick"]),[[k,["system:tenant:edit"]]])]),_:2},1024),e($,{content:"删除",placement:"top"},{default:n(()=>[g(e(m,{link:"",type:"primary",icon:"Delete",onClick:w=>A(t.row)},null,8,["onClick"]),[[k,["system:tenant:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[be,a(V)]]),g(e(pe,{page:a(u).pageNum,"onUpdate:page":l[7]||(l[7]=t=>a(u).pageNum=t),limit:a(u).pageSize,"onUpdate:limit":l[8]||(l[8]=t=>a(u).pageSize=t),total:a(I),onPagination:y},null,8,["page","limit","total"]),[[W,a(I)>0]])]),_:1}),e(_e,{modelValue:a(f).visible,"onUpdate:modelValue":l[22]||(l[22]=t=>a(f).visible=t),title:a(f).title,width:"500px","append-to-body":""},{footer:n(()=>[D("div",aa,[e(m,{loading:a(N),type:"primary",onClick:oe},{default:n(()=>[b("确 定")]),_:1},8,["loading"]),e(m,{onClick:ae},{default:n(()=>[b("取 消")]),_:1})])]),default:n(()=>[e(M,{ref_key:"tenantFormRef",ref:P,model:a(s),rules:a(X),"label-width":"80px"},{default:n(()=>[e(r,{label:"企业名称",prop:"companyName"},{default:n(()=>[e(i,{modelValue:a(s).companyName,"onUpdate:modelValue":l[9]||(l[9]=t=>a(s).companyName=t),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1}),e(r,{label:"联系人",prop:"contactUserName"},{default:n(()=>[e(i,{modelValue:a(s).contactUserName,"onUpdate:modelValue":l[10]||(l[10]=t=>a(s).contactUserName=t),placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1}),e(r,{label:"联系电话",prop:"contactPhone"},{default:n(()=>[e(i,{modelValue:a(s).contactPhone,"onUpdate:modelValue":l[11]||(l[11]=t=>a(s).contactPhone=t),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),a(s).id?q("",!0):(c(),v(r,{key:0,label:"用户名",prop:"username"},{default:n(()=>[e(i,{modelValue:a(s).username,"onUpdate:modelValue":l[12]||(l[12]=t=>a(s).username=t),placeholder:"请输入系统用户名",maxlength:"30"},null,8,["modelValue"])]),_:1})),a(s).id?q("",!0):(c(),v(r,{key:1,label:"用户密码",prop:"password"},{default:n(()=>[e(i,{modelValue:a(s).password,"onUpdate:modelValue":l[13]||(l[13]=t=>a(s).password=t),type:"password",placeholder:"请输入系统用户密码",maxlength:"20"},null,8,["modelValue"])]),_:1})),e(r,{label:"租户套餐",prop:"packageId"},{default:n(()=>[e(ge,{modelValue:a(s).packageId,"onUpdate:modelValue":l[14]||(l[14]=t=>a(s).packageId=t),disabled:!!a(s).tenantId,placeholder:"请选择租户套餐",clearable:"",style:{width:"100%"}},{default:n(()=>[(c(!0),G(Ne,null,Ue(a(x),t=>(c(),v(ce,{key:t.packageId,label:t.packageName,value:t.packageId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(r,{label:"过期时间",prop:"expireTime"},{default:n(()=>[e(fe,{modelValue:a(s).expireTime,"onUpdate:modelValue":l[15]||(l[15]=t=>a(s).expireTime=t),clearable:"",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择过期时间"},null,8,["modelValue"])]),_:1}),e(r,{label:"用户数量",prop:"accountCount"},{default:n(()=>[e(i,{modelValue:a(s).accountCount,"onUpdate:modelValue":l[16]||(l[16]=t=>a(s).accountCount=t),placeholder:"请输入用户数量"},null,8,["modelValue"])]),_:1}),e(r,{label:"绑定域名",prop:"domain"},{default:n(()=>[e(i,{modelValue:a(s).domain,"onUpdate:modelValue":l[17]||(l[17]=t=>a(s).domain=t),placeholder:"请输入绑定域名"},null,8,["modelValue"])]),_:1}),e(r,{label:"企业地址",prop:"address"},{default:n(()=>[e(i,{modelValue:a(s).address,"onUpdate:modelValue":l[18]||(l[18]=t=>a(s).address=t),placeholder:"请输入企业地址"},null,8,["modelValue"])]),_:1}),e(r,{label:"企业代码",prop:"licenseNumber"},{default:n(()=>[e(i,{modelValue:a(s).licenseNumber,"onUpdate:modelValue":l[19]||(l[19]=t=>a(s).licenseNumber=t),placeholder:"请输入统一社会信用代码"},null,8,["modelValue"])]),_:1}),e(r,{label:"企业简介",prop:"intro"},{default:n(()=>[e(i,{modelValue:a(s).intro,"onUpdate:modelValue":l[20]||(l[20]=t=>a(s).intro=t),type:"textarea",placeholder:"请输入企业简介"},null,8,["modelValue"])]),_:1}),e(r,{label:"备注",prop:"remark"},{default:n(()=>[e(i,{modelValue:a(s).remark,"onUpdate:modelValue":l[21]||(l[21]=t=>a(s).remark=t),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{wa as default};
