import{d as ae,u as we,r as d,a0 as Ce,de as Ne,b as ke,a1 as x,o as c,c as D,j as e,k as n,w as m,x as $,e as o,F as W,p as Z,m as f,t as H,Z as J,y as b,Y as X,a2 as Ee,R as ee,T as Ve,df as Se,C as Te,D as Ie,G as De,I as $e,a3 as Re,W as Ue,v as Fe}from"./index-_v2uieGc.js";import{E as Pe,a as qe}from"./el-tab-pane-D0PtCMTx.js";import{E as Le}from"./el-link-DAC4YaM8.js";import{_ as ze}from"./index-B7XPQ3lw.js";import{E as Oe,a as Be}from"./el-table-column-Q2QHI77F.js";import"./el-checkbox-C6h3hzMD.js";/* empty css               */import{_ as Ye}from"./index-Bi2yoGwv.js";/* empty css               *//* empty css                */import{E as Ge,a as je}from"./el-form-item-BZcdB44L.js";import{E as Ae}from"./el-date-picker-Csz6W1Cg.js";import{b as Ke,a as Me,c as Qe,s as xe,p as We,d as Ze}from"./index-CgTG5ZZl.js";import{_ as He}from"./importTable.vue_vue_type_script_setup_true_lang-D3M48Pxa.js";import{E as Je}from"./index-ctcZQfix.js";import{E as Xe}from"./index-7OoO_SlU.js";import{E as ea}from"./index-DJNwvRpE.js";import"./_initCloneObject-DMl0_0C4.js";/* empty css                */import"./index-BFoUAo4m.js";import"./_baseClone-Cj6s47u0.js";import"./index-D4mmW5IN.js";const aa={class:"p-2"},ta={class:"mb-[10px]"},la=ae({name:"Gen"}),Sa=ae({...la,setup(na){const R=we(),{proxy:s}=Ve(),U=d([]),S=d(!0),N=d(!0),k=d([]),F=d(!0),P=d(!0),T=d(0),v=d(["",""]),q=d(""),L=d([]),I=d(),z=d(),i=d({pageNum:1,pageSize:10,tableName:"",tableComment:"",dataName:""}),h=d({data:{},activeName:"domain.java"}),E=Ce({visible:!1,title:"代码预览"});Ne(()=>{var t;const a=R.query.t;a!=null&&a!=q.value&&(q.value=a,i.value.pageNum=Number(R.query.pageNum),v.value=["",""],(t=I.value)==null||t.resetFields(),g())});const te=async()=>{const a=await Me();L.value=a.data},g=async()=>{S.value=!0;const a=await Ke(s==null?void 0:s.addDateRange(i.value,v.value));U.value=a.rows,T.value=a.total,S.value=!1},y=()=>{i.value.pageNum=1,g()},O=async a=>{const t=(a==null?void 0:a.tableId)||k.value;if(t==""){s==null||s.$modal.msgError("请选择要生成的数据");return}(a==null?void 0:a.genType)==="1"?(await Qe(a.tableId),s==null||s.$modal.msgSuccess("成功生成到自定义路径："+a.genPath)):s==null||s.$download.zip("/tool/gen/batchGenCode?tableIdStr="+t,"ruoyi.zip")},le=async a=>{const t=a.tableId;await(s==null?void 0:s.$modal.confirm('确认要强制同步"'+a.tableName+'"表结构吗？')),await xe(t),s==null||s.$modal.msgSuccess("同步成功")},ne=()=>{var a;(a=z.value)==null||a.show(i.value.dataName)},oe=()=>{var a;v.value=["",""],(a=I.value)==null||a.resetFields(),y()},se=async a=>{const t=await We(a.tableId);h.value.data=t.data,E.visible=!0,h.value.activeName="domain.java"},ie=()=>{s==null||s.$modal.msgSuccess("复制成功")},de=a=>{k.value=a.map(t=>t.tableId),F.value=a.length!=1,P.value=!a.length},B=a=>{const t=(a==null?void 0:a.tableId)||k.value[0];Se.push({path:"/tool/gen-edit/index/"+t,query:{pageNum:i.value.pageNum}})},Y=async a=>{const t=(a==null?void 0:a.tableId)||k.value;await(s==null?void 0:s.$modal.confirm('是否确认删除表编号为"'+t+'"的数据项？')),await Ze(t),await g(),s==null||s.$modal.msgSuccess("删除成功")};return ke(()=>{g(),te()}),(a,t)=>{var M,Q;const G=Te,me=Ie,w=Ge,j=De,re=Ae,r=$e,ue=je,A=Je,V=Xe,ce=Ye,pe=ea,p=Oe,C=Re,_e=Be,fe=ze,be=Le,ve=Pe,ge=qe,he=Ue,_=x("hasPermi"),ye=Fe,K=x("copyText");return c(),D("div",aa,[e(Ee,{"enter-active-class":(M=o(s))==null?void 0:M.animate.searchAnimate.enter,"leave-active-class":(Q=o(s))==null?void 0:Q.animate.searchAnimate.leave},{default:n(()=>[m($("div",ta,[e(A,{shadow:"hover"},{default:n(()=>[e(ue,{ref_key:"queryFormRef",ref:I,model:o(i),inline:!0},{default:n(()=>[e(w,{label:"数据源",prop:"dataName"},{default:n(()=>[e(me,{modelValue:o(i).dataName,"onUpdate:modelValue":t[0]||(t[0]=l=>o(i).dataName=l),filterable:"",clearable:"",placeholder:"请选择/输入数据源名称"},{default:n(()=>[e(G,{key:"",label:"全部",value:""}),(c(!0),D(W,null,Z(o(L),l=>(c(),f(G,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"表名称",prop:"tableName"},{default:n(()=>[e(j,{modelValue:o(i).tableName,"onUpdate:modelValue":t[1]||(t[1]=l=>o(i).tableName=l),placeholder:"请输入表名称",clearable:"",onKeyup:H(y,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"表描述",prop:"tableComment"},{default:n(()=>[e(j,{modelValue:o(i).tableComment,"onUpdate:modelValue":t[2]||(t[2]=l=>o(i).tableComment=l),placeholder:"请输入表描述",clearable:"",onKeyup:H(y,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"创建时间",style:{width:"308px"}},{default:n(()=>[e(re,{modelValue:o(v),"onUpdate:modelValue":t[3]||(t[3]=l=>J(v)?v.value=l:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(w,null,{default:n(()=>[e(r,{type:"primary",icon:"Search",onClick:y},{default:n(()=>[b("搜索")]),_:1}),e(r,{icon:"Refresh",onClick:oe},{default:n(()=>[b("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[X,o(N)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(A,{shadow:"hover"},{header:n(()=>[e(pe,{gutter:10,class:"mb8"},{default:n(()=>[e(V,{span:1.5},{default:n(()=>[m((c(),f(r,{type:"primary",plain:"",icon:"Download",onClick:t[4]||(t[4]=l=>O())},{default:n(()=>[b("生成")]),_:1})),[[_,["tool:gen:code"]]])]),_:1}),e(V,{span:1.5},{default:n(()=>[m((c(),f(r,{type:"info",plain:"",icon:"Upload",onClick:ne},{default:n(()=>[b("导入")]),_:1})),[[_,["tool:gen:import"]]])]),_:1}),e(V,{span:1.5},{default:n(()=>[m((c(),f(r,{type:"success",plain:"",icon:"Edit",disabled:o(F),onClick:t[5]||(t[5]=l=>B())},{default:n(()=>[b("修改")]),_:1},8,["disabled"])),[[_,["tool:gen:edit"]]])]),_:1}),e(V,{span:1.5},{default:n(()=>[m((c(),f(r,{type:"danger",plain:"",icon:"Delete",disabled:o(P),onClick:t[6]||(t[6]=l=>Y())},{default:n(()=>[b(" 删除 ")]),_:1},8,["disabled"])),[[_,["tool:gen:remove"]]])]),_:1}),e(ce,{showSearch:o(N),"onUpdate:showSearch":t[7]||(t[7]=l=>J(N)?N.value=l:null),onQueryTable:g},null,8,["showSearch"])]),_:1})]),default:n(()=>[m((c(),f(_e,{data:o(U),onSelectionChange:de},{default:n(()=>[e(p,{type:"selection",align:"center",width:"55"}),e(p,{label:"序号",type:"index",width:"50",align:"center"},{default:n(l=>[$("span",null,ee((o(i).pageNum-1)*o(i).pageSize+l.$index+1),1)]),_:1}),e(p,{label:"数据源",align:"center",prop:"dataName","show-overflow-tooltip":!0}),e(p,{label:"表名称",align:"center",prop:"tableName","show-overflow-tooltip":!0}),e(p,{label:"表描述",align:"center",prop:"tableComment","show-overflow-tooltip":!0}),e(p,{label:"实体",align:"center",prop:"className","show-overflow-tooltip":!0}),e(p,{label:"创建时间",align:"center",prop:"createTime",width:"160"}),e(p,{label:"更新时间",align:"center",prop:"updateTime",width:"160"}),e(p,{label:"操作",align:"center",width:"330","class-name":"small-padding fixed-width"},{default:n(l=>[e(C,{content:"预览",placement:"top"},{default:n(()=>[m(e(r,{link:"",type:"primary",icon:"View",onClick:u=>se(l.row)},null,8,["onClick"]),[[_,["tool:gen:preview"]]])]),_:2},1024),e(C,{content:"编辑",placement:"top"},{default:n(()=>[m(e(r,{link:"",type:"primary",icon:"Edit",onClick:u=>B(l.row)},null,8,["onClick"]),[[_,["tool:gen:edit"]]])]),_:2},1024),e(C,{content:"删除",placement:"top"},{default:n(()=>[m(e(r,{link:"",type:"primary",icon:"Delete",onClick:u=>Y(l.row)},null,8,["onClick"]),[[_,["tool:gen:remove"]]])]),_:2},1024),e(C,{content:"同步",placement:"top"},{default:n(()=>[m(e(r,{link:"",type:"primary",icon:"Refresh",onClick:u=>le(l.row)},null,8,["onClick"]),[[_,["tool:gen:edit"]]])]),_:2},1024),e(C,{content:"生成代码",placement:"top"},{default:n(()=>[m(e(r,{link:"",type:"primary",icon:"Download",onClick:u=>O(l.row)},null,8,["onClick"]),[[_,["tool:gen:code"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ye,o(S)]]),m(e(fe,{page:o(i).pageNum,"onUpdate:page":t[8]||(t[8]=l=>o(i).pageNum=l),limit:o(i).pageSize,"onUpdate:limit":t[9]||(t[9]=l=>o(i).pageSize=l),total:o(T),onPagination:g},null,8,["page","limit","total"]),[[X,o(T)>0]])]),_:1}),e(he,{modelValue:o(E).visible,"onUpdate:modelValue":t[11]||(t[11]=l=>o(E).visible=l),title:o(E).title,width:"80%",top:"5vh","append-to-body":"",class:"scrollbar"},{default:n(()=>[e(ge,{modelValue:o(h).activeName,"onUpdate:modelValue":t[10]||(t[10]=l=>o(h).activeName=l)},{default:n(()=>[(c(!0),D(W,null,Z(o(h).data,(l,u)=>(c(),f(ve,{key:l,label:u.substring(u.lastIndexOf("/")+1,u.indexOf(".vm")),name:u.substring(u.lastIndexOf("/")+1,u.indexOf(".vm"))},{default:n(()=>[m((c(),f(be,{underline:!1,icon:"DocumentCopy",style:{float:"right"}},{default:n(()=>[b("  复制 ")]),_:2},1024)),[[K,l],[K,ie,"callback"]]),$("pre",null,ee(l),1)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"]),e(He,{ref_key:"importRef",ref:z,onOk:y},null,512)])}}});export{Sa as default};
