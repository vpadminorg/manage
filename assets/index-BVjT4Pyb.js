import{aa as L,d as re,Y as ee,r as p,Z as te,b as Ee,$ as Le,o as d,c as U,j as l,k as o,w as _,m as le,e as a,F as k,q as E,p as f,x as ae,y as b,W as oe,a0 as je,X as Ie,t as Ne,Q as Se,R as Re,N as De,C as Te,D as Fe,G as $e,I as qe,ab as Be,a1 as xe,U as Qe,v as ze}from"./index-DDAliqzK.js";/* empty css                       *//* empty css                 */import{_ as Ae}from"./index-RdVOGMqm.js";import{E as Ke,a as Me}from"./el-table-column-DxCuKUMo.js";import"./el-checkbox-BucE91Wb.js";import{_ as Ge}from"./index-cbmq-Xhe.js";/* empty css               */import{_ as Oe}from"./index-2eSzZeHe.js";/* empty css               *//* empty css                */import{E as We,a as Xe}from"./el-form-item-Dtm-Ic1o.js";import{g as Ye}from"./edit-aq4EfdLy.js";import{E as Ze}from"./index-x58AzXEe.js";import{E as He}from"./index-CokWeuRK.js";import{E as Je}from"./index-D7RFStbC.js";import{E as et,a as tt}from"./index-BmCCDXTO.js";import"./_initCloneObject-B4dgLBrf.js";/* empty css                */import"./index-CSfZWYHi.js";import"./_baseClone-1ZiivbqZ.js";const lt=c=>L({url:"/vpadmin/thirdPartyLoginConfig/list",method:"get",params:c}),at=c=>L({url:"/vpadmin/thirdPartyLoginConfig/"+c,method:"get"}),ot=c=>L({url:"/vpadmin/thirdPartyLoginConfig",method:"post",data:c}),ne=c=>L({url:"/vpadmin/thirdPartyLoginConfig",method:"put",data:c}),nt=c=>L({url:"/vpadmin/thirdPartyLoginConfig/"+c,method:"delete"}),rt={class:"p-2"},it={class:"mb-[10px]"},st={class:"dialog-footer"},dt=re({name:"ThirdPartyLoginConfig"}),Nt=re({...dt,setup(c){const{proxy:i}=Re(),{sys_normal_disable:x,vpa_social_login_type:T}=ee(i==null?void 0:i.useDict("sys_normal_disable","vpa_social_login_type")),Q=p([]),j=p(!1),I=p(!0),N=p(!0),F=p([]),z=p(!0),A=p(!0),$=p(0),S=p([]),K=p(),q=p(),v=te({visible:!1,title:"",isEdit:!1}),M={id:void 0,platform:void 0,clientId:void 0,clientSecret:void 0,redirectUri:void 0,status:"0",projectName:void 0,projectId:void 0},ie=te({form:{...M},queryParams:{pageNum:1,pageSize:10,platform:void 0,projectName:void 0,redirectUri:void 0,status:void 0,params:{}},rules:{id:[{required:!0,message:"主键不能为空",trigger:"blur"}],platform:[{required:!0,message:"第三方平台不能为空",trigger:"change"}],clientId:[{required:!0,message:"客户端ID不能为空",trigger:"blur"}],clientSecret:[{required:!0,message:"客户端密钥不能为空",trigger:"blur"}],redirectUri:[{required:!0,message:"重定向URI不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}],projectId:[{required:!0,message:"项目不能为空",trigger:"change"}]}}),{queryParams:s,form:r,rules:se}=ee(ie),h=async()=>{I.value=!0;const n=await lt(s.value);Q.value=n.rows,$.value=n.total,I.value=!1},de=()=>{B(),v.visible=!1},B=()=>{var n;r.value={...M},(n=q.value)==null||n.resetFields()},R=()=>{s.value.pageNum=1,h()},ue=()=>{var n;(n=K.value)==null||n.resetFields(),R()},me=n=>{F.value=n.map(e=>e.id),z.value=n.length!=1,A.value=!n.length},G=async()=>{try{const n=await Ye();S.value=n.data}catch(n){console.error("Failed to fetch project list:",n)}},pe=n=>{const e=S.value.find(u=>u.id===n);e?(r.value.redirectUri=`${e.domain}`,r.value.projectName=e.projectName):(r.value.redirectUri="",r.value.projectName=void 0)},ce=()=>{B(),G(),r.value.redirectUri="",r.value.projectName=void 0,r.value.status="0",v.visible=!0,v.title="添加第三方登录配置信息"},O=async n=>{B(),await G();const e=(n==null?void 0:n.id)||F.value[0],u=await at(e);if(Object.assign(r.value,u.data),r.value.projectId){const y=S.value.find(m=>m.id===r.value.projectId);y&&(r.value.redirectUri=`${y.domain}`,r.value.projectName=y.projectName)}v.visible=!0,v.title="修改第三方登录配置信息"},ge=async(n,e)=>{try{const u=e==="0"?"确认要启用该配置吗？":"确认要禁用该配置吗？";await De.confirm(u,"确认信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ne({...n,status:e}),i==null||i.$modal.msgSuccess(e==="0"?"启用成功":"禁用成功")}catch(u){n.status=e==="0"?"1":"0",u!=="cancel"&&(console.error("Failed to update status:",u),i==null||i.$modal.msgError("操作失败"))}},fe=()=>{var n;(n=q.value)==null||n.validate(async e=>{e&&(j.value=!0,r.value.id?await ne(r.value).finally(()=>j.value=!1):await ot(r.value).finally(()=>j.value=!1),i==null||i.$modal.msgSuccess("操作成功"),v.visible=!1,await h())})},W=async n=>{const e=(n==null?void 0:n.id)||F.value;await(i==null?void 0:i.$modal.confirm('是否确认删除第三方登录配置信息编号为"'+e+'"的数据项？').finally(()=>I.value=!1)),await nt(e),i==null||i.$modal.msgSuccess("删除成功"),await h()},ve=()=>{i==null||i.download("vpadmin/thirdPartyLoginConfig/export",{...s.value},`thirdPartyLoginConfig_${new Date().getTime()}.xlsx`)};return Ee(()=>{h()}),(n,e)=>{var H,J;const u=Te,y=Fe,m=We,P=$e,g=qe,X=Xe,Y=Ze,D=He,_e=Oe,be=Je,C=Ke,ye=Ge,Ce=Be,Z=xe,he=Me,Ve=Ae,Ue=et,Pe=tt,we=Qe,V=Le("hasPermi"),ke=ze;return d(),U("div",rt,[l(je,{"enter-active-class":(H=a(i))==null?void 0:H.animate.searchAnimate.enter,"leave-active-class":(J=a(i))==null?void 0:J.animate.searchAnimate.leave},{default:o(()=>[_(le("div",it,[l(Y,{shadow:"hover"},{default:o(()=>[l(X,{ref_key:"queryFormRef",ref:K,model:a(s),inline:!0},{default:o(()=>[l(m,{label:"第三方平台",prop:"platform"},{default:o(()=>[l(y,{modelValue:a(s).platform,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).platform=t),placeholder:"请选择第三方平台",clearable:""},{default:o(()=>[(d(!0),U(k,null,E(a(T),t=>(d(),f(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"项目名称",prop:"projectName"},{default:o(()=>[l(P,{modelValue:a(s).projectName,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).projectName=t),placeholder:"请输入项目名称",clearable:"",onKeyup:ae(R,["enter"])},null,8,["modelValue"])]),_:1}),l(m,{label:"重定向URI",prop:"redirectUri"},{default:o(()=>[l(P,{modelValue:a(s).redirectUri,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).redirectUri=t),placeholder:"请输入重定向URI",clearable:"",onKeyup:ae(R,["enter"])},null,8,["modelValue"])]),_:1}),l(m,{label:"状态",prop:"status"},{default:o(()=>[l(y,{modelValue:a(s).status,"onUpdate:modelValue":e[3]||(e[3]=t=>a(s).status=t),placeholder:"请选择状态",clearable:""},{default:o(()=>[(d(!0),U(k,null,E(a(x),t=>(d(),f(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,null,{default:o(()=>[l(g,{type:"primary",icon:"Search",onClick:R},{default:o(()=>e[16]||(e[16]=[b("搜索")])),_:1}),l(g,{icon:"Refresh",onClick:ue},{default:o(()=>e[17]||(e[17]=[b("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[oe,a(N)]])]),_:1},8,["enter-active-class","leave-active-class"]),l(Y,{shadow:"never"},{header:o(()=>[l(be,{gutter:10,class:"mb8"},{default:o(()=>[l(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"primary",plain:"",icon:"Plus",onClick:ce},{default:o(()=>e[18]||(e[18]=[b("新增")])),_:1})),[[V,["vpadmin:thirdPartyLoginConfig:add"]]])]),_:1}),l(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"success",plain:"",icon:"Edit",disabled:a(z),onClick:e[4]||(e[4]=t=>O())},{default:o(()=>e[19]||(e[19]=[b("修改")])),_:1},8,["disabled"])),[[V,["vpadmin:thirdPartyLoginConfig:edit"]]])]),_:1}),l(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"danger",plain:"",icon:"Delete",disabled:a(A),onClick:e[5]||(e[5]=t=>W())},{default:o(()=>e[20]||(e[20]=[b("删除")])),_:1},8,["disabled"])),[[V,["vpadmin:thirdPartyLoginConfig:remove"]]])]),_:1}),l(D,{span:1.5},{default:o(()=>[_((d(),f(g,{type:"warning",plain:"",icon:"Download",onClick:ve},{default:o(()=>e[21]||(e[21]=[b("导出")])),_:1})),[[V,["vpadmin:thirdPartyLoginConfig:export"]]])]),_:1}),l(_e,{showSearch:a(N),"onUpdate:showSearch":e[6]||(e[6]=t=>Ie(N)?N.value=t:null),onQueryTable:h},null,8,["showSearch"])]),_:1})]),default:o(()=>[_((d(),f(he,{data:a(Q),onSelectionChange:me},{default:o(()=>[l(C,{type:"selection",width:"55",align:"center"}),Ne("",!0),l(C,{label:"第三方平台",align:"center",prop:"platform"},{default:o(t=>[l(ye,{options:a(T),value:t.row.platform},null,8,["options","value"])]),_:1}),l(C,{label:"项目名称",align:"center",prop:"projectName"}),l(C,{label:"客户端ID",align:"center",prop:"clientId"}),l(C,{label:"客户端密钥",align:"center",prop:"clientSecret"}),l(C,{label:"重定向URI",align:"center",prop:"redirectUri"}),l(C,{key:"status",label:"状态",align:"center"},{default:o(t=>[l(Ce,{modelValue:t.row.status,"onUpdate:modelValue":w=>t.row.status=w,"active-value":"0","inactive-value":"1",onChange:w=>ge(t.row,w)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(C,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o(t=>[l(Z,{content:"修改",placement:"top"},{default:o(()=>[_(l(g,{link:"",type:"primary",icon:"Edit",onClick:w=>O(t.row)},null,8,["onClick"]),[[V,["vpadmin:thirdPartyLoginConfig:edit"]]])]),_:2},1024),l(Z,{content:"删除",placement:"top"},{default:o(()=>[_(l(g,{link:"",type:"primary",icon:"Delete",onClick:w=>W(t.row)},null,8,["onClick"]),[[V,["vpadmin:thirdPartyLoginConfig:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ke,a(I)]]),_(l(Ve,{page:a(s).pageNum,"onUpdate:page":e[7]||(e[7]=t=>a(s).pageNum=t),limit:a(s).pageSize,"onUpdate:limit":e[8]||(e[8]=t=>a(s).pageSize=t),total:a($),onPagination:h},null,8,["page","limit","total"]),[[oe,a($)>0]])]),_:1}),l(we,{modelValue:a(v).visible,"onUpdate:modelValue":e[15]||(e[15]=t=>a(v).visible=t),title:a(v).title,width:"500px","append-to-body":""},{footer:o(()=>[le("div",st,[l(g,{loading:a(j),type:"primary",onClick:fe},{default:o(()=>e[22]||(e[22]=[b("确 定")])),_:1},8,["loading"]),l(g,{onClick:de},{default:o(()=>e[23]||(e[23]=[b("取 消")])),_:1})])]),default:o(()=>[l(X,{ref_key:"thirdPartyLoginConfigFormRef",ref:q,model:a(r),rules:a(se),"label-width":"120px"},{default:o(()=>[l(m,{label:"项目",prop:"projectId"},{default:o(()=>[l(y,{modelValue:a(r).projectId,"onUpdate:modelValue":e[9]||(e[9]=t=>a(r).projectId=t),placeholder:"请选择项目",onChange:pe},{default:o(()=>[(d(!0),U(k,null,E(a(S),t=>(d(),f(u,{key:t.id,label:t.projectName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"第三方平台",prop:"platform"},{default:o(()=>[l(y,{modelValue:a(r).platform,"onUpdate:modelValue":e[10]||(e[10]=t=>a(r).platform=t),placeholder:"请选择第三方平台"},{default:o(()=>[(d(!0),U(k,null,E(a(T),t=>(d(),f(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"客户端ID",prop:"clientId"},{default:o(()=>[l(P,{modelValue:a(r).clientId,"onUpdate:modelValue":e[11]||(e[11]=t=>a(r).clientId=t),placeholder:"请输入客户端ID"},null,8,["modelValue"])]),_:1}),l(m,{label:"客户端密钥",prop:"clientSecret"},{default:o(()=>[l(P,{modelValue:a(r).clientSecret,"onUpdate:modelValue":e[12]||(e[12]=t=>a(r).clientSecret=t),placeholder:"请输入客户端密钥"},null,8,["modelValue"])]),_:1}),l(m,{label:"重定向URI",prop:"redirectUri"},{default:o(()=>[l(P,{modelValue:a(r).redirectUri,"onUpdate:modelValue":e[13]||(e[13]=t=>a(r).redirectUri=t),placeholder:"请选择项目以自动填充重定向URI",disabled:""},null,8,["modelValue"])]),_:1}),l(m,{label:"状态",prop:"status"},{default:o(()=>[l(Pe,{modelValue:a(r).status,"onUpdate:modelValue":e[14]||(e[14]=t=>a(r).status=t)},{default:o(()=>[(d(!0),U(k,null,E(a(x),t=>(d(),f(Ue,{key:t.value,value:t.value},{default:o(()=>[b(Se(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Nt as default};
