import{d as R,r as i,b as T,o as d,c as w,j as t,k as o,e as s,m as b,F as U,p as z,q as k,t as I,x as p,z as F,y as K,A,B as $,C as D,_ as G,D as O,G as j,I as H,J,K as Q,L as W,a as X,M as Y,O as Z,P as ee,N as te}from"./index-SwfHvmsR.js";import{E as se,a as ae}from"./el-form-item-BTGfmHo9.js";import"./_baseClone-D_rg-wPN.js";import"./_initCloneObject-DuYGRlJO.js";const C=_=>(Q("data-v-e8586442"),_=_(),W(),_),oe={class:"register"},re=C(()=>p("h3",{class:"title"},"VPADMIN SSG Sites Administrator Management System",-1)),ne={class:"register-code"},le=["src"],ie={key:0},de={key:1},ue={style:{float:"right"}},ce=C(()=>p("div",{class:"el-register-footer"},[p("span",null,"Copyright © 2018-2024 疯狂的狮子Li All Rights Reserved.")],-1)),pe=R({__name:"register",setup(_){const q=X(),a=i({tenantId:"",username:"",password:"",confirmPassword:"",code:"",uuid:"",userType:"vpadmin_user"}),h=i(!0),P={tenantId:[{required:!0,trigger:"blur",message:"请输入您的租户编号"}],username:[{required:!0,trigger:"blur",message:"请输入您的账号"},{min:2,max:20,message:"用户账号长度必须介于 2 和 20 之间",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"},{min:5,max:20,message:"用户密码长度必须介于 5 和 20 之间",trigger:"blur"},{pattern:/^[^<>"'|\\]+$/,message:`不能包含非法字符：< > " ' \\ |`,trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"请再次输入您的密码"},{required:!0,validator:(n,e,u)=>{a.value.password!==e?u(new Error("两次输入的密码不一致")):u()},trigger:"blur"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}]},E=i(""),g=i(!1),f=i(!0),x=i(),m=i([]),v=()=>{var n;(n=x.value)==null||n.validate(async e=>{if(e){g.value=!0;const[u]=await Y(Z(a.value));if(u)g.value=!1,f.value&&V();else{const l=a.value.username;await ee.alert("<font color='red'>恭喜你，您的账号 "+l+" 注册成功！</font>","系统提示",{dangerouslyUseHTMLString:!0,type:"success"}),await q.push("/login")}}})},V=async()=>{const n=await A(),{data:e}=n;f.value=e.captchaEnabled===void 0?!0:e.captchaEnabled,f.value&&(E.value="data:image/gif;base64,"+e.img,a.value.uuid=e.uuid)},S=async()=>{const{data:n}=await $();h.value=n.tenantEnabled===void 0?!0:n.tenantEnabled,h.value&&(m.value=n.voList,m.value!=null&&m.value.length!==0&&(a.value.tenantId=m.value[0].tenantId))};return T(()=>{V(),S()}),(n,e)=>{const u=D,l=G,L=O,c=se,y=j,B=H,M=J("router-link"),N=ae;return d(),w("div",oe,[t(N,{ref_key:"registerRef",ref:x,model:s(a),rules:P,class:"register-form"},{default:o(()=>[re,s(h)?(d(),b(c,{key:0,prop:"tenantId"},{default:o(()=>[t(L,{modelValue:s(a).tenantId,"onUpdate:modelValue":e[0]||(e[0]=r=>s(a).tenantId=r),filterable:"",placeholder:"请选择/输入公司名称",style:{width:"100%"}},{prefix:o(()=>[t(l,{"icon-class":"company",class:"el-input__icon input-icon"})]),default:o(()=>[(d(!0),w(U,null,z(s(m),r=>(d(),b(u,{key:r.tenantId,label:r.companyName,value:r.tenantId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):k("",!0),t(c,{prop:"username"},{default:o(()=>[t(y,{modelValue:s(a).username,"onUpdate:modelValue":e[1]||(e[1]=r=>s(a).username=r),type:"text",size:"large","auto-complete":"off",placeholder:"账号"},{prefix:o(()=>[t(l,{"icon-class":"user",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),t(c,{prop:"password"},{default:o(()=>[t(y,{modelValue:s(a).password,"onUpdate:modelValue":e[2]||(e[2]=r=>s(a).password=r),type:"password",size:"large","auto-complete":"off",placeholder:"密码",onKeyup:I(v,["enter"])},{prefix:o(()=>[t(l,{"icon-class":"password",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),t(c,{prop:"confirmPassword"},{default:o(()=>[t(y,{modelValue:s(a).confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=r=>s(a).confirmPassword=r),type:"password",size:"large","auto-complete":"off",placeholder:"确认密码",onKeyup:I(v,["enter"])},{prefix:o(()=>[t(l,{"icon-class":"password",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),s(f)?(d(),b(c,{key:1,prop:"code"},{default:o(()=>[t(y,{modelValue:s(a).code,"onUpdate:modelValue":e[4]||(e[4]=r=>s(a).code=r),size:"large","auto-complete":"off",placeholder:"验证码",style:{width:"63%"},onKeyup:I(v,["enter"])},{prefix:o(()=>[t(l,{"icon-class":"validCode",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"]),p("div",ne,[p("img",{src:s(E),class:"register-code-img",onClick:V},null,8,le)])]),_:1})):k("",!0),t(c,{style:{width:"100%"}},{default:o(()=>[t(B,{loading:s(g),size:"large",type:"primary",style:{width:"100%"},onClick:F(v,["prevent"])},{default:o(()=>[s(g)?(d(),w("span",de,"注 册 中...")):(d(),w("span",ie,"注 册"))]),_:1},8,["loading"]),p("div",ue,[t(M,{class:"link-type",to:"/login"},{default:o(()=>[K("使用已有账户登录")]),_:1})])]),_:1})]),_:1},8,["model"]),ce])}}}),ye=te(pe,[["__scopeId","data-v-e8586442"]]);export{ye as default};
